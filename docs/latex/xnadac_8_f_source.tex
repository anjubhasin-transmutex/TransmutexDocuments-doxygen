\hypertarget{xnadac_8_f_source}{}\doxysection{xnadac.\+F}
\label{xnadac_8_f_source}\index{/Users/Transmutex/Simulation/ADS\_SimulationCode/xnsect/isomers/xnadac.F@{/Users/Transmutex/Simulation/ADS\_SimulationCode/xnsect/isomers/xnadac.F}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00001}00001 \textcolor{comment}{*CMZ :  2.03/01 14/06/96  16.52.11  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00002}00002 \textcolor{comment}{*-\/-\/ Author :}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00003}00003       \textcolor{keyword}{SUBROUTINE }xnadac}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00004}00004 \textcolor{comment}{************************************************************************}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00005}00005 \textcolor{comment}{*                                                                      *}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00006}00006 \textcolor{comment}{*     Once product isomer yield has been read and accepted, this       *}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00007}00007 \textcolor{comment}{*     routine adds it in the isomer information common which will      *}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00008}00008 \textcolor{comment}{*     be eventually dumped onto disk                                   *}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00009}00009 \textcolor{comment}{*                                                                      *}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00010}00010 \textcolor{comment}{************************************************************************}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00011}00011 \textcolor{preprocessor}{\#include "{}xcsbnl.inc"{}}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00012}00012 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xcsend.inc"{}}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00013}00013 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xcacti.inc"{}}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00014}00014 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xcatmp.inc"{}}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00015}00015 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xctab1.inc"{}}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00016}00016 \textcolor{preprocessor}{}      \textcolor{keywordtype}{CHARACTER*11} CHELFA,XNELNA,CHELSO}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00017}00017       \textcolor{keywordtype}{CHARACTER*8} CHREAC,XNRENA}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00018}00018 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00019}00019 \textcolor{comment}{* -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00020}00020 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00021}00021 \textcolor{comment}{* -\/-\/-\/> See whether same reaction already loaded}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00022}00022       \textcolor{keywordflow}{DO} 10 jtmp=1,nmtpoi}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00023}00023          \textcolor{keywordflow}{IF}(izatmp(jtmp).EQ.izamat) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00024}00024             \textcolor{keywordflow}{IF}(imtpoi(jtmp,1).EQ.mthl(iposec)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00025}00025                \textcolor{keywordflow}{IF}(idbtmp(jtmp).NE.idbcod) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00026}00026 \textcolor{comment}{* -\/-\/-\/> Same reaction already loaded, from another ENDF database file,}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00027}00027 \textcolor{comment}{* -\/-\/-\/> print information and do not load}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00028}00028                   chelfa=xnelna(izamat)}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00029}00029                   chreac=xnrena(mthl(iposec))}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00030}00030                   \textcolor{keyword}{WRITE}(6,10000) chelfa,chreac}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00031}00031                   \textcolor{keywordflow}{GOTO} 999}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00032}00032 \textcolor{keywordflow}{               ENDIF}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00033}00033 \textcolor{keywordflow}{            ENDIF}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00034}00034 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00035}00035    10 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00036}00036 \textcolor{comment}{* -\/-\/-\/> Load data if enough space is left}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00037}00037       \textcolor{keywordflow}{IF}(nmtpoi.GE.mxmtpo) stop \textcolor{stringliteral}{'Increase MXMTPO'}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00038}00038 \textcolor{comment}{* -\/-\/-\/> Update reaction pointer}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00039}00039       nmtpoi=nmtpoi+1}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00040}00040 \textcolor{comment}{* -\/-\/-\/> Store database code}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00041}00041       idbtmp(nmtpoi) =idbcod}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00042}00042 \textcolor{comment}{* -\/-\/-\/> Store target code}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00043}00043       izatmp(nmtpoi)  =izamat}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00044}00044 \textcolor{comment}{* -\/-\/-\/> Store reaction MT code}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00045}00045       imtpoi(nmtpoi,1)=mthl(iposec)}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00046}00046 \textcolor{comment}{* -\/-\/-\/> Store product isomer code}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00047}00047       imtpoi(nmtpoi,2)=izapl(iposec)}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00048}00048 \textcolor{comment}{* -\/-\/-\/> Store beginning of information}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00049}00049       imtpoi(nmtpoi,3)=noacti}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00050}00050 \textcolor{comment}{* -\/-\/-\/> Store number of pairs (E, yield)}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00051}00051       imtpoi(nmtpoi,4)=np}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00052}00052 \textcolor{comment}{* -\/-\/-\/> Now store yield, if enough space left}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00053}00053       \textcolor{keywordflow}{IF}(noacti+2*np.GE.mxacti) stop \textcolor{stringliteral}{'Increase MXACTI'}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00054}00054       \textcolor{keywordflow}{DO} 20 jact=1,np*2}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00055}00055          xactiv(noacti+jact)=xnrval(jact)}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00056}00056    20 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00057}00057 \textcolor{comment}{* -\/-\/-\/> Update high water mark}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00058}00058       noacti=noacti+2*np}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00059}00059 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00060}00060 10000 \textcolor{keyword}{FORMAT}(\textcolor{stringliteral}{' Targ '},a,\textcolor{stringliteral}{' reac '},a,\textcolor{stringliteral}{' already in memory, skip!'})}
\DoxyCodeLine{\Hypertarget{xnadac_8_f_source_l00061}00061   999 \textcolor{keyword}{END}}

\end{DoxyCode}
