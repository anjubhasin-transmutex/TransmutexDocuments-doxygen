\hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source}{}\doxysection{Burnup.\+cc}
\label{_g4-_neutron_transport_2src_2_burnup_8cc_source}\index{/Users/Transmutex/Simulation/ADS\_SimulationCode/G4-\/NeutronTransport/src/Burnup.cc@{/Users/Transmutex/Simulation/ADS\_SimulationCode/G4-\/NeutronTransport/src/Burnup.cc}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00001}00001 \textcolor{comment}{//  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄   ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄        ▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄       ▄▄  ▄         ▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄       ▄}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00002}00002 \textcolor{comment}{// ▐░░░░░░░░░░░▌▐░░░░░░░░░░▌ ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░▌      ▐░▌▐░░░░░░░░░░░▌▐░░▌     ▐░░▌▐░▌       ▐░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░▌     ▐░▌}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00003}00003 \textcolor{comment}{// ▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀▀▀  ▀▀▀▀█░█▀▀▀▀ ▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀█░▌▐░▌░▌     ▐░▌▐░█▀▀▀▀▀▀▀▀▀ ▐░▌░▌   ▐░▐░▌▐░▌       ▐░▌ ▀▀▀▀█░█▀▀▀▀ ▐░█▀▀▀▀▀▀▀▀▀  ▐░▌   ▐░▌}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00004}00004 \textcolor{comment}{// ▐░▌       ▐░▌▐░▌       ▐░▌▐░▌               ▐░▌     ▐░▌       ▐░▌▐░▌       ▐░▌▐░▌▐░▌    ▐░▌▐░▌          ▐░▌▐░▌ ▐░▌▐░▌▐░▌       ▐░▌     ▐░▌     ▐░▌            ▐░▌ ▐░▌}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00005}00005 \textcolor{comment}{// ▐░█▄▄▄▄▄▄▄█░▌▐░▌       ▐░▌▐░█▄▄▄▄▄▄▄▄▄      ▐░▌     ▐░█▄▄▄▄▄▄▄█░▌▐░█▄▄▄▄▄▄▄█░▌▐░▌ ▐░▌   ▐░▌▐░█▄▄▄▄▄▄▄▄▄ ▐░▌ ▐░▐░▌ ▐░▌▐░▌       ▐░▌     ▐░▌     ▐░█▄▄▄▄▄▄▄▄▄    ▐░▐░▌}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00006}00006 \textcolor{comment}{// ▐░░░░░░░░░░░▌▐░▌       ▐░▌▐░░░░░░░░░░░▌     ▐░▌     ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░▌  ▐░▌  ▐░▌▐░░░░░░░░░░░▌▐░▌  ▐░▌  ▐░▌▐░▌       ▐░▌     ▐░▌     ▐░░░░░░░░░░░▌    ▐░▌}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00007}00007 \textcolor{comment}{// ▐░█▀▀▀▀▀▀▀█░▌▐░▌       ▐░▌ ▀▀▀▀▀▀▀▀▀█░▌     ▐░▌     ▐░█▀▀▀▀█░█▀▀ ▐░█▀▀▀▀▀▀▀█░▌▐░▌   ▐░▌ ▐░▌ ▀▀▀▀▀▀▀▀▀█░▌▐░▌   ▀   ▐░▌▐░▌       ▐░▌     ▐░▌     ▐░█▀▀▀▀▀▀▀▀▀    ▐░▌░▌}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00008}00008 \textcolor{comment}{// ▐░▌       ▐░▌▐░▌       ▐░▌          ▐░▌     ▐░▌     ▐░▌     ▐░▌  ▐░▌       ▐░▌▐░▌    ▐░▌▐░▌          ▐░▌▐░▌       ▐░▌▐░▌       ▐░▌     ▐░▌     ▐░▌            ▐░▌ ▐░▌}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00009}00009 \textcolor{comment}{// ▐░▌       ▐░▌▐░█▄▄▄▄▄▄▄█░▌ ▄▄▄▄▄▄▄▄▄█░▌     ▐░▌     ▐░▌      ▐░▌ ▐░▌       ▐░▌▐░▌     ▐░▐░▌ ▄▄▄▄▄▄▄▄▄█░▌▐░▌       ▐░▌▐░█▄▄▄▄▄▄▄█░▌     ▐░▌     ▐░█▄▄▄▄▄▄▄▄▄  ▐░▌   ▐░▌}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00010}00010 \textcolor{comment}{// ▐░▌       ▐░▌▐░░░░░░░░░░▌ ▐░░░░░░░░░░░▌     ▐░▌     ▐░▌       ▐░▌▐░▌       ▐░▌▐░▌      ▐░░▌▐░░░░░░░░░░░▌▐░▌       ▐░▌▐░░░░░░░░░░░▌     ▐░▌     ▐░░░░░░░░░░░▌▐░▌     ▐░▌}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00011}00011 \textcolor{comment}{//  ▀         ▀  ▀▀▀▀▀▀▀▀▀▀   ▀▀▀▀▀▀▀▀▀▀▀       ▀       ▀         ▀  ▀         ▀  ▀        ▀▀  ▀▀▀▀▀▀▀▀▀▀▀  ▀         ▀  ▀▀▀▀▀▀▀▀▀▀▀       ▀       ▀▀▀▀▀▀▀▀▀▀▀  ▀       ▀}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00012}00012 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00014}00014 \textcolor{comment}{}\textcolor{comment}{// \(\backslash\)brief Implementation of the Burnup class}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00015}00015 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00016}00016 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00018}00018 \textcolor{comment}{}\textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00019}00019 \textcolor{comment}{// Burnup}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00020}00020 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00021}00021 \textcolor{comment}{// Thomas Frosio, Transmutex, 10/04/2021}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00022}00022 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00024}00024 \textcolor{comment}{}\textcolor{comment}{// Class to update the nuclide vectors in the whole geometry and change}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00025}00025 \textcolor{comment}{// the material in order to evolve with irradiation}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00027}00027 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00028}00028 \textcolor{comment}{/********************************INCLUDES******************************/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00029}00029 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00030}00030 \textcolor{preprocessor}{\#include "{}Burnup.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00031}00031 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00032}00032 \textcolor{comment}{/**********************************************************************/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00034}00034 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00041}\mbox{\hyperlink{class_burnup_a1c217d143d339a3dbffcc19cebf89d12}{00041}} \mbox{\hyperlink{class_burnup_a055dcd10f50e0f72ed027574e4321c79}{Burnup::Burnup}}(std::map<\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}*, std::map<G4int, G4int>> sourceTerm, \mbox{\hyperlink{class_t_m_x_input_parameters}{TMXInputParameters}}* p, \textcolor{keywordtype}{int} stepNumber, \textcolor{keywordtype}{double} timePassed,}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00042}00042     \textcolor{keywordtype}{double} Edep \textcolor{comment}{/*eV*/}, \textcolor{keywordtype}{double} injE\textcolor{comment}{/*, std::vector<double> time*/}, std::vector<double> beamIntensity \textcolor{comment}{/* in Amp */}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00043}00043 ):}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00044}00044     m\_sourceTerm(sourceTerm)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00045}00045 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00046}00046     m\_epsilon     = 50;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00047}00047     m\_epsilonabs  = 1E+210; \textcolor{comment}{// To force the time subdivision to the user requirement, fix this value to infinity}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00048}00048 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00049}00049     m\_p                         = p;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00050}00050     m\_currentStep               = stepNumber;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00051}00051     m\_beamPower                 = m\_p-\/>P\_beam; \textcolor{comment}{// MW}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00052}00052     m\_corePower                 = m\_p-\/>P\_core; \textcolor{comment}{// MW, core power to target}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00053}00053 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00054}00054     m\_currentIrradiationPeriod = m\_p-\/>TimeOfRun / m\_p-\/>Nrun;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00055}00055 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00056}00056     \textcolor{keywordflow}{if}(m\_p-\/>int\_Option == 20)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00057}00057     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00058}00058         m\_nParticles            = m\_p-\/>Nparticles * (m\_p-\/>Ncycle -\/ m\_p-\/>NbDiscardCycle);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00059}00059         \textcolor{comment}{//Les deux suivants doivent etre modifies car m\_beamEnergy = EperFission / nu}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00060}00060         m\_beamEnergy            = injE;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00061}00061         m\_beamIntensity         = m\_beamPower / (m\_beamEnergy / MeV);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00062}00062     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00063}00063     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00064}00064     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00065}00065         m\_beamEnergy = m\_p-\/>BeamEnergy; \textcolor{comment}{// MeV}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00066}00066         m\_nParticles = m\_p-\/>Nparticles;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00067}00067         \textcolor{comment}{// m\_beamIntensity = beamIntensity.back();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00068}00068         \textcolor{keywordtype}{double} G = Edep/(m\_beamEnergy*1e6*(double)m\_nParticles)-\/1;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00069}00069 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00070}00070         \textcolor{keywordflow}{if} (beamIntensity.size() == 1) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00071}00071             \textcolor{keywordtype}{double} I\_0 = beamIntensity.back(); \textcolor{comment}{// A}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00072}00072             \textcolor{keywordtype}{double} corePower\_currentRun = G * I\_0 * m\_beamEnergy; \textcolor{comment}{// MW}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00073}00073             m\_beamIntensity = m\_corePower/corePower\_currentRun * I\_0; \textcolor{comment}{// A}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00074}00074         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00075}00075         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (beamIntensity.size() >= 2) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00076}00076             \textcolor{keywordtype}{double} I\_iminus1 = beamIntensity[beamIntensity.size()-\/2];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00077}00077             \textcolor{keywordtype}{double} I\_i = beamIntensity.back();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00078}00078             \textcolor{keywordtype}{double} corePower\_currentRun = G * I\_i * m\_beamEnergy; \textcolor{comment}{// MW}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00079}00079             m\_beamIntensity = (m\_corePower/corePower\_currentRun * I\_i + I\_i + I\_iminus1) / 3;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00080}00080         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00081}00081 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00082}00082         \textcolor{comment}{/*m\_timeHistory = time;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00083}00083 \textcolor{comment}{        m\_beamIntensityHistory = beamIntensity;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00084}00084 \textcolor{comment}{        std::vector<double> vec\_time, vec\_beamIntensity;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00085}00085 \textcolor{comment}{        const int sampleSize = 4;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00086}00086 \textcolor{comment}{        const int sizeVectorTime = (int)m\_timeHistory.size();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00087}00087 \textcolor{comment}{        for (int i = 0; i < sampleSize; i++) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00088}00088 \textcolor{comment}{            vec\_time.push\_back(m\_timeHistory[sizeVectorTime-\/sampleSize+i]);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00089}00089 \textcolor{comment}{            vec\_beamIntensity.push\_back(m\_beamIntensityHistory[sizeVectorTime-\/sampleSize+i]);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00090}00090 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00091}00091 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00092}00092 \textcolor{comment}{        std::cout << "{}Energy = "{} << m\_p-\/>BeamEnergy << '\(\backslash\)n';}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00093}00093 \textcolor{comment}{        std::cout << "{}Nparticles = "{} << m\_p-\/>Nparticles << '\(\backslash\)n';}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00094}00094 \textcolor{comment}{        std::cout << "{}P\_core = "{} << m\_p-\/>P\_core << '\(\backslash\)n';}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00095}00095 \textcolor{comment}{        std::cout << "{}Edep = "{} << Edep << '\(\backslash\)n';}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00096}00096 \textcolor{comment}{        double test = m\_p-\/>P\_core / ((Edep * 1e-\/6)/(double)m\_nParticles -\/ m\_beamEnergy);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00097}00097 \textcolor{comment}{        std::cout << "{}New Intensity = "{} << test << '\(\backslash\)n';}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00098}00098 \textcolor{comment}{        vec\_time.push\_back(timePassed + m\_currentIrradiationPeriod);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00099}00099 \textcolor{comment}{        vec\_beamIntensity.push\_back(m\_p-\/>P\_core / ((Edep * 1e-\/6)/(double)m\_nParticles -\/ m\_beamEnergy));}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00100}00100 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00101}00101 \textcolor{comment}{        double avgTime = avg(vec\_time);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00102}00102 \textcolor{comment}{        double avgBeamIntensity = avg(vec\_beamIntensity);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00103}00103 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00104}00104 \textcolor{comment}{        double s\_x\_y = 0., s\_x\_sq = 0.;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00105}00105 \textcolor{comment}{        for (int i = 0; i < sampleSize+1; i++) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00106}00106 \textcolor{comment}{            G4cout << i << "{} -\/ Time: "{} << vec\_time[i] << "{} -\/ Intensity: "{} << vec\_beamIntensity[i] << '\(\backslash\)n';}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00107}00107 \textcolor{comment}{            s\_x\_y += (vec\_time[i] -\/ avgTime) * (vec\_beamIntensity[i] -\/ avgBeamIntensity);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00108}00108 \textcolor{comment}{            s\_x\_sq += (vec\_time[i] -\/ avgTime) * (vec\_time[i] -\/ avgTime);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00109}00109 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00110}00110 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00111}00111 \textcolor{comment}{        // beamCurrent = alpha + beta * time}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00112}00112 \textcolor{comment}{        double beta = s\_x\_y / s\_x\_sq;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00113}00113 \textcolor{comment}{        double alpha = avgBeamIntensity -\/ beta * avgTime;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00114}00114 \textcolor{comment}{        G4cout << "{}Alpha = "{} << alpha << "{} -\/ Beta = "{} << beta << '\(\backslash\)n';*/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00115}00115 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00116}00116         \textcolor{comment}{// m\_beamIntensity     = m\_corePower / ((Edep * 1e-\/6)/(double)m\_nParticles -\/ m\_beamEnergy);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00117}00117         \textcolor{comment}{/*double beamIntensity\_temp = m\_corePower / (G * m\_beamEnergy);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00118}00118 \textcolor{comment}{        std::cout << "{}Temp Beam Intensity = "{} << beamIntensity\_temp << "{} A\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00119}00119 \textcolor{comment}{        double maximumBeamVariation = 10.; // \%}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00120}00120 \textcolor{comment}{        if (abs(beamIntensity\_temp/m\_beamIntensity -\/ 1.) < maximumBeamVariation/100.) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00121}00121 \textcolor{comment}{            m\_beamIntensity = beamIntensity\_temp;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00122}00122 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00123}00123 \textcolor{comment}{        else \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00124}00124 \textcolor{comment}{            std::cout << "{}Overvariation of "{} << maximumBeamVariation << "{} \%\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00125}00125 \textcolor{comment}{            if (beamIntensity\_temp > m\_beamIntensity) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00126}00126 \textcolor{comment}{                m\_beamIntensity *= 1. + maximumBeamVariation/100.;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00127}00127 \textcolor{comment}{            \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00128}00128 \textcolor{comment}{            else \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00129}00129 \textcolor{comment}{                m\_beamIntensity *= 1. -\/ maximumBeamVariation/100.;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00130}00130 \textcolor{comment}{            \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00131}00131 \textcolor{comment}{        \}*/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00132}00132         \textcolor{comment}{// m\_beamIntensity     = m\_corePower / (G * m\_beamEnergy);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00133}00133         \textcolor{comment}{// m\_beamIntensity = alpha + beta * (timePassed + m\_currentIrradiationPeriod);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00134}00134 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00135}00135         m\_beamPower = m\_beamEnergy * m\_beamIntensity;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00136}00136         m\_corePower = G * m\_beamPower;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00137}00137 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00138}00138         std::cout << \textcolor{stringliteral}{"{}Edep = "{}} << Edep << \textcolor{stringliteral}{"{} eV\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00139}00139         \textcolor{comment}{// G4cout << "{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/> Beam Intensity = "{} << m\_beamIntensity << "{} A (before correction: "{}<< vec\_beamIntensity.back() << "{} A)\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00140}00140         std::cout << \textcolor{stringliteral}{"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/> Beam Intensity = "{}} << m\_beamIntensity << \textcolor{stringliteral}{"{} A\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00141}00141     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00142}00142 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00143}00143     m\_totalIrradiationPeriod    = m\_p-\/>TimeOfRun ;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00144}00144     m\_coolingPeriod             = m\_p-\/>CoolingTime;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00145}00145 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00146}00146     m\_nSteps                    = m\_p-\/>Nrun;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00147}00147 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00148}00148     m\_verbose                   = m\_p-\/>Verbose;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00149}00149 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00150}00150 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00151}00151     std::cout << \textcolor{stringliteral}{"{}*********************************************************"{}}    << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00152}00152     std::cout << \textcolor{stringliteral}{"{}                    TIMESTEP "{}} << m\_currentStep               << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00153}00153     std::cout << \textcolor{stringliteral}{"{}*********************************************************"{}}    << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00154}00154 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00155}00155     m\_currentIrradiationPeriod = m\_p-\/>TimeOfRun / m\_p-\/>Nrun;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00156}00156     m\_scalingFactor            = m\_currentIrradiationPeriod * m\_beamIntensity / (m\_nParticles * e\_SI);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00157}00157     m\_irradiationTimePassed    = timePassed + m\_currentIrradiationPeriod;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00158}00158 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00159}00159     G4GeometryManager::GetInstance()-\/>OpenGeometry();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00160}00160 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00161}00161     recursiveInitialization((*G4PhysicalVolumeStore::GetInstance())[0]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00162}00162 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00163}00163     ModifyMaterial();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00164}00164     \mbox{\hyperlink{class_burnup_add988a7f493366949d7317da572d8f67}{writeMaterials}}();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00165}00165 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00166}00166 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00171}00171 \textcolor{keywordtype}{double} \mbox{\hyperlink{class_burnup_a53b19e00ea00612dcb9151d5def41fcc}{Burnup::getTimePassed}}()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00172}00172 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00173}00173     \textcolor{keywordflow}{return} m\_irradiationTimePassed;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00174}00174 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00175}00175 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00179}00179 \mbox{\hyperlink{class_burnup_ae5bceb64e397e4cbfb44aa89acc2e919}{Burnup::\string~Burnup}}()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00180}00180 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00181}00181     m\_sourceTerm.clear();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00182}00182     m\_matToLV.clear();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00183}00183     m\_matToMass.clear();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00184}00184     m\_nuclideVector.clear();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00185}00185     m\_timeHistory.clear();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00186}00186     m\_beamIntensityHistory.clear();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00187}00187 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00188}00188 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00189}00189 \textcolor{keywordtype}{double} Burnup::getNewBeamIntensity()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00190}00190     \textcolor{keywordflow}{return}(m\_beamIntensity);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00191}00191 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00192}00192 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00193}00193 \textcolor{keywordtype}{double} Burnup::avg(std::vector<double> sample) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00194}00194     \textcolor{keywordtype}{int} n = (int)sample.size();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00195}00195     \textcolor{keywordtype}{double} sum = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00196}00196     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < n; i++) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00197}00197         sum += sample[i];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00198}00198     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00199}00199     \textcolor{keywordflow}{return}(sum/(\textcolor{keywordtype}{double})n);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00200}00200 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00201}00201 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00207}00207 \textcolor{keywordtype}{void} Burnup::recursiveInitialization(G4VPhysicalVolume* PV, \textcolor{keywordtype}{int} replicate\_number) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00208}00208     \textcolor{keywordflow}{if}(PV) \textcolor{comment}{// if physical volume exists}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00209}00209     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00210}00210         G4LogicalVolume* LV     = PV-\/>GetLogicalVolume();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00211}00211         \textcolor{keywordtype}{int} PV\_replicate\_number = replicate\_number * PV-\/>GetMultiplicity(); \textcolor{comment}{// Get the number of replicates}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00212}00212 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00213}00213         \textcolor{keywordflow}{if}(LV) \textcolor{comment}{// if logical volume exists}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00214}00214         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00215}00215             \textcolor{comment}{// For each Physical volume get daugther of the Logical volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00216}00216             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < LV-\/>GetNoDaughters(); ++i)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00217}00217             \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00218}00218                 G4VPhysicalVolume* Daughter\_PV = LV-\/>GetDaughter(i);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00219}00219                 std::map<TMXMaterial*, std::vector<G4LogicalVolume*>>::iterator mat\_it = m\_matToLV.find((\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}*)(LV)-\/>GetMaterial());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00220}00220                 \textcolor{keywordflow}{if}(mat\_it  == m\_matToLV.end())}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00221}00221                 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00222}00222                     m\_matToLV[(\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}*)(Daughter\_PV-\/>GetLogicalVolume())-\/>GetMaterial()] = \{Daughter\_PV-\/>GetLogicalVolume()\};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00223}00223                     m\_matToMass[(\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}*)(Daughter\_PV-\/>GetLogicalVolume())-\/>GetMaterial()] = (Daughter\_PV-\/>GetLogicalVolume())-\/>GetMass(\textcolor{keyword}{true}, \textcolor{keyword}{false}) / g;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00224}00224                 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00225}00225                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00226}00226                 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00227}00227                     m\_matToLV[(\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}*)(Daughter\_PV-\/>GetLogicalVolume())-\/>GetMaterial()].push\_back(Daughter\_PV-\/>GetLogicalVolume());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00228}00228                     m\_matToMass[(\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}*)(Daughter\_PV-\/>GetLogicalVolume())-\/>GetMaterial()] += (Daughter\_PV-\/>GetLogicalVolume())-\/>GetMass(\textcolor{keyword}{true}, \textcolor{keyword}{false}) / g;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00229}00229                 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00230}00230                 recursiveInitialization(Daughter\_PV, PV\_replicate\_number);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00231}00231             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00232}00232         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00233}00233     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00234}00234 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00235}00235 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00239}00239 \textcolor{keywordtype}{void} Burnup::ModifyMaterial()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00240}00240 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00241}00241     G4bool hasScalingBeenModified = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00242}00242     \textcolor{comment}{//Loop on the materials matToLV = (material*, vector<lvolume*>)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00243}00243     \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\& mat : m\_matToLV)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00244}00244     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00245}00245         \textcolor{comment}{//Compute number of atoms of each nuclide in the material}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00246}00246         computetNumOfAtoms(mat.first);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00247}00247 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00248}00248 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00249}00249         \textcolor{comment}{//Addition of the decayed source term inside the final concentration + addition of initial compound decay}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00250}00250 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00251}00251         \textcolor{comment}{//Test to constitute time step}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00252}00252         testTimeStep(mat.first, hasScalingBeenModified);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00253}00253     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00254}00254 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00255}00255 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00257}00257     \textcolor{comment}{// Cette partie du code est dégueulasse. TF}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00259}00259 \textcolor{comment}{}    \textcolor{keywordflow}{if} (m\_verbose > 0 \&\& hasScalingBeenModified)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00260}00260     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00261}00261         std::ostringstream streamObj;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00262}00262         streamObj << m\_epsilonabs;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00263}00263         std::cout << \textcolor{stringliteral}{"{}The above nuclides are produced or consommed with a ratio above "{}} << m\_epsilon << \textcolor{stringliteral}{"{} \% and a production above "{}} + streamObj.str() + \textcolor{stringliteral}{"{} atoms\(\backslash\)n"{}}        << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00264}00264     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00265}00265     \textcolor{keywordflow}{if}(hasScalingBeenModified)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00266}00266     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00267}00267         std::cout << \textcolor{stringliteral}{"{}Scaling factor "{}} << m\_scalingFactor << \textcolor{stringliteral}{"{} -\/> "{}} << m\_scalingFactor * m\_epsilon / m\_scalingCorrection << \textcolor{stringliteral}{"{} particles"{}}                     << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00268}00268         std::cout << \textcolor{stringliteral}{"{}TimeStep correction: "{}} << m\_currentIrradiationPeriod << \textcolor{stringliteral}{"{} -\/> "{}} << m\_currentIrradiationPeriod * m\_epsilon / m\_scalingCorrection << \textcolor{stringliteral}{"{} s"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00269}00269         std::cout << \textcolor{stringliteral}{"{}Irradiation time reduction of a factor "{}} << m\_scalingCorrection / m\_epsilon                                                                          << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00270}00270         m\_scalingFactor            *= m\_epsilon / m\_scalingCorrection;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00271}00271 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00272}00272         m\_irradiationTimePassed    -\/= m\_currentIrradiationPeriod;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00273}00273         m\_currentIrradiationPeriod *= m\_epsilon / m\_scalingCorrection;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00274}00274         m\_irradiationTimePassed    += m\_currentIrradiationPeriod;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00275}00275 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00276}00276         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)n****************************************************"{}}                  << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00277}00277         std::cout << \textcolor{stringliteral}{"{}************ TIME STEP HAS BEEN CHANGED ************"{}}                    << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00278}00278         std::cout << \textcolor{stringliteral}{"{}****************************************************"{}}                    << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00279}00279 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00280}00280     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00281}00281     \textcolor{keywordflow}{if}(m\_irradiationTimePassed > m\_totalIrradiationPeriod)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00282}00282     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00283}00283         m\_irradiationTimePassed    += -\/(m\_irradiationTimePassed -\/ m\_totalIrradiationPeriod);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00284}00284         m\_currentIrradiationPeriod += -\/(m\_irradiationTimePassed -\/ m\_totalIrradiationPeriod);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00285}00285 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00286}00286         m\_scalingFactor            = m\_currentIrradiationPeriod * m\_beamIntensity / (m\_nParticles * e\_SI);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00287}00287     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00288}00288 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00289}00289 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00290}00290     \textcolor{keywordflow}{if}(m\_verbose > 0)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00291}00291     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00292}00292         std::cout << \textcolor{stringliteral}{"{}****************************************************"{}}                    << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00293}00293         std::cout << \textcolor{stringliteral}{"{}********** BEAM PARAMETERS FOR ACTIVATION **********"{}}                    << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00294}00294         std::cout << \textcolor{stringliteral}{"{}****************************************************\(\backslash\)n"{}}                  << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00295}00295 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00296}00296         std::cout << \textcolor{stringliteral}{"{}* Core power:                "{}} << m\_corePower << \textcolor{stringliteral}{"{} MW"{}}                   << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00297}00297         std::cout << \textcolor{stringliteral}{"{}* Beam power:                "{}} << m\_beamPower << \textcolor{stringliteral}{"{} MW"{}}                   << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00298}00298         std::cout << \textcolor{stringliteral}{"{}* Beam energy:               "{}} << m\_beamEnergy << \textcolor{stringliteral}{"{} MeV"{}}                 << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00299}00299         std::cout << \textcolor{stringliteral}{"{}* Beam intensity:            "{}} << m\_beamIntensity * 1000 << \textcolor{stringliteral}{"{} mA"{}}        << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00300}00300         std::cout << \textcolor{stringliteral}{"{}* Step irradiation period:   "{}} << m\_currentIrradiationPeriod << \textcolor{stringliteral}{"{} s "{}} << \textcolor{stringliteral}{"{} ("{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00301}00301                   << m\_currentIrradiationPeriod / m\_totalIrradiationPeriod * 100 << \textcolor{stringliteral}{"{} \%)"{}}      << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00302}00302         std::cout << \textcolor{stringliteral}{"{}* Step scaling factor:       "{}} << m\_scalingFactor}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00303}00303                   << \textcolor{stringliteral}{"{} number of primaries during step irradiation period"{}}                     << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00304}00304         std::cout << \textcolor{stringliteral}{"{}* Current irradiation time:  "{}} << m\_irradiationTimePassed << \textcolor{stringliteral}{"{} s "{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00305}00305                   << \textcolor{stringliteral}{"{} ("{}} << m\_irradiationTimePassed / m\_totalIrradiationPeriod * 100}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00306}00306                                                                                      << \textcolor{stringliteral}{"{} \%)"{}}  << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00307}00307         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)n****************************************************"{}}                  << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00308}00308         std::cout << \textcolor{stringliteral}{"{}**************** MATERIAL ACTIVATION ***************"{}}                    << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00309}00309         std::cout << \textcolor{stringliteral}{"{}****************************************************\(\backslash\)n"{}}                  << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00310}00310     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00312}00312 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00313}00313 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00314}00314 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00315}00315     \textcolor{comment}{//Loop on the materials matToLV = (material*, vector<lvolume*>)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00316}00316     \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\& mat : m\_matToLV)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00317}00317     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00318}00318         \textcolor{keywordflow}{if}(m\_verbose > 1) \mbox{\hyperlink{class_burnup_aa81e30147193d3e3c8cf5e770b53a0f5}{printMaterial}}(mat.first);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00319}00319 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00320}00320         \textcolor{comment}{// Computing the new nuclide vector and building new material}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00321}00321         computeNewNuclideVector(mat.first);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00322}00322 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00323}00323         \mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}} * newMat = buildMaterial(mat.first);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00324}00324 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00325}00325         \textcolor{comment}{// Replacing materials in all the LogicalVolumes}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00326}00326         \textcolor{keywordflow}{for}(std::vector<G4LogicalVolume*>::size\_type i=0; i<mat.second.size(); i++)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00327}00327             mat.second[i]-\/>SetMaterial(newMat);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00328}00328 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00329}00329         \textcolor{keywordflow}{if}(m\_verbose > 1) \mbox{\hyperlink{class_burnup_aa81e30147193d3e3c8cf5e770b53a0f5}{printMaterial}}((\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}*)newMat);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00330}00330     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00331}00331 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00332}00332 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00337}00337 \textcolor{keywordtype}{void} Burnup::computeNewNuclideVector(\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}* mat)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00338}00338 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00339}00339     \textcolor{comment}{//Compute number of atoms of each nuclide in the material}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00340}00340     computetNumOfAtoms(mat);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00341}00341 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00343}00343     \textcolor{comment}{//Here the bateman decay has to be done//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00345}00345 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00346}00346     \textcolor{comment}{//Addition of the decayed source term inside the final concentration + addition of initial compound decay}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00347}00347     \mbox{\hyperlink{class_t_m_x_bateman_decay}{TMXBatemanDecay}} bateman;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00348}00348     bateman.decayNuclideVector(m\_nuclideVector, m\_sourceTerm[mat],}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00349}00349                                m\_currentIrradiationPeriod,}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00350}00350                                m\_scalingFactor);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00351}00351 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00352}00352 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00353}00353 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00358}00358 \textcolor{keywordtype}{void} Burnup::testTimeStep(\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}* mat, G4bool \&modifScaling)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00359}00359 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00360}00360     \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\& source : m\_sourceTerm[mat])}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00361}00361     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00362}00362         \textcolor{keywordflow}{if}(m\_nuclideVector[source.first] != 0. \&\& source.second != 0.)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00363}00363         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00364}00364             \textcolor{keywordflow}{if}( (std::abs(source.second * m\_scalingFactor / m\_nuclideVector[source.first] * 100) > m\_epsilon}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00365}00365                     \&\& m\_nuclideVector[source.first] > m\_epsilonabs))}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00366}00366             \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00367}00367                 \textcolor{keywordflow}{if}(m\_verbose > 0) std::cout << mat-\/>GetName() << \textcolor{stringliteral}{"{} "{}} << source.first}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00368}00368                                                                              << \textcolor{stringliteral}{"{} "{}} << source.second * m\_scalingFactor / m\_nuclideVector[source.first] * 100 << \textcolor{stringliteral}{"{} \% and "{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00369}00369                                                                              << m\_nuclideVector[source.first] << \textcolor{stringliteral}{"{} number of atoms"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00370}00370                 m\_scalingCorrection = std::max(m\_scalingCorrection, std::abs(source.second * m\_scalingFactor / m\_nuclideVector[source.first] * 100));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00371}00371                 modifScaling = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00372}00372             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00373}00373             \textcolor{keywordflow}{if}(m\_nuclideVector[source.first] + source.second * m\_scalingFactor < 0. )}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00374}00374             \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00375}00375                 \textcolor{keywordtype}{double} newScalingFactor = -\/m\_nuclideVector[source.first] / source.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00376}00376                 \textcolor{keywordflow}{if}(newScalingFactor <= m\_scalingFactor * m\_epsilon / m\_scalingCorrection)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00377}00377                 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00378}00378                     \textcolor{keywordtype}{double} timeToSubstract      = m\_currentIrradiationPeriod * ( 1 -\/ newScalingFactor / m\_scalingFactor );}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00379}00379                     m\_currentIrradiationPeriod += -\/ timeToSubstract;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00380}00380                     m\_irradiationTimePassed    += -\/ timeToSubstract;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00381}00381                     m\_scalingFactor             = newScalingFactor;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00382}00382                     std::cout<< \textcolor{stringliteral}{"{}Consumption of the totality of "{}} << source.first << \textcolor{stringliteral}{"{}. Initial number of atoms: "{}} << m\_nuclideVector[source.first]}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00383}00383                              << \textcolor{stringliteral}{"{}. Final number of atoms: "{}} << m\_nuclideVector[source.first] + source.second * m\_scalingFactor<<std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00384}00384                 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00385}00385             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00386}00386         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00387}00387     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00388}00388 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00389}00389 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00394}00394 \textcolor{keywordtype}{void} Burnup::computetNumOfAtoms(\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}* mat)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00395}00395 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00396}00396     m\_nuclideVector.clear();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00397}00397     \textcolor{keyword}{const} G4double* massFraction    = mat-\/>GetFractionVector();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00398}00398 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00399}00399     \textcolor{comment}{//Loop on the number of elements of the material}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00400}00400     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j=0; j < mat-\/>GetNumberOfElements(); ++j)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00401}00401     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00402}00402         G4double* relativeAbundance = mat-\/>GetElement(j)-\/>GetRelativeAbundanceVector();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00403}00403 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00404}00404         \textcolor{comment}{//Loop on the number of isotopes of the element}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00405}00405         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i <  mat-\/>GetElement(j)-\/>GetNumberOfIsotopes(); i++)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00406}00406         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00407}00407             G4double nAtoms = m\_matToMass[mat] * CLHEP::Avogadro / ( mat-\/>GetElement(j)-\/>GetA() / (g/mole) ) * relativeAbundance[i] * massFraction[j];\textcolor{comment}{// tenir compte des différents volumes}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00408}00408             \textcolor{keywordtype}{double} IZA = mat-\/>GetElement(j)-\/>GetZ() * 10000 + mat-\/>GetElement(j)-\/>GetIsotope(0)-\/>GetN() * 10 + mat-\/>GetElement(j)-\/>GetIsotope(0)-\/>Getm();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00409}00409             std::map<G4int,G4double>::iterator it = m\_nuclideVector.find(IZA);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00410}00410             \textcolor{keywordflow}{if} ( it == m\_nuclideVector.end())}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00411}00411                 m\_nuclideVector[IZA] = nAtoms;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00412}00412             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00413}00413                 m\_nuclideVector[IZA] += nAtoms;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00414}00414         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00415}00415     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00416}00416 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00417}00417 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00423}00423 \mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}* Burnup::buildMaterial(\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}* mat)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00424}00424 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00425}00425     std::vector<int> remove;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00426}00426     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} \textcolor{keyword}{const}\& elem : m\_nuclideVector)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00427}00427         \textcolor{keywordflow}{if} (elem.second <= 1. )}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00428}00428             remove.push\_back(elem.first);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00429}00429     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} \&e: remove) m\_nuclideVector.erase(e);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00430}00430 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00431}00431     \textcolor{comment}{//Compute mass of the new material and turn nuclide vector from atom percentage to mass percentage}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00432}00432     G4double newMass       = getMaterialMass();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00433}00433 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00434}00434     \textcolor{comment}{//Initialize a new material with the new composition}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00435}00435     \mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}} *updatedMat = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}(getMatNameCurrentStep(mat),}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00436}00436                                             mat-\/>GetDensity() * newMass / m\_matToMass[mat],}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00437}00437                                             m\_nuclideVector.size(),}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00438}00438                                             mat-\/>GetState(),}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00439}00439                                             mat-\/>GetTemperature(),}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00440}00440                                             mat-\/>GetPressure());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00441}00441     \textcolor{comment}{//Construct the new material}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00442}00442     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} \textcolor{keyword}{const}\& elem : m\_nuclideVector)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00443}00443     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00444}00444         \textcolor{keywordflow}{if}( TMXElementStore::GetElement(elem.first)-\/>Name().substr(0,3) == \textcolor{stringliteral}{"{}TS\_"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00445}00445         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00446}00446             updatedMat-\/>AddElement(TMXElementStore::GetElement(elem.first)-\/>IZA(), elem.second / newMass, TMXElementStore::GetElement(elem.first)-\/>Name());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00447}00447         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00448}00448         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00449}00449         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00450}00450 \textcolor{comment}{//            std::cout<< elem.first<< "{} "{} <<elem.second <<std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00451}00451 \textcolor{comment}{//            std::cout<<TMXElementStore::GetElement(elem.first)-\/>IZA() << "{} "{}<<elem.second / newMass <<std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00452}00452             \textcolor{keywordflow}{if} (elem.second / newMass <= 0.) \textcolor{comment}{// ATTENTION: on triche}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00453}00453                 updatedMat-\/>AddElement(TMXElementStore::GetElement(elem.first)-\/>IZA(), 0.);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00454}00454             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00455}00455                 updatedMat-\/>AddElement(TMXElementStore::GetElement(elem.first)-\/>IZA(), elem.second / newMass);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00456}00456 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00457}00457         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00458}00458     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00459}00459     \textcolor{keywordflow}{return} updatedMat;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00460}00460 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00461}00461 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00467}00467 G4double Burnup::getMaterialMass()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00468}00468 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00469}00469     G4double newMass = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00470}00470     \textcolor{comment}{// Loop over nuclides in nuclideVector}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00471}00471     \textcolor{comment}{// isot.second returns the number of atoms of nuclide with name isot.first}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00472}00472     \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\& isot : m\_nuclideVector)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00473}00473     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00474}00474         \textcolor{keywordflow}{if}(TMXElementStore::GetElement(isot.first) == NULL)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00475}00475         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00476}00476             std::cout << \textcolor{stringliteral}{"{}Element "{}} << isot.first << \textcolor{stringliteral}{"{} unknown"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00477}00477         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00478}00478         G4double isotMass = isot.second / CLHEP::Avogadro * TMXElementStore::GetElement(isot.first)-\/>Mweight();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00479}00479         newMass += isotMass;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00480}00480 \textcolor{comment}{//        std::cout<< isot.first<< "{} MassIsot: "{}<<isotMass <<"{} MassMat: "{}<< newMass<<"{} nAtomsIsot: "{}<< isot.second <<std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00481}00481         m\_nuclideVector[isot.first] = isotMass;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00482}00482     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00483}00483     \textcolor{keywordflow}{return} newMass;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00484}00484 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00485}00485 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00491}00491 std::string Burnup::getMatNameCurrentStep(\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}} *mat)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00492}00492 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00493}00493     \textcolor{keywordflow}{return} (mat-\/>GetName().find(\textcolor{stringliteral}{"{}*"{}}) == std::string::npos)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00494}00494                              ? mat-\/>GetName() + \textcolor{stringliteral}{"{}*"{}} + std::to\_string(m\_currentStep)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00495}00495                              : mat-\/>GetName().substr(0, mat-\/>GetName().find(\textcolor{stringliteral}{"{}*"{}})) + \textcolor{stringliteral}{"{}*"{}} + std::to\_string(m\_currentStep);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00496}00496 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00497}00497 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00504}00504 std::string Burnup::getMatName(\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}} *mat, \textcolor{keywordtype}{int} nStep)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00505}00505 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00506}00506     \textcolor{keywordflow}{if} (nStep == 0)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00507}00507         \textcolor{keywordflow}{return} mat-\/>GetName().substr(0, mat-\/>GetName().find(\textcolor{stringliteral}{"{}*"{}}));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00508}00508     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00509}00509         \textcolor{keywordflow}{return} mat-\/>GetName().substr(0, mat-\/>GetName().find(\textcolor{stringliteral}{"{}*"{}})) + \textcolor{stringliteral}{"{}*"{}} + std::to\_string(nStep);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00510}00510 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00511}00511 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00515}00515 \textcolor{keywordtype}{void} \mbox{\hyperlink{class_burnup_add988a7f493366949d7317da572d8f67}{Burnup::writeMaterials}}()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00516}00516 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00517}00517     std::string fileName = \textcolor{stringliteral}{"{}Evolved\_Materials\_Step"{}} + std::to\_string(m\_currentStep);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00518}00518     std::ofstream file;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00519}00519     file.open(fileName, std::ios::out);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00520}00520 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00521}00521     file << \textcolor{stringliteral}{"{}// ****************************************************"{}}                    << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00522}00522     file << \textcolor{stringliteral}{"{}// ********** BEAM PARAMETERS FOR ACTIVATION **********"{}}                    << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00523}00523     file << \textcolor{stringliteral}{"{}// ****************************************************\(\backslash\)n"{}}                  << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00524}00524 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00525}00525     file << \textcolor{stringliteral}{"{}// * Core power:                "{}} << m\_corePower << \textcolor{stringliteral}{"{} MW"{}}                   << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00526}00526     file << \textcolor{stringliteral}{"{}// * Beam power:                "{}} << m\_beamPower << \textcolor{stringliteral}{"{} MW"{}}                   << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00527}00527     file << \textcolor{stringliteral}{"{}// * Beam energy:               "{}} << m\_beamEnergy << \textcolor{stringliteral}{"{} MeV"{}}                 << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00528}00528     file << \textcolor{stringliteral}{"{}// * Beam intensity:            "{}} << m\_beamIntensity * 1000 << \textcolor{stringliteral}{"{} mA"{}}        << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00529}00529     file << \textcolor{stringliteral}{"{}// * Step irradiation period:   "{}} << m\_currentIrradiationPeriod << \textcolor{stringliteral}{"{} s "{}} << \textcolor{stringliteral}{"{} ("{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00530}00530               << m\_currentIrradiationPeriod / m\_totalIrradiationPeriod * 100 << \textcolor{stringliteral}{"{} \%)"{}}      << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00531}00531     file << \textcolor{stringliteral}{"{}// * Step scaling factor:       "{}} << m\_scalingFactor}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00532}00532               << \textcolor{stringliteral}{"{} number of primaries during step irradiation period"{}}                     << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00533}00533     file << \textcolor{stringliteral}{"{}// * Current irradiation time:  "{}} << m\_irradiationTimePassed << \textcolor{stringliteral}{"{} s "{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00534}00534               << \textcolor{stringliteral}{"{} ("{}} << m\_irradiationTimePassed / m\_totalIrradiationPeriod * 100}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00535}00535                                                                                  << \textcolor{stringliteral}{"{} \%)"{}}  << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00536}00536 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00537}00537     \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\& mat : m\_matToLV)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00538}00538     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00539}00539         \mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}* newMat = (\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}*)TMXMaterial::GetMaterial(getMatNameCurrentStep(mat.first), \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00540}00540         \textcolor{keywordflow}{if}(!newMat) newMat = mat.first;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00541}00541 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00542}00542         file              << \textcolor{stringliteral}{"{}\(\backslash\)n// Material: "{}}       <<newMat-\/>GetName()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00543}00543                           << \textcolor{stringliteral}{"{} appearing in "{}}        << m\_matToLV[mat.first].size()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00544}00544                           << \textcolor{stringliteral}{"{} logical volume(s):"{}}   <<std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00545}00545 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00546}00546         G4double totalVolume = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00547}00547         G4double totalMass   = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00548}00548         \textcolor{keywordflow}{for}(std::vector<G4LogicalVolume*>::size\_type i=0; i<mat.second.size(); i++)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00549}00549         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00550}00550             G4double daugtherVolume = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00551}00551             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < mat.second[i]-\/>GetNoDaughters(); j++)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00552}00552             \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00553}00553                 daugtherVolume += mat.second[i]-\/>GetDaughter(j)-\/>GetLogicalVolume()-\/>GetSolid()-\/>GetCubicVolume() / cm3;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00554}00554             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00555}00555             totalVolume += mat.second[i]-\/>GetSolid()-\/>GetCubicVolume() / cm3 -\/ daugtherVolume;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00556}00556             G4double addMass = mat.second[i]-\/>GetMass(\textcolor{keyword}{false}, \textcolor{keyword}{false}) / g;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00557}00557             totalMass   += addMass;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00558}00558             file          << \textcolor{stringliteral}{"{}// LogicalVolume: "{}}   << mat.second[i]-\/>GetName()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00559}00559                           << \textcolor{stringliteral}{"{} with mass: "{}}         << addMass}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00560}00560                           << \textcolor{stringliteral}{"{} g and volume: "{}}      << mat.second[i]-\/>GetSolid()-\/>GetCubicVolume() / cm3 -\/ daugtherVolume}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00561}00561                           << \textcolor{stringliteral}{"{} cm3"{}}                 << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00562}00562         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00563}00563         file              << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00564}00564 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00565}00565         \textcolor{comment}{// int count = 0;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00566}00566         \textcolor{keyword}{const} G4double* massFraction    = newMat-\/>GetFractionVector();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00567}00567         std::string matName = newMat-\/>GetName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00568}00568         std::replace(matName.begin(), matName.end(), \textcolor{charliteral}{'*'}, \textcolor{charliteral}{'\_'});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00569}00569         file              << \textcolor{stringliteral}{"{}TMXMaterial* "{}}       << matName}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00570}00570                           << \textcolor{stringliteral}{"{} = new TMXMaterial(\(\backslash\)"{}"{}} << newMat-\/>GetName()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00571}00571                           << \textcolor{stringliteral}{"{}\(\backslash\)"{}, "{}}                 << totalMass / totalVolume}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00572}00572                           << \textcolor{stringliteral}{"{} * (g / cm3), "{}}       << newMat-\/>GetElementVector()-\/>size()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00573}00573                           << \textcolor{stringliteral}{"{}, "{}}                   << m\_State[newMat-\/>GetState()]}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00574}00574                           << \textcolor{stringliteral}{"{}, "{}}                   << newMat-\/>GetTemperature()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00575}00575                           << \textcolor{stringliteral}{"{}, "{}}                   << newMat-\/>GetPressure()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00576}00576                           << \textcolor{stringliteral}{"{});"{}}                   << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00577}00577 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00578}00578         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j=0; j < newMat-\/>GetNumberOfElements(); ++j)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00579}00579         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00580}00580             \textcolor{comment}{//Loop on the number of isotopes of the element}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00581}00581             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i <  newMat-\/>GetElement(j)-\/>GetNumberOfIsotopes(); i++)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00582}00582             \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00583}00583                 \textcolor{keywordtype}{double} IZA = newMat-\/>GetElement(j)-\/>GetZ() * 10000 + newMat-\/>GetElement(j)-\/>GetIsotope(0)-\/>GetN() * 10 + newMat-\/>GetElement(j)-\/>GetIsotope(0)-\/>Getm();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00584}00584 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00585}00585                 file      << matName}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00586}00586                           << \textcolor{stringliteral}{"{}-\/>AddElement("{}}        << IZA}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00587}00587                           << \textcolor{stringliteral}{"{}, "{}}                   << massFraction[j]}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00588}00588                           << \textcolor{stringliteral}{"{});"{}}                   << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00589}00589             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00590}00590         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00591}00591         file              << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}                   << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00592}00592     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00593}00593     file.close();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00594}00594 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00595}00595 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00600}00600 \textcolor{keywordtype}{void} \mbox{\hyperlink{class_burnup_aa81e30147193d3e3c8cf5e770b53a0f5}{Burnup::printMaterial}}(\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}* mat)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00601}00601 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00602}00602     \mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}* matSubstitute = mat;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00603}00603     std::string initialString = \textcolor{stringliteral}{"{}Material: "{}};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00604}00604     std::string finalString   = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00605}00605 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00606}00606     \textcolor{keywordflow}{if}(mat-\/>GetName().find(\textcolor{stringliteral}{"{}*"{}}) == std::string::npos)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00607}00607         initialString = \textcolor{stringliteral}{"{}Modifying: "{}};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00608}00608     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00609}00609     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00610}00610         \textcolor{keywordtype}{int} pos = mat-\/>GetName().find(\textcolor{stringliteral}{"{}*"{}});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00611}00611         std::string substring = mat-\/>GetName().substr(pos + 1, mat-\/>GetName().length());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00612}00612 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00613}00613         \textcolor{keywordflow}{if}(std::stoi(substring) == m\_currentStep)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00614}00614         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00615}00615             initialString = \textcolor{stringliteral}{"{}By: "{}};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00616}00616             finalString   = \textcolor{stringliteral}{"{}\(\backslash\)n-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00617}00617             matSubstitute = (\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}*)TMXMaterial::GetMaterial(getMatName(mat, m\_currentStep -\/ 1), \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00618}00618         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00619}00619         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(std::stoi(substring) == m\_currentStep -\/ 1 || substring.length() == 0)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00620}00620             initialString = \textcolor{stringliteral}{"{}Modifying: "{}};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00621}00621     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00622}00622 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00623}00623     std::cout         << initialString         << mat-\/>GetName()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00624}00624                       << \textcolor{stringliteral}{"{} appearing in "{}}      << m\_matToLV[matSubstitute].size()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00625}00625                       << \textcolor{stringliteral}{"{} logical volume(s):"{}} <<std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00626}00626 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00627}00627     G4double totalVolume = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00628}00628     G4double totalMass   = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00629}00629     \textcolor{keywordflow}{for}(std::vector<G4LogicalVolume*>::size\_type i=0; i<m\_matToLV[matSubstitute].size(); i++)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00630}00630     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00631}00631         G4double daugtherVolume = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00632}00632         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < m\_matToLV[matSubstitute][i]-\/>GetNoDaughters(); j++)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00633}00633         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00634}00634             daugtherVolume += m\_matToLV[matSubstitute][i]-\/>GetDaughter(j)-\/>GetLogicalVolume()-\/>GetSolid()-\/>GetCubicVolume() / cm3;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00635}00635         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00636}00636         totalVolume += m\_matToLV[matSubstitute][i]-\/>GetSolid()-\/>GetCubicVolume() / cm3 -\/ daugtherVolume;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00637}00637         G4double addMass = m\_matToLV[matSubstitute][i]-\/>GetMass(\textcolor{keyword}{false}, \textcolor{keyword}{false}) / g;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00638}00638         totalMass   += addMass;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00639}00639         std::cout     << \textcolor{stringliteral}{"{}\(\backslash\)tLogicalVolume: "{}}  << m\_matToLV[matSubstitute][i]-\/>GetName()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00640}00640                       << \textcolor{stringliteral}{"{} with mass: "{}}       << addMass}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00641}00641                       << \textcolor{stringliteral}{"{} g and volume: "{}}    << m\_matToLV[matSubstitute][i]-\/>GetSolid()-\/>GetCubicVolume() / cm3 -\/ daugtherVolume}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00642}00642                       << \textcolor{stringliteral}{"{} cm3"{}}               << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00643}00643     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00644}00644 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00645}00645     std::cout         << \textcolor{stringliteral}{"{}\(\backslash\)tTotal mass: "{}}     << totalMass}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00646}00646                       << \textcolor{stringliteral}{"{} ,Total volume: "{}}   << totalVolume}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00647}00647                       << \textcolor{stringliteral}{"{} cm3, Density: "{}}    << totalMass / totalVolume}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00648}00648                       << \textcolor{stringliteral}{"{} g / cm3"{}}           << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00649}00649 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00650}00650     \textcolor{keyword}{const} G4double* massFraction    = mat-\/>GetFractionVector();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00651}00651     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j=0; j < mat-\/>GetNumberOfElements(); ++j)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00652}00652     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00653}00653         G4double* relativeAbundance = mat-\/>GetElement(j)-\/>GetRelativeAbundanceVector();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00654}00654         std::cout     << \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)tElement: "{}}      << mat-\/>GetElement(j)-\/>GetName()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00655}00655                       << \textcolor{stringliteral}{"{} "{}}                  << massFraction[j]}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00656}00656                       << \textcolor{stringliteral}{"{} "{}}                  << mat-\/>GetElement(j)-\/>GetA() / (g/mole)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00657}00657                       << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00658}00658 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00659}00659         \textcolor{comment}{//Loop on the number of isotopes of the element}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00660}00660         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i <  mat-\/>GetElement(j)-\/>GetNumberOfIsotopes(); i++)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00661}00661         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00662}00662             \textcolor{keyword}{const} G4Isotope* Isotope = mat-\/>GetElement(j)-\/>GetIsotope(i);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00663}00663             G4double nAtoms =totalMass * CLHEP::Avogadro / ( mat-\/>GetElement(j)-\/>GetA() / (g/mole) ) * relativeAbundance[i] * massFraction[j];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00664}00664             std::cout << \textcolor{stringliteral}{"{}\(\backslash\)t\(\backslash\)t\(\backslash\)tIsotope: "{}}    << Isotope-\/>GetName()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00665}00665                       << \textcolor{stringliteral}{"{} "{}}                  << nAtoms}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00666}00666                       << \textcolor{stringliteral}{"{} "{}}                  << relativeAbundance[i]}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00667}00667                       << \textcolor{stringliteral}{"{} "{}}                  << Isotope-\/>GetA()/(g/mole)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00668}00668                       << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00669}00669         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00670}00670     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00671}00671     std::cout<<endl;   std::cout << finalString << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_burnup_8cc_source_l00672}00672 \}}

\end{DoxyCode}
