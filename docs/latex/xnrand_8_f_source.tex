\hypertarget{xnrand_8_f_source}{}\doxysection{xnrand.\+F}
\label{xnrand_8_f_source}\index{/Users/Transmutex/Simulation/ADS\_SimulationCode/xnsect/xnsect/src/xnrand.F@{/Users/Transmutex/Simulation/ADS\_SimulationCode/xnsect/xnsect/src/xnrand.F}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00001}00001 \textcolor{comment}{*CMZ :  2.03/01 21/06/96  10.53.12  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00002}00002 \textcolor{comment}{*-\/-\/ Author :    Federico Carminati   18/01/94}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00003}00003       \textcolor{keyword}{SUBROUTINE }xnrand(RVEC,LENV)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00004}00004 \textcolor{comment}{C      SUBROUTINE RANLUX(RVEC,LENV)}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00005}00005 \textcolor{comment}{C         Subtract-\/and-\/borrow random number generator proposed by}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00006}00006 \textcolor{comment}{C         Marsaglia and Zaman, implemented by F. James with the name}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00007}00007 \textcolor{comment}{C         RCARRY in 1991, and later improved by Martin Luescher}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00008}00008 \textcolor{comment}{C         in 1993 to produce "{}Luxury Pseudorandom Numbers"{}.}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00009}00009 \textcolor{comment}{C     Fortran 77 coded by F. James, 1993}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00010}00010 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00011}00011 \textcolor{comment}{C   LUXURY LEVELS.}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00012}00012 \textcolor{comment}{C   -\/-\/-\/-\/-\/-\/ -\/-\/-\/-\/-\/-\/      The available luxury levels are:}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00013}00013 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00014}00014 \textcolor{comment}{C  level 0  (p=24): equivalent to the original RCARRY of Marsaglia}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00015}00015 \textcolor{comment}{C           and Zaman, very long period, but fails many tests.}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00016}00016 \textcolor{comment}{C  level 1  (p=48): considerable improvement in quality over level 0,}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00017}00017 \textcolor{comment}{C           now passes the gap test, but still fails spectral test.}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00018}00018 \textcolor{comment}{C  level 2  (p=97): passes all known tests, but theoretically still}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00019}00019 \textcolor{comment}{C           defective.}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00020}00020 \textcolor{comment}{C  level 3  (p=223): DEFAULT VALUE.  Any theoretically possible}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00021}00021 \textcolor{comment}{C           correlations have very small chance of being observed.}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00022}00022 \textcolor{comment}{C  level 4  (p=389): highest possible luxury, all 24 bits chaotic.}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00023}00023 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00024}00024 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00025}00025 \textcolor{comment}{C!!!  Calling sequences for RANLUX:                                  ++}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00026}00026 \textcolor{comment}{C!!!      CALL RANLUX (RVEC, LEN)   returns a vector RVEC of LEN     ++}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00027}00027 \textcolor{comment}{C!!!                   32-\/bit random floating point numbers between  ++}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00028}00028 \textcolor{comment}{C!!!                   zero (not included) and one (also not incl.). ++}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00029}00029 \textcolor{comment}{C!!!      CALL RLUXGO(LUX,INT) initializes the generator from one    ++}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00030}00030 \textcolor{comment}{C!!!                   32-\/bit integer INT and sets Luxury Level LUX  ++}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00031}00031 \textcolor{comment}{C!!!                   which is integer between zero and MAXLEV,     ++}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00032}00032 \textcolor{comment}{C!!!                   or if LUX .GT. 24, it sets p=LUX directly     ++}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00033}00033 \textcolor{comment}{C!!!      CALL RLUXIN(IVEC)    restarts the generator from vector    ++}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00034}00034 \textcolor{comment}{C!!!                   IVEC of 25 32-\/bit integers (see RLUXUT)       ++}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00035}00035 \textcolor{comment}{C!!!      CALL RLUXUT(IVEC)    outputs the current values of the 25  ++}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00036}00036 \textcolor{comment}{C!!!                 32-\/bit integer seeds, to be used for restarting ++}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00037}00037 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00038}00038       dimension rvec(lenv)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00039}00039       dimension seeds(24), iseeds(24), isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00040}00040       parameter(maxlev=4, lxdflt=3)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00041}00041       dimension ndskip(0:maxlev)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00042}00042       parameter(twop12=4096.)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00043}00043       parameter(itwo24=2**24, icons=2147483563)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00044}00044       \textcolor{keywordtype}{SAVE} notyet, i24, j24, carry, seeds, twom24, twom12, luxlev}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00045}00045       \textcolor{keywordtype}{SAVE} nskip, ndskip, in24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00046}00046       \textcolor{keywordtype}{INTEGER} LUXLEV}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00047}00047       \textcolor{keywordtype}{LOGICAL} NOTYET}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00048}00048       \textcolor{keyword}{DATA} notyet, luxlev, in24 /.true., lxdflt, 0/}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00049}00049       \textcolor{keyword}{DATA} i24,j24,carry/24,10,0./}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00050}00050       \textcolor{keyword}{DATA} ndskip/0,  24,  73, 199, 365 /}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00051}00051 \textcolor{comment}{Corresponds to p=24   48   97  223  389}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00052}00052 \textcolor{comment}{C     time factor 1    2    4    9   16   (in practice, much smaller)}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00053}00053 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00054}00054 \textcolor{comment}{C  NOTYET is .TRUE. if no initialization has been performed yet.}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00055}00055 \textcolor{comment}{C              Default Initialization by Multiplicative Congruential}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00056}00056       \textcolor{keywordflow}{IF} (notyet) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00057}00057          notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00058}00058          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00059}00059          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default initialisation '}\textcolor{stringliteral}{',I12)'}) jseed}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00060}00060          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00061}00061          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00062}00062          lp = nskip + 24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00063}00063          in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00064}00064          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00065}00065      +           luxlev, lp}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00066}00066          twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00067}00067          \textcolor{keywordflow}{DO} 10 i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00068}00068             twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00069}00069             k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00070}00070             jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00071}00071             \textcolor{keywordflow}{IF} (jseed .LT. 0) jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00072}00072             iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00073}00073    10    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00074}00074          twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00075}00075          \textcolor{keywordflow}{DO} 20 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00076}00076             seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00077}00077    20    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00078}00078          i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00079}00079          j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00080}00080          carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00081}00081          \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00082}00082 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00083}00083 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00084}00084 \textcolor{comment}{C          The Generator proper: "{}Subtract-\/with-\/borrow"{},}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00085}00085 \textcolor{comment}{C          as proposed by Marsaglia and Zaman,}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00086}00086 \textcolor{comment}{C          Florida State University, March, 1989}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00087}00087 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00088}00088       \textcolor{keywordflow}{DO} 40  ivec= 1, lenv}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00089}00089 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00090}00090          uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00091}00091 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00092}00092          \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00093}00093             uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00094}00094             carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00095}00095          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00096}00096             carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00097}00097 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00098}00098          seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00099}00099          i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00100}00100          \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00101}00101          j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00102}00102          \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00103}00103          rvec(ivec) = uni}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00104}00104 \textcolor{comment}{C  small numbers (with less than 12 "{}significant"{} bits) are "{}padded"{}.}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00105}00105          \textcolor{keywordflow}{IF} (uni .LT. twom12) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00106}00106             rvec(ivec) = rvec(ivec) + twom24*seeds(j24)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00107}00107 \textcolor{comment}{C        and zero is forbidden in case someone takes a logarithm}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00108}00108             \textcolor{keywordflow}{IF} (rvec(ivec) .EQ. 0.) rvec(ivec) = twom24*twom24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00109}00109 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00110}00110 \textcolor{comment}{C        Skipping to luxury.  As proposed by Martin Luscher.}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00111}00111          in24 = in24 + 1}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00112}00112          \textcolor{keywordflow}{IF} (in24 .EQ. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00113}00113             in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00114}00114             \textcolor{keywordflow}{DO} 30 isk= 1, nskip}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00115}00115                uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00116}00116 \textcolor{comment}{CCCCCC         The above has been corrected}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00117}00117                \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00118}00118                   uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00119}00119                   carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00120}00120                \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00121}00121                   carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00122}00122 \textcolor{keywordflow}{               ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00123}00123                seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00124}00124                i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00125}00125                \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00126}00126                j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00127}00127                \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00128}00128    30       \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00129}00129 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00130}00130    40 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00131}00131       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00132}00132 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00133}00133 \textcolor{comment}{C           Entry to input and float integer seeds from previous run}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00134}00134 \textcolor{comment}{C      ENTRY RLUXIN(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00135}00135       entry xnrnin(isdext)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00136}00136       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00137}00137       \textcolor{keywordflow}{DO} 50  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00138}00138    50 twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00139}00139       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00140}00140       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: initialisation with 25 numbers'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00141}00141       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'(5X,5I12)'}) isdext}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00142}00142       \textcolor{keywordflow}{DO} 60  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00143}00143          seeds(i) = real(isdext(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00144}00144    60 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00145}00145       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00146}00146       \textcolor{keywordflow}{IF} (isdext(25) .LT. 0)  carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00147}00147       isd = iabs(isdext(25))}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00148}00148       i24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00149}00149       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00150}00150       j24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00151}00151       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00152}00152       in24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00153}00153       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00154}00154       luxlev = isd}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00155}00155       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00156}00156          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00157}00157          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: level set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00158}00158       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (luxlev .GE. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00159}00159          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00160}00160          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00161}00161       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00162}00162          nskip = ndskip(maxlev)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00163}00163          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: illegal level '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00164}00164          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00165}00165 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00166}00166       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00167}00167 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00168}00168 \textcolor{comment}{C                    Entry to ouput seeds as integers}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00169}00169 \textcolor{comment}{C      ENTRY RLUXUT(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00170}00170       entry xnrnut(isdext)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00171}00171       \textcolor{keywordflow}{DO} 70  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00172}00172          isdext(i) = int(seeds(i)*twop12*twop12)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00173}00173    70 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00174}00174       isdext(25) = i24 + 100*j24 + 10000*in24 + 1000000*luxlev}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00175}00175       \textcolor{keywordflow}{IF} (carry .GT. 0.)  isdext(25) = -\/isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00176}00176       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00177}00177 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00178}00178 \textcolor{comment}{C                    Entry to initialize from one integer}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00179}00179 \textcolor{comment}{C      ENTRY RLUXGO(LUX,INSEED)}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00180}00180       entry xnrngo(lux,inseed)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00181}00181       \textcolor{keywordflow}{IF} (lux .LT. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00182}00182          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00183}00183       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00184}00184          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00185}00185       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LT. 24 .OR. lux .GT. 2000) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00186}00186          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00187}00187          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: illegal level '}\textcolor{stringliteral}{',I2)'}) lux}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00188}00188       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00189}00189          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00190}00190          \textcolor{keywordflow}{DO} 80  ilx= 0, maxlev}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00191}00191             \textcolor{keywordflow}{IF} (lux .EQ. ndskip(ilx)+24) luxlev = ilx}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00192}00192    80    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00193}00193 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00194}00194       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00195}00195          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00196}00196          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00197}00197      +           luxlev, nskip+24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00198}00198       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00199}00199          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00200}00200          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00201}00201 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00202}00202       in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00203}00203       \textcolor{keywordflow}{IF} (inseed .NE. 0)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00204}00204          jseed = inseed}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00205}00205          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from seed '}\textcolor{stringliteral}{',I12)'})inseed}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00206}00206       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00207}00207          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00208}00208          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from default seed'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00209}00209 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00210}00210       notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00211}00211       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00212}00212       \textcolor{keywordflow}{DO} 90  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00213}00213          twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00214}00214          k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00215}00215          jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00216}00216          \textcolor{keywordflow}{IF} (jseed .LT. 0)  jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00217}00217          iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00218}00218    90 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00219}00219       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00220}00220       \textcolor{keywordflow}{DO} 100 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00221}00221          seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00222}00222   100 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00223}00223       i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00224}00224       j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00225}00225       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00226}00226       \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrand_8_f_source_l00227}00227       \textcolor{keyword}{END}}

\end{DoxyCode}
