\hypertarget{convac9_2comain_8_f_source}{}\doxysection{comain.\+F}
\label{convac9_2comain_8_f_source}\index{/Users/Transmutex/Simulation/ADS\_SimulationCode/xnsect/convac9/comain.F@{/Users/Transmutex/Simulation/ADS\_SimulationCode/xnsect/convac9/comain.F}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00001}00001 \textcolor{comment}{*CMZ :  2.03/07 27/09/96  15.19.10  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00002}00002 \textcolor{comment}{*-\/-\/ Author :    Federico Carminati   23/08/95}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00003}00003       \textcolor{keyword}{program} comain}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00004}00004 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00005}00005 \textcolor{comment}{*     Convert European Activation File to ENDF/B-\/VI format}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00006}00006 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00007}00007 \textcolor{comment}{*     The EAF is a sequence of TAB1 records preceded by two lines of}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00008}00008 \textcolor{comment}{*     comment and a HEAD record with the format:}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00009}00009 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00010}00010 \textcolor{comment}{*                    (2e11.4,4i11,i4,i2,i3)}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00011}00011 \textcolor{comment}{*                    ZA, AWR, 0, ITAPS, 0, 0, MAT, MF, MT}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00012}00012 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00013}00013 \textcolor{comment}{*     ZA is correct, but AWR should be the atomic mass in neutron}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00014}00014 \textcolor{comment}{*     units, and this is only occasionally correct in the file. The}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00015}00015 \textcolor{comment}{*     material code is obtained as 100*Z+MOD(A,100) for the fundamental}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00016}00016 \textcolor{comment}{*     state. For isomeric states 30+LISO*20 is added to the}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00017}00017 \textcolor{comment}{*     mat number, where LISO is the metastable state number.}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00018}00018 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00019}00019 \textcolor{comment}{*     The reaction codes follow the ENDF/B-\/VI rule, but the isomeric}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00020}00020 \textcolor{comment}{*     state of the product is indicated adding 300*LISO to the reaction}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00021}00021 \textcolor{comment}{*     code.}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00022}00022 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00023}00023 \textcolor{comment}{*     A proper ENDF/B-\/VI file cannot be made because FILE 2 will be}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00024}00024 \textcolor{comment}{*     absent, but the result of the following program can be passed}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00025}00025 \textcolor{comment}{*     through LINEAR and SIGMA1 programs to obtain linearised Doppler}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00026}00026 \textcolor{comment}{*     broadened cross sections. From there on the file is (almost)}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00027}00027 \textcolor{comment}{*     an ordinary PENDF file from which group condensed cross sections}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00028}00028 \textcolor{comment}{*     can be derived.}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00029}00029 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00030}00030 \textcolor{preprocessor}{\#include "{}xcmxse.inc"{}}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00031}00031 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xctb1c.inc"{}}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00032}00032 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xcnamf.inc"{}}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00033}00033 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xcseet.inc"{}}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00034}00034 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xceafi.inc"{}}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00035}00035 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xcmf01.inc"{}}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00036}00036 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xcdbna.inc"{}}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00037}00037 \textcolor{preprocessor}{}\textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00038}00038       parameter(maxsto=500)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00039}00039       \textcolor{keyword}{common} / xcstor / hmem(maxsto)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00040}00040 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00041}00041       parameter(itapd=98,itaps=99)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00042}00042       parameter(itapa=12,neaff=5)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00043}00043       \textcolor{keywordtype}{character*8} xnrena, chrena}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00044}00044       \textcolor{keywordtype}{character*11} xnelna}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00045}00045       \textcolor{keywordtype}{character*66} chtext}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00046}00046       \textcolor{keywordtype}{character*255} chfili, chfilo}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00047}00047       \textcolor{keywordtype}{logical} lskips}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00048}00048       \textcolor{keyword}{data} mathol / -\/99 /}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00049}00049 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00050}00050 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00051}00051 \textcolor{comment}{*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00052}00052 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00053}00053 \textcolor{comment}{* -\/-\/-\/ Init for filenames}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00054}00054       \textcolor{keyword}{call }xninit(maxsto,\textcolor{stringliteral}{' '})}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00055}00055 \textcolor{comment}{* -\/-\/-\/ Load EET nuclear database, one entry per isomer}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00056}00056       \textcolor{keyword}{call }xnleet(chetdb)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00057}00057 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00058}00058 \textcolor{comment}{* -\/-\/-\/ Open temporary direct access file for storing info}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00059}00059       \textcolor{keyword}{open}(unit=itapd,file=\textcolor{stringliteral}{'eaf.scratch'},form=\textcolor{stringliteral}{'formatted'},recl=75,}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00060}00060      +access=\textcolor{stringliteral}{'direct'},status=\textcolor{stringliteral}{'unknown'})}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00061}00061 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00062}00062 \textcolor{comment}{* -\/-\/-\/ Initialise pointers and counters}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00063}00063       nrecw=0}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00064}00064       nrecwo=0}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00065}00065       nrecs=0}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00066}00066       matho=-\/1}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00067}00067       mfho=-\/1}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00068}00068       mtho=-\/1}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00069}00069       nsec=0}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00070}00070       \textcolor{keyword}{write}(6,10000)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00071}00071 10000 \textcolor{keyword}{format}(\textcolor{stringliteral}{' Please enter the name of the input file'})}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00072}00072       \textcolor{keyword}{read}(5,\textcolor{stringliteral}{'(a)'}) chfili}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00073}00073       \textcolor{keyword}{write}(6,10100)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00074}00074 10100 \textcolor{keyword}{format}(\textcolor{stringliteral}{' Please enter the name of the output file'})}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00075}00075       \textcolor{keyword}{read}(5,\textcolor{stringliteral}{'(a)'}) chfilo}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00076}00076 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00077}00077 \textcolor{comment}{* -\/-\/-\/ Open input database file}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00078}00078       \textcolor{keyword}{open}(itapa,file=chfili,status=\textcolor{stringliteral}{'old'},action=\textcolor{stringliteral}{'read'})}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00079}00079 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00080}00080 \textcolor{comment}{* -\/-\/-\/ Reading loop, to the end of the file}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00081}00081    10 \textcolor{keyword}{read}(itapa,11300,\textcolor{keyword}{end}=30) chtext, math, mfh, mth}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00082}00082 \textcolor{comment}{* -\/-\/-\/ If MEND or FEND record read again}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00083}00083       \textcolor{keywordflow}{if}(math.le.0.or.mfh.le.0) \textcolor{keywordflow}{goto} 10}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00084}00084 \textcolor{comment}{* -\/-\/-\/ If SEND record, cleanup previous section, if any, and read again}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00085}00085       \textcolor{keywordflow}{if}(mth.le.0.and.nsec.gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00086}00086          ipoint(nsec,4) = nrecs}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00087}00087          ipoint(nsec,5) = 0}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00088}00088          \textcolor{keywordflow}{goto} 10}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00089}00089 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00090}00090       \textcolor{keywordflow}{if}(math.ne.matho.or.mfh.ne.mfho.or.mth.ne.mtho) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00091}00091 \textcolor{comment}{* -\/-\/-\/ A new section}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00092}00092          nrecwi=nrecw}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00093}00093          mfho=mfh}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00094}00094          mtho=mth}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00095}00095          mfmt=mfh*1000+mth}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00096}00096          nrecs=0}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00097}00097          \textcolor{keyword}{read}(chtext,10600) za,awr,l99}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00098}00098          \textcolor{keywordflow}{if}(math.ne.matho}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00099}00099      +      .or.(za.gt.99000.and.mfh.eq.1.and.mth.eq.451)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00100}00100 \textcolor{comment}{* -\/-\/-\/ If Z>=99 math numbers are the same for all isomers.}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00101}00101 \textcolor{comment}{* -\/-\/-\/ If new material load isomer information}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00102}00102             \textcolor{keyword}{call }xnwtxt(itapd,chtext,math, mfh, mth, nrecw)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00103}00103             nrecs=nrecs+1}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00104}00104             \textcolor{keyword}{read}(itapa,11300,\textcolor{keyword}{end}=30) chtext, math, mfh, mth}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00105}00105             \textcolor{keyword}{read}(chtext,10300) liso}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00106}00106             izamat=nint(za)*10+liso}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00107}00107             chelna=xnelna(izamat)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00108}00108             \textcolor{keyword}{write}(6,10500) chelna}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00109}00109 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00110}00110          matho=math}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00111}00111          \textcolor{keywordflow}{if}(mfh.eq.3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00112}00112 \textcolor{comment}{* -\/-\/-\/ If section 3, check that it is not repeated}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00113}00113             \textcolor{keywordflow}{do} 20 js=1,nsec}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00114}00114                \textcolor{keywordflow}{if}(ipoint(js,1).eq.izamat.and.ipoint(js,2).eq.mfmt)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00115}00115      +         \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00116}00116                   \textcolor{keyword}{write}(6,10400) chelna, ipoint(js,2)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00117}00117                   stop \textcolor{stringliteral}{'Repeated section'}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00118}00118 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00119}00119    20       \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00120}00120 \textcolor{comment}{* -\/-\/-\/ Real reaction code}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00121}00121             mtendf=mod(mth,300)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00122}00122 \textcolor{comment}{* -\/-\/-\/ LISO of product}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00123}00123             lisos=mth/300}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00124}00124             \textcolor{keywordflow}{if}((l99.eq.99.and.lisos.ne.0).or.}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00125}00125      +         (lisos.ne.l99.and.l99.ne.99)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00126}00126 \textcolor{comment}{* -\/-\/-\/ This should never happen}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00127}00127                \textcolor{keyword}{write}(6,10700) l99,lisos}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00128}00128 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00129}00129             \textcolor{keywordflow}{if}(mtendf.eq.18) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00130}00130 \textcolor{comment}{* -\/-\/-\/ Treat son isomer of fission separately}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00131}00131                \textcolor{keywordflow}{if}(mth.ne.mtendf.or.l99.ne.99) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00132}00132                   \textcolor{keyword}{write}(6,10200) chelna,mth,l99}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00133}00133 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00134}00134                izason=0}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00135}00135                chelns=\textcolor{stringliteral}{'Fiss Fragm'}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00136}00136             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00137}00137 \textcolor{comment}{* -\/-\/-\/ Find son isomer for reaction}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00138}00138                \textcolor{keyword}{call }xngson(izamat,mtendf,izason)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00139}00139                izason=izason+lisos}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00140}00140                chelns=xnelna(izason)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00141}00141                \textcolor{keywordflow}{if}(l99.eq.99) chelns(11:11)=\textcolor{stringliteral}{'*'}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00142}00142 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00143}00143             chrena=xnrena(mth)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00144}00144             \textcolor{keyword}{write}(6,11000) chrena,chelns}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00145}00145             \textcolor{keywordflow}{if}(l99.eq.0.or.lisos.gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00146}00146 \textcolor{comment}{* -\/-\/-\/ If reaction leads to a specific isomer, find it}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00147}00147                mtmp=mth}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00148}00148                mth=mtendf}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00149}00149                \textcolor{keywordflow}{if}(mtendf.ne.18) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00150}00150                   \textcolor{keyword}{call }xnckis(lskips)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00151}00151 \textcolor{comment}{* -\/-\/-\/ If son isomer not there, skip reaction}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00152}00152                   \textcolor{keywordflow}{if}(lskips) \textcolor{keywordflow}{goto} 10}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00153}00153 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00154}00154                mth=mtmp}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00155}00155 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00156}00156 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00157}00157          \textcolor{keywordflow}{if}(nsec.ge.maxsec) stop \textcolor{stringliteral}{'Increase MAXSEC'}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00158}00158 \textcolor{comment}{* -\/-\/-\/ New section can be added}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00159}00159          nsec=nsec+1}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00160}00160          ipoint(nsec,1)=izamat}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00161}00161          ipoint(nsec,2)=mfmt}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00162}00162          ipoint(nsec,3)=nrecwi}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00163}00163 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00164}00164 \textcolor{comment}{* -\/-\/-\/ Add record to temporary file}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00165}00165       \textcolor{keyword}{call }xnwtxt(itapd,chtext,math, mfh, mth, nrecw)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00166}00166       nrecs=nrecs+1}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00167}00167       \textcolor{keywordflow}{goto} 10}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00168}00168 \textcolor{comment}{* -\/-\/-\/ End of file processing}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00169}00169    30 \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00170}00170       \textcolor{keyword}{close}(itapa)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00171}00171 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00172}00172 \textcolor{comment}{* -\/-\/-\/ Add files 3 for as sum of separate isotopes productions}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00173}00173 \textcolor{comment}{* -\/-\/-\/ not ideal, but the best we can do...}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00174}00174       \textcolor{keyword}{call }xnf3ad}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00175}00175 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00176}00176 \textcolor{comment}{* -\/-\/-\/ Now write finally the file}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00177}00177       \textcolor{keyword}{open}(itaps,file=chfilo,status=\textcolor{stringliteral}{'UNKNOWN'})}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00178}00178       \textcolor{keyword}{call }xnwfil}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00179}00179       \textcolor{keyword}{close}(itaps)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00180}00180       \textcolor{keyword}{close}(itapd,status=\textcolor{stringliteral}{'DELETE'})}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00181}00181 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00182}00182 10200 \textcolor{keyword}{format}(1x,a,\textcolor{stringliteral}{' for fission found mth '},i4,\textcolor{stringliteral}{' L99 '},i6)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00183}00183 10300 \textcolor{keyword}{format}(33x,i11)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00184}00184 10400 \textcolor{keyword}{format}(\textcolor{stringliteral}{' Material '},a,\textcolor{stringliteral}{' section '},i4,\textcolor{stringliteral}{' repeated'})}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00185}00185 10500 \textcolor{keyword}{format}(\textcolor{stringliteral}{' Now processing '},a)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00186}00186 10600 \textcolor{keyword}{format}(2e11.4,11x,i11)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00187}00187 10700 \textcolor{keyword}{format}(\textcolor{stringliteral}{' L99 = '},i2,\textcolor{stringliteral}{' and isomeric state = '},i1)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00188}00188 10800 \textcolor{keyword}{format}(2e11.4,4i11,i4,i2,i3)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00189}00189 10900 \textcolor{keyword}{format}(\textcolor{stringliteral}{' Data from '},a)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00190}00190 11000 \textcolor{keyword}{format}(\textcolor{stringliteral}{' Reaction '},a,\textcolor{stringliteral}{' residual '},a)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00191}00191 11100 \textcolor{keyword}{format}(6e11.4,i4,i2,i3,i5)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00192}00192 11200 \textcolor{keyword}{format}(2e11.4,4i11,i4,i2,i3)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00193}00193 11300 \textcolor{keyword}{format}(a66,i4,i2,i3)}
\DoxyCodeLine{\Hypertarget{convac9_2comain_8_f_source_l00194}00194       \textcolor{keyword}{END}}

\end{DoxyCode}
