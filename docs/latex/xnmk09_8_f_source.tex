\hypertarget{xnmk09_8_f_source}{}\doxysection{xnmk09.\+F}
\label{xnmk09_8_f_source}\index{/Users/Transmutex/Simulation/ADS\_SimulationCode/xnsect/convac9/xnmk09.F@{/Users/Transmutex/Simulation/ADS\_SimulationCode/xnsect/convac9/xnmk09.F}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00001}00001 \textcolor{comment}{*CMZ :  2.00/01 12/12/95  12.01.49  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00002}00002 \textcolor{comment}{*-\/-\/ Author :}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00003}00003       \textcolor{keyword}{subroutine }xnmk09}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00004}00004 \textcolor{preprocessor}{\#include "{}xceafi.inc"{}}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00005}00005 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xctb1c.inc"{}}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00006}00006 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xcmk09.inc"{}}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00007}00007 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xcmf01.inc"{}}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00008}00008 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xcmf03.inc"{}}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00009}00009 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xcseet.inc"{}}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00010}00010 \textcolor{preprocessor}{}      \textcolor{keywordtype}{logical} lfixqm}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00011}00011       \textcolor{keywordtype}{character*8}  xnrena,chrena}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00012}00012       \textcolor{keywordtype}{character*11} xnelna}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00013}00013       \textcolor{keywordtype}{character*66} chtext}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00014}00014       \textcolor{keywordtype}{character*11} xnform}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00015}00015       parameter(itapd=98,itaps=99)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00016}00016 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00017}00017 \textcolor{comment}{* -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00018}00018 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00019}00019 \textcolor{comment}{* -\/-\/-\/ Order section 9}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00020}00020       \textcolor{keywordflow}{do} 20 j=1,npo9-\/1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00021}00021          \textcolor{keywordflow}{do} 10 l=j+1,npo9}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00022}00022             \textcolor{keywordflow}{if}(ipoint(ipo9(j),2).gt.ipoint(ipo9(l),2)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00023}00023                itmp=ipo9(j)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00024}00024                ipo9(j)=ipo9(l)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00025}00025                ipo9(l)=itmp}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00026}00026 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00027}00027    10    \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00028}00028    20 \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00029}00029 \textcolor{comment}{* -\/-\/-\/ Read all file 9 candidates}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00030}00030       \textcolor{keywordflow}{do} 50 j=1,npo9}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00031}00031          nrecr=ipoint(ipo9(j),3)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00032}00032          nrecr=nrecr+2}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00033}00033          \textcolor{keyword}{read}(itapd,rec=nrecr,fmt=10100)qm09(j),qi09(j),nr09(j),np09(j)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00034}00034          \textcolor{keywordflow}{if}(np09(j).gt.maxpnt) stop \textcolor{stringliteral}{' *** XNMK03: increase maxpnt'}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00035}00035          \textcolor{keywordflow}{if}(nr09(j).gt.maxran) stop \textcolor{stringliteral}{'Increase MAXRAN'}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00036}00036          nlints=(nr09(j)-\/1)/3+1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00037}00037          \textcolor{keywordflow}{do} 30 jl=1,nlints}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00038}00038             nrecr=nrecr+1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00039}00039             \textcolor{keyword}{read}(itapd,rec=nrecr,fmt=10200) (nbt09(n,j),int09(n,j),n=3*}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00040}00040      +      (jl-\/1)+1,min(nr09(j),3*jl))}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00041}00041    30    \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00042}00042          nlines=(np09(j)-\/1)/3+1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00043}00043          \textcolor{keywordflow}{do} 40 jl=1,nlines}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00044}00044             nrecr=nrecr+1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00045}00045             \textcolor{keyword}{read}(itapd,rec=nrecr,fmt=10300) (tab109(n,j),n=6*}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00046}00046      +      (jl-\/1)+1,min(2*np09(j),6*jl))}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00047}00047    40    \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00048}00048    50 \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00049}00049       chelna=xnelna(izamat)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00050}00050       chrena=xnrena(mth)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00051}00051       \textcolor{keywordflow}{if}(ipo3.le.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00052}00052 \textcolor{comment}{* -\/-\/-\/ see whether we have to build a section 3 or not}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00053}00053          \textcolor{keyword}{write}(6,10500) chelna,chrena}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00054}00054          \textcolor{keyword}{call }xnmk03}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00055}00055       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00056}00056 \textcolor{comment}{* -\/-\/-\/ Read in section 3 which exists}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00057}00057          nrecr=ipoint(ipo3,3)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00058}00058          nrecr=nrecr+2}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00059}00059          \textcolor{keyword}{read}(itapd,rec=nrecr,fmt=10100)qm,qi03,nr03,np03}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00060}00060          \textcolor{keywordflow}{if}(np03.gt.maxpnt) stop \textcolor{stringliteral}{' *** XNMK03: increase maxpnt'}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00061}00061          \textcolor{keywordflow}{if}(nr03.gt.maxran) stop \textcolor{stringliteral}{'Increase MAXRAN'}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00062}00062          nlints=(nr03-\/1)/3+1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00063}00063          \textcolor{keywordflow}{do} 60 jl=1,nlints}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00064}00064             nrecr=nrecr+1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00065}00065             \textcolor{keyword}{read}(itapd,rec=nrecr,fmt=10200) (nbt03(n),int03(n),n=3*}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00066}00066      +      (jl-\/1)+1,min(nr03,3*jl))}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00067}00067    60    \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00068}00068          nlines=(np03-\/1)/3+1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00069}00069          \textcolor{keywordflow}{do} 70 jl=1,nlines}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00070}00070             nrecr=nrecr+1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00071}00071             \textcolor{keyword}{read}(itapd,rec=nrecr,fmt=10300) (tab103(n),n=6*}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00072}00072      +      (jl-\/1)+1,min(2*np03,6*jl))}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00073}00073    70    \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00074}00074 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00075}00075 \textcolor{comment}{* -\/-\/-\/ make the section 9s}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00076}00076       nsec=nsec+1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00077}00077       \textcolor{keywordflow}{if}(nsec.gt.maxsec) stop \textcolor{stringliteral}{'Increase MAXSEC'}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00078}00078       ipoint(nsec,1)=izamat}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00079}00079       ipoint(nsec,2)=ipoint(ipo9(1),2)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00080}00080       ipoint(nsec,3)=nrecw}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00081}00081       ipoint(nsec,4)=1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00082}00082       ipoint(nsec,5)=0}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00083}00083       lis=mod(izamat,10)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00084}00084       liso=lis}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00085}00085       ns=npo9}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00086}00086       \textcolor{keyword}{call }xnwhea(itapd,za,awr,lis,liso,npo9,0,math,9,mth,nrecw)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00087}00087 \textcolor{comment}{*>}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00088}00088       lfixqm=.false.}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00089}00089       emin=1e10}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00090}00090       \textcolor{keywordflow}{do} 90  j=1,npo9}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00091}00091          lisos=mod(ipoint(ipo9(j),2),1000)/300}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00092}00092          difqm=abs((qm09(j)-\/qm)/qm)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00093}00093          \textcolor{keywordflow}{if}(difqm.gt.1e-\/3.and..not.lfixqm) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00094}00094             chelns=xnelna(izaeet(ipos(j)))}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00095}00095             \textcolor{keyword}{write}(6,10000)chelna,chrena,chelns,qm-\/qi09(j),qm09(j)-\/}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00096}00096      +      qi09(j)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00097}00097             lfixqm=.true.}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00098}00098 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00099}00099          \textcolor{keywordflow}{do} 80 jp=1,np09(j)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00100}00100             xe=tab109(2*jp-\/1,j)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00101}00101             \textcolor{keyword}{call }xnterp(nbt03,int03,nr03,tab103,np03,xe,xs)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00102}00102             \textcolor{keyword}{call }xnterp(nbt09(1,j),int09(1,j),nr09(j), tab109(1,j),}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00103}00103      +      np09(j),xe,xs9)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00104}00104             \textcolor{keywordflow}{if}(xs.gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00105}00105                tab109(2*jp  ,j)=xs9/xs}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00106}00106             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00107}00107                tab109(2*jp  ,j)=0}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00108}00108 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00109}00109    80    \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00110}00110 \textcolor{comment}{* -\/-\/-\/ Here thin section 9 should be linear!}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00111}00111          \textcolor{keyword}{call }xnthin(tab109(1,j),np09(j),np09n,perthi)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00112}00112          \textcolor{keywordflow}{if}(nr09(j).ne.1) stop \textcolor{stringliteral}{'XNMK09 more than 1 interp range!'}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00113}00113          np09(j)=np09n}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00114}00114          nbt09(1,j)=np09n}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00115}00115 \textcolor{comment}{* -\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00116}00116          emin=min(emin,tab109(1,j))}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00117}00117    90 \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00118}00118       \textcolor{keywordflow}{do} 110 j=1,npo9}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00119}00119          \textcolor{keywordflow}{if}(lfixqm) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00120}00120             qi09(j)=qm-\/qlveet(ipos(j))*1e6}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00121}00121             qm09(j)=qm}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00122}00122 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00123}00123          \textcolor{keywordflow}{if}(tab109(1,j).gt.emin) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00124}00124             \textcolor{keywordflow}{if}(np09(j).ge.maxpnt) stop \textcolor{stringliteral}{' *** XNMK09: increase maxpnt'}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00125}00125             \textcolor{keywordflow}{do} 100 kp=np09(j),1,-\/1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00126}00126                tab109(2*kp+1,j)=tab109(2*kp-\/1,j)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00127}00127                tab109(2*kp+2,j)=tab109(2*kp  ,j)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00128}00128   100       \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00129}00129             tab109(1,j)=emin}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00130}00130             tab109(2,j)=0.}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00131}00131             np09(j)=np09(j)+1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00132}00132             nbt09(1,j)=np09(j)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00133}00133 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00134}00134   110 \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00135}00135 \textcolor{comment}{*>}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00136}00136       \textcolor{keywordflow}{do} 150 j=1,npo9}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00137}00137          lisos=mod(ipoint(ipo9(j),2),1000)/300}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00138}00138          \textcolor{keyword}{call }xnwhea(itapd,qm09(j),qi09(j),0,lisos,nr09(j),}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00139}00139      +                               np09(j),math,9,mth,nrecw)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00140}00140          nlints=(nr09(j)-\/1)/3+1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00141}00141          \textcolor{keywordflow}{do} 120 jl=1,nlints}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00142}00142             chtext=\textcolor{stringliteral}{' '}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00143}00143             \textcolor{keyword}{write}(chtext,10200) (nbt09(n,j),int09(n,j), n=3*(jl-\/1)+1,}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00144}00144      +      min(nr09(j),3*jl))}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00145}00145             \textcolor{keyword}{call }xnwtxt(itapd,chtext,math,9,mth,nrecw)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00146}00146   120    \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00147}00147          nlines=(np09(j)-\/1)/3+1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00148}00148          \textcolor{keywordflow}{do} 140 jl=1,nlines}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00149}00149             chtext=\textcolor{stringliteral}{' '}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00150}00150             jbase=(jl-\/1)*6}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00151}00151             \textcolor{keywordflow}{do} 130 jn=1,min(2*np09(j)-\/jbase,6)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00152}00152                chtext(11*(jn-\/1)+1:11*jn)=xnform(tab109(jbase+jn,j))}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00153}00153   130       \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00154}00154             \textcolor{keyword}{call }xnwtxt(itapd,chtext,math,9,mth,nrecw)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00155}00155   140    \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00156}00156          ipoint(nsec,4)=ipoint(nsec,4)+nlints+nlines+1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00157}00157   150 \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00158}00158 \textcolor{comment}{* -\/-\/-\/ now can make section 3}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00159}00159       \textcolor{keywordflow}{if}(ipo3.le.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00160}00160          \textcolor{keyword}{call }xnm03v}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00161}00161          ipo3=nsec}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00162}00162 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00163}00163 \textcolor{comment}{*>}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00164}00164       \textcolor{keywordflow}{do} 170 j=1,npo9-\/1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00165}00165          \textcolor{keywordflow}{do} 160 l=j+1,npo9}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00166}00166             \textcolor{keywordflow}{if}(ipo9(j).lt.ipo9(l)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00167}00167                itmp=ipo9(j)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00168}00168                ipo9(j)=ipo9(l)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00169}00169                ipo9(l)=itmp}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00170}00170 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00171}00171   160    \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00172}00172   170 \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00173}00173       \textcolor{keywordflow}{do} 180 js=1,npo9}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00174}00174          \textcolor{keywordflow}{if}(ipo9(js).lt.nsec) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00175}00175             ipoint(ipo9(js),1)=ipoint(nsec,1)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00176}00176             ipoint(ipo9(js),2)=ipoint(nsec,2)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00177}00177             ipoint(ipo9(js),3)=ipoint(nsec,3)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00178}00178             ipoint(ipo9(js),4)=ipoint(nsec,4)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00179}00179             ipoint(ipo9(js),5)=ipoint(nsec,5)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00180}00180 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00181}00181          nsec=nsec-\/1}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00182}00182   180 \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00183}00183 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00184}00184 10000 \textcolor{keyword}{format}(1x,a11,\textcolor{stringliteral}{',('},a,\textcolor{stringliteral}{'),'},a,\textcolor{stringliteral}{' Lev EAF='},g10.3,\textcolor{stringliteral}{', EET='},g10.3)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00185}00185 10100 \textcolor{keyword}{format}(2e11.4,22x,2i11)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00186}00186 10200 \textcolor{keyword}{format}(6i11)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00187}00187 10300 \textcolor{keyword}{format}(6e11.4)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00188}00188 10400 \textcolor{keyword}{format}(\textcolor{stringliteral}{' x-\/sec'}\textcolor{stringliteral}{'s '},6g14.7,3i11)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00189}00189 10500 \textcolor{keyword}{format}(\textcolor{stringliteral}{' *** XNMK03: building section 3 for '},a,\textcolor{stringliteral}{' reac '},a)}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00190}00190 10600 \textcolor{keyword}{format}(\textcolor{stringliteral}{' *** XNMK03: '},i5,\textcolor{stringliteral}{' points added'})}
\DoxyCodeLine{\Hypertarget{xnmk09_8_f_source_l00191}00191       \textcolor{keyword}{end}}

\end{DoxyCode}
