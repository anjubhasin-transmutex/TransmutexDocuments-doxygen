\hypertarget{xnmasf_8_f_source}{}\doxysection{xnmasf.\+F}
\label{xnmasf_8_f_source}\index{/Users/Transmutex/Simulation/ADS\_SimulationCode/xnsect/xnsect/src/xnmasf.F@{/Users/Transmutex/Simulation/ADS\_SimulationCode/xnsect/xnsect/src/xnmasf.F}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00001}00001 \textcolor{comment}{*CMZ :  2.00/02 03/06/96  14.40.52  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00002}00002 \textcolor{comment}{*-\/-\/ Author :    Federico Carminati   21/01/94}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00003}00003       \textcolor{keyword}{SUBROUTINE }xnmasf(Z,AP,BN)}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00004}00004 \textcolor{comment}{************************************************************************}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00005}00005 \textcolor{comment}{*                                                                      *}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00006}00006 \textcolor{comment}{*     Program for mass calculations. J.Duflo and A.P.Zuker. Kindly     *}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00007}00007 \textcolor{comment}{*     provided by H.Nifenecker                                         *}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00008}00008 \textcolor{comment}{*                                                                      *}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00009}00009 \textcolor{comment}{*     Z         (input) Z of the nucleus                               *}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00010}00010 \textcolor{comment}{*     AP        (input) A of the nucleus                               *}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00011}00011 \textcolor{comment}{*     BN        (output) binding energy of one nucleon in eV           *}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00012}00012 \textcolor{comment}{*                                                                      *}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00013}00013 \textcolor{comment}{************************************************************************}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00014}00014       dimension xmag(6), zmag(5), a(21), et(2)}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00015}00015       \textcolor{keyword}{DATA} zmag / 14.,28.,50.,82.,114./}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00016}00016       \textcolor{keyword}{DATA} xmag / 14.,28.,50.,82.,126.,184. /}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00017}00017       \textcolor{keyword}{DATA} a    /16.178,18.422,120.146,202.305,12.454,0.73598,5.204,}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00018}00018      +           1.0645,1.4206,0.0548,0.1786,0.6181,0.998,0.0265,}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00019}00019      +           -\/0.1537,.3113,-\/0.6650,-\/0.0553,-\/0.0401,0.1774,.4523 /}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00020}00020 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00021}00021 \textcolor{comment}{*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00022}00022 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00023}00023       nz=z}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00024}00024       nn=ap-\/z}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00025}00025       iter = 0}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00026}00026    10 iter = iter + 1}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00027}00027       x = ap -\/ z}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00028}00028       t = abs(x -\/ z) * .5}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00029}00029       v = x + z}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00030}00030       s = v ** (2. / 3.)}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00031}00031       u = v ** (1. / 3.)}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00032}00032       a5 = a(5)}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00033}00033       \textcolor{keywordflow}{IF} (z .GT. x) a5 = 0}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00034}00034 \textcolor{comment}{* -\/-\/-\/> Energy of the drop}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00035}00035       e0=a(1)*v-\/a(2)*s-\/a(3)*t*t/v+a(4)*t*t/u/v-\/a5*t/u-\/a(6)*z*z/u}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00036}00036 \textcolor{comment}{* -\/-\/-\/> Energy of the level}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00037}00037       \textcolor{keywordflow}{DO} 30 k = 2, 5}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00038}00038          f1 = zmag(k -\/ 1)}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00039}00039          f2 = zmag(k)}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00040}00040          dfz = (f2 -\/ f1)}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00041}00041          \textcolor{keywordflow}{IF} (z .GT. f1 .AND. z .LE. f2) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00042}00042             roz = (z -\/ f1) / dfz}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00043}00043             pz = roz * (roz -\/ 1) * dfz}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00044}00044             \textcolor{keywordflow}{DO} 20 l=1,6}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00045}00045                f3 = xmag(l -\/ 1)}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00046}00046                f4 = xmag(l)}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00047}00047                dfn = (f4 -\/ f3)}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00048}00048                \textcolor{keywordflow}{IF} (x .GT. f3 .AND. x .LE. f4) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00049}00049                   ron = (x -\/ f3) / dfn}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00050}00050                   pn = ron * (ron -\/ 1) * dfn}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00051}00051                   esh = (pn + pz) * a(8) + a(10) * pn * pz}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00052}00052                   xx = 2 * ron -\/ 1}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00053}00053                   zz = 2 * roz -\/ 1}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00054}00054                   txxx = pn * xx}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00055}00055                   tzzz = pz * zz}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00056}00056                   txxz = pn * zz}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00057}00057                   tzzx = pz * xx}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00058}00058                   kl = l -\/ k}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00059}00059                   \textcolor{keywordflow}{IF}(kl.EQ.0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00060}00060                      esh1=a(k+10)*(txxx+tzzz)+a(k+15)*(txxz+tzzx)}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00061}00061                   \textcolor{keywordflow}{ELSEIF}(kl.EQ.1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00062}00062                      esh1=a(k+11)*txxx-\/a(k+16)*txxz+a(k+10)*tzzz-\/}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00063}00063      +               tzzx*a(k+15)}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00064}00064                   \textcolor{keywordflow}{ELSEIF}(kl.EQ.2) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00065}00065                      esh1=a(k+12)*txxx+a(k+17)*txxz+a(k+10)*tzzz+}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00066}00066      +               tzzx*a(k+15)}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00067}00067 \textcolor{keywordflow}{                  ENDIF}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00068}00068                   edef = a(9) * (pn + pz) + a(11) * pn * pz}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00069}00069                   \textcolor{keywordflow}{IF} (esh .LT. edef) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00070}00070                      esh = edef}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00071}00071 \textcolor{comment}{*                     WRITE(6,'('' Deformed nucleus'')')}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00072}00072 \textcolor{keywordflow}{                  END IF}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00073}00073 \textcolor{keywordflow}{               END IF}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00074}00074    20       \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00075}00075 \textcolor{keywordflow}{         END IF}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00076}00076    30 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00077}00077 \textcolor{comment}{*      WRITE(6,'('' Energy of liquid drop = '',E11.4)') E0}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00078}00078       e = esh + esh1}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00079}00079 \textcolor{comment}{*      WRITE(6,'('' Energy of the surface = '',E11.4)') E}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00080}00080       e = e + e0}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00081}00081 \textcolor{comment}{* -\/-\/-\/> Pairing}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00082}00082       nn2 = int(nn / 2)}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00083}00083       nn2 = 2 * nn2}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00084}00084       nz2 = int(nz / 2)}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00085}00085       nz2 = 2 * nz2}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00086}00086       \textcolor{keywordflow}{IF} (nn2 .GT. nn .OR. nn2 .LT. nn) e = e -\/ a(7) / u}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00087}00087       \textcolor{keywordflow}{IF} (nz2 .GT. nz .OR. nz2 .LT. nn) e = e -\/ a(7) / u}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00088}00088 \textcolor{comment}{*      WRITE(6,'('' Mass energy = '',E11.4)') E}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00089}00089       et(iter) = e}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00090}00090       \textcolor{keywordflow}{IF} (iter .EQ. 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00091}00091          ap = ap -\/ 1}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00092}00092          nn=ap-\/z}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00093}00093          \textcolor{keywordflow}{GOTO} 10}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00094}00094 \textcolor{keywordflow}{      END IF}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00095}00095       bn = 1e6*(et(1) -\/ et(2))}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00096}00096 \textcolor{comment}{*      WRITE(6,'('' BN = '',E11.4)') BN}}
\DoxyCodeLine{\Hypertarget{xnmasf_8_f_source_l00097}00097       \textcolor{keyword}{END}}

\end{DoxyCode}
