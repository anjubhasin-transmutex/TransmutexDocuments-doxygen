\hypertarget{xnprod_8_f_source}{}\doxysection{xnprod.\+F}
\label{xnprod_8_f_source}\index{/Users/Transmutex/Simulation/ADS\_SimulationCode/xnsect/xnsect/src/xnprod.F@{/Users/Transmutex/Simulation/ADS\_SimulationCode/xnsect/xnsect/src/xnprod.F}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00001}00001 \textcolor{comment}{*CMZ :  2.03/07 25/09/96  19.34.38  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00002}00002 \textcolor{comment}{*-\/-\/ Author :    Federico Carminati   19/09/95}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00003}00003       \textcolor{keyword}{SUBROUTINE }xnprod(IZAFAE,JCR,EN,IZASOE,NSON)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00004}00004 \textcolor{comment}{************************************************************************}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00005}00005 \textcolor{comment}{*                                                                      *}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00006}00006 \textcolor{comment}{*     Returns all product from a neutron interaction including         *}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00007}00007 \textcolor{comment}{*     isomeric states                                                  *}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00008}00008 \textcolor{comment}{*                                                                      *}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00009}00009 \textcolor{comment}{*     IZAFAE    (input) isomer code of target                          *}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00010}00010 \textcolor{comment}{*     JCR       (input) reaction code                                  *}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00011}00011 \textcolor{comment}{*     EN        (input) incoming neutron energy in eV                  *}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00012}00012 \textcolor{comment}{*     IZASOE    (output) array of isomer code of the reaction          *}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00013}00013 \textcolor{comment}{*               products                                               *}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00014}00014 \textcolor{comment}{*     NSON      (output) number of products of the reaction            *}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00015}00015 \textcolor{comment}{*                                                                      *}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00016}00016 \textcolor{comment}{************************************************************************}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00017}00017 \textcolor{preprocessor}{\#include "{}xcmxse.inc"{}}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00018}00018 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xcnamf.inc"{}}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00019}00019 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xcacti.inc"{}}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00020}00020 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#include "{}xcroot.inc"{}}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00021}00021 \textcolor{preprocessor}{}      \textcolor{keywordtype}{CHARACTER*11} XNELNA,CHELEM}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00022}00022       \textcolor{keywordtype}{CHARACTER*8}  XNRENA,CHRENA}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00023}00023       \textcolor{keywordtype}{LOGICAL} LDEBUG}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00024}00024       parameter(ninrea=35)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00025}00025       dimension lreac(ninrea),lconv(ninrea),ida(ninrea),idz(ninrea)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00026}00026       dimension kconv(ninrea),izasoe(*),kson(ninrea,2),lson(46)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00027}00027       \textcolor{keywordtype}{LOGICAL} LFIRST}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00028}00028 \textcolor{comment}{* -\/-\/-\/> Conversion internal code to position in CHNAME/NBFMT arrays}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00029}00029       \textcolor{keyword}{DATA} lreac/ 1,  2,  3,  4,  5,  6, 48, 49, 50, 51, 52, 53, 54, 55,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00030}00030      +           56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00031}00031      +           70, 71, 72, 73, 74, 75, 76 /}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00032}00032 \textcolor{comment}{* -\/-\/-\/> Conversion from internal to CR conventions LCONV(Internal) = CR}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00033}00033       \textcolor{keyword}{DATA} lconv/ 6,  3,  5,  4,  2,  1,  7,  8,  9, 10, 11, 12, 13, 14,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00034}00034      +           15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00035}00035      +           29, 30, 31, 32, 33, 34, 35 /}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00036}00036 \textcolor{comment}{* -\/-\/-\/> Conversion from CR to internal conventions LCONV(CR) = Internal}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00037}00037       \textcolor{keyword}{DATA} kconv/ 6,  5,  2,  4,  3,  1,  7,  8,  9, 10, 11, 12, 13, 14,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00038}00038      +           15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00039}00039      +           29, 30, 31, 32, 33, 34, 35 /}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00040}00040 \textcolor{comment}{* -\/-\/-\/> Delta A of residual nucleus after reaction}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00041}00041       \textcolor{keyword}{DATA} ida  / 0,  0,  0, -\/1,  0,  1, -\/2, -\/4,-\/12, -\/5, -\/6, -\/1, -\/8, -\/9,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00042}00042      +           -\/2, -\/3, -\/3,-\/10,-\/11, -\/3, -\/2, -\/3,  0, -\/1, -\/2, -\/2, -\/3, -\/7,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00043}00043      +          -\/11, -\/1, -\/4,-\/10, -\/9, -\/2, -\/3/}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00044}00044 \textcolor{comment}{* -\/-\/-\/> Delta Z of residual nucleus after reaction}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00045}00045       \textcolor{keyword}{DATA} idz /  0,  0,  0,  0,  0,  0,  0, -\/2, -\/6, -\/2, -\/2, -\/1, -\/4, -\/4,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00046}00046      +           -\/1, -\/1, -\/2, -\/5, -\/5,  0, -\/1, -\/1, -\/1, -\/1, -\/1, -\/2, -\/2, -\/4,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00047}00047      +           -\/6, -\/2, -\/3, -\/5, -\/5, -\/2, -\/2/}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00048}00048 \textcolor{comment}{* -\/-\/-\/> KSON(IREAC,1) = number of products of reaction}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00049}00049 \textcolor{comment}{*      KSON(IREAC,2) = pointer to product list in LSON}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00050}00050       \textcolor{keyword}{DATA} kson/  0,  0,  0,  0,  0,  0,  0,  1,  3,  1,  1,  1,  2,  2,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00051}00051      +            1,  1,  1,  3,  3,  0,  1,  1,  1,  1,  1,  1,  1,  2,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00052}00052      +            3,  2,  2,  3,  3,  2,  2, 35*0/}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00053}00053 \textcolor{comment}{* -\/-\/-\/> Product list for reactions}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00054}00054       \textcolor{keyword}{DATA} lson/}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00055}00055      + 20040, 20040, 20040, 20040, 20040, 20040, 10010, 20040, 20040,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00056}00056      + 20040, 20040, 10020, 10030, 20030, 10020, 20040, 20040, 10030,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00057}00057      + 20040, 20040, 10010, 10010, 10010, 10020, 10030, 20030, 20040,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00058}00058      + 20040, 20040, 20040, 20040, 20040, 10010, 10010, 10010, 20040,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00059}00059      + 10030, 20040, 20040, 10020, 20040, 20040, 10010, 10020, 10010,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00060}00060      + 10030 /}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00061}00061       \textcolor{keyword}{DATA} ldebug /.false./}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00062}00062       \textcolor{keyword}{DATA} lfirst /.true./}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00063}00063       \textcolor{keywordtype}{SAVE} lfirst, ldebug}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00064}00064 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00065}00065 \textcolor{comment}{* -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00066}00066 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00067}00067 \textcolor{comment}{* -\/-\/-\/> Make sure we do it only once}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00068}00068       \textcolor{keywordflow}{IF}(lfirst) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00069}00069 \textcolor{comment}{* -\/-\/-\/> Open file with isomer information}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00070}00070          \textcolor{keyword}{OPEN}(20,file=chroot//\textcolor{stringliteral}{'isomers.dat'},status=\textcolor{stringliteral}{'OLD'},action=\textcolor{stringliteral}{'READ'})}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00071}00071 \textcolor{comment}{* -\/-\/-\/> Read index table for targets}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00072}00072          \textcolor{keyword}{READ}(20,10600) nizact,((izacti(i1,i2),i1=1,nizact),i2=1,3)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00073}00073 \textcolor{comment}{* -\/-\/-\/> Read index table for reactions}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00074}00074          \textcolor{keyword}{READ}(20,10600) nmtpoi,((imtpoi(i1,i2),i1=1,nmtpoi),i2=1,4)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00075}00075 \textcolor{comment}{* -\/-\/-\/> Read number of data}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00076}00076          \textcolor{keyword}{READ}(20,10600) noacti}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00077}00077 \textcolor{comment}{* -\/-\/-\/> Read yield tables}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00078}00078          \textcolor{keyword}{READ}(20,10700) (xactiv(l),l=1,noacti)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00079}00079 \textcolor{comment}{* -\/-\/-\/> Close file}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00080}00080          \textcolor{keyword}{CLOSE}(20)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00081}00081 \textcolor{comment}{* -\/-\/-\/> Write summary}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00082}00082          \textcolor{keyword}{WRITE}(6,10100) nizact, nmtpoi, noacti}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00083}00083 \textcolor{comment}{* -\/-\/-\/> Debug print}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00084}00084          \textcolor{keywordflow}{IF}(ldebug) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00085}00085             \textcolor{keyword}{WRITE}(6,10200) (chname(lreac(j)), ida(j), idz(j), j=1,}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00086}00086      +      ninrea)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00087}00087 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00088}00088 \textcolor{comment}{* -\/-\/-\/> Initialise KSON(i,2) pointers}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00089}00089          kson(1,2)=0}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00090}00090          \textcolor{keywordflow}{DO} 10 jr=2,ninrea}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00091}00091             kson(jr,2)=kson(jr-\/1,2)+kson(jr-\/1,1)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00092}00092    10    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00093}00093 \textcolor{comment}{* -\/-\/-\/> Debug print}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00094}00094          \textcolor{keywordflow}{IF}(ldebug) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00095}00095             \textcolor{keywordflow}{DO} 30 jr=1,ninrea}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00096}00096                ns=kson(jr,1)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00097}00097                ip=kson(jr,2)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00098}00098                \textcolor{keyword}{WRITE}(6,10300) chname(lreac(jr)),ns,ip}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00099}00099                \textcolor{keywordflow}{DO} 20 jp=1,ns}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00100}00100                   chelem=xnelna(lson(ip+jp))}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00101}00101                   \textcolor{keyword}{WRITE}(6,10400) chelem}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00102}00102    20          \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00103}00103    30       \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00104}00104 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00105}00105          lfirst=.false.}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00106}00106 \textcolor{comment}{* -\/-\/-\/> End of initialisation}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00107}00107 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00108}00108 \textcolor{comment}{* -\/-\/-\/> Get rid of temperature coefficent}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00109}00109       \textcolor{keyword}{CALL }xngtmp(izafae,izafat,itcod)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00110}00110       \textcolor{keywordflow}{IF}(jcr.EQ.2) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00111}00111 \textcolor{comment}{* -\/-\/-\/> Fission is a special case, treat immediately and leave}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00112}00112          nson=2}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00113}00113          \textcolor{keyword}{CALL }xnnfis(izafat,en,ias1,izs1,iss1,ias2,izs2,iss2)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00114}00114          izasoe(1) = 10000*izs1+10*ias1+iss1}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00115}00115          izasoe(2) = 10000*izs2+10*ias2+iss2}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00116}00116          \textcolor{keywordflow}{IF}(izasoe(1).LE.0.AND.izasoe(2).LE.0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00117}00117 \textcolor{comment}{* -\/-\/-\/> No fission yield for this isomer, print message}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00118}00118 \textcolor{comment}{*            CHELEM=XNELNA(IZAFAT)}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00119}00119 \textcolor{comment}{*            WRITE(6,10000) CHELEM}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00120}00120             nson=0}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00121}00121 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00122}00122          \textcolor{keywordflow}{GOTO} 110}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00123}00123 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00124}00124 \textcolor{comment}{* -\/-\/-\/> Get internal reaction code}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00125}00125       jint=kconv(jcr)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00126}00126 \textcolor{comment}{* -\/-\/-\/> Get pointer in reaction array}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00127}00127       mth=nbmft(lreac(jint))}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00128}00128 \textcolor{comment}{* -\/-\/-\/> See if there is isomer yield information}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00129}00129       klow=1}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00130}00130       khig=nizact}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00131}00131       \textcolor{keywordflow}{IF}(izafat.EQ.izacti(klow,1)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00132}00132          iact=klow}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00133}00133          \textcolor{keywordflow}{GOTO} 50}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00134}00134       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(izafat.EQ.izacti(khig,1)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00135}00135          iact=khig}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00136}00136          \textcolor{keywordflow}{GOTO} 50}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00137}00137 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00138}00138    40 \textcolor{keywordflow}{IF}(khig-\/klow.GT.1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00139}00139          khalf=(khig+klow)/2}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00140}00140          izacom=izacti(khalf,1)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00141}00141          \textcolor{keywordflow}{IF}(izafat.EQ.izacom) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00142}00142             iact=khalf}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00143}00143             \textcolor{keywordflow}{GOTO} 50}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00144}00144          \textcolor{keywordflow}{ELSEIF}(izafat.GT.izacom) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00145}00145             klow=khalf}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00146}00146          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00147}00147             khig=khalf}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00148}00148 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00149}00149          \textcolor{keywordflow}{GOTO} 40}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00150}00150 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00151}00151 \textcolor{comment}{* -\/-\/-\/> No isomer yield information, skip to products list}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00152}00152       \textcolor{keywordflow}{GOTO} 80}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00153}00153 \textcolor{comment}{* -\/-\/-\/> Isomer yield information present for target, see if}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00154}00154 \textcolor{comment}{*      specific reaction is there}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00155}00155    50 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00156}00156 \textcolor{comment}{* -\/-\/-\/> Number of isomer found}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00157}00157       nfound=0}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00158}00158 \textcolor{comment}{* -\/-\/-\/> Running probability sum}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00159}00159       prtot=0}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00160}00160 \textcolor{comment}{* -\/-\/-\/> Prepare rejection random variable}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00161}00161       \textcolor{keyword}{CALL }xnrand(rr,1)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00162}00162 \textcolor{comment}{* -\/-\/-\/> Loop on all reaction for given target}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00163}00163       \textcolor{keywordflow}{DO} 60 jmt=izacti(iact,2),izacti(iact,3)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00164}00164          \textcolor{keywordflow}{IF}(mth.EQ.imtpoi(jmt,1)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00165}00165 \textcolor{comment}{* -\/-\/-\/> Found reaction partial channel, compare with random probability}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00166}00166             nfound=nfound+1}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00167}00167 \textcolor{comment}{* -\/-\/-\/> Number of pairs (E,Branching Ratio) for this channel}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00168}00168             np=imtpoi(jmt,4)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00169}00169 \textcolor{comment}{* -\/-\/-\/> Find branching ratio for this channel}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00170}00170             \textcolor{keyword}{CALL }xnterp(np,2,1,xactiv(imtpoi(jmt,3)+1),np,en,pr)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00171}00171 \textcolor{comment}{* -\/-\/-\/> Update running sum}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00172}00172             prtot=prtot+pr}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00173}00173             \textcolor{keywordflow}{IF}(rr.LE.prtot) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00174}00174 \textcolor{comment}{* -\/-\/-\/> Ok this branch taken}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00175}00175                nson=1}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00176}00176                izasoe(nson)=imtpoi(jmt,2)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00177}00177                \textcolor{keywordflow}{GOTO} 90}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00178}00178 \textcolor{keywordflow}{            ENDIF}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00179}00179          \textcolor{keywordflow}{ELSEIF} (mth.LT.imtpoi(jmt,1)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00180}00180 \textcolor{comment}{* -\/-\/-\/> All branches scanned and no one chosen}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00181}00181             \textcolor{keywordflow}{GOTO} 70}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00182}00182 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00183}00183    60 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00184}00184    70 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00185}00185       \textcolor{keywordflow}{IF}(nfound.EQ.1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00186}00186 \textcolor{comment}{* -\/-\/-\/> This is a strange case... for the moment we go via normal route}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00187}00187 \textcolor{comment}{*      Only one reaction channel seems possible, but it was not chosen!}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00188}00188          \textcolor{keywordflow}{GOTO} 80}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00189}00189       \textcolor{keywordflow}{ELSEIF}(nfound.GT.1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00190}00190 \textcolor{comment}{* -\/-\/-\/> Print a message and return ground state}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00191}00191          chelem=xnelna(izafat)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00192}00192          chrena=xnrena(mth)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00193}00193          \textcolor{keyword}{WRITE}(6,10500) prtot,chelem,chrena,en}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00194}00194 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00195}00195 \textcolor{comment}{* -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00196}00196    80 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00197}00197 \textcolor{comment}{* -\/-\/-\/> Normal channel return ground state!}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00198}00198 \textcolor{comment}{* -\/-\/-\/> Calculate Z, A of residual}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00199}00199       izf=izafat/10000}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00200}00200       iaf=mod(izafat/10,1000)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00201}00201       isf=mod(izafat,10)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00202}00202       izasoe(1)=(izf+idz(jint))*10000+(iaf+ida(jint))*10+0}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00203}00203       nson=1}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00204}00204    90 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00205}00205 \textcolor{comment}{* -\/-\/-\/> Add other products if any}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00206}00206       nason=kson(jint,1)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00207}00207       \textcolor{keywordflow}{IF}(nason.LE.0) \textcolor{keywordflow}{GOTO} 110}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00208}00208 \textcolor{comment}{* -\/-\/-\/> Other products have to be added}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00209}00209       ipson=kson(jint,2)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00210}00210       \textcolor{keywordflow}{DO} 100 json=1,nason}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00211}00211          izasoe(json+1)=lson(ipson+1)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00212}00212   100 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00213}00213       nson=nson+nason}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00214}00214 \textcolor{comment}{* -\/-\/-\/> Put back temperature code}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00215}00215   110 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00216}00216       itadd=itcod*10000000}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00217}00217       \textcolor{keywordflow}{DO} 120 json=1,nson}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00218}00218          izasoe(json)=izasoe(json)+itadd}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00219}00219   120 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00220}00220 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00221}00221 10000 \textcolor{keyword}{FORMAT}(\textcolor{stringliteral}{' *** XNPROD: No fission product yield information for'},a)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00222}00222 10100 \textcolor{keyword}{FORMAT}(\textcolor{stringliteral}{' *** XNPROD: Loaded data for '},i5,\textcolor{stringliteral}{' targets, '},}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00223}00223      +i5,\textcolor{stringliteral}{' reactions, '},i8,\textcolor{stringliteral}{' points'})}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00224}00224 10200 \textcolor{keyword}{FORMAT}(a,1x,i3,1x,i3)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00225}00225 10300 \textcolor{keyword}{FORMAT}(\textcolor{stringliteral}{' Reaction '},a,\textcolor{stringliteral}{' Products '},i2,\textcolor{stringliteral}{' starting at '},i3)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00226}00226 10400 \textcolor{keyword}{FORMAT}(a)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00227}00227 10500 \textcolor{keyword}{FORMAT}(\textcolor{stringliteral}{' *** XNPROD: Tot pb<1 '},g9.2,\textcolor{stringliteral}{' for '},a,1x,a,\textcolor{stringliteral}{' E '},e10.3)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00228}00228 10600 \textcolor{keyword}{FORMAT}(9i8)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00229}00229 10700 \textcolor{keyword}{FORMAT}(6e11.4)}
\DoxyCodeLine{\Hypertarget{xnprod_8_f_source_l00230}00230   999 \textcolor{keyword}{END}}

\end{DoxyCode}
