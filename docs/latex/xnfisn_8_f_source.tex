\hypertarget{xnfisn_8_f_source}{}\doxysection{xnfisn.\+F}
\label{xnfisn_8_f_source}\index{/Users/Transmutex/Simulation/ADS\_SimulationCode/xnsect/xnsect/src/xnfisn.F@{/Users/Transmutex/Simulation/ADS\_SimulationCode/xnsect/xnsect/src/xnfisn.F}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00001}00001 \textcolor{comment}{*CMZ :          15/04/97  09.22.53  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00002}00002 \textcolor{comment}{*-\/-\/ Author :}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00003}00003       \textcolor{keyword}{SUBROUTINE }xnfisn(IZAMAT,E0,IZAFF1,IZAFF2,IZAFF3,NUF)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00004}00004 \textcolor{comment}{************************************************************************}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00005}00005 \textcolor{comment}{*                                                                      *}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00006}00006 \textcolor{comment}{*     Samples two or three fission fragments from the Independent      *}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00007}00007 \textcolor{comment}{*     Yield distribution. Distributions are taken from the European,   *}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00008}00008 \textcolor{comment}{*     American and Japanese databases in the order.                    *}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00009}00009 \textcolor{comment}{*     Also samples number of fission neutrons according to Poisson's   *}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00010}00010 \textcolor{comment}{*     distribution                                                     *}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00011}00011 \textcolor{comment}{*                                                                      *}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00012}00012 \textcolor{comment}{*     IZAMAT    (input) code of the fissile nuclide                    *}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00013}00013 \textcolor{comment}{*     E0        (input) energy of the incoming neutron in eV           *}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00014}00014 \textcolor{comment}{*     IZAFF1    (output) isomer code of the first fission fragment     *}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00015}00015 \textcolor{comment}{*     IZAFF2    (output) isomer code of the second fission fragment    *}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00016}00016 \textcolor{comment}{*     IZAFF3    (output) isomer code of the third fission fragment     *}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00017}00017 \textcolor{comment}{*               if different from 0, otherwise is a binary fission     *}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00018}00018 \textcolor{comment}{*     NUF       (output) number of fission neutrons sampled            *}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00019}00019 \textcolor{comment}{*                                                                      *}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00020}00020 \textcolor{comment}{************************************************************************}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00021}00021 \textcolor{preprocessor}{\#include "{}xcfisb.inc"{}}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00022}00022 \textcolor{preprocessor}{}      parameter(npsrep=20)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00023}00023       dimension xt(3),rs(npsrep)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00024}00024       \textcolor{keywordtype}{LOGICAL} LFIRST}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00025}00025       \textcolor{keywordtype}{SAVE} lfirst}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00026}00026       \textcolor{keyword}{DATA} lfirst / .true. /}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00027}00027 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00028}00028 \textcolor{comment}{*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00029}00029 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00030}00030       \textcolor{keywordflow}{IF}(lfirst) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00031}00031          \textcolor{keyword}{CALL }xnloan}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00032}00032          lfirst = .false.}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00033}00033 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00034}00034 \textcolor{comment}{* -\/-\/-\/ Convert from external to internal material code,}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00035}00035 \textcolor{comment}{*     stripping temperature code}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00036}00036 \textcolor{comment}{*     CALL XNGTMP(IZAMAT,IZAP,ITPOS)}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00037}00037       izap=mod(izamat,10000000)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00038}00038 \textcolor{comment}{* -\/-\/-\/ Suppose we fail, set everything to 0}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00039}00039       izaff1=0}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00040}00040       izaff2=0}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00041}00041       izaff3=0}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00042}00042 \textcolor{comment}{* -\/-\/-\/ Find reduced IZZ and IAP for IZAPNT array}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00043}00043       izz = izap/10000}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00044}00044       izp = izz-\/85}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00045}00045       iap = mod(izap/10,1000)-\/2*izz}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00046}00046       \textcolor{keywordflow}{IF}((izp.LT.1.OR.izp.GT.maxizp).OR. (iap.LT.1.OR.iap.GT.maxiap))}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00047}00047      +\textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00048}00048 \textcolor{comment}{* -\/-\/-\/ Check that nuclide is a fissionable one}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00049}00049          \textcolor{keyword}{WRITE}(6,10000) izap/10000,mod(izap/10,1000),izp,iap}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00050}00050          \textcolor{keywordflow}{GOTO} 999}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00051}00051 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00052}00052 \textcolor{comment}{* -\/-\/-\/ Load pointers}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00053}00053       ip = izapnt(izp,iap,1)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00054}00054       ne = izapnt(izp,iap,2)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00055}00055       nd = izapnt(izp,iap,3)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00056}00056 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00057}00057       \textcolor{keywordflow}{IF}(nd.EQ.0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00058}00058 \textcolor{comment}{* -\/-\/-\/ No data present, exit}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00059}00059          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' No fission information on '}\textcolor{stringliteral}{',I6)'}) izap}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00060}00060          \textcolor{keywordflow}{GOTO} 40}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00061}00061 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00062}00062 \textcolor{comment}{* -\/-\/-\/ Find energy for linear interpolation of yields}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00063}00063       \textcolor{keywordflow}{IF}(e0.LE.xfisb(ip+1)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00064}00064 \textcolor{comment}{* -\/-\/-\/ Underflow}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00065}00065          indi=1}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00066}00066          inde=1}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00067}00067          xrai=1}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00068}00068          xrae=0}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00069}00069       \textcolor{keywordflow}{ELSEIF}(e0.GE.xfisb(ip+ne)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00070}00070 \textcolor{comment}{* -\/-\/-\/ Overflow}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00071}00071          indi=ne}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00072}00072          inde=ne}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00073}00073          xrai=0}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00074}00074          xrae=1}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00075}00075       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00076}00076 \textcolor{comment}{* -\/-\/-\/ Case of several energies (can only be 3)}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00077}00077          \textcolor{keywordflow}{IF}(e0.LT.xfisb(ip+2)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00078}00078 \textcolor{comment}{* -\/-\/-\/ In the first (and may be only) energy interval}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00079}00079             indi=1}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00080}00080             inde=2}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00081}00081             xrai=(xfisb(ip+2)-\/e0)*xfisb(ip+ne+1)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00082}00082          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00083}00083 \textcolor{comment}{* -\/-\/-\/ In the second energy interval}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00084}00084             indi=2}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00085}00085             inde=3}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00086}00086             xrai=(xfisb(ip+3)-\/e0)*xfisb(ip+ne+2)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00087}00087 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00088}00088          xrae = 1-\/xrai}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00089}00089 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00090}00090 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00091}00091       \textcolor{keyword}{CALL }xnrand(xt,3)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00092}00092 \textcolor{comment}{* -\/-\/-\/ IP is before start of information}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00093}00093 \textcolor{comment}{*     plus NE energies and NE-\/1 intervals + 1}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00094}00094 \textcolor{comment}{*     is the IZAMAT information to which follow}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00095}00095 \textcolor{comment}{*     the NE values of yield, one per energy}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00096}00096       ibas = ip+2*ne-\/1+1}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00097}00097       indi = indi+ibas}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00098}00098       inde = inde+ibas}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00099}00099       nw = ne+1}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00100}00100       xxt=xt(1)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00101}00101 \textcolor{comment}{* -\/-\/-\/ Sample low mass fission fragment}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00102}00102       k1=0}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00103}00103       k2=nd-\/1}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00104}00104    10 \textcolor{keywordflow}{IF}(k2-\/k1.GT.1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00105}00105          khalf=(k2+k1)/2}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00106}00106          indha=nw*khalf}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00107}00107          phalf=xfisb(indha+indi)*xrai+xfisb(indha+inde)*xrae}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00108}00108          \textcolor{keywordflow}{IF}(xxt.GT.phalf) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00109}00109             k1=khalf}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00110}00110          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00111}00111             k2=khalf}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00112}00112 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00113}00113          \textcolor{keywordflow}{GOTO} 10}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00114}00114 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00115}00115       i2=ibas+nw*k2}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00116}00116       izaff1=mfisb(i2)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00117}00117 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00118}00118       xxt=xt(2)+1}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00119}00119 \textcolor{comment}{* -\/-\/-\/ Sample high mass fission fragment}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00120}00120       k1=k2}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00121}00121       k2=nd-\/1}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00122}00122    20 \textcolor{keywordflow}{IF}(k2-\/k1.GT.1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00123}00123          khalf=(k2+k1)/2}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00124}00124          indha=nw*khalf}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00125}00125          phalf=xfisb(indha+indi)*xrai+xfisb(indha+inde)*xrae}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00126}00126          \textcolor{keywordflow}{IF}(xxt.GT.phalf) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00127}00127             k1=khalf}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00128}00128          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00129}00129             k2=khalf}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00130}00130 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00131}00131          \textcolor{keywordflow}{GOTO} 20}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00132}00132 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00133}00133       i2=ibas+nw*k2}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00134}00134       izaff2=mfisb(i2)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00135}00135 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00136}00136       xxt=xt(3)+2}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00137}00137 \textcolor{comment}{* -\/-\/-\/ Sample ternary fission fragment -\/ if any}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00138}00138       indnd=nw*(nd-\/1)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00139}00139       \textcolor{keywordflow}{IF}(xxt.LE.xfisb(indnd+indi)*xrai+xfisb(indnd+inde)*xrae) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00140}00140          k1=k2}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00141}00141          k2=nd-\/1}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00142}00142    30    \textcolor{keywordflow}{IF}(k2-\/k1.GT.1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00143}00143             khalf=(k2+k1)/2}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00144}00144             indha=nw*khalf}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00145}00145             phalf=xfisb(indha+indi)*xrai+xfisb(indha+inde)*xrae}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00146}00146             \textcolor{keywordflow}{IF}(xxt.GT.phalf) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00147}00147                k1=khalf}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00148}00148             \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00149}00149                k2=khalf}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00150}00150 \textcolor{keywordflow}{            ENDIF}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00151}00151             \textcolor{keywordflow}{GOTO} 30}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00152}00152 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00153}00153          i2=ibas+nw*k2}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00154}00154          izaff3=mfisb(i2)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00155}00155 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00156}00156 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00157}00157    40 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00158}00158       xnuf=0}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00159}00159 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00160}00160       ip = izapnt(izp,iap,4)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00161}00161       ln = izapnt(izp,iap,5)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00162}00162       nd = izapnt(izp,iap,6)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00163}00163 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00164}00164       \textcolor{keywordflow}{IF}(ln.EQ.1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00165}00165          \textcolor{keywordflow}{DO} 50 jnuf=ip+nd,ip+1,-\/1}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00166}00166             xnuf=e0*xnuf+xfisb(jnuf)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00167}00167    50    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00168}00168       \textcolor{keywordflow}{ELSEIF}(ln.EQ.2) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00169}00169          np = nd/2}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00170}00170          \textcolor{keywordflow}{IF}(e0.LE.xfisb(ip+1)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00171}00171             xnuf=xfisb(ip+2)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00172}00172          \textcolor{keywordflow}{ELSEIF}(e0.GE.xfisb(ip+2*np-\/1)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00173}00173             xnuf=xfisb(ip+2*np)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00174}00174          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00175}00175             k1=1}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00176}00176             k2=np}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00177}00177    60       \textcolor{keywordflow}{IF}(k2-\/k1.GT.1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00178}00178                khalf=(k1+k2)/2}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00179}00179                vhalf=xfisb(ip+2*khalf-\/1)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00180}00180                \textcolor{keywordflow}{IF}(e0.LT.vhalf) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00181}00181                   k2=khalf}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00182}00182                \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00183}00183                   k1=khalf}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00184}00184 \textcolor{keywordflow}{               ENDIF}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00185}00185                \textcolor{keywordflow}{GOTO} 60}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00186}00186 \textcolor{keywordflow}{            ENDIF}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00187}00187             xrat=(xfisb(ip+2*k1+1)-\/e0)/ (xfisb(ip+2*k1+1)-\/}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00188}00188      +      xfisb(ip+2*k1-\/1))}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00189}00189             xnuf=xfisb(ip+2*k1)*xrat+xfisb(ip+2*k1+2)*(1-\/xrat)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00190}00190 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00191}00191 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00192}00192 \textcolor{comment}{* -\/-\/-\/ Sample number of neutrons, Poisson's distribution}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00193}00193       p0=exp(-\/xnuf)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00194}00194       nuf=-\/1}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00195}00195       rp=1}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00196}00196       nr=min(2*xnuf,real(npsrep))}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00197}00197    70 \textcolor{keyword}{CALL }xnrand(rs,nr)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00198}00198       \textcolor{keywordflow}{DO} 80 jj=1,nr}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00199}00199          nuf=nuf+1}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00200}00200          rp=rs(jj)*rp}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00201}00201          \textcolor{keywordflow}{IF}(rp.LE.p0) \textcolor{keywordflow}{GOTO} 90}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00202}00202    80 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00203}00203       \textcolor{keywordflow}{GOTO} 70}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00204}00204    90 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00205}00205 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00206}00206 10000 \textcolor{keyword}{FORMAT}(\textcolor{stringliteral}{' Out-\/of-\/bound fission yield! Z/A '},i2.2,\textcolor{stringliteral}{'/'},i3.3,}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00207}00207      +\textcolor{stringliteral}{' IZP/IAP '},i4,\textcolor{stringliteral}{'/'},i4)}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00208}00208   999 \textcolor{keyword}{END}}
\DoxyCodeLine{\Hypertarget{xnfisn_8_f_source_l00209}00209 }

\end{DoxyCode}
