\hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source}{}\doxysection{Stepping\+Action.\+cc}
\label{_g4-_neutron_transport_2src_2_stepping_action_8cc_source}\index{/Users/Transmutex/Simulation/ADS\_SimulationCode/G4-\/NeutronTransport/src/SteppingAction.cc@{/Users/Transmutex/Simulation/ADS\_SimulationCode/G4-\/NeutronTransport/src/SteppingAction.cc}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00001}00001 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00002}00002 \textcolor{comment}{// ********************************************************************}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00003}00003 \textcolor{comment}{// * License and Disclaimer                                           *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00004}00004 \textcolor{comment}{// *                                                                  *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00005}00005 \textcolor{comment}{// * The  Geant4 software  is  copyright of the Copyright Holders  of *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00006}00006 \textcolor{comment}{// * the Geant4 Collaboration.  It is provided  under  the terms  and *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00007}00007 \textcolor{comment}{// * conditions of the Geant4 Software License,  included in the file *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00008}00008 \textcolor{comment}{// * LICENSE and available at  http://cern.ch/geant4/license .  These *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00009}00009 \textcolor{comment}{// * include a list of copyright holders.                             *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00010}00010 \textcolor{comment}{// *                                                                  *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00011}00011 \textcolor{comment}{// * Neither the authors of this software system, nor their employing *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00012}00012 \textcolor{comment}{// * institutes,nor the agencies providing financial support for this *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00013}00013 \textcolor{comment}{// * work  make  any representation or  warranty, express or implied, *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00014}00014 \textcolor{comment}{// * regarding  this  software system or assume any liability for its *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00015}00015 \textcolor{comment}{// * use.  Please see the license in the file  LICENSE  and URL above *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00016}00016 \textcolor{comment}{// * for the full disclaimer and the limitation of liability.         *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00017}00017 \textcolor{comment}{// *                                                                  *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00018}00018 \textcolor{comment}{// * This  code  implementation is the result of  the  scientific and *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00019}00019 \textcolor{comment}{// * technical work of the GEANT4 collaboration.                      *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00020}00020 \textcolor{comment}{// * By using,  copying,  modifying or  distributing the software (or *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00021}00021 \textcolor{comment}{// * any work based  on the software)  you  agree  to acknowledge its *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00022}00022 \textcolor{comment}{// * use  in  resulting  scientific  publications,  and indicate your *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00023}00023 \textcolor{comment}{// * acceptance of all terms of the Geant4 Software license.          *}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00024}00024 \textcolor{comment}{// ********************************************************************}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00025}00025 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00027}00027 \textcolor{comment}{}\textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00028}00028 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00030}00030 \textcolor{comment}{}\textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00031}00031 \textcolor{comment}{// SteppingAction}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00032}00032 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00033}00033 \textcolor{comment}{// Donovan Maire, Transmutex, 18/10/2019}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00034}00034 \textcolor{comment}{// Copyright 2020 Transmutex SA -\/-\/ all rights reserved}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00036}00036 \textcolor{comment}{}\textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00037}00037 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00038}00038 \textcolor{comment}{// TMX Class}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00039}00039 \textcolor{preprocessor}{\#include "{}SteppingAction.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00040}00040 \textcolor{preprocessor}{\#include "{}DetectorConstruction.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00041}00041 \textcolor{preprocessor}{\#include "{}PrimaryGeneratorAction.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00042}00042 \textcolor{preprocessor}{\#include "{}TMXBatemanDecay.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00043}00043 \textcolor{preprocessor}{\#include "{}TMXOption.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00044}00044 \textcolor{preprocessor}{\#include "{}TMXAbstractTargetAssembly.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00045}00045 \textcolor{preprocessor}{\#include "{}TMXAbstractBeamPipe.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00046}00046 \textcolor{comment}{// \#include "{}TMXBurnup.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00047}00047 \textcolor{preprocessor}{\#include "{}GeomEAP80.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00048}00048 \textcolor{preprocessor}{\#include "{}GeomSVBR\_AKME.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00049}00049 \textcolor{preprocessor}{\#include "{}Run.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00050}00050 \textcolor{preprocessor}{\#include "{}TMXkeff.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00051}00051 \textcolor{preprocessor}{\#include "{}TMXStopTheRun.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00052}00052 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00053}00053 \textcolor{comment}{// GEANT4 libraries}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00054}00054 \textcolor{preprocessor}{\#include "{}G4SteppingManager.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00055}00055 \textcolor{preprocessor}{\#include "{}G4Step.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00056}00056 \textcolor{preprocessor}{\#include "{}G4StepPoint.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00057}00057 \textcolor{preprocessor}{\#include "{}G4TrackStatus.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00058}00058 \textcolor{preprocessor}{\#include "{}G4VPhysicalVolume.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00059}00059 \textcolor{preprocessor}{\#include "{}G4ParticleDefinition.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00060}00060 \textcolor{preprocessor}{\#include "{}G4ParticleTypes.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00061}00061 \textcolor{preprocessor}{\#ifdef G4MULTITHREADED}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00062}00062 \textcolor{preprocessor}{    \#include "{}G4MTRunManager.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00063}00063 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00064}00064 \textcolor{preprocessor}{    \#include "{}G4RunManager.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00065}00065 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00066}00066 \textcolor{preprocessor}{\#include "{}G4SystemOfUnits.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00067}00067 \textcolor{preprocessor}{\#include "{}G4HadronicProcessType.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00068}00068 \textcolor{preprocessor}{\#include "{}G4HadronicProcess.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00069}00069 \textcolor{preprocessor}{\#include "{}G4VProcess.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00070}00070 \textcolor{preprocessor}{\#include "{}G4PhysicalConstants.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00071}00071 \textcolor{preprocessor}{\#include "{}G4ProcessVector.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00072}00072 \textcolor{preprocessor}{\#include "{}G4PhysicalVolumeStore.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00073}00073 \textcolor{preprocessor}{\#include "{}G4SolidStore.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00074}00074 \textcolor{preprocessor}{\#include "{}G4LogicalVolumeStore.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00075}00075 \textcolor{preprocessor}{\#include "{}G4Ions.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00076}00076 \textcolor{comment}{// \#include "{}G4NeutronInelasticProcess.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00077}00077 \textcolor{preprocessor}{\#include "{}G4ParticleHPInelastic.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00078}00078 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00079}00079 \textcolor{comment}{// C++ librairies}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00080}00080 \textcolor{keyword}{using} std::log10;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00081}00081 \textcolor{keyword}{using} std::sqrt;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00082}00082 \textcolor{keyword}{using} std::floor;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00083}00083 \textcolor{preprocessor}{\#include <map>}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00084}00084 \textcolor{preprocessor}{\#include <unordered\_map>}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00085}00085 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00086}00086 \textcolor{keyword}{using namespace }std;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00087}00087 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00088}00088 \textcolor{preprocessor}{\#include "{}G4AutoLock.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00089}00089  \textcolor{keyword}{namespace }\{ G4Mutex myHEPPrimGenMutex = G4MUTEX\_INITIALIZER; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00090}00090 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00091}00091 SteppingAction::SteppingAction(\mbox{\hyperlink{class_event_action}{EventAction}}* eventAction, \mbox{\hyperlink{class_run_action}{RunAction}}* runAction, \mbox{\hyperlink{class_t_m_x_input_parameters}{TMXInputParameters}}\& parameter)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00092}00092 : G4UserSteppingAction()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00093}00093 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00094}00094     Initialize(eventAction, runAction, parameter); \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00095}00095 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00096}00096 SteppingAction::\string~SteppingAction()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00097}00097 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00098}00098     \textcolor{keyword}{delete} fGenerationCounter;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00099}00099     fEventAction = \textcolor{keyword}{nullptr}; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00100}00100 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00101}00101 \textcolor{keywordtype}{void} SteppingAction::UserSteppingAction(\textcolor{keyword}{const} G4Step * theStep)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00102}00102 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00103}00103     \textcolor{comment}{// Added on 14/04/2021:}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00104}00104     \textcolor{comment}{// 3rd modif: no effect on keff -\/> checked}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00105}00105 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00106}00106     \textcolor{keywordflow}{if}(theStep-\/>GetTrack()-\/>GetParticleDefinition() == G4Neutron::NeutronDefinition()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00107}00107     \&\& theStep-\/>GetTrack()-\/>GetCurrentStepNumber() == 1}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00108}00108     \&\& theStep-\/>GetTrack()-\/>GetCreatorProcess()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00109}00109     \&\& theStep-\/>GetTrack()-\/>GetCreatorProcess()-\/>GetProcessName() == \textcolor{stringliteral}{"{}nFission"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00110}00110     \&\& p-\/>int\_Option == 20)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00111}00111     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00112}00112         theStep-\/>GetTrack()-\/>SetTrackStatus(fKillTrackAndSecondaries); \textcolor{comment}{// secondary neutron from fission are killed at their first step}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00113}00113         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00114}00114     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00115}00115   \textcolor{comment}{// std::cout << "{}Begin of step"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00116}00116   TMXStopTheRun::getInstance()-\/>UserSteppingAction();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00117}00117 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00118}00118   \textcolor{comment}{/*if (theStep-\/>GetTrack()-\/>GetParticleDefinition()-\/>GetParticleName() != "{}proton"{}) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00119}00119 \textcolor{comment}{      // theStep-\/>GetTrack()-\/>SetTrackStatus(fStopAndKill);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00120}00120 \textcolor{comment}{      return;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00121}00121 \textcolor{comment}{  \}*/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00122}00122 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00123}00123   \textcolor{comment}{// If new run -\/> Initialization of stepping action}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00124}00124   \textcolor{keywordflow}{if}(fRunNumber != fEventAction-\/>GetRunNumber()) \{ Initialize(fEventAction, fRunAction, *p); \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00125}00125 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00126}00126   \textcolor{comment}{// theStep-\/>GetTrack()-\/>SetTrackStatus(fKillTrackAndSecondaries);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00127}00127 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00128}00128   \textcolor{comment}{// If the hadron processes are not defined, then we search for them}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00129}00129   \textcolor{comment}{// std::cout << "{}Begin GetNeutronHadronicProcesses"{} <<std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00130}00130   \textcolor{keywordflow}{if}(!fProcessElas)  \{GetNeutronHadronicProcesses();\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00131}00131 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00132}00132   G4int nNeutrons = 0; \textcolor{comment}{// Number of secondary neutrons from inelastic reaction}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00133}00133   \textcolor{comment}{// std::cout << "{}Begin GetPhysicalVolumeNumber"{} <<std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00134}00134   GetPhysicalVolumeNumber(theStep); \textcolor{comment}{// Get the physical volume ID of preStep, postStep and the one to be used}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00135}00135 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00136}00136   \textcolor{comment}{// Find a better solution}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00137}00137   \textcolor{comment}{// FillNtupleDepositedPower(theStep);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00138}00138 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00139}00139   \textcolor{comment}{// General Scoring of Flux Spectrum for any particle define by the user}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00140}00140   fRunAction-\/>ScoreDPA(theStep);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00141}00141   fRunAction-\/>ScoreEnergyDeposited(theStep);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00142}00142   fRunAction-\/>ScoreDetectionChamber(theStep);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00143}00143   \textcolor{comment}{// fRunAction-\/>GetRun()-\/>ScoreEnergyDeposited(theStep);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00144}00144   fRunAction-\/>GetRun()-\/>ScoreSurfaceCurrentSpectrum(theStep);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00145}00145   fRunAction-\/>GetRun()-\/>ScoreSurfaceFluenceSpectrum(theStep);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00146}00146   fRunAction-\/>GetRun()-\/>ScoreVolumeFluenceSpectrum(theStep);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00147}00147   fRunAction-\/>GetRun()-\/>ScoreFluenceMap(theStep);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00148}00148   fRunAction-\/>GetRun()-\/>ScorePowerDensityMap(theStep);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00149}00149 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00150}00150 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00151}00151   \textcolor{comment}{// std::cout<<theStep-\/>GetPreStepPoint()-\/>GetPhysicalVolume()-\/>GetName()<<"{} "{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00152}00152   \textcolor{comment}{// <<theStep-\/>GetTrack()-\/>GetParticleDefinition()-\/>GetParticleName()<<std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00153}00153   \textcolor{comment}{//TFTEST}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00154}00154 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00155}00155 \textcolor{comment}{//   if(theStep-\/>GetPostStepPoint()-\/>GetPhysicalVolume()) \{ // Not necessary anymore ?? GetProcessName has been protected.}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00156}00156 \textcolor{comment}{//     if( theStep-\/>GetTrack()-\/>GetDynamicParticle()-\/>GetDefinition()-\/>GetParticleName() !=  "{}neutron"{} \&\& p-\/>int\_Option == 4) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00157}00157 \textcolor{comment}{//         theStep-\/>GetTrack()-\/>SetTrackStatus(fKillTrackAndSecondaries);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00158}00158 \textcolor{comment}{//         return;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00159}00159 \textcolor{comment}{//     \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00160}00160 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00161}00161 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00162}00162 \textcolor{comment}{/*  if(theStep-\/>GetPostStepPoint()-\/>GetPhysicalVolume()) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00163}00163 \textcolor{comment}{  if(theStep-\/>GetPreStepPoint()-\/>GetPhysicalVolume()-\/>GetName() == "{}pTarget"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00164}00164 \textcolor{comment}{          \&\& theStep-\/>GetPostStepPoint()-\/>GetPhysicalVolume()-\/>GetName() == "{}pCore"{} )}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00165}00165 \textcolor{comment}{  \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00166}00166 \textcolor{comment}{      if(theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() == "{}e-\/"{} || theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() == "{}gamma"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00167}00167 \textcolor{comment}{      \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00168}00168 \textcolor{comment}{//          std::cout<<theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() << "{} "{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00169}00169 \textcolor{comment}{//                   <<theStep-\/>GetPreStepPoint()-\/>GetPhysicalVolume()-\/>GetName() << "{} "{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00170}00170 \textcolor{comment}{//                   <<theStep-\/>GetPostStepPoint()-\/>GetPhysicalVolume()-\/>GetName()<<std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00171}00171 \textcolor{comment}{        theStep-\/>GetTrack()-\/>SetTrackStatus(fKillTrackAndSecondaries);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00172}00172 \textcolor{comment}{      \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00173}00173 \textcolor{comment}{  \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00174}00174 \textcolor{comment}{\}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00175}00175 \textcolor{comment}{  if(fEventAction-\/>GetNevt() < 131500)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00176}00176 \textcolor{comment}{      theStep-\/>GetTrack()-\/>SetTrackStatus(fKillTrackAndSecondaries);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00177}00177 \textcolor{comment}{*/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00178}00178 \textcolor{comment}{/*   if(theStep-\/>GetPreStepPoint ()-\/>GetPhysicalVolume()-\/>GetName() == "{}Target"{} )}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00179}00179 \textcolor{comment}{   \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00180}00180 \textcolor{comment}{        if(theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() == "{}neutron"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00181}00181 \textcolor{comment}{        \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00182}00182 \textcolor{comment}{            std::cout<< "{}nFlu "{} << theStep-\/>GetPreStepPoint ()-\/>GetKineticEnergy()/ MeV << "{} "{} <<  (theStep-\/>GetStepLength()/cm) / (theStep-\/>GetPreStepPoint ()-\/>GetPhysicalVolume()-\/>GetLogicalVolume()-\/>GetSolid()-\/>GetCubicVolume()/cm3)<<std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00183}00183 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00184}00184 \textcolor{comment}{        if(theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() == "{}gamma"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00185}00185 \textcolor{comment}{        \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00186}00186 \textcolor{comment}{//            std::cout<< "{}pFlu "{} << theStep-\/>GetPreStepPoint ()-\/>GetKineticEnergy()/ MeV << "{} "{}<<   theStep-\/>GetStepLength()/PostCubicVolume<<std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00187}00187 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00188}00188 \textcolor{comment}{    \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00189}00189 \textcolor{comment}{    if(theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() == "{}neutron"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00190}00190 \textcolor{comment}{            \&\& theStep-\/>GetPostStepPoint()-\/>GetPhysicalVolume()-\/>GetName() != "{}Target"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00191}00191 \textcolor{comment}{            \&\& theStep-\/>GetPreStepPoint()-\/>GetStepStatus() == fGeomBoundary)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00192}00192 \textcolor{comment}{    \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00193}00193 \textcolor{comment}{        std::cout<< "{}nYield "{} << theStep-\/>GetPreStepPoint ()-\/>GetKineticEnergy() / MeV << "{} "{}<<  1<<std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00194}00194 \textcolor{comment}{    \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00195}00195 \textcolor{comment}{    return;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00196}00196 \textcolor{comment}{*/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00197}00197 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00198}00198 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00199}00199 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00201}00201     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ Scoring of every particles (neutron excepted) -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00203}00203 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00204}00204     \textcolor{comment}{// Initialization of status flags}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00205}00205     \textcolor{comment}{// std::cout << "{}Begin InitializeGenerationFlag"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00206}00206     fGenerationCounter-\/>InitializeGenerationFlag(theStep, IsTargetRegion(fPhysicalVolumeNumber));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00207}00207     \textcolor{comment}{// std::cout << "{}Begin fGenerationCounter-\/>GetStatus\_SourceNeutron"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00208}00208     fIsSourceNeutron = fGenerationCounter-\/>GetStatus\_SourceNeutron();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00209}00209     \textcolor{comment}{// std::cout << "{}Begin fGenerationCounter-\/>GetNeutronGeneration"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00210}00210     fNeutronGeneration = fGenerationCounter-\/>GetNeutronGeneration();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00211}00211 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00212}00212     \textcolor{comment}{// Required quantities from the step}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00213}00213 \textcolor{comment}{//     int Nprotons = 1;   // The graphs are scaled in Graphes\_ROOT.C}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00214}00214     \textcolor{keywordtype}{double} dbl\_Ibeam = 1; \textcolor{comment}{//.E6 / fEbeam /(double) Nprotons;  // beam current at 1 MW\_beam}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00215}00215 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00216}00216     \textcolor{comment}{// std::cout << "{}Begin FillEdepInStepHisto"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00217}00217     FillEdepInStepHisto(theStep, dbl\_Ibeam); \textcolor{comment}{// Fill histogram of Edeposition depending on the volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00218}00218     \textcolor{comment}{// std::cout << "{}Begin ScorePrimaryProtons"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00219}00219     ScorePrimaryProtons(theStep, dbl\_Ibeam); \textcolor{comment}{// Score information of primary protons}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00220}00220 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00221}00221     \textcolor{comment}{// Fill Time VS Energy histograms of fission product}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00222}00222     \textcolor{comment}{// std::cout << "{}Begin FillTimeEnergyFissionProducts"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00223}00223     \textcolor{keywordflow}{if} (IsFissionProduct(theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleType())) \{ FillTimeEnergyFissionProducts(theStep); \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00225}00225     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ Neutrons scoring -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00227}00227 \textcolor{comment}{}    \textcolor{comment}{// std::cout << "{}Begin AccumulateMeanEperFission"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00228}00228     AccumulateMeanEperFission(theStep); \textcolor{comment}{// To calculate the mean deposited energy per fission}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00229}00229 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00230}00230     \textcolor{comment}{// std::cout << "{}Begin ManageNeutronScoring"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00231}00231     ManageNeutronScoring(theStep, nNeutrons);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00232}00232 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00233}00233 \textcolor{comment}{//     CountNeutronSource\_DefEAP(theStep);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00234}00234 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00235}00235     \textcolor{keywordflow}{if}(p-\/>int\_Option == 10) \{ }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00236}00236         fRunAction-\/>ScoreDepositedPower(theStep,fNeutronGeneration);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00237}00237         \textcolor{keywordflow}{if}(theStep-\/>GetTrack()-\/>GetTrackStatus() == fKillTrackAndSecondaries)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00238}00238             \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00239}00239     \};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00240}00240     }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00242}00242     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ k calculation, counting of neutrons and transmuted elements (burnup) -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00244}00244 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00245}00245     \textcolor{comment}{// Score the position of fissions inside a mesh}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00246}00246     \textcolor{comment}{// std::cout << "{}Begin keff\_Mesh\_scoring"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00247}00247     keff\_Mesh\_scoring(theStep);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00248}00248 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00249}00249     \textcolor{comment}{// Score neutron generation and source term for burnup}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00250}00250     \textcolor{comment}{// std::cout << "{}Begin CountSecondaries"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00251}00251     CountSecondaries(theStep, nNeutrons);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00252}00252  \textcolor{comment}{//   computeSourceTerm(theStep);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00253}00253 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00254}00254     \textcolor{comment}{// to do ManagePrimaryProtonEscape(theStep);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00255}00255 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00256}00256     \textcolor{comment}{/*if (theStep-\/>GetTrack()-\/>GetParticleDefinition()-\/>GetParticleName() == "{}proton"{}) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00257}00257 \textcolor{comment}{        FillNtupleProton(}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00258}00258 \textcolor{comment}{            theStep-\/>GetPostStepPoint()-\/>GetPosition(),}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00259}00259 \textcolor{comment}{            theStep-\/>GetPostStepPoint()-\/>GetMomentumDirection(),}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00260}00260 \textcolor{comment}{            theStep-\/>GetTotalEnergyDeposit()/eV// theStep-\/>GetPostStepPoint()-\/>GetKineticEnergy()/eV}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00261}00261 \textcolor{comment}{        );}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00262}00262 \textcolor{comment}{    \}*/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00263}00263 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00264}00264     \textcolor{keywordflow}{if}( p-\/>int\_Option == 20)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00265}00265     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00266}00266         \mbox{\hyperlink{class_t_m_xkeff_ae1e9f4676a54a9533cfe95f2d3b38805}{TMXkeff::getInstance}}()-\/>\mbox{\hyperlink{class_t_m_xkeff_a33a603dcd2f64217c3e97ace0e62a110}{inUserSteppingAction}}(theStep);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00267}00267 \textcolor{comment}{//        computeSourceTerm(theStep);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00268}00268 \textcolor{comment}{//         FillEdepInStepHisto(theStep,1); // Fill histogram of Edeposition depending on the volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00269}00269 \textcolor{comment}{//         ManageNeutronScoring(theStep, nNeutrons);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00270}00270         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00271}00271     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00272}00272 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00273}00273     \textcolor{comment}{// std::cout << "{}End of step"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00274}00274 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00275}00275 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00298}00298 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00299}00299 \textcolor{comment}{// User-\/defined method because of geometry dependencies}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00300}00300 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00315}00315 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00316}00316 \textcolor{comment}{// At initialisation, associate a region ID to one or more physical volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00317}00317 \textcolor{keywordtype}{void} SteppingAction::Initialize\_userDefinedRegions() \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00318}00318     \textcolor{comment}{// Definition of physical volume numbers}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00319}00319     \textcolor{keywordflow}{if}(p-\/>Geometry == 0 || p-\/>Geometry == 2) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00320}00320         strPhysVolNumber = \{         14,            15,            16,           17,             18,            19,           20,           21,       22,            23,}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00321}00321                                     400,         41,                  42,         43,            44,           50,           51,           52,           53,           54,}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00322}00322                                       1,           5,            3,       13,         24,           25,         2,          9,       7 ,       10 ,}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00323}00323                                       55,        4,           60,            56,           14,                  26\};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00324}00324         strPhysVolName = \{\textcolor{stringliteral}{"{}TargetSlab0"{}}, \textcolor{stringliteral}{"{}TargetSlab1"{}}, \textcolor{stringliteral}{"{}TargetSlab2"{}}, \textcolor{stringliteral}{"{}TargetSlab3"{}}, \textcolor{stringliteral}{"{}TargetSlab4"{}}, \textcolor{stringliteral}{"{}TargetSlab5"{}}, \textcolor{stringliteral}{"{}TargetSlab6"{}}, \textcolor{stringliteral}{"{}TargetTube"{}}, \textcolor{stringliteral}{"{}Alcuts"{}}, \textcolor{stringliteral}{"{}TargetWater"{}},}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00325}00325                                  \textcolor{stringliteral}{"{}Fuel"{}}, \textcolor{stringliteral}{"{}Cladding"{}}, \textcolor{stringliteral}{"{}WaterFuelCladding"{}}, \textcolor{stringliteral}{"{}pBreeder"{}}, \textcolor{stringliteral}{"{}pReflectorC"{}}, \textcolor{stringliteral}{"{}pDiffusor0"{}}, \textcolor{stringliteral}{"{}pDiffusor1"{}}, \textcolor{stringliteral}{"{}pDiffusor2"{}}, \textcolor{stringliteral}{"{}pDiffusor3"{}}, \textcolor{stringliteral}{"{}pDiffusor4"{}},}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00326}00326                                 \textcolor{stringliteral}{"{}World"{}}, \textcolor{stringliteral}{"{}pDiffusor"{}}, \textcolor{stringliteral}{"{}pReflector"{}}, \textcolor{stringliteral}{"{}pFetop"{}}, \textcolor{stringliteral}{"{}BeamPipe"{}}, \textcolor{stringliteral}{"{}BeamWindow"{}}, \textcolor{stringliteral}{"{}pShield"{}}, \textcolor{stringliteral}{"{}pAirside"{}}, \textcolor{stringliteral}{"{}pCool7"{}}, \textcolor{stringliteral}{"{}pCool10"{}},}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00327}00327                         \textcolor{stringliteral}{"{}pAbsorberLayer"{}}, \textcolor{stringliteral}{"{}pFebot"{}}, \textcolor{stringliteral}{"{}pSpentFuel"{}}, \textcolor{stringliteral}{"{}pControlRod"{}}, \textcolor{stringliteral}{"{}TargetSlab"{}}, \textcolor{stringliteral}{"{}CoolantTargetTube"{}}\};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00328}00328         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i\_pv = 0; i\_pv < strPhysVolNumber.size(); ++i\_pv)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00329}00329             fmap\_PV\_name\_number[ strPhysVolName[i\_pv] ] = strPhysVolNumber[i\_pv];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00330}00330     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00331}00331     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(p-\/>Geometry == 1) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00332}00332 \textcolor{comment}{//         if(p-\/>Geometry == 1) \{ // hard-\/coded but will be improved with new version of code}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00333}00333 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00334}00334             strPhysVolNumber = \{       1\};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00335}00335             strPhysVolName = \{\textcolor{stringliteral}{"{}Universe"{}}\};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00336}00336             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}Universe"{}}] = 1;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00337}00337 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00338}00338             \textcolor{comment}{// 42 -\/> Water around fuel cladding}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00339}00339             std::vector<std::string> WaterVolumes \{ \textcolor{stringliteral}{"{}REFL"{}}, \textcolor{stringliteral}{"{}WaterBottom"{}}, \textcolor{stringliteral}{"{}InBottWater"{}}, \textcolor{stringliteral}{"{}WaterTop"{}}, \textcolor{stringliteral}{"{}WaterCentralCyl0"{}}, \textcolor{stringliteral}{"{}WaterCentralCyl1"{}}, \textcolor{stringliteral}{"{}WaterCentralCyl2"{}}, \textcolor{stringliteral}{"{}WDISPL"{}}, \textcolor{stringliteral}{"{}WaterDispl"{}}, \textcolor{stringliteral}{"{}IRT4M8T"{}}, \textcolor{stringliteral}{"{}IRT4M6T"{}}, \textcolor{stringliteral}{"{}WaterInCore"{}}, \textcolor{stringliteral}{"{}FAST"{}}\};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00340}00340             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<WaterVolumes.size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00341}00341                 strPhysVolName.push\_back(WaterVolumes[i]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00342}00342                 strPhysVolNumber.push\_back(42);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00343}00343                 fmap\_PV\_name\_number[ WaterVolumes[i] ] = 42;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00344}00344             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00345}00345 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00346}00346             \textcolor{comment}{// 44 -\/> Reflector}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00347}00347             std::vector<std::string> ReflectorVolumes \{ \textcolor{stringliteral}{"{}BeAssembly0"{}}, \textcolor{stringliteral}{"{}BeAssembly1"{}}, \textcolor{stringliteral}{"{}BeAssembly2"{}}, \textcolor{stringliteral}{"{}BeCentralCyl0"{}}, \textcolor{stringliteral}{"{}BeCentralCyl1"{}}, \textcolor{stringliteral}{"{}BeCentralCyl2"{}}, \textcolor{stringliteral}{"{}LEAD"{}} \};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00348}00348             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<ReflectorVolumes.size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00349}00349                 strPhysVolName.push\_back(ReflectorVolumes[i]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00350}00350                 strPhysVolNumber.push\_back(44);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00351}00351                 fmap\_PV\_name\_number[ ReflectorVolumes[i] ] = 44;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00352}00352             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00353}00353 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00354}00354             \textcolor{comment}{// 43 -\/> Structural material in the core}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00355}00355             std::vector<std::string> AlStructureVolumes \{ \textcolor{stringliteral}{"{}RefAssembly"{}}, \textcolor{stringliteral}{"{}ConeBelow"{}}, \textcolor{stringliteral}{"{}AlTop"{}}, \textcolor{stringliteral}{"{}VOID"{}}, \textcolor{stringliteral}{"{}TubeWDispl"{}}, \textcolor{stringliteral}{"{}CR"{}}, \textcolor{stringliteral}{"{}Separator"{}}, \textcolor{stringliteral}{"{}NeutronChannel\_pipe"{}}\};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00356}00356             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<AlStructureVolumes.size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00357}00357                 strPhysVolName.push\_back(AlStructureVolumes[i]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00358}00358                 strPhysVolNumber.push\_back(43);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00359}00359                 fmap\_PV\_name\_number[ AlStructureVolumes[i] ] = 43;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00360}00360             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00361}00361 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00362}00362             \textcolor{comment}{// Fuel IRT4M8T}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00363}00363             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<7; ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00364}00364                 strPhysVolName.push\_back(\textcolor{stringliteral}{"{}IRT4MAssembly8T\_"{}} + std::to\_string(i));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00365}00365                 strPhysVolNumber.push\_back(41);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00366}00366                 fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}IRT4MAssembly8T\_"{}} + std::to\_string(i)] = 41;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00367}00367 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00368}00368                 strPhysVolName.push\_back(\textcolor{stringliteral}{"{}FuelAssembly8T\_"{}} + std::to\_string(i));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00369}00369                 strPhysVolNumber.push\_back(400);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00370}00370                 fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}FuelAssembly8T\_"{}} + std::to\_string(i)] = 400;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00371}00371                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<5; ++j) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00372}00372                     strPhysVolName.push\_back(\textcolor{stringliteral}{"{}FuelAssembly8T\_"{}} + std::to\_string(i) + \textcolor{stringliteral}{"{}\_"{}} + std::to\_string(j));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00373}00373                     strPhysVolNumber.push\_back(400);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00374}00374                     fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}FuelAssembly8T\_"{}} + std::to\_string(i) + \textcolor{stringliteral}{"{}\_"{}} + std::to\_string(j)] = 400;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00375}00375                 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00376}00376             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00377}00377             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}TubeClad8T"{}});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00378}00378             strPhysVolNumber.push\_back(41);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00379}00379             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}TubeClad8T"{}}] = 41;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00380}00380             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}TubeFuel8T"{}});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00381}00381             strPhysVolNumber.push\_back(400);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00382}00382             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}TubeFuel8T"{}}] = 400;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00383}00383             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<5; ++j) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00384}00384                 strPhysVolName.push\_back(\textcolor{stringliteral}{"{}TubeFuel8T\_"{}} + std::to\_string(j));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00385}00385                 strPhysVolNumber.push\_back(400);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00386}00386                 fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}TubeFuel8T\_"{}} + std::to\_string(j)] = 400;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00387}00387             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00388}00388             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}TubeDisplacement8T"{}});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00389}00389             strPhysVolNumber.push\_back(41);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00390}00390             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}TubeDisplacement8T"{}}] = 41;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00391}00391 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00392}00392             \textcolor{comment}{// Fuel IRT4M6T}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00393}00393             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<6; ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00394}00394                 strPhysVolName.push\_back(\textcolor{stringliteral}{"{}IRT4MAssembly6T\_"{}} + std::to\_string(i));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00395}00395                 strPhysVolNumber.push\_back(41);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00396}00396                 fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}IRT4MAssembly6T\_"{}} + std::to\_string(i)] = 41;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00397}00397                 strPhysVolName.push\_back(\textcolor{stringliteral}{"{}FuelAssembly6T\_"{}} + std::to\_string(i));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00398}00398                 strPhysVolNumber.push\_back(400);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00399}00399                 fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}FuelAssembly6T\_"{}} + std::to\_string(i)] = 400;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00400}00400                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<5; ++j) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00401}00401                     strPhysVolName.push\_back(\textcolor{stringliteral}{"{}FuelAssembly6T\_"{}} + std::to\_string(i) + \textcolor{stringliteral}{"{}\_"{}} + std::to\_string(j));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00402}00402                     strPhysVolNumber.push\_back(400);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00403}00403                     fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}FuelAssembly6T\_"{}} + std::to\_string(i) + \textcolor{stringliteral}{"{}\_"{}} + std::to\_string(j)] = 400;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00404}00404                 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00405}00405             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00406}00406             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}IRT4MAssembly6TChannel"{}});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00407}00407             strPhysVolNumber.push\_back(41);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00408}00408             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}IRT4MAssembly6TChannel"{}}] = 41;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00409}00409 \textcolor{comment}{//             strPhysVolName.push\_back("{}TubeAbs"{});}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00410}00410 \textcolor{comment}{//             strPhysVolNumber.push\_back(55);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00411}00411 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00412}00412             \textcolor{comment}{// "{}SSclad"{} -\/> Stainless steel cladding of control rod}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00413}00413             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}SSclad"{}});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00414}00414             strPhysVolNumber.push\_back(56);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00415}00415             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}SSclad"{}}] = 56;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00416}00416             \textcolor{comment}{// "{}Absorber"{} -\/> Neutron absorber of control rod}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00417}00417             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}Absorber"{}});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00418}00418             strPhysVolNumber.push\_back(55);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00419}00419             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}Absorber"{}}] = 55;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00420}00420 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00421}00421             \textcolor{comment}{// "{}ReactorConcreteShield"{} -\/> Concrete around the reactor}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00422}00422             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}ReactorConcreteShield"{}});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00423}00423             strPhysVolNumber.push\_back(7);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00424}00424             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}ReactorConcreteShield"{}}] = 7;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00425}00425 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00426}00426             \textcolor{comment}{// "{}ReactorAirOutside"{} -\/> Air around the reactor}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00427}00427             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}ReactorAirOutside"{}});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00428}00428             strPhysVolNumber.push\_back(9);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00429}00429             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}ReactorAirOutside"{}}] = 9;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00430}00430 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00431}00431             \textcolor{comment}{// "{}ReactorVessel"{} -\/> Reactor vessel}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00432}00432             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}ReactorVessel"{}});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00433}00433             strPhysVolNumber.push\_back(2);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00434}00434             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}ReactorVessel"{}}] = 2;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00435}00435 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00436}00436             \textcolor{comment}{// "{}ReactorWater"{} -\/> water in the reactor but outside the core}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00437}00437             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}ReactorWater"{}});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00438}00438             strPhysVolNumber.push\_back(3);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00439}00439             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}ReactorWater"{}}] = 3;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00440}00440 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00441}00441             \textcolor{comment}{// "{}NeutronChannel\_air"{} -\/> air in the neutron beam channel}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00442}00442             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}NeutronChannel\_air"{}});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00443}00443             strPhysVolNumber.push\_back(9);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00444}00444             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}NeutronChannel\_air"{}}] = 9;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00445}00445 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00446}00446             \textcolor{comment}{// "{}Lead"{} -\/> Lead rid defining a fast zone}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00447}00447             std::vector<std::string> FastLeadVolumes \{ \textcolor{stringliteral}{"{}FastZone"{}}, \textcolor{stringliteral}{"{}LeadInside"{}}\};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00448}00448             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<FastLeadVolumes.size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00449}00449                 strPhysVolName.push\_back(FastLeadVolumes[i]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00450}00450                 strPhysVolNumber.push\_back(5);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00451}00451                 fmap\_PV\_name\_number[FastLeadVolumes[i]] = 5;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00452}00452             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00453}00453 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00454}00454             \textcolor{comment}{// "{}B4C\_fastZone"{} -\/> B4C to absorb thermal neutrons}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00455}00455             std::vector<std::string> FastB4CVolumes \{ \textcolor{stringliteral}{"{}Carrier\_B4C"{}}, \textcolor{stringliteral}{"{}B4C\_fastZone"{}}\};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00456}00456             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<FastB4CVolumes.size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00457}00457                 strPhysVolName.push\_back(FastB4CVolumes[i]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00458}00458                 strPhysVolNumber.push\_back(50);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00459}00459                 fmap\_PV\_name\_number[FastB4CVolumes[i]] = 50;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00460}00460             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00461}00461 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00462}00462             \textcolor{comment}{// "{}Al\_capsule"{} -\/> B4C to absorb thermal neutrons}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00463}00463             std::vector<std::string> FastAlCapsuleVolumes \{ \textcolor{stringliteral}{"{}AlCarrier0"{}}, \textcolor{stringliteral}{"{}AlCarrier1"{}}, \textcolor{stringliteral}{"{}AlCarrier2"{}}, \textcolor{stringliteral}{"{}AlCarrier3"{}}\};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00464}00464             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<FastAlCapsuleVolumes.size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00465}00465                 strPhysVolName.push\_back(FastAlCapsuleVolumes[i]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00466}00466                 strPhysVolNumber.push\_back(51 + i);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00467}00467                 fmap\_PV\_name\_number[FastAlCapsuleVolumes[i]] = 51 + i;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00468}00468             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00469}00469 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00470}00470             \textcolor{comment}{// "{}FuelSample"{} -\/> Fuel sample at the center of the fast zone}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00471}00471             std::vector<std::string> FuelSampleVolumes \{ \textcolor{stringliteral}{"{}FuelSample"{}}, \textcolor{stringliteral}{"{}Carrier\_Fuel"{}}\};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00472}00472             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<FuelSampleVolumes.size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00473}00473                 strPhysVolName.push\_back(FuelSampleVolumes[i]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00474}00474                 strPhysVolNumber.push\_back(60);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00475}00475                 fmap\_PV\_name\_number[FuelSampleVolumes[i]] = 60;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00476}00476             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00477}00477 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00478}00478             \textcolor{comment}{// 57 -\/> Cladding of the fast zone}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00479}00479             std::vector<std::string> FastAlStructureVolumes \{ \textcolor{stringliteral}{"{}FastZone\_AlClad"{}}, \textcolor{stringliteral}{"{}FastZone\_ssClad"{}}, \textcolor{stringliteral}{"{}FastZone\_Tube"{}}\};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00480}00480             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<FastAlStructureVolumes.size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00481}00481                 strPhysVolName.push\_back(FastAlStructureVolumes[i]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00482}00482                 strPhysVolNumber.push\_back(57);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00483}00483                 fmap\_PV\_name\_number[FastAlStructureVolumes[i]] = 57;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00484}00484             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00485}00485 \textcolor{comment}{//         \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00486}00486 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00487}00487         \textcolor{comment}{// Beam pipe assembly}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00488}00488 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00489}00489         \textcolor{keyword}{const} std::vector<std::string>* vacuum = TMXAbstractBeamPipe::getVacuumName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00490}00490         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<vacuum-\/>size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00491}00491             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}p"{}} + (*vacuum)[i]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00492}00492             strPhysVolNumber.push\_back(26);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00493}00493             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}p"{}} + (*vacuum)[i]] = 26;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00494}00494         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00495}00495         \textcolor{keyword}{const} std::vector<std::string>* tube   = TMXAbstractBeamPipe::getTubeName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00496}00496         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<tube-\/>size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00497}00497             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}p"{}} + (*tube)[i]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00498}00498             strPhysVolNumber.push\_back(24);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00499}00499             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}p"{}} + (*tube)[i]] = 24;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00500}00500         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00501}00501         \textcolor{keyword}{const} std::vector<std::string>* window = TMXAbstractBeamPipe::getWindowName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00502}00502         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<window-\/>size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00503}00503             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}p"{}} + (*window)[i]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00504}00504             strPhysVolNumber.push\_back(25);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00505}00505             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}p"{}} + (*window)[i]] = 25;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00506}00506         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00507}00507 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00508}00508         \textcolor{comment}{// Target assembly}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00509}00509 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00510}00510         \textcolor{keyword}{const} std::vector<std::string>* coolant = TMXAbstractTargetAssembly::getCoolantName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00511}00511         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<coolant-\/>size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00512}00512             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}p"{}} + (*coolant)[i]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00513}00513             strPhysVolNumber.push\_back(23);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00514}00514             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}p"{}} + (*coolant)[i]] = 23;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00515}00515         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00516}00516         \textcolor{keyword}{const} std::vector<std::string>* targetTube = TMXAbstractTargetAssembly::getCladName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00517}00517         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<targetTube-\/>size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00518}00518             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}p"{}} + (*targetTube)[i]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00519}00519             strPhysVolNumber.push\_back(21);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00520}00520             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}p"{}} + (*targetTube)[i]] = 21;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00521}00521         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00522}00522         \textcolor{keyword}{const} std::vector<std::string>* slabs = TMXAbstractTargetAssembly::getTargetName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00523}00523         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<slabs-\/>size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00524}00524             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}p"{}} + (*slabs)[i]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00525}00525             \textcolor{keywordflow}{if}(14+i <= 20) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00526}00526                 strPhysVolNumber.push\_back(14 + i);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00527}00527                 fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}p"{}} + (*slabs)[i]] = 14 + i;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00528}00528             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00529}00529             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00530}00530                 strPhysVolNumber.push\_back(20);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00531}00531                 fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}p"{}} + (*slabs)[i]] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00532}00532             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00533}00533         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00534}00534     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00535}00535     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (p-\/>Geometry == 5) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00536}00536         strPhysVolName.push\_back(\textcolor{stringliteral}{"{}pSphere1"{}});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00537}00537         strPhysVolNumber.push\_back(20);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00538}00538         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pSphere1"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00539}00539 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00540}00540         strPhysVolName.push\_back(\textcolor{stringliteral}{"{}pSphere2"{}});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00541}00541         strPhysVolNumber.push\_back(400);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00542}00542         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pSphere2"{}}] = 400;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00543}00543     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00544}00544     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (p-\/>Geometry == 6) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00545}00545 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00546}00546         \textcolor{comment}{// Beam pipe assembly}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00547}00547 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00548}00548         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pBeamPipe"{}}] = 24;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00549}00549         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pVoid"{}}] = 24;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00550}00550         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pWindow"{}}] = 24;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00551}00551 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00552}00552         \textcolor{comment}{// Target assembly}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00553}00553 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00554}00554         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pTarget"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00555}00555         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pTarget\_Coating"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00556}00556         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pTarget\_Plate"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00557}00557         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pTarget\_Water"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00558}00558         fSpallationTargetCubicVolume = 7 * cm * 7 * cm * 5.4 * cm;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00559}00559 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00560}00560         \textcolor{comment}{// Fuel material only}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00561}00561         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < 3; i++)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00562}00562             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pFuel"{}} + std::to\_string(i + 1)] = 400;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00563}00563 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00564}00564         \textcolor{comment}{// Water inside core excluding fuel assemblies}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00565}00565         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pCore"{}}] = 42;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00566}00566 \textcolor{comment}{//        fmap\_PV\_name\_number["{}pFuelAssemblyVVRM2"{}] = 50;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00567}00567 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00568}00568         \textcolor{comment}{// Reflectors}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00569}00569         fmap\_PV\_name\_number[ \textcolor{stringliteral}{"{}pReflectorAssembly"{}} ] = 44;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00570}00570 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00571}00571     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00572}00572 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00573}00573     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (p-\/>Geometry == 7) \{ \textcolor{comment}{// EAP80}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00574}00574         \textcolor{keyword}{const} std::vector<std::string>* primaryCoolant = GeomEAP80::getPrimaryCoolantName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00575}00575         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<primaryCoolant-\/>size(); i++) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00576}00576             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}p"{}} + (*primaryCoolant)[i].substr(1, 30));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00577}00577             strPhysVolNumber.push\_back(50);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00578}00578         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00579}00579 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00580}00580         \textcolor{keyword}{const} std::vector<std::string>* primaryCoolantCore = GeomEAP80::getPrimaryCoolantCoreName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00581}00581         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<primaryCoolantCore-\/>size(); i++) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00582}00582             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}p"{}} + (*primaryCoolantCore)[i].substr(1, 30));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00583}00583             strPhysVolNumber.push\_back(5);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00584}00584         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00585}00585 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00586}00586         \textcolor{keyword}{const} std::vector<std::string>* secondaryCoolant = GeomEAP80::getSecondaryCoolantName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00587}00587         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<secondaryCoolant-\/>size(); i++) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00588}00588             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}p"{}} + (*secondaryCoolant)[i].substr(1, 30));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00589}00589             strPhysVolNumber.push\_back(85);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00590}00590         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00591}00591 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00592}00592         \textcolor{comment}{// Incineration blanket}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00593}00593         strPhysVolName.push\_back(\textcolor{stringliteral}{"{}pblancool"{}});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00594}00594         strPhysVolNumber.push\_back(90);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00595}00595 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00596}00596         \textcolor{keyword}{const} std::vector<std::string>* fuel = GeomEAP80::getFuelName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00597}00597         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<fuel-\/>size(); i++) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00598}00598             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}p"{}} + (*fuel)[i].substr(1, 30));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00599}00599             strPhysVolNumber.push\_back(400);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00600}00600         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00601}00601 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00602}00602         \textcolor{comment}{/*const std::string spallationTarget = GeomEAP80::getSpallationTargetName();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00603}00603 \textcolor{comment}{        strPhysVolName.push\_back("{}p"{} + spallationTarget.substr(1, 30));}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00604}00604 \textcolor{comment}{        strPhysVolNumber.push\_back(20);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00605}00605 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00606}00606 \textcolor{comment}{        strPhysVolName.push\_back("{}pBeamvoid"{}); // Beam void}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00607}00607 \textcolor{comment}{        strPhysVolNumber.push\_back(26);*/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00608}00608         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pbeamwal1"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00609}00609         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pbeamin1"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00610}00610         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pbeamwal2"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00611}00611         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pBeamvoid"{}}] = 26;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00612}00612         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pspalwal"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00613}00613         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pspalin"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00614}00614         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pinjtubX"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00615}00615         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pinjinX"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00616}00616         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pinjtubXX"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00617}00617         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pinjinXX"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00618}00618         std::string ind;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00619}00619         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=1; i<=6; i++) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00620}00620             ind = std::to\_string((\textcolor{keywordtype}{int})i);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00621}00621             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pinjwal"{}}+ind] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00622}00622             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pinjwal"{}}+ind+ind] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00623}00623             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pinjtub"{}}+ind+ind+ind] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00624}00624         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00625}00625         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pbeamin2"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00626}00626         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}ptarghxEnv"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00627}00627         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pbeamEnv"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00628}00628         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pTargint"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00629}00629         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}ptargwalO"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00630}00630 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00631}00631         \textcolor{keyword}{const} std::string reactorOuterVessel = GeomEAP80::getReactorOuterVesselName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00632}00632 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00633}00633         \textcolor{keyword}{const} std::string reactorInnerVessel = GeomEAP80::getReactorInnerVesselName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00634}00634         strPhysVolName.push\_back(\textcolor{stringliteral}{"{}p"{}} + reactorInnerVessel.substr(1, 30));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00635}00635         strPhysVolNumber.push\_back(80);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00636}00636 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00637}00637         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i\_pv = 0; i\_pv < strPhysVolNumber.size(); ++i\_pv)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00638}00638             fmap\_PV\_name\_number[ strPhysVolName[i\_pv] ] = strPhysVolNumber[i\_pv];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00639}00639     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00640}00640 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00641}00641     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (p-\/>Geometry == 8) \{ \textcolor{comment}{// AKME Dev Reactor}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00642}00642         \textcolor{keyword}{const} std::vector<std::string>* primaryCoolant = GeomSVBR\_AKME::getPrimaryCoolantName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00643}00643         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<primaryCoolant-\/>size(); i++) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00644}00644             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}p"{}} + (*primaryCoolant)[i].substr(1, 30));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00645}00645             strPhysVolNumber.push\_back(50);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00646}00646         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00647}00647 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00648}00648         \textcolor{keyword}{const} std::vector<std::string>* primaryCoolantCore = GeomSVBR\_AKME::getPrimaryCoolantCoreName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00649}00649         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<primaryCoolantCore-\/>size(); i++) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00650}00650             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}p"{}} + (*primaryCoolantCore)[i].substr(1, 30));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00651}00651             strPhysVolNumber.push\_back(5);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00652}00652         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00653}00653 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00654}00654         \textcolor{keyword}{const} std::vector<std::string>* secondaryCoolant = GeomSVBR\_AKME::getSecondaryCoolantName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00655}00655         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<secondaryCoolant-\/>size(); i++) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00656}00656             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}p"{}} + (*secondaryCoolant)[i].substr(1, 30));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00657}00657             strPhysVolNumber.push\_back(85);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00658}00658         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00659}00659 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00660}00660         \textcolor{comment}{// Incineration blanket}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00661}00661         strPhysVolName.push\_back(\textcolor{stringliteral}{"{}pblancool"{}});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00662}00662         strPhysVolNumber.push\_back(90);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00663}00663 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00664}00664         \textcolor{keyword}{const} std::vector<std::string>* fuel = GeomSVBR\_AKME::getFuelName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00665}00665         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<fuel-\/>size(); i++) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00666}00666             strPhysVolName.push\_back(\textcolor{stringliteral}{"{}p"{}} + (*fuel)[i].substr(1, 30));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00667}00667             strPhysVolNumber.push\_back(400);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00668}00668         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00669}00669 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00670}00670         \textcolor{comment}{// Target}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00671}00671         \textcolor{comment}{/*const std::string spallationTarget = GeomSVBR\_AKME::getSpallationTargetName();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00672}00672 \textcolor{comment}{        strPhysVolName.push\_back("{}p"{} + spallationTarget.substr(1, 30));}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00673}00673 \textcolor{comment}{        strPhysVolNumber.push\_back(20);*/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00674}00674 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00675}00675         \textcolor{comment}{// strPhysVolName.push\_back("{}pBeamvoid"{}); // Beam void}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00676}00676         \textcolor{comment}{// strPhysVolNumber.push\_back(26);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00677}00677         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pbeamwal1"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00678}00678         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pbeamin1"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00679}00679         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pbeamwal2"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00680}00680         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pBeamvoid"{}}] = 26;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00681}00681         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pspalwal"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00682}00682         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pspalin"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00683}00683         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pinjtubX"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00684}00684         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pinjinX"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00685}00685         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pinjtubXX"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00686}00686         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pinjinXX"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00687}00687         std::string ind;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00688}00688         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=1; i<=6; i++) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00689}00689             ind = std::to\_string((\textcolor{keywordtype}{int})i);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00690}00690             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pinjwal"{}}+ind] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00691}00691             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pinjwal"{}}+ind+ind] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00692}00692             fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pinjtub"{}}+ind+ind+ind] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00693}00693         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00694}00694         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pbeamin2"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00695}00695         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}ptarghxEnv"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00696}00696         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pbeamEnv"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00697}00697         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pTargint"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00698}00698         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}ptargwalO"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00699}00699 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00700}00700         \textcolor{keyword}{const} std::string reactorOuterVessel = GeomSVBR\_AKME::getReactorOuterVesselName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00701}00701 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00702}00702         \textcolor{keyword}{const} std::string reactorInnerVessel = GeomSVBR\_AKME::getReactorInnerVesselName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00703}00703         strPhysVolName.push\_back(\textcolor{stringliteral}{"{}p"{}} + reactorInnerVessel.substr(1, 30));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00704}00704         strPhysVolNumber.push\_back(80);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00705}00705 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00706}00706         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i\_pv = 0; i\_pv < strPhysVolNumber.size(); ++i\_pv)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00707}00707             fmap\_PV\_name\_number[ strPhysVolName[i\_pv] ] = strPhysVolNumber[i\_pv];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00708}00708     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00709}00709 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00710}00710     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (p-\/>Geometry == 10) \{ \textcolor{comment}{// SVBR100 + TMX Target}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00711}00711 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00712}00712         \textcolor{comment}{// Beam pipe assembly}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00713}00713         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pBeamPipe\_Target"{}}] = 24;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00714}00714         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pWindow"{}}] = 25;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00715}00715         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pWindow\_tip"{}}] = 25;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00716}00716 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00717}00717         \textcolor{comment}{// Target assembly}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00718}00718         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pBeamTube"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00719}00719         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pUpperCoolant"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00720}00720         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pIntermediateVoidEnvelope"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00721}00721         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pIntermediateVoid"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00722}00722         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pTarget\_innerEMPomp"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00723}00723         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pTarget\_outerEMPomp"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00724}00724         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pHXWings\_replica"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00725}00725         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pHXWings"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00726}00726         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pWing"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00727}00727         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pInner\_envelope"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00728}00728         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pOuter\_outerShell"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00729}00729         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pTargetCoolant"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00730}00730         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pOuter\_flowGuide"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00731}00731         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pInner\_flowGuide"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00732}00732         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pInner\_beamWindow"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00733}00733         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pInner\_beamWindow\_tip"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00734}00734         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pVanes\_0"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00735}00735         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pVanes\_1"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00736}00736         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pVanes\_2"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00737}00737         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pVanes\_3"{}}] = 20;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00738}00738 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00739}00739         \textcolor{comment}{// Fuel material only}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00740}00740         fmap\_PV\_name\_number[\textcolor{stringliteral}{"{}pFuelPin\_FuelPellet"{}}] = 400;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00741}00741 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00742}00742         \textcolor{comment}{// Water inside core excluding fuel assemblies}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00743}00743         \textcolor{comment}{//fmap\_PV\_name\_number["{}pCore"{}] = 42;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00744}00744 \textcolor{comment}{//        fmap\_PV\_name\_number["{}pFuelAssemblyVVRM2"{}] = 50;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00745}00745 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00746}00746         \textcolor{comment}{// Reflectors}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00747}00747         \textcolor{comment}{//fmap\_PV\_name\_number[ "{}pReflectorAssembly"{} ] = 44;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00748}00748 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00749}00749     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00750}00750     \textcolor{keywordflow}{else} \{ \textcolor{comment}{// Generic volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00751}00751         \textcolor{keywordtype}{int} numVol=0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00752}00752         \textcolor{keywordflow}{for}(G4PhysicalVolumeStore::iterator physicalVolume=G4PhysicalVolumeStore::GetInstance()-\/>begin(); physicalVolume!=G4PhysicalVolumeStore::GetInstance()-\/>end(); physicalVolume++) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00753}00753             \textcolor{keywordflow}{if}(*physicalVolume) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00754}00754                 strPhysVolName.push\_back((*physicalVolume)-\/>GetName());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00755}00755                 strPhysVolNumber.push\_back(numVol);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00756}00756                 fmap\_PV\_name\_number[(*physicalVolume)-\/>GetName()] = numVol;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00757}00757                 ++numVol;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00758}00758             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00759}00759         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00760}00760     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00761}00761 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00762}00762 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00763}00763 \textcolor{comment}{// At initialisation, defined some variables (e.g. volume for fluence calculation)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00764}00764 \textcolor{keywordtype}{void} SteppingAction::Initialize\_userDefinedVariables() \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00765}00765   \textcolor{comment}{// Size of a bin in log scale}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00766}00766   fDeltat = (8. -\/ (-\/9.) ) / 1000.;  \textcolor{comment}{// WARNING : hard-\/coded value -\/> depend on histograms 21 to 24}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00767}00767 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00768}00768 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00769}00769   \textcolor{comment}{// Volume calculation}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00770}00770     \textcolor{keywordflow}{if} (p-\/>Geometry == 0 || p-\/>Geometry == 2)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00771}00771     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00772}00772 \textcolor{comment}{//         fTargetPosition          = static\_cast<const DetectorConstruction*> (G4RunManager::GetRunManager()-\/>GetUserDetectorConstruction())}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00773}00773 \textcolor{comment}{//                                     -\/>GetTargetPosition(); // Position of the target}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00774}00774 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00775}00775         fTargetZdistanceToBottom = \textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }\mbox{\hyperlink{class_detector_construction}{DetectorConstruction}}*\textcolor{keyword}{>} (G4RunManager::GetRunManager()-\/>GetUserDetectorConstruction())}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00776}00776                                     -\/>GetTargetZdistanceToBottom(); \textcolor{comment}{// Heigth between the bottom of the well and the center of the target}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00777}00777         fh0                      = \textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }\mbox{\hyperlink{class_detector_construction}{DetectorConstruction}}*\textcolor{keyword}{>} (G4RunManager::GetRunManager()-\/>GetUserDetectorConstruction())}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00778}00778                                     -\/>Geth0(); \textcolor{comment}{// Height between the bottom of the well and the center of the world volume (concrete)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00779}00779 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00780}00780 \textcolor{comment}{//         fTargetTubeSolid = static\_cast<const DetectorConstruction*> (G4RunManager::GetRunManager()-\/>GetUserDetectorConstruction())}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00781}00781 \textcolor{comment}{//                                         -\/>GetTargetTubeSolid(); // Outer radius of the target tube}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00782}00782 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00783}00783         fN\_fuelrods = \textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }\mbox{\hyperlink{class_detector_construction}{DetectorConstruction}}*\textcolor{keyword}{>} (G4RunManager::GetRunManager()-\/>GetUserDetectorConstruction())}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00784}00784                                     -\/>GetTotalCopyNumberFuelRods(); \textcolor{comment}{// Total number of fuel rods}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00785}00785 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00786}00786         G4LogicalVolume* logicLead =  G4LogicalVolumeStore::GetInstance()-\/>GetVolume(\textcolor{stringliteral}{"{}lDiffusor"{}},\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00787}00787         \textcolor{keywordflow}{if}(logicLead) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00788}00788             fLeadCubicVolume = logicLead-\/>GetSolid()-\/>GetCubicVolume()/cm3;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00789}00789             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < (int)logicLead-\/>GetNoDaughters(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00790}00790                 std::string LV\_Name = logicLead-\/>GetDaughter(i)-\/>GetLogicalVolume()-\/>GetName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00791}00791                 \textcolor{keywordflow}{if}(LV\_Name.find(\textcolor{stringliteral}{"{}lDiffusor"{}}) == std::string::npos )   \textcolor{comment}{// Do not substract lead daugther volume in lead}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00792}00792                     fLeadCubicVolume -\/= logicLead-\/>GetDaughter(i)-\/>GetLogicalVolume()-\/>GetSolid()-\/>GetCubicVolume()/cm3;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00793}00793             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00794}00794     \textcolor{comment}{//         std::cout << "{}Lead Volume : "{} << fLeadCubicVolume << "{} cm\string^3"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00795}00795         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00796}00796 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00797}00797         G4LogicalVolume* logicTarget =  G4LogicalVolumeStore::GetInstance()-\/>GetVolume(\textcolor{stringliteral}{"{}lTargetTube"{}},\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00798}00798         \textcolor{keywordflow}{if}(logicTarget) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00799}00799             fTargetTubeCubicVolume = logicTarget-\/>GetSolid()-\/>GetCubicVolume()/cm3;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00800}00800             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < (int)logicTarget-\/>GetNoDaughters(); ++i) \{ fTargetTubeCubicVolume -\/= logicTarget-\/>GetDaughter(i)-\/>GetLogicalVolume()-\/>GetSolid()-\/>GetCubicVolume()/cm3; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00801}00801             std::cout << \textcolor{stringliteral}{"{}Target tube Volume : "{}} << fTargetTubeCubicVolume << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00802}00802         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00803}00803 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00804}00804         G4LogicalVolume* logicFuelUnion =  G4LogicalVolumeStore::GetInstance()-\/>GetVolume(\textcolor{stringliteral}{"{}lFuelUnion"{}},\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00805}00805         \textcolor{keywordflow}{if}(logicFuelUnion) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00806}00806             fFuelUnionCubicVolume = logicFuelUnion-\/>GetSolid()-\/>GetCubicVolume()/cm3;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00807}00807             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < (int)logicFuelUnion-\/>GetNoDaughters(); ++i) \{ fFuelUnionCubicVolume -\/= logicFuelUnion-\/>GetDaughter(i)-\/>GetLogicalVolume()-\/>GetSolid()-\/>GetCubicVolume()/cm3; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00808}00808     \textcolor{comment}{//         std::cout << "{}Fuel Volume : "{} << fFuelUnionCubicVolume << "{} cm\string^3"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00809}00809         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00810}00810     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00811}00811     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (p-\/>Geometry == 7) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00812}00812         \textcolor{comment}{// Volume Calculations}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00813}00813         fSpallationTargetCubicVolume = fmap\_LV\_volume[GeomEAP80::getSpallationTargetName()];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00814}00814         fReactorOuterVesselCubicVolume = fmap\_LV\_volume[GeomEAP80::getReactorOuterVesselName()];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00815}00815         fReactorInnerVesselCubicVolume = fmap\_LV\_volume[GeomEAP80::getReactorInnerVesselName()];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00816}00816 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00817}00817         fFuelUnionCubicVolume = 0.;                              \textcolor{comment}{// Total volume of fuel in cm3}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00818}00818         \textcolor{keywordtype}{int} count = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00819}00819         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_volume ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00820}00820             \textcolor{keywordflow}{if}( (LVvol.first).substr(0,8) == \textcolor{stringliteral}{"{}lFuelMat"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00821}00821                 fFuelUnionCubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00822}00822                 count++;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00823}00823             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00824}00824             \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMatBlkt1"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00825}00825                 fFuelBlkt1CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00826}00826             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat1"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00827}00827                 fFuel1CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00828}00828             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat2"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00829}00829                 fFuel2CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00830}00830             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat3"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00831}00831                 fFuel3CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00832}00832             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMatGrid2"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00833}00833                 fFuelGrid2CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00834}00834             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat4"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00835}00835                 fFuel4CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00836}00836             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat5"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00837}00837                 fFuel5CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00838}00838             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat6"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00839}00839                 fFuel6CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00840}00840             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat7"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00841}00841                 fFuel7CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00842}00842             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat8"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00843}00843                 fFuel8CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00844}00844             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMatGrid3"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00845}00845                 fFuelGrid3CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00846}00846             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat9"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00847}00847                 fFuel9CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00848}00848             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat10"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00849}00849                 fFuel10CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00850}00850             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat11"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00851}00851                 fFuel11CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00852}00852             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMatBlkt2"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00853}00853                 fFuelBlkt2CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00854}00854         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00855}00855         std::cout << \textcolor{stringliteral}{"{}Number of Physical Volume Fuel : "{}} << count << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00856}00856 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00857}00857         fIncinerationCubicVolume = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00858}00858         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_volume ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00859}00859             \textcolor{keywordflow}{if}( (LVvol.first).substr(0,8) == \textcolor{stringliteral}{"{}lIncBlkt"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00860}00860             \{ fIncinerationCubicVolume += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00861}00861         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00862}00862 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00863}00863         fSecondaryCoolantCubicVolume = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00864}00864         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_volume ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00865}00865             \textcolor{keywordflow}{if}( (LVvol.first).substr(0,17) == \textcolor{stringliteral}{"{}lSecondaryCoolant"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00866}00866             \{ fSecondaryCoolantCubicVolume += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00867}00867         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00868}00868 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00869}00869         fPrimaryCoolantCoreCubicVolume = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00870}00870         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_volume ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00871}00871             \textcolor{keywordflow}{if}( (LVvol.first).substr(0,14) == \textcolor{stringliteral}{"{}lAssemblyCool\_"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00872}00872             \{ fPrimaryCoolantCoreCubicVolume += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00873}00873         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00874}00874 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00875}00875         fPrimaryCoolantCubicVolume = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00876}00876         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_volume ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00877}00877             \textcolor{keywordflow}{if} (   (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lreacvesI"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00878}00878                 || (LVvol.first).substr(0,14) == \textcolor{stringliteral}{"{}lCoreStructure"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00879}00879                 || (LVvol.first).substr(0,12) == \textcolor{stringliteral}{"{}lCoreQuarter"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00880}00880                 || (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lrefcool1"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00881}00881                 || (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lreftube2"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00882}00882                 || (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lblancool"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00883}00883                 || (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lrefcool2"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00884}00884                 || (LVvol.first).substr(0,17) == \textcolor{stringliteral}{"{}lMHDUnitContainer"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00885}00885                 || (LVvol.first).substr(0,8)  == \textcolor{stringliteral}{"{}lupflowI"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00886}00886                 || (LVvol.first).substr(0,8)  == \textcolor{stringliteral}{"{}lloflowI"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00887}00887             \{ fPrimaryCoolantCubicVolume += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00888}00888         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00889}00889 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00890}00890         std::cout << \textcolor{stringliteral}{"{}Primary coolant volume in Core             : "{}} << fPrimaryCoolantCoreCubicVolume << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00891}00891         std::cout << \textcolor{stringliteral}{"{}Primary coolant volume in reactor          : "{}} << fPrimaryCoolantCubicVolume     << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00892}00892         std::cout << \textcolor{stringliteral}{"{}Secondary coolant volume in heat exchanger : "{}} << fSecondaryCoolantCubicVolume   << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00893}00893         std::cout << \textcolor{stringliteral}{"{}Fuel volume in core                        : "{}} << fFuelUnionCubicVolume          << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00894}00894         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Blkt1 volume                        : "{}} << fFuelBlkt1CubicVolume          << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00895}00895         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel1 volume                        : "{}} << fFuel1CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00896}00896         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel2 volume                        : "{}} << fFuel2CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00897}00897         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel3 volume                        : "{}} << fFuel3CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00898}00898         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Grid2 volume                        : "{}} << fFuelGrid2CubicVolume          << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00899}00899         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel4 volume                        : "{}} << fFuel4CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00900}00900         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel5 volume                        : "{}} << fFuel5CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00901}00901         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel6 volume                        : "{}} << fFuel6CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00902}00902         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel7 volume                        : "{}} << fFuel7CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00903}00903         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel8 volume                        : "{}} << fFuel8CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00904}00904         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Grid3 volume                        : "{}} << fFuelGrid3CubicVolume          << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00905}00905         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel9 volume                        : "{}} << fFuel9CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00906}00906         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel10 volume                       : "{}} << fFuel10CubicVolume             << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00907}00907         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel11 volume                       : "{}} << fFuel11CubicVolume             << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00908}00908         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Blkt2 volume                        : "{}} << fFuelBlkt2CubicVolume          << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00909}00909         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Total                               : "{}} << fFuelBlkt1CubicVolume+fFuel1CubicVolume+fFuel2CubicVolume+fFuel3CubicVolume+fFuelGrid2CubicVolume+fFuel4CubicVolume+fFuel5CubicVolume+fFuel6CubicVolume+fFuel7CubicVolume+fFuel8CubicVolume+fFuelGrid3CubicVolume+fFuel9CubicVolume+fFuel10CubicVolume+fFuel11CubicVolume+fFuelBlkt2CubicVolume << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00910}00910         std::cout << \textcolor{stringliteral}{"{}Spallation target volume                   : "{}} << fSpallationTargetCubicVolume   << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00911}00911         std::cout << \textcolor{stringliteral}{"{}Incineration Blanket volume                : "{}} << fIncinerationCubicVolume       << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00912}00912         std::cout << \textcolor{stringliteral}{"{}Reactor outer vessel volume                : "{}} << fReactorOuterVesselCubicVolume << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00913}00913         std::cout << \textcolor{stringliteral}{"{}Reactor inner vessel volume                : "{}} << fReactorInnerVesselCubicVolume << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00914}00914 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00915}00915         \textcolor{comment}{// Mass Calculations}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00916}00916         G4double spallationTargetMass = fmap\_LV\_mass[GeomEAP80::getSpallationTargetName()];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00917}00917         G4double reactorOuterVesselMass = fmap\_LV\_mass[GeomEAP80::getReactorOuterVesselName()];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00918}00918         G4double reactorInnerVesselMass = fmap\_LV\_mass[GeomEAP80::getReactorInnerVesselName()];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00919}00919 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00920}00920         G4double fuelUnionMass = 0.;                              \textcolor{comment}{// Total volume of fuel in cm3}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00921}00921         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_mass ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00922}00922             \textcolor{keywordflow}{if}( (LVvol.first).substr(0,8) == \textcolor{stringliteral}{"{}lFuelMat"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00923}00923                 \{ fuelUnionMass += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00924}00924         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00925}00925 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00926}00926         G4double incinerationMass = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00927}00927         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_mass ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00928}00928             \textcolor{keywordflow}{if}( (LVvol.first).substr(0,8) == \textcolor{stringliteral}{"{}lIncBlkt"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00929}00929             \{ incinerationMass += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00930}00930         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00931}00931 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00932}00932         G4double secondaryCoolantMass = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00933}00933         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_mass ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00934}00934             \textcolor{keywordflow}{if}( (LVvol.first).substr(0,17) == \textcolor{stringliteral}{"{}lSecondaryCoolant"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00935}00935             \{ secondaryCoolantMass += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00936}00936         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00937}00937 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00938}00938         G4double primaryCoolantCoreMass = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00939}00939         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_mass ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00940}00940             \textcolor{keywordflow}{if}( (LVvol.first).substr(0,14) == \textcolor{stringliteral}{"{}lAssemblyCool\_"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00941}00941             \{ primaryCoolantCoreMass += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00942}00942         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00943}00943 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00944}00944         G4double primaryCoolantMass = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00945}00945         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_mass ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00946}00946             \textcolor{keywordflow}{if} (   (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lreacvesI"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00947}00947                 || (LVvol.first).substr(0,14) == \textcolor{stringliteral}{"{}lCoreStructure"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00948}00948                 || (LVvol.first).substr(0,12) == \textcolor{stringliteral}{"{}lCoreQuarter"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00949}00949                 || (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lrefcool1"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00950}00950                 || (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lreftube2"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00951}00951                 || (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lblancool"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00952}00952                 || (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lrefcool2"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00953}00953                 || (LVvol.first).substr(0,17) == \textcolor{stringliteral}{"{}lMHDUnitContainer"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00954}00954                 || (LVvol.first).substr(0,8)  == \textcolor{stringliteral}{"{}lupflowI"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00955}00955                 || (LVvol.first).substr(0,8)  == \textcolor{stringliteral}{"{}lloflowI"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00956}00956             \{ primaryCoolantMass += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00957}00957         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00958}00958 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00959}00959         std::cout << \textcolor{stringliteral}{"{}Primary coolant mass in Core             : "{}} << primaryCoolantCoreMass << \textcolor{stringliteral}{"{} g"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00960}00960         std::cout << \textcolor{stringliteral}{"{}Primary coolant mass in reactor          : "{}} << primaryCoolantMass     << \textcolor{stringliteral}{"{} g"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00961}00961         std::cout << \textcolor{stringliteral}{"{}Secondary coolant mass in heat exchanger : "{}} << secondaryCoolantMass   << \textcolor{stringliteral}{"{} g"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00962}00962         std::cout << \textcolor{stringliteral}{"{}Fuel mass in core                        : "{}} << fuelUnionMass          << \textcolor{stringliteral}{"{} g"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00963}00963         std::cout << \textcolor{stringliteral}{"{}Incineration Blanket mass                 : "{}} << incinerationMass       << \textcolor{stringliteral}{"{} g"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00964}00964         std::cout << \textcolor{stringliteral}{"{}Spallation target mass                   : "{}} << spallationTargetMass   << \textcolor{stringliteral}{"{} g"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00965}00965         std::cout << \textcolor{stringliteral}{"{}Reactor outer vessel mass                : "{}} << reactorOuterVesselMass << \textcolor{stringliteral}{"{} g"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00966}00966         std::cout << \textcolor{stringliteral}{"{}Reactor inner vessel mass                : "{}} << reactorInnerVesselMass << \textcolor{stringliteral}{"{} g"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00967}00967     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00968}00968 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00969}00969     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (p-\/>Geometry == 8) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00970}00970         \textcolor{comment}{// Volume Calculations}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00971}00971         \textcolor{comment}{//fSpallationTargetCubicVolume = fmap\_LV\_volume[GeomSVBR\_AKME::getSpallationTargetName()];}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00972}00972         fReactorOuterVesselCubicVolume = fmap\_LV\_volume[GeomSVBR\_AKME::getReactorOuterVesselName()];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00973}00973         fReactorInnerVesselCubicVolume = fmap\_LV\_volume[GeomSVBR\_AKME::getReactorInnerVesselName()];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00974}00974 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00975}00975         fFuelUnionCubicVolume = 0.;                              \textcolor{comment}{// Total volume of fuel in cm3}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00976}00976         \textcolor{keywordtype}{int} count = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00977}00977         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_volume ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00978}00978             \textcolor{keywordflow}{if}( (LVvol.first).substr(0,8) == \textcolor{stringliteral}{"{}lFuelMat"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00979}00979                 fFuelUnionCubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00980}00980                 count++;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00981}00981             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00982}00982             \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMatBlkt1"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00983}00983                 fFuelBlkt1CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00984}00984             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat1"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00985}00985                 fFuel1CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00986}00986             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat2"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00987}00987                 fFuel2CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00988}00988             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat3"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00989}00989                 fFuel3CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00990}00990             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMatGrid2"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00991}00991                 fFuelGrid2CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00992}00992             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat4"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00993}00993                 fFuel4CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00994}00994             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat5"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00995}00995                 fFuel5CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00996}00996             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat6"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00997}00997                 fFuel6CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00998}00998             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat7"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l00999}00999                 fFuel7CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01000}01000             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat8"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01001}01001                 fFuel8CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01002}01002             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMatGrid3"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01003}01003                 fFuelGrid3CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01004}01004             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat9"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01005}01005                 fFuel9CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01006}01006             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat10"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01007}01007                 fFuel10CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01008}01008             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMat11"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01009}01009                 fFuel11CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01010}01010             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( LVvol.first == \textcolor{stringliteral}{"{}lFuelMatBlkt2"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01011}01011                 fFuelBlkt2CubicVolume += LVvol.second;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01012}01012         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01013}01013         std::cout << \textcolor{stringliteral}{"{}Number of Physical Volume Fuel : "{}} << count << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01014}01014 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01015}01015         fIncinerationCubicVolume = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01016}01016         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_volume ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01017}01017             \textcolor{keywordflow}{if}( (LVvol.first).substr(0,8) == \textcolor{stringliteral}{"{}lIncBlkt"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01018}01018             \{ fIncinerationCubicVolume += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01019}01019         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01020}01020 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01021}01021         fSecondaryCoolantCubicVolume = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01022}01022         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_volume ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01023}01023             \textcolor{keywordflow}{if}( (LVvol.first).substr(0,17) == \textcolor{stringliteral}{"{}lSecondaryCoolant"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01024}01024             \{ fSecondaryCoolantCubicVolume += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01025}01025         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01026}01026 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01027}01027         fPrimaryCoolantCoreCubicVolume = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01028}01028         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_volume ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01029}01029             \textcolor{keywordflow}{if}( (LVvol.first).substr(0,14) == \textcolor{stringliteral}{"{}lAssemblyCool\_"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01030}01030             \{ fPrimaryCoolantCoreCubicVolume += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01031}01031         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01032}01032 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01033}01033         fPrimaryCoolantCubicVolume = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01034}01034         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_volume ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01035}01035             \textcolor{keywordflow}{if} (   (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lreacvesI"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01036}01036                 || (LVvol.first).substr(0,14) == \textcolor{stringliteral}{"{}lCoreStructure"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01037}01037                 || (LVvol.first).substr(0,12) == \textcolor{stringliteral}{"{}lCoreQuarter"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01038}01038                 || (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lrefcool1"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01039}01039                 || (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lreftube2"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01040}01040                 || (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lblancool"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01041}01041                 || (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lrefcool2"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01042}01042                 || (LVvol.first).substr(0,17) == \textcolor{stringliteral}{"{}lMHDUnitContainer"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01043}01043                 || (LVvol.first).substr(0,8)  == \textcolor{stringliteral}{"{}lupflowI"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01044}01044                 || (LVvol.first).substr(0,8)  == \textcolor{stringliteral}{"{}lloflowI"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01045}01045             \{ fPrimaryCoolantCubicVolume += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01046}01046         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01047}01047 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01048}01048         std::cout << \textcolor{stringliteral}{"{}Primary coolant volume in Core             : "{}} << fPrimaryCoolantCoreCubicVolume << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01049}01049         std::cout << \textcolor{stringliteral}{"{}Primary coolant volume in reactor          : "{}} << fPrimaryCoolantCubicVolume     << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01050}01050         std::cout << \textcolor{stringliteral}{"{}Secondary coolant volume in heat exchanger : "{}} << fSecondaryCoolantCubicVolume   << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01051}01051         std::cout << \textcolor{stringliteral}{"{}Fuel volume in core                        : "{}} << fFuelUnionCubicVolume          << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01052}01052         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Blkt1 volume                        : "{}} << fFuelBlkt1CubicVolume          << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01053}01053         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel1 volume                        : "{}} << fFuel1CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01054}01054         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel2 volume                        : "{}} << fFuel2CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01055}01055         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel3 volume                        : "{}} << fFuel3CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01056}01056         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Grid2 volume                        : "{}} << fFuelGrid2CubicVolume          << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01057}01057         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel4 volume                        : "{}} << fFuel4CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01058}01058         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel5 volume                        : "{}} << fFuel5CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01059}01059         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel6 volume                        : "{}} << fFuel6CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01060}01060         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel7 volume                        : "{}} << fFuel7CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01061}01061         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel8 volume                        : "{}} << fFuel8CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01062}01062         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Grid3 volume                        : "{}} << fFuelGrid3CubicVolume          << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01063}01063         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel9 volume                        : "{}} << fFuel9CubicVolume              << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01064}01064         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel10 volume                       : "{}} << fFuel10CubicVolume             << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01065}01065         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Fuel11 volume                       : "{}} << fFuel11CubicVolume             << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01066}01066         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Blkt2 volume                        : "{}} << fFuelBlkt2CubicVolume          << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01067}01067         std::cout << \textcolor{stringliteral}{"{}\(\backslash\)tFuel Total                               : "{}} << fFuelBlkt1CubicVolume+fFuel1CubicVolume+fFuel2CubicVolume+fFuel3CubicVolume+fFuelGrid2CubicVolume+fFuel4CubicVolume+fFuel5CubicVolume+fFuel6CubicVolume+fFuel7CubicVolume+fFuel8CubicVolume+fFuelGrid3CubicVolume+fFuel9CubicVolume+fFuel10CubicVolume+fFuel11CubicVolume+fFuelBlkt2CubicVolume << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01068}01068         \textcolor{comment}{// std::cout << "{}Spallation target volume                   : "{} << fSpallationTargetCubicVolume   << "{} cm\string^3"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01069}01069         std::cout << \textcolor{stringliteral}{"{}Incineration Blanket volume                : "{}} << fIncinerationCubicVolume       << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01070}01070         std::cout << \textcolor{stringliteral}{"{}Reactor outer vessel volume                : "{}} << fReactorOuterVesselCubicVolume << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01071}01071         std::cout << \textcolor{stringliteral}{"{}Reactor inner vessel volume                : "{}} << fReactorInnerVesselCubicVolume << \textcolor{stringliteral}{"{} cm\string^3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01072}01072 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01073}01073         \textcolor{comment}{// Mass Calculations}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01074}01074         \textcolor{comment}{// G4double spallationTargetMass = fmap\_LV\_mass[GeomSVBR\_AKME::getSpallationTargetName()];}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01075}01075         G4double reactorOuterVesselMass = fmap\_LV\_mass[GeomSVBR\_AKME::getReactorOuterVesselName()];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01076}01076         G4double reactorInnerVesselMass = fmap\_LV\_mass[GeomSVBR\_AKME::getReactorInnerVesselName()];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01077}01077 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01078}01078         G4double fuelUnionMass = 0.;                              \textcolor{comment}{// Total volume of fuel in cm3}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01079}01079         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_mass ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01080}01080             \textcolor{keywordflow}{if}( (LVvol.first).substr(0,8) == \textcolor{stringliteral}{"{}lFuelMat"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01081}01081                 \{ fuelUnionMass += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01082}01082         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01083}01083 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01084}01084         G4double incinerationMass = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01085}01085         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_mass ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01086}01086             \textcolor{keywordflow}{if}( (LVvol.first).substr(0,8) == \textcolor{stringliteral}{"{}lIncBlkt"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01087}01087             \{ incinerationMass += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01088}01088         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01089}01089 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01090}01090         G4double secondaryCoolantMass = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01091}01091         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_mass ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01092}01092             \textcolor{keywordflow}{if}( (LVvol.first).substr(0,17) == \textcolor{stringliteral}{"{}lSecondaryCoolant"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01093}01093             \{ secondaryCoolantMass += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01094}01094         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01095}01095 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01096}01096         G4double primaryCoolantCoreMass = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01097}01097         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_mass ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01098}01098             \textcolor{keywordflow}{if}( (LVvol.first).substr(0,14) == \textcolor{stringliteral}{"{}lAssemblyCool\_"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01099}01099             \{ primaryCoolantCoreMass += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01100}01100         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01101}01101 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01102}01102         G4double primaryCoolantMass = 0.;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01103}01103         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_mass ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01104}01104             \textcolor{keywordflow}{if} (   (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lreacvesI"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01105}01105                 || (LVvol.first).substr(0,14) == \textcolor{stringliteral}{"{}lCoreStructure"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01106}01106                 || (LVvol.first).substr(0,12) == \textcolor{stringliteral}{"{}lCoreQuarter"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01107}01107                 || (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lrefcool1"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01108}01108                 || (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lreftube2"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01109}01109                 || (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lblancool"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01110}01110                 || (LVvol.first).substr(0,9)  == \textcolor{stringliteral}{"{}lrefcool2"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01111}01111                 || (LVvol.first).substr(0,17) == \textcolor{stringliteral}{"{}lMHDUnitContainer"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01112}01112                 || (LVvol.first).substr(0,8)  == \textcolor{stringliteral}{"{}lupflowI"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01113}01113                 || (LVvol.first).substr(0,8)  == \textcolor{stringliteral}{"{}lloflowI"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01114}01114             \{ primaryCoolantMass += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01115}01115         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01116}01116 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01117}01117         std::cout << \textcolor{stringliteral}{"{}Primary coolant mass in Core             : "{}} << primaryCoolantCoreMass << \textcolor{stringliteral}{"{} g"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01118}01118         std::cout << \textcolor{stringliteral}{"{}Primary coolant mass in reactor          : "{}} << primaryCoolantMass     << \textcolor{stringliteral}{"{} g"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01119}01119         std::cout << \textcolor{stringliteral}{"{}Secondary coolant mass in heat exchanger : "{}} << secondaryCoolantMass   << \textcolor{stringliteral}{"{} g"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01120}01120         std::cout << \textcolor{stringliteral}{"{}Fuel mass in core                        : "{}} << fuelUnionMass          << \textcolor{stringliteral}{"{} g"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01121}01121         std::cout << \textcolor{stringliteral}{"{}Incineration Blanket mass                 : "{}} << incinerationMass       << \textcolor{stringliteral}{"{} g"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01122}01122         \textcolor{comment}{// std::cout << "{}Spallation target mass                   : "{} << spallationTargetMass   << "{} g"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01123}01123         std::cout << \textcolor{stringliteral}{"{}Reactor outer vessel mass                : "{}} << reactorOuterVesselMass << \textcolor{stringliteral}{"{} g"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01124}01124         std::cout << \textcolor{stringliteral}{"{}Reactor inner vessel mass                : "{}} << reactorInnerVesselMass << \textcolor{stringliteral}{"{} g"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01125}01125     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01126}01126     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (p-\/>Geometry == 10) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01127}01127         fTargetBeamWindowCubicVolume = 6175.26; \textcolor{comment}{// * cm3; // 819.7 * cm3; // for stretch beam window [-\/225; 370] mm // 6264.1 * cm3;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01128}01128         \textcolor{comment}{// std::cout << "{}fTargetBeamWindowCubicVolume ========================== "{} << fTargetBeamWindowCubicVolume << "{} cm3\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01129}01129         fTargetTubeCubicVolume = 15250.9; \textcolor{comment}{// * cm3; // 3.14159265 * 2.5 * 2.5 * 52.5 * cm3; // Approximate to the main coolant part}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01130}01130         fFuelUnionCubicVolume = 1022699.; \textcolor{comment}{// * cm3;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01131}01131     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01132}01132     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01133}01133 \textcolor{comment}{// // //         fTargetTubeCubicVolume = 0;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01134}01134 \textcolor{comment}{// // //         const std::vector<std::string>* targetTube = TMXAbstractTargetAssembly::getCladName();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01135}01135 \textcolor{comment}{// // //         for(size\_t i=0; i<targetTube-\/>size(); ++i) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01136}01136 \textcolor{comment}{// // //             G4LogicalVolume* logicTarget =  G4LogicalVolumeStore::GetInstance()-\/>GetVolume("{}l"{} + (*targetTube)[i] + "{}0"{},false);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01137}01137 \textcolor{comment}{// // //             if(logicTarget) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01138}01138 \textcolor{comment}{// // //                 fTargetTubeCubicVolume += logicTarget-\/>GetSolid()-\/>GetCubicVolume()/cm3;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01139}01139 \textcolor{comment}{// // //                 for(int j = 0; j < (int)logicTarget-\/>GetNoDaughters(); ++j) \{ fTargetTubeCubicVolume -\/= logicTarget-\/>GetDaughter(j)-\/>GetLogicalVolume()-\/>GetSolid()-\/>GetCubicVolume()/cm3; \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01140}01140 \textcolor{comment}{// // // //                 std::cout << "{}Target tube Volume : "{} << fTargetTubeCubicVolume << "{} cm\string^3"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01141}01141 \textcolor{comment}{// // //             \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01142}01142 \textcolor{comment}{// // //         \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01143}01143 \textcolor{comment}{// // //}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01144}01144 \textcolor{comment}{// // //         // Calculation of volumes in cm3}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01145}01145 \textcolor{comment}{// // //         fWaterInCoreCubicVolume = 0; // Water volume inside the core in cm3}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01146}01146 \textcolor{comment}{// // //         fLeadCubicVolume = 0;  // Lead volume outside B4C in the fast zone}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01147}01147 \textcolor{comment}{// // //         fN\_FastRods = 0; // Number of fast rods}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01148}01148 \textcolor{comment}{// // //         fFuelUnionCubicVolume = 0; // Total volume of fuel in cm3}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01149}01149 \textcolor{comment}{// // //         for(G4PhysicalVolumeStore::iterator physicalVolume=G4PhysicalVolumeStore::GetInstance()-\/>begin(); physicalVolume!=G4PhysicalVolumeStore::GetInstance()-\/>end(); physicalVolume++) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01150}01150 \textcolor{comment}{// // //             if(*physicalVolume \&\& (*physicalVolume)-\/>GetName() != "{}ScoringMeshPhys"{}) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01151}01151 \textcolor{comment}{// // // //                 std::cout << (*physicalVolume)-\/>GetName() << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01152}01152 \textcolor{comment}{// // //                 G4LogicalVolume* logicalVolume = (*physicalVolume)-\/>GetLogicalVolume();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01153}01153 \textcolor{comment}{// // //                 if(logicalVolume \&\& logicalVolume-\/>GetMaterial() \&\& logicalVolume-\/>GetMaterial()-\/>GetName() == "{}fuel\_Water"{}) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01154}01154 \textcolor{comment}{// // //                     fWaterInCoreCubicVolume += logicalVolume-\/>GetSolid()-\/>GetCubicVolume()/cm3;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01155}01155 \textcolor{comment}{// // //                     for(size\_t i = 0; i < logicalVolume-\/>GetNoDaughters(); ++i)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01156}01156 \textcolor{comment}{// // //                         fWaterInCoreCubicVolume -\/= logicalVolume-\/>GetDaughter(i)-\/>GetLogicalVolume()-\/>GetSolid()-\/>GetCubicVolume()/cm3;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01157}01157 \textcolor{comment}{// // //                 \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01158}01158 \textcolor{comment}{// // //}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01159}01159 \textcolor{comment}{// // //                 if(logicalVolume \&\& logicalVolume-\/>GetName() == "{}lWaterFastZone"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01160}01160 \textcolor{comment}{// // //                     ++fN\_FastRods;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01161}01161 \textcolor{comment}{// // //                 if(logicalVolume \&\& logicalVolume-\/>GetName() == "{}lFastZone"{}) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01162}01162 \textcolor{comment}{// // //                     fLeadCubicVolume += logicalVolume-\/>GetSolid()-\/>GetCubicVolume()/cm3;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01163}01163 \textcolor{comment}{// // //                     for(size\_t i = 0; i < logicalVolume-\/>GetNoDaughters(); ++i)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01164}01164 \textcolor{comment}{// // //                         fLeadCubicVolume -\/= logicalVolume-\/>GetDaughter(i)-\/>GetLogicalVolume()-\/>GetSolid()-\/>GetCubicVolume()/cm3;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01165}01165 \textcolor{comment}{// // //                 \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01166}01166 \textcolor{comment}{// // //}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01167}01167 \textcolor{comment}{// // //                 if(logicalVolume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01168}01168 \textcolor{comment}{// // //                     \&\& ( (logicalVolume-\/>GetName()).substr(0,7) == "{}lFuel8T"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01169}01169 \textcolor{comment}{// // //                       || (logicalVolume-\/>GetName()).substr(0,7) == "{}lTubeFuel8T"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01170}01170 \textcolor{comment}{// // //                       || (logicalVolume-\/>GetName()).substr(0,7) == "{}lFuel6T"{})) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01171}01171 \textcolor{comment}{// // //                     fFuelUnionCubicVolume += logicalVolume-\/>GetSolid()-\/>GetCubicVolume()/cm3;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01172}01172 \textcolor{comment}{// // //                 \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01173}01173 \textcolor{comment}{// // //             \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01174}01174 \textcolor{comment}{// // //         \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01175}01175 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01176}01176 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01177}01177         fTargetTubeCubicVolume = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01178}01178 \textcolor{comment}{//         std::vector<std::string> TargetLVs = *TMXAbstractTargetAssembly::getCladName();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01179}01179 \textcolor{comment}{//         TargetLVs.insert(TargetLVs.end(), TMXAbstractTargetAssembly::getCoolantName()-\/>begin(),}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01180}01180 \textcolor{comment}{//                                           TMXAbstractTargetAssembly::getCoolantName()-\/>end());}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01181}01181 \textcolor{comment}{//         TargetLVs.insert(TargetLVs.end(), TMXAbstractTargetAssembly::getTargetName()-\/>begin(),}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01182}01182 \textcolor{comment}{//                                           TMXAbstractTargetAssembly::getTargetName()-\/>end());}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01183}01183 \textcolor{comment}{//         for(size\_t i=0; i<TargetLVs.size(); ++i) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01184}01184 \textcolor{comment}{//             fTargetTubeCubicVolume +=fmap\_LV\_volume["{}l"{} + TargetLVs[i] + "{}0"{}];}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01185}01185 \textcolor{comment}{//         \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01186}01186         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=14; i<=23; ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01187}01187             fTargetTubeCubicVolume += fmap\_Region\_volume[i];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01188}01188         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01189}01189 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01190}01190         fLeadCubicVolume = fmap\_LV\_volume[\textcolor{stringliteral}{"{}Carrier\_B4C"{}}]; \textcolor{comment}{// Lead volume outside B4C in the fast zone}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01191}01191         \textcolor{comment}{// "{}Al\_capsule"{} -\/> B4C to absorb thermal neutrons}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01192}01192         std::vector<std::string> FastAlCapsuleVolumes \{ \textcolor{stringliteral}{"{}AlCarrier0"{}}, \textcolor{stringliteral}{"{}AlCarrier1"{}}, \textcolor{stringliteral}{"{}AlCarrier2"{}}, \textcolor{stringliteral}{"{}AlCarrier3"{}}\};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01193}01193         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<FastAlCapsuleVolumes.size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01194}01194             fLeadCubicVolume += fmap\_LV\_volume[FastAlCapsuleVolumes[i]];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01195}01195         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01196}01196 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01197}01197 \textcolor{comment}{//         fLeadCubicVolume = fmap\_LV\_volume["{}lFastZone"{}]; // Lead volume outside B4C in the fast zone}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01198}01198         fWaterInCoreCubicVolume = fmap\_mat\_volume[\textcolor{stringliteral}{"{}fuel\_Water"{}}]; \textcolor{comment}{// Water volume inside the core in cm3}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01199}01199         fFuelUnionCubicVolume = 0;                              \textcolor{comment}{// Total volume of fuel in cm3}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01200}01200         \textcolor{keywordflow}{for}( \textcolor{keyword}{const} \textcolor{keyword}{auto}\& LVvol : fmap\_LV\_volume ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01201}01201             \textcolor{keywordflow}{if}( (LVvol.first).substr(0,7) == \textcolor{stringliteral}{"{}lFuel8T"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01202}01202              || (LVvol.first).substr(0,7) == \textcolor{stringliteral}{"{}lTubeFuel8T"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01203}01203              || (LVvol.first).substr(0,7) == \textcolor{stringliteral}{"{}lFuel6T"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01204}01204             \{ fFuelUnionCubicVolume += LVvol.second; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01205}01205         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01206}01206 \textcolor{comment}{//         std::cout << "{}Number of fast rods     : "{} << fN\_FastRods << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01207}01207 \textcolor{comment}{//         std::cout << "{}Lead volume in fast zone: "{} << fLeadCubicVolume << "{} cm\string^3"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01208}01208 \textcolor{comment}{//         std::cout << "{}Water in core volume    : "{} << fWaterInCoreCubicVolume << "{} cm\string^3"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01209}01209 \textcolor{comment}{//         std::cout << "{}Fuel  in core volume    : "{} << fFuelUnionCubicVolume << "{} cm\string^3"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01210}01210     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01211}01211 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01212}01212 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01213}01213 \textcolor{comment}{// Fill histograms of which energy distribution of the neutron flux (with volumic dependencies)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01214}01214 \textcolor{keywordtype}{void} SteppingAction::FillHistoTimeEnergyFlux(\textcolor{keyword}{const} G4Step* theStep, \textcolor{keywordtype}{bool} BoundaryStatus, G4int nNeutrons) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01215}01215     \textcolor{keyword}{auto} analysisManager = G4AnalysisManager::Instance();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01216}01216     \textcolor{comment}{// Get required quantites from the step}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01217}01217     G4double energyK = KineticEnergy\_eV(theStep); \textcolor{comment}{// Kinetic energy in eV}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01218}01218     G4double StepLength        = theStep-\/>GetStepLength()/cm; \textcolor{comment}{// Length of the step in cm}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01219}01219     G4double PostGlobalTime    = theStep-\/>GetPostStepPoint()-\/>GetGlobalTime()/s; \textcolor{comment}{// Time since the event is created}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01220}01220     G4String processName = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01221}01221     \textcolor{keywordflow}{if}(theStep-\/>GetPostStepPoint()-\/>GetProcessDefinedStep())}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01222}01222         processName = theStep-\/>GetPostStepPoint()-\/>GetProcessDefinedStep()-\/>GetProcessName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01223}01223 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01224}01224     \textcolor{keywordflow}{if} (p-\/>Geometry == 7 || p-\/>Geometry == 8) \{ \textcolor{comment}{// temporary solution for the SVBR AKME}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01225}01225         \textcolor{keywordflow}{if} (IsTargetRegion(fPhysicalVolumeNumber)) \textcolor{comment}{// target}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01226}01226         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01227}01227             \textcolor{keywordflow}{if}( BoundaryStatus )  \textcolor{comment}{// On a surface}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01228}01228                 analysisManager-\/>FillH2(12, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01229}01229             \textcolor{keywordflow}{else} \textcolor{comment}{// for interactions only}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01230}01230                 analysisManager-\/>FillH2(16, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01231}01231 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01232}01232             \textcolor{keywordflow}{if}(IsTarget(fPhysicalVolumeNumber)) \textcolor{comment}{// fluence spectrum in target except target tube}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01233}01233                 analysisManager-\/>FillH1(13, log10(energyK), StepLength/fSpallationTargetCubicVolume);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01234}01234         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01235}01235         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (IsLeadRegion(fPhysicalVolumeNumber))  \textcolor{comment}{// Lead}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01236}01236         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01237}01237             \textcolor{comment}{// Angular Distribution (in cos)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01238}01238             \textcolor{comment}{/*if (theStep \&\& theStep-\/>GetPostStepPoint()) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01239}01239 \textcolor{comment}{                const G4Isotope* target = GetTargetIsotope(theStep-\/>GetPostStepPoint());}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01240}01240 \textcolor{comment}{                if (target) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01241}01241 \textcolor{comment}{                    if (target \&\& (target-\/>GetName() == "{}BI-\/209-\/0"{})) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01242}01242 \textcolor{comment}{                        analysisManager-\/>FillH1(46, theStep-\/>GetPostStepPoint()-\/>GetMomentumDirection().dot(theStep-\/>GetPreStepPoint()-\/>GetMomentumDirection()), 1);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01243}01243 \textcolor{comment}{                    \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01244}01244 \textcolor{comment}{                \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01245}01245 \textcolor{comment}{            \}*/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01246}01246 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01247}01247             \textcolor{keywordflow}{if} ( BoundaryStatus )  \textcolor{comment}{// On a surface}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01248}01248                 analysisManager-\/>FillH2(14, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01249}01249             \textcolor{keywordflow}{else} \textcolor{comment}{// for interactions only}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01250}01250                 analysisManager-\/>FillH2(18, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01251}01251 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01252}01252             \textcolor{comment}{// fluence spectrum in lead}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01253}01253             \textcolor{keywordflow}{if} (IsLead(fPhysicalVolumeNumber)) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01254}01254                 analysisManager-\/>FillH1(2, log10(energyK), StepLength/fPrimaryCoolantCoreCubicVolume);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01255}01255             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01256}01256 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01257}01257             \textcolor{keywordflow}{if} (fPhysicalVolumeNumber >= 50) \{  \textcolor{comment}{// fluence spectrum at different radius in lead}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01258}01258                 analysisManager-\/>FillH1(3 + fPhysicalVolumeNumber-\/50, log10(energyK), StepLength/fPrimaryCoolantCubicVolume);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01259}01259             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01260}01260         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01261}01261         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (IsFuel(fPhysicalVolumeNumber))  \textcolor{comment}{// Fuel}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01262}01262         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01263}01263             \textcolor{keywordflow}{if} ( BoundaryStatus )  \textcolor{comment}{// On a surface}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01264}01264                 analysisManager-\/>FillH2(15, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01265}01265             \textcolor{keywordflow}{else} \textcolor{comment}{// for interactions only}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01266}01266                 analysisManager-\/>FillH2(19, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01267}01267 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01268}01268             \textcolor{comment}{// fluence spectrum in fuel}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01269}01269             analysisManager-\/>FillH1(8, log10(energyK), StepLength/fFuelUnionCubicVolume);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01270}01270 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01271}01271             \textcolor{comment}{/* // use scoring in param}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01272}01272 \textcolor{comment}{            if (fPrePhysicalVolumeName == "{}pFuelMatBlkt1"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01273}01273 \textcolor{comment}{                analysisManager-\/>FillH1(30, log10(energyK), StepLength/fFuelBlkt1CubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01274}01274 \textcolor{comment}{            else if (fPrePhysicalVolumeName == "{}pFuelMat1"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01275}01275 \textcolor{comment}{                analysisManager-\/>FillH1(31, log10(energyK), StepLength/fFuel1CubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01276}01276 \textcolor{comment}{            else if (fPrePhysicalVolumeName == "{}pFuelMat2"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01277}01277 \textcolor{comment}{                analysisManager-\/>FillH1(32, log10(energyK), StepLength/fFuel2CubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01278}01278 \textcolor{comment}{            else if (fPrePhysicalVolumeName == "{}pFuelMat3"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01279}01279 \textcolor{comment}{                analysisManager-\/>FillH1(33, log10(energyK), StepLength/fFuel3CubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01280}01280 \textcolor{comment}{            else if (fPrePhysicalVolumeName == "{}pFuelMatGrid2"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01281}01281 \textcolor{comment}{                analysisManager-\/>FillH1(34, log10(energyK), StepLength/fFuelGrid2CubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01282}01282 \textcolor{comment}{            else if (fPrePhysicalVolumeName == "{}pFuelMat4"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01283}01283 \textcolor{comment}{                analysisManager-\/>FillH1(35, log10(energyK), StepLength/fFuel4CubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01284}01284 \textcolor{comment}{            else if (fPrePhysicalVolumeName == "{}pFuelMat5"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01285}01285 \textcolor{comment}{                analysisManager-\/>FillH1(36, log10(energyK), StepLength/fFuel5CubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01286}01286 \textcolor{comment}{            else if (fPrePhysicalVolumeName == "{}pFuelMat6"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01287}01287 \textcolor{comment}{                analysisManager-\/>FillH1(37, log10(energyK), StepLength/fFuel6CubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01288}01288 \textcolor{comment}{            else if (fPrePhysicalVolumeName == "{}pFuelMat7"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01289}01289 \textcolor{comment}{                analysisManager-\/>FillH1(38, log10(energyK), StepLength/fFuel7CubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01290}01290 \textcolor{comment}{            else if (fPrePhysicalVolumeName == "{}pFuelMat8"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01291}01291 \textcolor{comment}{                analysisManager-\/>FillH1(39, log10(energyK), StepLength/fFuel8CubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01292}01292 \textcolor{comment}{            else if (fPrePhysicalVolumeName == "{}pFuelMatGrid3"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01293}01293 \textcolor{comment}{                analysisManager-\/>FillH1(40, log10(energyK), StepLength/fFuelGrid3CubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01294}01294 \textcolor{comment}{            else if (fPrePhysicalVolumeName == "{}pFuelMat9"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01295}01295 \textcolor{comment}{                analysisManager-\/>FillH1(41, log10(energyK), StepLength/fFuel9CubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01296}01296 \textcolor{comment}{            else if (fPrePhysicalVolumeName == "{}pFuelMat10"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01297}01297 \textcolor{comment}{                analysisManager-\/>FillH1(42, log10(energyK), StepLength/fFuel10CubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01298}01298 \textcolor{comment}{            else if (fPrePhysicalVolumeName == "{}pFuelMat11"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01299}01299 \textcolor{comment}{                analysisManager-\/>FillH1(43, log10(energyK), StepLength/fFuel11CubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01300}01300 \textcolor{comment}{            else if (fPrePhysicalVolumeName == "{}pFuelMatBlkt2"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01301}01301 \textcolor{comment}{                analysisManager-\/>FillH1(44, log10(energyK), StepLength/fFuelBlkt2CubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01302}01302 \textcolor{comment}{            */}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01303}01303             \textcolor{keywordflow}{if} (processName==\textcolor{stringliteral}{"{}nFission"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01304}01304                 \textcolor{comment}{// Energy spectrum in fuel for fissions}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01305}01305                 analysisManager-\/>FillH1(9, log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01306}01306 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01307}01307                 \textcolor{comment}{// Time for fissions from N0}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01308}01308                 \textcolor{keywordflow}{if} (fNeutronGeneration == 0)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01309}01309                     analysisManager-\/>FillH1(12, log10(PostGlobalTime));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01310}01310 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01311}01311                 analysisManager-\/>FillH1(14, log10(PostGlobalTime)); \textcolor{comment}{// Time for every fissions}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01312}01312             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01313}01313         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01314}01314         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (IsInReactorVes(fPhysicalVolumeNumber)) \textcolor{comment}{// Inner Reactor Vessel}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01315}01315         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01316}01316             \textcolor{keywordflow}{if}( BoundaryStatus )  \textcolor{comment}{// On a surface}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01317}01317                 analysisManager-\/>FillH2(41, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01318}01318             \textcolor{keywordflow}{else} \textcolor{comment}{// for interactions only}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01319}01319                 analysisManager-\/>FillH2(42, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01320}01320 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01321}01321             \textcolor{comment}{// use scoring in param analysisManager-\/>FillH1(28, log10(energyK), StepLength/fReactorInnerVesselCubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01322}01322         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01323}01323         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (IsSecondCoolant(fPhysicalVolumeNumber)) \textcolor{comment}{// Secondary Coolant in Heat Exchangers}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01324}01324         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01325}01325             \textcolor{keywordflow}{if}( BoundaryStatus )  \textcolor{comment}{// On a surface}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01326}01326                 analysisManager-\/>FillH2(43, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01327}01327             \textcolor{keywordflow}{else} \textcolor{comment}{// for interactions only}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01328}01328                 analysisManager-\/>FillH2(44, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01329}01329 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01330}01330             \textcolor{comment}{// use scoring in param analysisManager-\/>FillH1(29, log10(energyK), StepLength/fSecondaryCoolantCubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01331}01331         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01332}01332         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (IsIncineration(fPhysicalVolumeNumber)) \textcolor{comment}{// Incineration Blanket}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01333}01333         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01334}01334             \textcolor{comment}{// use param file analysisManager-\/>FillH1(47, log10(energyK), StepLength/fIncinerationCubicVolume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01335}01335         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01336}01336     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01337}01337     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01338}01338         \textcolor{keywordflow}{if}( IsTargetRegion(fPhysicalVolumeNumber) ) \textcolor{comment}{// target}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01339}01339         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01340}01340             \textcolor{keywordflow}{if}( BoundaryStatus )  \textcolor{comment}{// On a surface}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01341}01341                 analysisManager-\/>FillH2(12, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01342}01342             \textcolor{keywordflow}{else} \textcolor{comment}{// for interactions only}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01343}01343                 analysisManager-\/>FillH2(16, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01344}01344 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01345}01345             \textcolor{keywordflow}{if}(IsTarget(fPhysicalVolumeNumber)) \{\textcolor{comment}{// fluence spectrum in target except target tube}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01346}01346                 analysisManager-\/>FillH1(13, log10(energyK), StepLength/fTargetTubeCubicVolume);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01347}01347                 \textcolor{comment}{// std::cout << "{}Score Base "{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01348}01348                 \textcolor{comment}{//             << theStep-\/>GetTrack()-\/>GetParticleDefinition()-\/>GetParticleName() << "{} "{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01349}01349                 \textcolor{comment}{//             << theStep-\/>GetPreStepPoint()-\/>GetPhysicalVolume()-\/>GetName()}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01350}01350                 \textcolor{comment}{//             << "{}\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01351}01351             \} \textcolor{comment}{//       analysisManager-\/>FillH1(13, log10(energyK), StepLength/fmap\_Region\_volume[fPhysicalVolumeNumber]);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01352}01352 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01353}01353             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (IsBeamWindow(fPhysicalVolumeNumber)) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01354}01354                 analysisManager-\/>FillH1(\textcolor{comment}{/*57*/}29, log10(energyK), StepLength/fTargetBeamWindowCubicVolume);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01355}01355             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01356}01356 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01357}01357         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01358}01358         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (p-\/>Geometry != 1 \&\& IsHeatShieldRegion(fPhysicalVolumeNumber))}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01359}01359             || (p-\/>Geometry == 1 \&\& IsBeamWindow(fPhysicalVolumeNumber))) \textcolor{comment}{// Reflector + iron Top}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01360}01360         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01361}01361             \textcolor{keywordflow}{if}( BoundaryStatus )  \textcolor{comment}{// On a surface}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01362}01362                 analysisManager-\/>FillH2(13, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01363}01363             \textcolor{keywordflow}{else} \textcolor{comment}{// for interactions only}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01364}01364                 analysisManager-\/>FillH2(17, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01365}01365 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01366}01366             \textcolor{comment}{// fluence spectrum in water-\/cooled heat shield}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01367}01367             analysisManager-\/>FillH1(10, log10(energyK), StepLength/fmap\_Region\_volume[fPhysicalVolumeNumber]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01368}01368         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01369}01369         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(IsReflector(fPhysicalVolumeNumber))  \textcolor{comment}{// Lead}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01370}01370         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01371}01371              \textcolor{comment}{// fluence spectrum in reflector}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01372}01372             \textcolor{comment}{// use scoring in param analysisManager-\/>FillH1(45, log10(energyK), StepLength/fmap\_Region\_volume[fPhysicalVolumeNumber]);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01373}01373 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01374}01374         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01375}01375         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(IsLeadRegion(fPhysicalVolumeNumber))  \textcolor{comment}{// Lead}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01376}01376         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01377}01377             \textcolor{keywordflow}{if}( BoundaryStatus )  \textcolor{comment}{// On a surface}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01378}01378                 analysisManager-\/>FillH2(14, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01379}01379             \textcolor{keywordflow}{else} \textcolor{comment}{// for interactions only}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01380}01380                 analysisManager-\/>FillH2(18, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01381}01381 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01382}01382             \textcolor{comment}{// fluence spectrum in lead}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01383}01383             \textcolor{keywordflow}{if}(IsLead(fPhysicalVolumeNumber)) \{analysisManager-\/>FillH1(2, log10(energyK), StepLength/fmap\_Region\_volume[fPhysicalVolumeNumber]);\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01384}01384 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01385}01385             \textcolor{keywordflow}{if}(IsSamplesInLead(fPhysicalVolumeNumber)) \{  \textcolor{comment}{// fluence spectrum at different radius in lead}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01386}01386                 analysisManager-\/>FillH1(3 + fPhysicalVolumeNumber-\/50, log10(energyK), StepLength/ fmap\_Region\_volume[fPhysicalVolumeNumber]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01387}01387             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01388}01388         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01389}01389         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(IsFuel(fPhysicalVolumeNumber))  \textcolor{comment}{// Fuel}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01390}01390         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01391}01391             \textcolor{keywordflow}{if}( BoundaryStatus )  \textcolor{comment}{// On a surface}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01392}01392                 analysisManager-\/>FillH2(15, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01393}01393             \textcolor{keywordflow}{else} \textcolor{comment}{// for interactions only}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01394}01394                 analysisManager-\/>FillH2(19, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01395}01395 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01396}01396             \textcolor{comment}{// fluence spectrum in fuel}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01397}01397             analysisManager-\/>FillH1(8, log10(energyK), StepLength/fmap\_Region\_volume[fPhysicalVolumeNumber]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01398}01398 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01399}01399             \textcolor{keywordflow}{if} (processName==\textcolor{stringliteral}{"{}nFission"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01400}01400                 \textcolor{comment}{// Energy spectrum in fuel for fissions}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01401}01401                 analysisManager-\/>FillH1(9, log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01402}01402 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01403}01403                 \textcolor{comment}{// Time for fissions from N0}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01404}01404                 \textcolor{keywordflow}{if}(fNeutronGeneration == 0)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01405}01405                     analysisManager-\/>FillH1(12, log10(PostGlobalTime));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01406}01406 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01407}01407                 analysisManager-\/>FillH1(14, log10(PostGlobalTime)); \textcolor{comment}{// Time for every fissions}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01408}01408             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01409}01409         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01410}01410         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(IsWaterCoreRegion(fPhysicalVolumeNumber))  \textcolor{comment}{// Water in core acting as the moderator}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01411}01411         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01412}01412             \textcolor{keywordflow}{if}( BoundaryStatus )  \textcolor{comment}{// On a surface}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01413}01413                 analysisManager-\/>FillH2(39, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01414}01414             \textcolor{keywordflow}{else} \textcolor{comment}{// for interactions only}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01415}01415                 analysisManager-\/>FillH2(40, log10(PostGlobalTime), log10(energyK));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01416}01416 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01417}01417             \textcolor{comment}{// fluence spectrum in water}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01418}01418             analysisManager-\/>FillH1(26, log10(energyK), StepLength/fmap\_Region\_volume[fPhysicalVolumeNumber]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01419}01419         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01420}01420         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(IsSpentFuel(fPhysicalVolumeNumber))  \textcolor{comment}{// Spent fuel samples to be transmuted}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01421}01421         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01422}01422             \textcolor{comment}{// fluence spectrum in fuel sample to transmute}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01423}01423             analysisManager-\/>FillH1(27, log10(energyK), StepLength/fmap\_Region\_volume[fPhysicalVolumeNumber]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01424}01424         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01425}01425         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(IsNeutronAbsorber(fPhysicalVolumeNumber) \&\& fNeutronGeneration == 0 \&\& (processName==\textcolor{stringliteral}{"{}nCapture"{}} || (processName==\textcolor{stringliteral}{"{}neutronInelastic"{}} \&\& nNeutrons==0)))  \{ \textcolor{comment}{// Energy spectrum for absorption of spallation neutrons in Neutron absorber}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01426}01426             analysisManager-\/>FillH2(21, log10(energyK), log10(StepLength/fmap\_Region\_volume[fPhysicalVolumeNumber]));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01427}01427             ++fN0Absorber;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01428}01428             fEventAction-\/>SetN0Abs(fN0Absorber);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01429}01429         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01430}01430 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01431}01431         \textcolor{keywordflow}{if}(IsNeutronAbsorber(fPhysicalVolumeNumber) \&\& (processName==\textcolor{stringliteral}{"{}nCapture"{}} || (processName==\textcolor{stringliteral}{"{}neutronInelastic"{}} \&\& nNeutrons==0))) \textcolor{comment}{// Energy spectrum for absorption in Neutron absorber}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01432}01432             analysisManager-\/>FillH2(20, log10(energyK), log10(StepLength/fmap\_Region\_volume[fPhysicalVolumeNumber]));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01433}01433 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01434}01434         \textcolor{keywordflow}{if}((processName==\textcolor{stringliteral}{"{}nCapture"{}} || (processName==\textcolor{stringliteral}{"{}neutronInelastic"{}} \&\& nNeutrons==0) || processName==\textcolor{stringliteral}{"{}nFission"{}}) \&\& fPromptN) \textcolor{comment}{// Prompt neutron absorption -\/> Calculation of prompt neutron lifetime}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01435}01435             analysisManager-\/>FillH1(19, log10(PostGlobalTime -\/ fBirthTime));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01436}01436 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01437}01437         \textcolor{keywordflow}{if}( processName==\textcolor{stringliteral}{"{}nCapture"{}} || (processName==\textcolor{stringliteral}{"{}neutronInelastic"{}} \&\& nNeutrons==0) || processName==\textcolor{stringliteral}{"{}nFission"{}}) \textcolor{comment}{// Neutron absorption -\/> Calculation of neutron lifetime}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01438}01438             analysisManager-\/>FillH1(20, log10(PostGlobalTime -\/ fBirthTime));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01439}01439     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01440}01440 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01441}01441 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01442}01442 \textcolor{comment}{// The mesh which is used for keff calculations is hard-\/coded and the scoring of fission must be adapted to this mesh}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01443}01443 \textcolor{keywordtype}{void} SteppingAction::keff\_Mesh\_scoring(\textcolor{keyword}{const} G4Step* theStep) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01444}01444     G4String processName = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01445}01445     \textcolor{keywordflow}{if}(theStep-\/>GetPostStepPoint()-\/>GetProcessDefinedStep()) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01446}01446         processName = theStep-\/>GetPostStepPoint()-\/>GetProcessDefinedStep()-\/>GetProcessName();\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01447}01447     \textcolor{keywordflow}{if}(processName==\textcolor{stringliteral}{"{}nFission"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01448}01448         \textcolor{keywordflow}{if} (TMXOption::IsKeffCalculation(p-\/>int\_Option)) \{  \textcolor{comment}{// In case of keff calculation, update the 3D space distribution with the position of fission}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01449}01449             G4ThreeVector PostPos = theStep-\/>GetPostStepPoint()-\/>GetPosition();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01450}01450             \textcolor{keywordflow}{if}(p-\/>Geometry == 0) \{ \textcolor{comment}{// Troïtsk}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01451}01451                 \textcolor{keywordtype}{double} radius = sqrt(PostPos.x()/mm * PostPos.x()/mm + PostPos.y()/mm*PostPos.y()/mm);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01452}01452                 \textcolor{keywordtype}{double} theta = std::acos(PostPos.x()/mm / radius);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01453}01453                 \textcolor{keywordflow}{if}(PostPos.y() < 0) \{theta = twopi -\/ theta;\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01454}01454                 fEventAction-\/>AddWeight(radius*radius, theta, fTargetZdistanceToBottom -\/ fh0 + PostPos.z()/mm);  \textcolor{comment}{// RandomDistribution}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01455}01455             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01456}01456             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(p-\/>Geometry == 1) \{ \textcolor{comment}{// CVR-\/Rez}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01457}01457                 fEventAction-\/>AddWeight(PostPos.x()/mm, PostPos.y()/mm, PostPos.z()/mm);  \textcolor{comment}{// RandomDistribution}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01458}01458             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01459}01459             \textcolor{keywordflow}{else} \{ \textcolor{comment}{// Default is polar mesh}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01460}01460                 \textcolor{keywordtype}{double} radius = sqrt(PostPos.x()/mm * PostPos.x()/mm + PostPos.y()/mm*PostPos.y()/mm);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01461}01461                 \textcolor{keywordtype}{double} theta = std::acos(PostPos.x()/mm / radius);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01462}01462                 \textcolor{keywordflow}{if}(PostPos.y() < 0) \{theta = twopi -\/ theta;\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01463}01463                 fEventAction-\/>AddWeight(radius*radius, theta, PostPos.z()/mm);  \textcolor{comment}{// RandomDistribution}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01464}01464             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01465}01465         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01466}01466     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01467}01467 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01468}01468 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01491}01491 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01492}01492 \textcolor{comment}{// SteppingAction tools}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01493}01493 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01508}01508 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01509}01509 \textcolor{comment}{// Initialize every data members of this class}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01510}01510 \textcolor{keywordtype}{void} SteppingAction::Initialize(\mbox{\hyperlink{class_event_action}{EventAction}}* eventAction, \mbox{\hyperlink{class_run_action}{RunAction}}* runAction, \mbox{\hyperlink{class_t_m_x_input_parameters}{TMXInputParameters}}\& parameter) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01511}01511 \textcolor{comment}{//     std::cout << "{}-\/-\/-\/-\/ Begin of SteppingAction Initialization -\/-\/-\/-\/-\/"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01512}01512 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01513}01513   fGenerationCounter = \textcolor{keyword}{new} \mbox{\hyperlink{class_t_m_x_neutron_generation_counting}{TMXNeutronGenerationCounting}}(runAction, eventAction, \&parameter);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01514}01514   fEventAction = eventAction;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01515}01515   fRunAction = runAction;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01516}01516   fRunNumber= fEventAction-\/>GetRunNumber();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01517}01517   fNeutronGeneration = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01518}01518   fIsSourceNeutron = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01519}01519 \textcolor{comment}{//   fNeutronGeneration = -\/1;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01520}01520 \textcolor{comment}{//   fIsSourceNeutron = false;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01521}01521   v\_NeutronGeneration.clear();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01522}01522   N0 = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01523}01523   Nf = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01524}01524   Nfission = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01525}01525   Nnfission = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01526}01526   fN0Absorber = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01527}01527   fTargetZdistanceToBottom = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01528}01528   fh0 = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01529}01529   fEnergyAtBirth = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01530}01530   fPosAtBirth = G4ThreeVector(0,0,0);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01531}01531   fBirthTime = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01532}01532   fPromptN = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01533}01533   f\_tBin = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01534}01534   p = \&parameter;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01535}01535   fFromFission = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01536}01536   fID\_firstfission = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01537}01537   fEperFission = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01538}01538   fProcessElas = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01539}01539   fProcessInel = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01540}01540   fProcessCap = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01541}01541   fProcessFis = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01542}01542   fLengthBetweenCollision = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01543}01543   fN\_FastRods = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01544}01544   fPostPhysicalVolumeNumber = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01545}01545   fPrePhysicalVolumeNumber = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01546}01546   fPhysicalVolumeNumber = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01547}01547 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01548}01548     \textcolor{comment}{// Definition of region ID associated to physical volumes}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01549}01549     Initialize\_userDefinedRegions();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01550}01550 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01551}01551     \textcolor{comment}{// Calculation of volumes in cm3}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01552}01552     \textcolor{comment}{// To be called after the definition of regions}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01553}01553     fmap\_LV\_volume.clear();     \textcolor{comment}{// clear the map at initialization}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01554}01554     fmap\_mat\_volume.clear();    \textcolor{comment}{// clear the map at initialization}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01555}01555     fmap\_Region\_volume.clear(); \textcolor{comment}{// clear the map at initialization}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01556}01556     RecursiveVolumeCalculation((*G4PhysicalVolumeStore::GetInstance())[0]); \textcolor{comment}{// First physical volume of the G4PhysicalVolumeStore is the universe}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01557}01557     fmap\_LV\_mass.clear();     \textcolor{comment}{// clear the map at initialization}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01558}01558     fmap\_mat\_mass.clear();    \textcolor{comment}{// clear the map at initialization}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01559}01559     fmap\_Region\_mass.clear(); \textcolor{comment}{// clear the map at initialization}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01560}01560     RecursiveMassCalculation((*G4PhysicalVolumeStore::GetInstance())[0]); \textcolor{comment}{// First physical volume of the G4PhysicalVolumeStore is the universe}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01561}01561 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01562}01562     \textcolor{comment}{// Definition of some variables (e.g. volume for fluence calculation)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01563}01563     Initialize\_userDefinedVariables();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01564}01564 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01565}01565     fRunAction-\/>SetMapLVCubicVolume(fmap\_LV\_volume);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01566}01566 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01567}01567 \textcolor{comment}{//     std::cout << "{}-\/-\/-\/-\/ End of SteppingAction Initialization -\/-\/-\/-\/-\/"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01568}01568 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01569}01569     \textcolor{comment}{// Setup the volumes of interest for the scoring of spectra}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01570}01570     \textcolor{comment}{// fRunAction-\/>GetRun()-\/>m\_scoringSurfaceCurrentSpectrum-\/>buildMapPVSurface();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01571}01571     \textcolor{comment}{// fRunAction-\/>GetRun()-\/>m\_scoringSurfaceFluenceSpectrum-\/>buildMapPVSurface();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01572}01572     \textcolor{comment}{// fRunAction-\/>GetRun()-\/>m\_scoringVolumeFluenceSpectrum-\/>buildMapPVCubicVolume(fmap\_LV\_volume);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01573}01573 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01574}01574     \textcolor{comment}{// if (p-\/>Verbose >= 1) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01575}01575     \textcolor{comment}{//     fRunAction-\/>GetRun()-\/>m\_scoringVolumeFluenceSpectrum-\/>printSummary();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01576}01576     \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01577}01577 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01578}01578 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01579}01579 \textcolor{comment}{// Recalculate the region ID associated to a physical volume at each step}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01580}01580 \textcolor{keywordtype}{void} SteppingAction::GetPhysicalVolumeNumber(\textcolor{keyword}{const} G4Step * theStep) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01581}01581     G4String  thePrePVname  = theStep-\/>GetPreStepPoint ()-\/>GetPhysicalVolume()-\/>GetName(); \textcolor{comment}{// Name of the physical volume of the preStep}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01582}01582     G4StepStatus PreStatus  = theStep-\/>GetPreStepPoint ()-\/>GetStepStatus(); \textcolor{comment}{// Status of the pre-\/step}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01583}01583     G4String  thePostPVname;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01584}01584     \textcolor{keywordflow}{if}(theStep-\/>GetPostStepPoint()-\/>GetPhysicalVolume())}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01585}01585         thePostPVname = theStep-\/>GetPostStepPoint()-\/>GetPhysicalVolume()-\/>GetName(); \textcolor{comment}{// Name of the physical volume of the postStep}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01586}01586     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01587}01587         thePostPVname = thePrePVname; \textcolor{comment}{// if the postStep is outside the universe = its name is the one of the preStep physical volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01588}01588     G4StepStatus PostStatus = theStep-\/>GetPostStepPoint()-\/>GetStepStatus(); \textcolor{comment}{// Status of the post-\/step}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01589}01589     \textcolor{keyword}{const} G4int stepnumber  = theStep-\/>GetTrack()-\/>GetCurrentStepNumber(); \textcolor{comment}{// stepnumber of the track, ==1 means first step}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01590}01590 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01591}01591     \textcolor{keywordflow}{if}(stepnumber == 1) \{ \textcolor{comment}{// Initialize the volume number of the track's first step}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01592}01592         fPrePhysicalVolumeNumber = GetRegionNumber(thePrePVname, PreStatus);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01593}01593 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01594}01594         \textcolor{keywordflow}{if}(thePrePVname.compare(thePostPVname) == 0 || PostStatus == fWorldBoundary) \textcolor{comment}{// if postStep point is still in the same volume or at the boarder of the universe}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01595}01595             fPostPhysicalVolumeNumber = fPrePhysicalVolumeNumber;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01596}01596         \textcolor{keywordflow}{else} \textcolor{comment}{// We search its number}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01597}01597             fPostPhysicalVolumeNumber = GetRegionNumber(thePostPVname, PostStatus);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01598}01598     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01599}01599     \textcolor{keywordflow}{else} \{ \textcolor{comment}{// not first step of the track}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01600}01600         \textcolor{keywordflow}{if}( fPrePhysicalVolumeNumber != fPostPhysicalVolumeNumber ) \textcolor{comment}{// If the track has changed of volume during last step}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01601}01601             fPrePhysicalVolumeNumber = fPostPhysicalVolumeNumber;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01602}01602 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01603}01603         \textcolor{keywordflow}{if}(thePrePVname.compare(thePostPVname) != 0 \&\& PostStatus == fGeomBoundary) \textcolor{comment}{// if postStep point is not in the same volume and postStep is at the boarder of a volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01604}01604             fPostPhysicalVolumeNumber = GetRegionNumber(thePostPVname, PostStatus);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01605}01605     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01606}01606 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01607}01607     fPhysicalVolumeNumber = fPrePhysicalVolumeNumber;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01608}01608     fPrePhysicalVolumeName = thePrePVname;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01609}01609 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01610}01610 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01612}01612     \textcolor{comment}{// fPhysicalVolumeNumber = GetRegionNumber(thePrePVname, PreStatus);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01614}01614 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01615}01615 \textcolor{comment}{//     if(/*stepnumber != 1*/ fPhysicalVolumeNumber==1 \&\& thePrePVname != "{}AirSpacer"{} \&\& thePostPVname != "{}AirSpacer"{}) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01616}01616 \textcolor{comment}{//         std::cout << "{}\(\backslash\)nstepnumber "{} << stepnumber << "{}\(\backslash\)n\(\backslash\)t thePrePVname : "{} << thePrePVname << "{} fPrePhysicalVolumeNumber "{} << fPrePhysicalVolumeNumber << "{} boundary ? "{} << (PreStatus == fGeomBoundary) << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01617}01617 \textcolor{comment}{//         std::cout << "{}\(\backslash\)t thePostPVname : "{} << thePostPVname << "{} fPostPhysicalVolumeNumber "{} << fPostPhysicalVolumeNumber << "{} boundary ? "{} << (PostStatus == fGeomBoundary) << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01618}01618 \textcolor{comment}{//         std::cout << "{}\(\backslash\)t fPhysicalVolumeNumber "{} << fPhysicalVolumeNumber << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01619}01619 \textcolor{comment}{//     \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01620}01620 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01621}01621 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01622}01622 \textcolor{comment}{// Get the region ID of a physical volume considering its name}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01623}01623 \textcolor{keywordtype}{int} SteppingAction::GetRegionNumber(std::string PhyicalVolume\_name, G4StepStatus \textcolor{comment}{/*stepStatus*/}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01624}01624     \textcolor{keywordflow}{if}(fmap\_PV\_name\_number.find(PhyicalVolume\_name) == fmap\_PV\_name\_number.end()) \{ \textcolor{comment}{// if PhyicalVolume\_name not found}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01625}01625 \textcolor{comment}{//         if(stepStatus != fWorldBoundary) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01626}01626 \textcolor{comment}{//             std::cout << "{}in SteppingAction: !! WARNING !! Physical Volume "{} << PhyicalVolume\_name << "{} not listed in fmap\_PV\_name\_number of SteppingAction."{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01627}01627 \textcolor{comment}{//             std::cout << "{}Region number is set to universe 1"{} << std::endl; \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01628}01628         \textcolor{keywordflow}{return} 1; \textcolor{comment}{// it is considered as the universe}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01629}01629     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01630}01630     \textcolor{keywordflow}{else} \textcolor{comment}{// If found in the map of regions}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01631}01631         \textcolor{keywordflow}{return} fmap\_PV\_name\_number[PhyicalVolume\_name];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01632}01632 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01633}01633 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01634}01634 \textcolor{comment}{// Calculate the cubic volume per material, logical volume or region}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01635}01635 \textcolor{keywordtype}{void} SteppingAction::RecursiveVolumeCalculation(G4VPhysicalVolume* PV, \textcolor{keywordtype}{int} replicate\_number) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01636}01636     \textcolor{keywordflow}{if}(PV) \{ \textcolor{comment}{// if physical volume is not null}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01637}01637         G4LogicalVolume* LV = PV-\/>GetLogicalVolume();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01638}01638         \textcolor{keywordtype}{int} PV\_replicate\_number = replicate\_number * PV-\/>GetMultiplicity(); \textcolor{comment}{// Get the number of replicates}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01639}01639 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01640}01640         \textcolor{keywordflow}{if}(LV) \{ \textcolor{comment}{// if logical volume is not null}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01641}01641             \textcolor{keywordtype}{double} PV\_volume = replicate\_number * LV-\/>GetSolid()-\/>GetCubicVolume()/cm3; \textcolor{comment}{// Get the real volume of daugthers}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01642}01642 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01644}01644             \textcolor{comment}{// Sum of volume in dedicated maps}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01646}01646 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01647}01647             \textcolor{comment}{// Map of listed regions}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01648}01648             \textcolor{keywordflow}{if}(fmap\_PV\_name\_number.find(PV-\/>GetName()) != fmap\_PV\_name\_number.end())}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01649}01649                 fmap\_Region\_volume[fmap\_PV\_name\_number[PV-\/>GetName()]] += PV\_volume;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01650}01650             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01651}01651                 fmap\_Region\_volume[1] += PV\_volume;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01652}01652 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01653}01653             \textcolor{comment}{// Map of Logical volumes}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01654}01654             fmap\_LV\_volume[LV-\/>GetName()] += PV\_volume;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01655}01655 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01656}01656             \textcolor{comment}{// Map of materials}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01657}01657             \textcolor{keywordflow}{if}(LV-\/>GetMaterial()) \{ fmap\_mat\_volume[LV-\/>GetMaterial()-\/>GetName()] += PV\_volume;\} \textcolor{comment}{// If material is not null}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01658}01658 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01659}01659             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < LV-\/>GetNoDaughters(); ++i) \{ \textcolor{comment}{// For each Physical volume daugther of the Logical volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01660}01660                 G4VPhysicalVolume* Daughter\_PV = LV-\/>GetDaughter(i);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01661}01661                 \textcolor{keywordtype}{int} daughter\_replicate\_number = PV\_replicate\_number * Daughter\_PV-\/>GetMultiplicity(); \textcolor{comment}{// Get the number of replicates}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01662}01662                 \textcolor{keywordtype}{double} daugther\_volume = daughter\_replicate\_number * Daughter\_PV-\/>GetLogicalVolume()-\/>GetSolid()-\/>GetCubicVolume()/cm3; \textcolor{comment}{// Get the real volume of daugthers}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01663}01663 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01665}01665                 \textcolor{comment}{// Substract volume of daughters in dedicated maps}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01667}01667 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01668}01668                 \textcolor{comment}{// Map of listed regions}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01669}01669                 \textcolor{keywordflow}{if}(fmap\_PV\_name\_number.find(PV-\/>GetName()) != fmap\_PV\_name\_number.end())}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01670}01670                     fmap\_Region\_volume[fmap\_PV\_name\_number[PV-\/>GetName()]] -\/= daugther\_volume; \textcolor{comment}{// removing volume of daughters}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01671}01671                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01672}01672                     fmap\_Region\_volume[1] -\/= daugther\_volume; \textcolor{comment}{// removing volume of daughters}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01673}01673 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01674}01674                 \textcolor{comment}{// Map of Logical volumes}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01675}01675                 fmap\_LV\_volume[LV-\/>GetName()] -\/= daugther\_volume; \textcolor{comment}{// removing volume of daughters}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01676}01676 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01677}01677                 \textcolor{comment}{// Map of materials}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01678}01678                 \textcolor{keywordflow}{if}(LV-\/>GetMaterial()) \{ fmap\_mat\_volume[LV-\/>GetMaterial()-\/>GetName()] -\/= daugther\_volume;\}  \textcolor{comment}{// If material is not null, the volume of daughters is removed}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01679}01679 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01680}01680                 \textcolor{comment}{// Call recursive method for each daughter physical volume (Daughter\_PV)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01681}01681                 RecursiveVolumeCalculation(Daughter\_PV, PV\_replicate\_number);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01682}01682             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01683}01683 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01684}01684             \textcolor{comment}{// std::cout << LV-\/>GetName() << "{} -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/> "{} << fmap\_LV\_volume[LV-\/>GetName()] << "{} cm3\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01685}01685         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01686}01686     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01687}01687 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01688}01688 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01689}01689 \textcolor{comment}{// Calculate the mass per material, logical volume or region}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01690}01690 \textcolor{keywordtype}{void} SteppingAction::RecursiveMassCalculation(G4VPhysicalVolume* PV, \textcolor{keywordtype}{int} replicate\_number) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01691}01691     \textcolor{keywordflow}{if}(PV) \{ \textcolor{comment}{// if physical volume is not null}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01692}01692         G4LogicalVolume* LV = PV-\/>GetLogicalVolume();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01693}01693         \textcolor{keywordtype}{int} PV\_replicate\_number = replicate\_number * PV-\/>GetMultiplicity(); \textcolor{comment}{// Get the number of replicates}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01694}01694 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01695}01695         \textcolor{keywordflow}{if}(LV) \{ \textcolor{comment}{// if logical volume is not null}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01696}01696             \textcolor{keywordtype}{double} PV\_mass = replicate\_number * LV-\/>GetMass()/g; \textcolor{comment}{// Get the real mass of daugthers}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01697}01697 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01699}01699             \textcolor{comment}{// Sum of volume in dedicated maps}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01701}01701 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01702}01702             \textcolor{comment}{// Map of listed regions}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01703}01703             \textcolor{keywordflow}{if}(fmap\_PV\_name\_number.find(PV-\/>GetName()) != fmap\_PV\_name\_number.end())}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01704}01704                 fmap\_Region\_mass[fmap\_PV\_name\_number[PV-\/>GetName()]] += PV\_mass;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01705}01705             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01706}01706                 fmap\_Region\_mass[1] += PV\_mass;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01707}01707 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01708}01708             \textcolor{comment}{// Map of Logical volumes}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01709}01709             fmap\_LV\_mass[LV-\/>GetName()] += PV\_mass;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01710}01710 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01711}01711             \textcolor{comment}{// Map of materials}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01712}01712             \textcolor{keywordflow}{if}(LV-\/>GetMaterial()) \{ fmap\_mat\_mass[LV-\/>GetMaterial()-\/>GetName()] += PV\_mass;\} \textcolor{comment}{// If material is not null}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01713}01713 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01714}01714             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < LV-\/>GetNoDaughters(); ++i) \{ \textcolor{comment}{// For each Physical volume daugther of the Logical volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01715}01715                 G4VPhysicalVolume* Daughter\_PV = LV-\/>GetDaughter(i);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01716}01716                 \textcolor{keywordtype}{int} daughter\_replicate\_number = PV\_replicate\_number * Daughter\_PV-\/>GetMultiplicity(); \textcolor{comment}{// Get the number of replicates}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01717}01717                 \textcolor{keywordtype}{double} daugther\_volume = daughter\_replicate\_number * Daughter\_PV-\/>GetLogicalVolume()-\/>GetMass()/g; \textcolor{comment}{// Get the real mass of daugthers}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01718}01718 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01720}01720                 \textcolor{comment}{// Substract volume of daughters in dedicated maps}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01722}01722 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01723}01723                 \textcolor{comment}{// Map of listed regions}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01724}01724                 \textcolor{keywordflow}{if}(fmap\_PV\_name\_number.find(PV-\/>GetName()) != fmap\_PV\_name\_number.end())}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01725}01725                     fmap\_Region\_mass[fmap\_PV\_name\_number[PV-\/>GetName()]] -\/= daugther\_volume; \textcolor{comment}{// removing volume of daughters}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01726}01726                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01727}01727                     fmap\_Region\_mass[1] -\/= daugther\_volume; \textcolor{comment}{// removing volume of daughters}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01728}01728 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01729}01729                 \textcolor{comment}{// Map of Logical volumes}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01730}01730                 fmap\_LV\_mass[LV-\/>GetName()] -\/= daugther\_volume; \textcolor{comment}{// removing volume of daughters}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01731}01731 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01732}01732                 \textcolor{comment}{// Map of materials}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01733}01733                 \textcolor{keywordflow}{if}(LV-\/>GetMaterial()) \{ fmap\_mat\_mass[LV-\/>GetMaterial()-\/>GetName()] -\/= daugther\_volume;\}  \textcolor{comment}{// If material is not null, the volume of daughters is removed}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01734}01734 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01735}01735                 \textcolor{comment}{// Call recursive method for each daughter physical volume (Daughter\_PV)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01736}01736                 RecursiveMassCalculation(Daughter\_PV, PV\_replicate\_number);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01737}01737             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01738}01738         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01739}01739     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01740}01740 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01741}01741 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01742}01742 \textcolor{comment}{// Calculate the kinetic energy}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01743}01743 \textcolor{keywordtype}{double} SteppingAction::KineticEnergy\_eV(\textcolor{keyword}{const} G4Step * theStep) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01744}01744     G4double energyK = theStep-\/>GetTrack()-\/>GetKineticEnergy()/eV;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01745}01745     \textcolor{keywordflow}{if}(energyK==0) \{energyK = theStep-\/>GetPreStepPoint()-\/>GetKineticEnergy()/eV;\} \textcolor{comment}{// If kinetic energy is 0, get the kinetic energy of preStep}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01746}01746     \textcolor{keywordflow}{return} energyK; \textcolor{comment}{// Return the energy in eV}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01747}01747 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01748}01748 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01749}01749 \textcolor{keywordtype}{bool} SteppingAction::IsInReactorVes       (\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return}  VolNumber == 80;\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01750}01750 \textcolor{keywordtype}{bool} SteppingAction::IsSecondCoolant      (\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return}  VolNumber == 85;\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01751}01751 \textcolor{keywordtype}{bool} SteppingAction::IsIncineration       (\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return}  VolNumber == 90;\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01752}01752 \textcolor{keywordtype}{bool} SteppingAction::IsTargetRegion       (\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return} (VolNumber <= 26 \&\&  VolNumber >= 14);\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01753}01753 \textcolor{keywordtype}{bool} SteppingAction::IsTarget             (\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return} (VolNumber <= 23 \&\&  VolNumber >= 14);\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01754}01754 \textcolor{keywordtype}{bool} SteppingAction::IsHeatShieldRegion   (\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return} (VolNumber == 3  ||  VolNumber == 13);\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01755}01755 \textcolor{keywordtype}{bool} SteppingAction::IsLeadRegion         (\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return} (VolNumber == 5  || (VolNumber >= 50 \&\& VolNumber <= 54));\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01756}01756 \textcolor{keywordtype}{bool} SteppingAction::IsWaterCoreRegion    (\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return}  VolNumber == 42;\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01757}01757 \textcolor{keywordtype}{bool} SteppingAction::IsBeamPipe           (\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return}  VolNumber == 24;\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01758}01758 \textcolor{keywordtype}{bool} SteppingAction::IsBeamWindow         (\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return}  VolNumber == 25;\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01759}01759 \textcolor{keywordtype}{bool} SteppingAction::IsLead               (\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return}  VolNumber ==  5;\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01760}01760 \textcolor{keywordtype}{bool} SteppingAction::IsSamplesInLead      (\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return} (VolNumber >= 50  \&\& VolNumber <= 54);\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01761}01761 \textcolor{keywordtype}{bool} SteppingAction::IsSpentFuel          (\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return}  VolNumber == 60;\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01762}01762 \textcolor{keywordtype}{bool} SteppingAction::IsNeutronAbsorber    (\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return}  VolNumber == 55;\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01763}01763 \textcolor{keywordtype}{bool} SteppingAction::IsFuel               (\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return}  VolNumber == 400;\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01764}01764 \textcolor{keywordtype}{bool} SteppingAction::IsCoolantRegion      (\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return} (VolNumber == 5 || (VolNumber >= 50 \&\& VolNumber <= 54));\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01765}01765 \textcolor{keywordtype}{bool} SteppingAction::IsCoolantInCoreRegion(\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return}  VolNumber == 42;\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01766}01766 \textcolor{keywordtype}{bool} SteppingAction::IsReflector          (\textcolor{keywordtype}{int} VolNumber) \{ \textcolor{keywordflow}{return}  VolNumber == 44;\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01767}01767 \textcolor{keywordtype}{bool} SteppingAction::IsFissionProduct(std::string particleType) \{ \textcolor{keywordflow}{return} (particleType==\textcolor{stringliteral}{"{}nucleus"{}} \&\& IsFuel(fPhysicalVolumeNumber));\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01768}01768 \textcolor{keywordtype}{bool} SteppingAction::IsPrimaryProton(std::string particleName, \textcolor{keywordtype}{int} ID\_track) \{ \textcolor{keywordflow}{return} (particleName==\textcolor{stringliteral}{"{}proton"{}} \&\& ID\_track == 1);\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01769}01769 \textcolor{keywordtype}{bool} SteppingAction::IsEscapingTarget() \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01770}01770     \textcolor{keywordflow}{return} (IsTargetRegion(fPrePhysicalVolumeNumber) \&\& !IsTargetRegion(fPostPhysicalVolumeNumber));\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01771}01771 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01795}01795 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01796}01796 \textcolor{comment}{// Methods used to count neutrons, transmuted elements, and calculate k}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01797}01797 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01812}01812 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01813}01813 \textcolor{keywordtype}{void} SteppingAction::CountSecondaries(\textcolor{keyword}{const} G4Step* theStep, \textcolor{keywordtype}{int} nNeutrons) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01814}01814 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01816}01816     \textcolor{comment}{// Counting of neutron generations}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01817}01817     \textcolor{comment}{// Counting of source term for burnup calculation}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01818}01818     \textcolor{keywordtype}{int} Nb\_second\_neutrons=0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01819}01819     \textcolor{keywordtype}{int} Nb\_OtherNeutrons  =0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01820}01820     \textcolor{keywordtype}{int} Nb\_inelastic      =0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01821}01821     \textcolor{keyword}{const} std::vector<const G4Track*> *secondaries = theStep-\/>GetSecondaryInCurrentStep();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01822}01822     G4String processName = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01823}01823     \textcolor{keywordflow}{if}(theStep-\/>GetPostStepPoint()-\/>GetProcessDefinedStep()) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01824}01824         processName = theStep-\/>GetPostStepPoint()-\/>GetProcessDefinedStep()-\/>GetProcessName();\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01825}01825 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01826}01826     \textcolor{keywordflow}{for}(G4int i=0; i<(G4int)secondaries-\/>size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01827}01827         \textcolor{comment}{// std::cout << "{}secondaries "{} << i << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01828}01828 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01829}01829         \textcolor{comment}{// Count neutron per generation and change generation of secondaries}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01830}01830         \textcolor{keywordflow}{if}( theStep-\/>GetTrack()-\/>GetTrackStatus() != fKillTrackAndSecondaries )}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01831}01831             fGenerationCounter-\/>NeutronGenerationCounting(theStep, (*secondaries)[i], nNeutrons, Nb\_inelastic);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01832}01832         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01833}01833             std::cout << \textcolor{stringliteral}{"{}The track and its secondaries are killed, neutron counting is biaised."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01834}01834 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01835}01835         \textcolor{comment}{// count secondary neutrons coming from mother neutron and not from fission}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01836}01836         \textcolor{keywordflow}{if}(theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}neutron"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01837}01837           \&\& (*secondaries)[i]-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}neutron"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01838}01838           \&\& processName!=\textcolor{stringliteral}{"{}nFission"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01839}01839             ++Nb\_second\_neutrons;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01840}01840 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01841}01841         \textcolor{comment}{// count secondary neutrons coming from mother particle other than neutron or primary particles or particle in the target (flagged as source neutrons)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01842}01842         \textcolor{keywordflow}{if}(theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() != \textcolor{stringliteral}{"{}neutron"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01843}01843           \&\& (*secondaries)[i]-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}neutron"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01844}01844           \&\& processName!=\textcolor{stringliteral}{"{}nFission"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01845}01845           \&\& theStep-\/>GetTrack()-\/>GetTrackID() != 1}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01846}01846           \&\& fIsSourceNeutron == \textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01847}01847             ++Nb\_OtherNeutrons;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01848}01848 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01852}01852         \textcolor{comment}{// Source term calculation for Burnup calculation}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01856}01856 \textcolor{comment}{}\textcolor{comment}{//        if(p-\/>TimeOfRun > 0) \{TMXBurnup::FillvectorBurnupElement(theStep, fEventAction, (*secondaries)[i]);\} // Calculation of burnup required only if time of run > 0}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01858}01858 \textcolor{comment}{}    \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01859}01859 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01860}01860 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01861}01861      \textcolor{comment}{// count processes as well as production / disparition of elements}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01862}01862      G4VProcess* process = \textcolor{keyword}{const\_cast<}G4VProcess*\textcolor{keyword}{>}(theStep-\/>GetPostStepPoint()-\/>GetProcessDefinedStep());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01863}01863      G4HadronicProcess* hproc = \textcolor{keyword}{dynamic\_cast<}G4HadronicProcess*\textcolor{keyword}{>}(process);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01864}01864      \mbox{\hyperlink{class_run}{Run}}* run = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{class_run}{Run}}*\textcolor{keyword}{>}(G4RunManager::GetRunManager()-\/>GetNonConstCurrentRun());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01865}01865      run-\/>\mbox{\hyperlink{class_run_ac5bfcd51f38b7c06c3b6f8e613631fdc}{CountProcesses}}(process);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01866}01866 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01867}01867      \textcolor{keywordflow}{if}(     hproc \&\&}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01868}01868              ( process-\/>GetProcessName() == \textcolor{stringliteral}{"{}neutronInelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01869}01869                || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}nFission"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01870}01870                || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}nCapture"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01871}01871                || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}ionInelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01872}01872                || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}protonInelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01873}01873                || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}pi+Inelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01874}01874                || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}pi-\/Inelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01875}01875                || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}alphaInelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01876}01876                || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}dInelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01877}01877                || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}tInelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01878}01878                || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}He3Inelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01879}01879              ))}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01880}01880      \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01881}01881          \textcolor{keyword}{const} G4Isotope* target = GetTargetIsotope(theStep-\/>GetPostStepPoint());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01882}01882          \textcolor{keywordflow}{if}(target)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01883}01883          \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01884}01884              \textcolor{keywordtype}{double} IZAmother = 10000 * target-\/>GetZ() + 10 * target-\/>GetN() + target-\/>Getm();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01885}01885 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01886}01886              run-\/>\mbox{\hyperlink{class_run_abce51991634ccd5a2061c2efb1c2a18e}{ParticleCount}}(IZAmother, -\/1, (\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}*)theStep-\/>GetPreStepPoint()-\/>GetMaterial());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01887}01887 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01888}01888              \textcolor{comment}{// Daughter elements}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01889}01889              \textcolor{keywordflow}{for}(std::vector<const G4Track*>::size\_type j = 0; j < secondaries-\/>size(); j++)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01890}01890              \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01891}01891                  \textcolor{keywordflow}{if}(        (*secondaries)[j]-\/>GetDefinition()-\/>GetParticleType()    == \textcolor{stringliteral}{"{}nucleus"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01892}01892                             || (*secondaries)[j]-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}proton"{}} )}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01893}01893                  \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01894}01894                      G4Ions* SecondIonsType = \textcolor{keyword}{dynamic\_cast<}G4Ions*\textcolor{keyword}{>} ((*secondaries)[j]-\/>GetDefinition());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01895}01895                      \textcolor{keywordtype}{double} IZAdaughter = 10000 * SecondIonsType-\/>GetAtomicNumber() + 10 * SecondIonsType-\/>GetAtomicMass() + SecondIonsType-\/>GetIsomerLevel();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01896}01896                      run-\/>\mbox{\hyperlink{class_run_abce51991634ccd5a2061c2efb1c2a18e}{ParticleCount}}(IZAdaughter, +1, (\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}*)theStep-\/>GetPreStepPoint()-\/>GetMaterial());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01897}01897                  \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01898}01898              \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01899}01899          \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01900}01900      \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01901}01901     \textcolor{comment}{// Counting of additionnal neutrons not coming from fission}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01902}01902     \textcolor{keywordflow}{if}(Nb\_second\_neutrons > 1)  \textcolor{comment}{// secondary neutrons coming from mother neutron}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01903}01903         fEventAction-\/>AddInelasticN(Nb\_second\_neutrons);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01904}01904     \textcolor{keywordflow}{if}(Nb\_OtherNeutrons > 0) \textcolor{comment}{// secondary neutrons coming from mother particle other than neutron}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01905}01905         fEventAction-\/>AddInelasticN(Nb\_OtherNeutrons);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01906}01906 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01907}01907 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01908}01908 \textcolor{keywordtype}{void} SteppingAction::computeSourceTerm(\textcolor{keyword}{const} G4Step* theStep)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01909}01909 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01910}01910 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01911}01911 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01912}01912     \textcolor{comment}{// count processes as well as production / disparition of elements}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01913}01913     G4VProcess* process = \textcolor{keyword}{const\_cast<}G4VProcess*\textcolor{keyword}{>}(theStep-\/>GetPostStepPoint()-\/>GetProcessDefinedStep());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01914}01914     G4HadronicProcess* hproc = \textcolor{keyword}{dynamic\_cast<}G4HadronicProcess*\textcolor{keyword}{>}(process);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01915}01915     \mbox{\hyperlink{class_run}{Run}}* run = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{class_run}{Run}}*\textcolor{keyword}{>}(G4RunManager::GetRunManager()-\/>GetNonConstCurrentRun());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01916}01916     run-\/>\mbox{\hyperlink{class_run_ac5bfcd51f38b7c06c3b6f8e613631fdc}{CountProcesses}}(process);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01917}01917 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01918}01918     \textcolor{keywordflow}{if}(     hproc \&\&}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01919}01919             ( process-\/>GetProcessName() == \textcolor{stringliteral}{"{}neutronInelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01920}01920               || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}nFission"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01921}01921               || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}nCapture"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01922}01922               || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}ionInelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01923}01923               || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}protonInelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01924}01924               || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}pi+Inelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01925}01925               || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}pi-\/Inelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01926}01926               || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}alphaInelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01927}01927               || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}dInelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01928}01928               || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}tInelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01929}01929               || process-\/>GetProcessName() == \textcolor{stringliteral}{"{}He3Inelastic"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01930}01930             ))}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01931}01931     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01932}01932         \textcolor{keyword}{const} G4Isotope* target = GetTargetIsotope(theStep-\/>GetPostStepPoint());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01933}01933         \textcolor{keywordflow}{if}(target)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01934}01934         \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01935}01935             \textcolor{keywordtype}{double} IZAmother = 10000 * target-\/>GetZ() + 10 * target-\/>GetN() + target-\/>Getm();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01936}01936 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01937}01937             run-\/>\mbox{\hyperlink{class_run_abce51991634ccd5a2061c2efb1c2a18e}{ParticleCount}}(IZAmother, -\/1, (\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}*)theStep-\/>GetPreStepPoint()-\/>GetMaterial());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01938}01938 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01939}01939             \textcolor{comment}{// Daughter elements}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01940}01940             \textcolor{keyword}{const} std::vector<const G4Track*> *secondaries = theStep-\/>GetSecondaryInCurrentStep();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01941}01941             \textcolor{keywordflow}{for}(std::vector<const G4Track*>::size\_type j = 0; j < secondaries-\/>size(); j++)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01942}01942             \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01943}01943                 \textcolor{keywordflow}{if}(        (*secondaries)[j]-\/>GetDefinition()-\/>GetParticleType()    == \textcolor{stringliteral}{"{}nucleus"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01944}01944                            || (*secondaries)[j]-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}proton"{}} )}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01945}01945                 \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01946}01946                     G4Ions* SecondIonsType = \textcolor{keyword}{dynamic\_cast<}G4Ions*\textcolor{keyword}{>} ((*secondaries)[j]-\/>GetDefinition());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01947}01947                     \textcolor{keywordtype}{double} IZAdaughter = 10000 * SecondIonsType-\/>GetAtomicNumber() + 10 * SecondIonsType-\/>GetAtomicMass() + SecondIonsType-\/>GetIsomerLevel();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01948}01948                     run-\/>\mbox{\hyperlink{class_run_abce51991634ccd5a2061c2efb1c2a18e}{ParticleCount}}(IZAdaughter, +1, (\mbox{\hyperlink{class_t_m_x_material}{TMXMaterial}}*)theStep-\/>GetPreStepPoint()-\/>GetMaterial());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01949}01949                 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01950}01950             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01951}01951         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01952}01952     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01953}01953 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01954}01954 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01955}01955 \textcolor{keywordtype}{void} SteppingAction::ManagePrimaryProtonEscape(\textcolor{keyword}{const} G4Step* theStep) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01956}01956     \textcolor{comment}{// if (theStep-\/>GetTrack()-\/>GetTrackID() == 0) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01957}01957         \textcolor{keywordflow}{if} (theStep-\/>GetTrack()-\/>GetParticleDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}proton"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01958}01958             \textcolor{keywordflow}{if} (IsEscapingTarget()) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01959}01959                 fEventAction-\/>AddNprimaryEscape(1);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01960}01960                 \textcolor{keyword}{auto} analysisManager = G4AnalysisManager::Instance();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01961}01961                 analysisManager-\/>FillH1(28, log10(KineticEnergy\_eV(theStep)));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01962}01962             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01963}01963         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01964}01964     \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01965}01965 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01966}01966 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01967}01967 \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01968}01968 \textcolor{comment}{void SteppingAction::k\_initialization(const G4Step* theStep) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01969}01969 \textcolor{comment}{    // Score neutron birth for neutron counting}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01970}01970 \textcolor{comment}{    if(theStep-\/>GetTrack()}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01971}01971 \textcolor{comment}{    \&\& theStep-\/>GetTrack()-\/>GetDefinition()}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01972}01972 \textcolor{comment}{    \&\& theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() == "{}neutron"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01973}01973 \textcolor{comment}{    \&\& theStep-\/>GetTrack()-\/>GetCurrentStepNumber() == 1}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01974}01974 \textcolor{comment}{    ) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01975}01975 \textcolor{comment}{        // Track quantities}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01976}01976 \textcolor{comment}{        G4double energyK = KineticEnergy\_eV(theStep);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01977}01977 \textcolor{comment}{        G4double StepLength = theStep-\/>GetStepLength()/cm; // Length of the step in cm}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01978}01978 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01979}01979 \textcolor{comment}{        // PreStep quantities}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01980}01980 \textcolor{comment}{        G4ThreeVector PrePos   = theStep-\/>GetPreStepPoint()-\/>GetPosition();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01981}01981 \textcolor{comment}{        G4ThreeVector PreMom   = theStep-\/>GetPreStepPoint()-\/>GetMomentumDirection();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01982}01982 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01983}01983 \textcolor{comment}{        // Store quantities at birth}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01984}01984 \textcolor{comment}{        fEnergyAtBirth = energyK;   // Store kinetic energy at birth}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01985}01985 \textcolor{comment}{        fPosAtBirth = PrePos;       // Store position at birth}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01986}01986 \textcolor{comment}{        fBirthTime = theStep-\/>GetPreStepPoint()-\/>GetGlobalTime()/s; // Store time at birth}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01987}01987 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01988}01988 \textcolor{comment}{        if(theStep-\/>GetTrack()-\/>GetParentID() == 0) \{ // If birth of a source neutron generated by primaryGenerator => generation = 0}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01989}01989 \textcolor{comment}{            ScoreNeutronGeneration(0, 1);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01990}01990 \textcolor{comment}{            FillHistoSourceN(fEnergyAtBirth, fPosAtBirth, energyK, PrePos, PreMom, 1);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01991}01991 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01992}01992 \textcolor{comment}{            // MCNP keff estimators}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01993}01993 \textcolor{comment}{            fEventAction-\/>Add\_NsourceNeutronPerEvent(1); // Add 1 more source neutron in this cycle (= event)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01994}01994 \textcolor{comment}{            fLengthBetweenCollision = StepLength; // Initialize stepLength accumulator}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01995}01995 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01996}01996 \textcolor{comment}{    \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01997}01997 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01998}01998 \textcolor{comment}{    // Manage status of neutrons and generation number}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l01999}01999 \textcolor{comment}{    if ( theStep-\/>GetTrack()}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02000}02000 \textcolor{comment}{      \&\& theStep-\/>GetTrack()-\/>GetParentID() == 0}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02001}02001 \textcolor{comment}{      \&\& theStep-\/>GetTrack()-\/>GetCurrentStepNumber()==1 ) \{ // New event -\/> Initialization of variables for k calculation}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02002}02002 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02003}02003 \textcolor{comment}{        if (TMXOption::IsKeffCalculation(p-\/>int\_Option) || !p-\/>ExtSourcePath.empty() ) \{ fIsSourceNeutron = false; \} // No neutrons coming from an external source in keff calculation}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02004}02004 \textcolor{comment}{        else \{ fIsSourceNeutron = true; \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02005}02005 \textcolor{comment}{        vStatus\_secondaries.clear();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02006}02006 \textcolor{comment}{        v\_NeutronGeneration.clear();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02007}02007 \textcolor{comment}{    \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02008}02008 \textcolor{comment}{    else if (theStep-\/>GetTrack()}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02009}02009 \textcolor{comment}{          \&\& theStep-\/>GetTrack()-\/>GetCurrentStepNumber()==1) // New particle birth (not a primary)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02010}02010 \textcolor{comment}{    \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02011}02011 \textcolor{comment}{        if (!TMXOption::IsKeffCalculation(p-\/>int\_Option)) \{ // if it is not a keff calculation}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02012}02012 \textcolor{comment}{            // The status is saved in the vector to be deleted after reading}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02013}02013 \textcolor{comment}{            fIsSourceNeutron = vStatus\_secondaries[vStatus\_secondaries.size()-\/1];}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02014}02014 \textcolor{comment}{            vStatus\_secondaries.pop\_back();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02015}02015 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02016}02016 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02017}02017 \textcolor{comment}{        // This condition commented in april 2021 should be uncommented}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02018}02018 \textcolor{comment}{//         G4String particleName = theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02019}02019 \textcolor{comment}{//         if( (!TMXOption::IsSourceNeutronEADefinition(p-\/>int\_Option) \&\& particleName == "{}neutron"{} \&\& !IsTargetRegion(fPhysicalVolumeNumber))// if a neutron is generated outside the target (e.g. in the beam window) and the definition of source neutron is not the Energy Amplifier's definition}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02020}02020 \textcolor{comment}{//           ||  TMXOption::IsKeffCalculation(p-\/>int\_Option) // or if it is a keff calculation}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02021}02021 \textcolor{comment}{//           || (TMXOption::IsSourceNeutronEADefinition(p-\/>int\_Option) \&\& particleName == "{}neutron"{} \&\& KineticEnergy\_eV(theStep) < 2E7) // or old definition of source neutrons (Energy Amplifier 1995): From neutron with E > 20 MeV and E\_second\_neutron at birth < 20 MeV}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02022}02022 \textcolor{comment}{//       )}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02023}02023 \textcolor{comment}{          if(TMXOption::IsKeffCalculation(p-\/>int\_Option)) //if it is a keff calculation}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02024}02024 \textcolor{comment}{            // The status is changed whatever the particle}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02025}02025 \textcolor{comment}{            // if it is a neutron, the source neutron is scored}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02026}02026 \textcolor{comment}{        \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02027}02027 \textcolor{comment}{            // It should be tested}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02028}02028 \textcolor{comment}{//             if( fIsSourceNeutron // The particle is still flagged in the target (never escaped)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02029}02029 \textcolor{comment}{//             \&\& theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName()=="{}neutron"{}) // it is a neutron}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02030}02030 \textcolor{comment}{//             \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02031}02031 \textcolor{comment}{//                 ScoreNeutronGeneration(0, 1); // Score 1 source neutron (generation 0)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02032}02032 \textcolor{comment}{//                 G4ThreeVector postPos = theStep-\/>GetPostStepPoint()-\/>GetPosition();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02033}02033 \textcolor{comment}{//                 G4ThreeVector postMom = theStep-\/>GetPostStepPoint()-\/>GetMomentumDirection();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02034}02034 \textcolor{comment}{//                 FillHistoSourceN(fEnergyAtBirth, fPosAtBirth, KineticEnergy\_eV(theStep), postPos, postMom, 1); // Score position / energy of 1 source neutron}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02035}02035 \textcolor{comment}{//             \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02036}02036 \textcolor{comment}{            fIsSourceNeutron = false; // The particle and its progeny is flagged as it has escaped the target}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02037}02037 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02038}02038 \textcolor{comment}{    \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02039}02039 \textcolor{comment}{\}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02040}02040 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02041}02041 \textcolor{comment}{void SteppingAction::InitializeNeutronGenerationFlag(const G4Step * theStep) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02042}02042 \textcolor{comment}{    if(theStep-\/>GetTrack()}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02043}02043 \textcolor{comment}{    \&\& theStep-\/>GetTrack()-\/>GetDefinition()}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02044}02044 \textcolor{comment}{    \&\& theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() == "{}neutron"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02045}02045 \textcolor{comment}{    \&\& theStep-\/>GetTrack()-\/>GetCurrentStepNumber() == 1) \{ // If first step of a neutron track}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02046}02046 \textcolor{comment}{        if(TMXOption::IsMultiplicationKilled(p-\/>int\_Option) // If the multiplication is killed}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02047}02047 \textcolor{comment}{        || theStep-\/>GetTrack()-\/>GetParentID() == 0) \{       // or if it is a primary neutron generated by the primaryGenerator => generation = 0}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02048}02048 \textcolor{comment}{            fNeutronGeneration = 0;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02049}02049 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02050}02050 \textcolor{comment}{        else if( theStep-\/>GetTrack()-\/>GetParentID() != 0) \{ // else if it is not a primary neutron}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02051}02051 \textcolor{comment}{            // The status is saved in the vector; to be deleted after reading}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02052}02052 \textcolor{comment}{            fNeutronGeneration = v\_NeutronGeneration[v\_NeutronGeneration.size()-\/1];}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02053}02053 \textcolor{comment}{            v\_NeutronGeneration.pop\_back();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02054}02054 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02055}02055 \textcolor{comment}{    \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02056}02056 \textcolor{comment}{\}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02057}02057 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02058}02058 \textcolor{comment}{void SteppingAction::FillHistoSourceN(double energyAtBirth, G4ThreeVector\& posAtBirth, double energyAtCounting, G4ThreeVector\& posAtCounting, G4ThreeVector\& dirAtCounting, int nbNeutrons) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02059}02059 \textcolor{comment}{    auto analysisManager = G4AnalysisManager::Instance();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02060}02060 \textcolor{comment}{    analysisManager-\/>FillH1(16, log10(energyAtBirth), nbNeutrons);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02061}02061 \textcolor{comment}{    analysisManager-\/>FillH1(17, log10(energyAtCounting), nbNeutrons);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02062}02062 \textcolor{comment}{    analysisManager-\/>FillH2(32, posAtCounting.x()/mm, posAtCounting.y()/mm, nbNeutrons);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02063}02063 \textcolor{comment}{    analysisManager-\/>FillH2(33, posAtCounting.x()/mm, posAtCounting.z()/mm, nbNeutrons);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02064}02064 \textcolor{comment}{    analysisManager-\/>FillH2(34, posAtBirth.x()/mm, posAtBirth.y()/mm, nbNeutrons);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02065}02065 \textcolor{comment}{    analysisManager-\/>FillH2(35, posAtBirth.x()/mm, posAtBirth.z()/mm, nbNeutrons);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02066}02066 \textcolor{comment}{    analysisManager-\/>FillH2(36, dirAtCounting.unit().z(), log10(energyAtCounting), nbNeutrons);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02067}02067 \textcolor{comment}{    analysisManager-\/>FillH2(37, std::acos(dirAtCounting.unit().z())* 360.0 / twopi, log10(energyAtCounting), nbNeutrons);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02068}02068 \textcolor{comment}{\}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02069}02069 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02070}02070 \textcolor{comment}{void SteppingAction::CountN0\_leavingTarget(const G4Step * theStep) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02071}02071 \textcolor{comment}{    // Neutrons born in the target and leaving the target tube are counted as N0}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02072}02072 \textcolor{comment}{    // Or old definition of source neutrons (Energy Amplifier 1995): E\_neutron < 20 MeV}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02073}02073 \textcolor{comment}{    if( ( (!TMXOption::IsSourceNeutronEADefinition(p-\/>int\_Option) \&\& !TMXOption::IsKeffCalculation(p-\/>int\_Option) \&\& IsEscapingTarget())}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02074}02074 \textcolor{comment}{        || (TMXOption::IsSourceNeutronEADefinition(p-\/>int\_Option) \&\& KineticEnergy\_eV(theStep) < 2E7) )}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02075}02075 \textcolor{comment}{     \&\& fIsSourceNeutron // The neutron is still flagged in the target (never escaped)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02076}02076 \textcolor{comment}{     \&\& theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName()=="{}neutron"{}) // it is a neutron}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02077}02077 \textcolor{comment}{    \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02078}02078 \textcolor{comment}{        ScoreNeutronGeneration(0, 1); // Score 1 source neutron (generation 0)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02079}02079 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02080}02080 \textcolor{comment}{        G4ThreeVector postPos = theStep-\/>GetPostStepPoint()-\/>GetPosition();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02081}02081 \textcolor{comment}{        G4ThreeVector postMom = theStep-\/>GetPostStepPoint()-\/>GetMomentumDirection();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02082}02082 \textcolor{comment}{        FillHistoSourceN(fEnergyAtBirth, fPosAtBirth, KineticEnergy\_eV(theStep), postPos, postMom, 1); // Score position / energy of 1 source neutron}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02083}02083 \textcolor{comment}{        fIsSourceNeutron = false; // The neutron has escaped the target}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02084}02084 \textcolor{comment}{    \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02085}02085 \textcolor{comment}{\}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02086}02086 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02087}02087 \textcolor{comment}{void SteppingAction::CountN0\_FromPrimaries(const G4Step* theStep, double SecondEnergy, G4ThreeVector\& SecondPos, G4ThreeVector\& SecondMom) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02088}02088 \textcolor{comment}{    std::string particleName = theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02089}02089 \textcolor{comment}{    int ID\_track =  theStep-\/>GetTrack()-\/>GetTrackID();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02090}02090 \textcolor{comment}{    if( ( (!TMXOption::IsSourceNeutronEADefinition(p-\/>int\_Option) \&\& !IsTargetRegion(fPostPhysicalVolumeNumber)) // if a source neutron is generated by a source proton outside the target (e.g. in the beam window)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02091}02091 \textcolor{comment}{        || (TMXOption::IsSourceNeutronEADefinition(p-\/>int\_Option) \&\& SecondEnergy < 2E7)) // if a source neutron is generated by a source proton outside the target (e.g. in the beam window)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02092}02092 \textcolor{comment}{    \&\& IsPrimaryProton(particleName, ID\_track)) \{ // if it is a primary proton}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02093}02093 \textcolor{comment}{        ScoreNeutronGeneration(0, 1);  // Score 1 source neutron (generation = 0)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02094}02094 \textcolor{comment}{        FillHistoSourceN(SecondEnergy, SecondPos, SecondEnergy, SecondPos, SecondMom, 1);  // The source neutron is scored and counted thus the position is the same}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02095}02095 \textcolor{comment}{    \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02096}02096 \textcolor{comment}{\}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02097}02097 \textcolor{comment}{*/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02098}02098 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02099}02099 \textcolor{keywordtype}{void} SteppingAction::CountNeutronSource\_DefEAP(\textcolor{keyword}{const} G4Step* theStep) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02100}02100     \textcolor{keyword}{const} G4double kinEnergyThreshold = 19.7e6; \textcolor{comment}{// eV}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02101}02101     \textcolor{keywordflow}{if} (TMXOption::IsSourceNeutronEADefinition(p-\/>int\_Option) \&\& theStep) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02102}02102         \textcolor{keywordflow}{if} (   theStep-\/>GetPreStepPoint()-\/>GetKineticEnergy()/eV > kinEnergyThreshold}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02103}02103             \&\& theStep-\/>GetPostStepPoint()-\/>GetKineticEnergy()/eV < kinEnergyThreshold}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02104}02104             \&\& theStep-\/>GetPostStepPoint()-\/>GetKineticEnergy()/eV != 0.}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02105}02105             \&\& theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}neutron"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02106}02106         ) \{ \textcolor{comment}{// Collision reach the limit}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02107}02107             std::cout << \textcolor{stringliteral}{"{}EAP "{}} << theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02108}02108                 << theStep-\/>GetPreStepPoint()-\/>GetKineticEnergy()/eV << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02109}02109                 << theStep-\/>GetPostStepPoint()-\/>GetKineticEnergy()/eV << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02110}02110                 << kinEnergyThreshold}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02111}02111                 << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02112}02112             \textcolor{comment}{/*FillNtupleNeutronSource(theStep-\/>GetPostStepPoint()-\/>GetPosition(),}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02113}02113 \textcolor{comment}{                                    theStep-\/>GetPostStepPoint()-\/>GetMomentumDirection(),}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02114}02114 \textcolor{comment}{                                    theStep-\/>GetPostStepPoint()-\/>GetKineticEnergy()/eV}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02115}02115 \textcolor{comment}{            );*/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02116}02116             \textcolor{comment}{//std::cout << "{}Count EAP80 collision"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02117}02117         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02118}02118         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (theStep-\/>GetPreStepPoint()-\/>GetKineticEnergy()/eV > kinEnergyThreshold) \{ \textcolor{comment}{// Production of neutrons from any particles with an energy higher than 19.7 MeV}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02119}02119             G4String processName = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02120}02120             \textcolor{keywordflow}{if}(theStep-\/>GetPostStepPoint()-\/>GetProcessDefinedStep()) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02121}02121                 processName = theStep-\/>GetPostStepPoint()-\/>GetProcessDefinedStep()-\/>GetProcessName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02122}02122                 \textcolor{keywordflow}{if} (processName == \textcolor{stringliteral}{"{}nFission"{}} || processName == \textcolor{stringliteral}{"{}neutronInelastic"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02123}02123                     \textcolor{comment}{//std::cout << processName << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02124}02124                     \textcolor{keyword}{const} std::vector<const G4Track*> *secondaries = theStep-\/>GetSecondaryInCurrentStep();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02125}02125                     \textcolor{keywordflow}{for}(G4int i=0; i<(G4int)secondaries-\/>size(); i++) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02126}02126                         G4double SecondEnergy = (*secondaries)[i]-\/>GetKineticEnergy()/eV;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02127}02127                         \textcolor{keywordflow}{if} ((*secondaries)[i]-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}neutron"{}} \&\& SecondEnergy < kinEnergyThreshold) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02128}02128                             \textcolor{comment}{/*FillNtupleNeutronSource(}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02129}02129 \textcolor{comment}{                                (*secondaries)[i]-\/>GetPosition(),}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02130}02130 \textcolor{comment}{                                (*secondaries)[i]-\/>GetMomentumDirection(),}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02131}02131 \textcolor{comment}{                                SecondEnergy}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02132}02132 \textcolor{comment}{                            );*/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02133}02133                             \textcolor{comment}{//std::cout << "{}Count EAP80 process"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02134}02134                         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02135}02135                     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02136}02136                 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02137}02137             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02138}02138         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02139}02139     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02140}02140 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02141}02141 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02142}02142 \textcolor{keywordtype}{void} SteppingAction::CountNeutronGeneration\_FromInelastic(\textcolor{keywordtype}{int} MotherNeutronGeneration, \textcolor{keywordtype}{int} Nb\_inelastic) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02143}02143     \textcolor{comment}{// Counting of additionnal neutrons coming from inelastic reaction (n, Xn)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02144}02144     \textcolor{keywordflow}{if}(Nb\_inelastic > 1 \&\& fIsSourceNeutron == \textcolor{keyword}{false}) \{  \textcolor{comment}{// Neutron is counted only if it exits the target}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02145}02145         \textcolor{comment}{// Source neutrons definition 1: The generation of neutrons is not changed after (n, Xn) reactions}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02146}02146         \textcolor{keywordflow}{if}(TMXOption::IsSrcNeutronDefinitionWithNxN(p-\/>int\_Option)) \{ ScoreNeutronGeneration(MotherNeutronGeneration, Nb\_inelastic-\/1); \}\textcolor{comment}{// +Nb\_inelastic-\/1 neutron from generation MotherNeutronGeneration}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02147}02147         \textcolor{keywordflow}{else} \{ \textcolor{comment}{// The generation of neutrons is changed after (n, Xn) reactions}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02148}02148             ScoreNeutronGeneration(MotherNeutronGeneration+1, Nb\_inelastic); \}\textcolor{comment}{// +Nb\_inelastic neutron for generation MotherNeutronGeneration+1}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02149}02149     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02150}02150 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02151}02151 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02152}02152 \textcolor{keywordtype}{void} SteppingAction::CountNeutronGeneration\_FromFission(\textcolor{keywordtype}{int} NeutronGeneration) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02153}02153     \textcolor{comment}{// Secondary neutron is counted only if it is not a source neutron}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02154}02154     \textcolor{keywordflow}{if} (NeutronGeneration >= 1 \&\& fIsSourceNeutron == \textcolor{keyword}{false}) \{ ScoreNeutronGeneration(NeutronGeneration, 1); \} \textcolor{comment}{// +1 neutron from generation fNeutronGeneration+1 (old definition (Energy Amplifier 1995))}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02155}02155 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02156}02156 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02157}02157 \textcolor{keywordtype}{void} SteppingAction::ScoreNeutronGeneration(\textcolor{keywordtype}{int} NeutronGeneration, \textcolor{keywordtype}{int} NeutronNumber) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02158}02158     Nf += NeutronNumber;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02159}02159     fEventAction-\/>SetNf(Nf);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02160}02160     fEventAction-\/>AddNbNeutronPerGeneration(NeutronGeneration, NeutronNumber);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02161}02161     fRunAction-\/>GetRun()-\/>m\_NeutronGenerationsHisto-\/>Fill(NeutronGeneration, NeutronNumber);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02162}02162 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02163}02163 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02164}02164 \textcolor{comment}{// void SteppingAction::MCNPkeffInitialize(const G4Step* theStep) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02165}02165 \textcolor{comment}{//     // Score neutron birth for neutron counting}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02166}02166 \textcolor{comment}{//     if(theStep-\/>GetTrack()}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02167}02167 \textcolor{comment}{//     \&\& theStep-\/>GetTrack()-\/>GetDefinition()}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02168}02168 \textcolor{comment}{//     \&\& theStep-\/>GetTrack()-\/>GetParentID() == 0}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02169}02169 \textcolor{comment}{//     \&\& theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() == "{}neutron"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02170}02170 \textcolor{comment}{//     \&\& theStep-\/>GetTrack()-\/>GetCurrentStepNumber() == 1}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02171}02171 \textcolor{comment}{//     ) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02172}02172 \textcolor{comment}{//         // MCNP keff estimators}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02173}02173 \textcolor{comment}{//         fEventAction-\/>Add\_NsourceNeutronPerEvent(1); // Add 1 more source neutron in this cycle (= event)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02174}02174 \textcolor{comment}{//         fLengthBetweenCollision = theStep-\/>GetStepLength()/cm; // Initialize stepLength accumulator}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02175}02175 \textcolor{comment}{//     \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02176}02176 \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02198}02198 \textcolor{comment}{}\textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02199}02199 \textcolor{comment}{// Scoring tools}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02200}02200 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02215}02215 \textcolor{comment}{}\textcolor{keywordtype}{void} SteppingAction::ManageNeutronScoring(\textcolor{keyword}{const} G4Step* theStep, \textcolor{keywordtype}{int}\& nNeutrons) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02216}02216     \textcolor{keywordflow}{if}(theStep-\/>GetTrack()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02217}02217     \&\& theStep-\/>GetTrack()-\/>GetDefinition()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02218}02218     \&\& theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}neutron"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02219}02219 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02220}02220         \textcolor{comment}{// Get required quantites from the step}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02221}02221         \textcolor{comment}{// to do G4StepStatus PostStatus = theStep-\/>GetPostStepPoint()-\/>GetStepStatus(); // Status of the post-\/step}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02222}02222         G4ThreeVector      PostPos = theStep-\/>GetPostStepPoint()-\/>GetPosition();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02223}02223         \textcolor{comment}{// to do G4double    PostGlobalTime = theStep-\/>GetPostStepPoint()-\/>GetGlobalTime()/s; // Time since the event is created}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02224}02224         G4String processName = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02225}02225         \textcolor{keywordflow}{if}(theStep-\/>GetPostStepPoint()-\/>GetProcessDefinedStep())}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02226}02226             processName = theStep-\/>GetPostStepPoint()-\/>GetProcessDefinedStep()-\/>GetProcessName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02227}02227 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02228}02228         \textcolor{comment}{// -\/-\/ Neutron birth (initialisation and counting of neutrons)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02229}02229         ManageNeutronBirth(theStep); \textcolor{comment}{// Fill histograms/Ntuples and manage neutron generation}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02230}02230 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02231}02231         \textcolor{comment}{// Number of neutrons as a function of time in 4 different regions}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02232}02232         \textcolor{comment}{// to do if( log10(PostGlobalTime) > log10(f\_tBin) + fDeltat ) // If the time reach another bin of the histogram}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02233}02233             \textcolor{comment}{// to do FillNdensityVStimeHisto(PostGlobalTime);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02234}02234 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02236}02236         \textcolor{comment}{//  Definition of the neutron scoring}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02237}02237         \textcolor{comment}{// only for fission, capture or inelastic reactions}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02239}02239 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02240}02240 \textcolor{comment}{//         // Calculate neutron mean free (or GetMeanFreePath)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02241}02241 \textcolor{comment}{//          if (processName=="{}nFission"{} || processName=="{}nCapture"{} || processName=="{}neutronInelastic"{} || processName=="{}hadElastic"{}) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02242}02242 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02243}02243 \textcolor{comment}{//         \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02244}02244 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02246}02246         \textcolor{comment}{//  Scoring of fission, capture or inelastic reaction}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02248}02248 \textcolor{comment}{}        \textcolor{keywordflow}{if} (processName==\textcolor{stringliteral}{"{}nFission"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02249}02249             ManageFission(theStep);\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02250}02250         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (processName==\textcolor{stringliteral}{"{}nCapture"{}} \&\& !TMXOption::IsKeffCalculation(p-\/>int\_Option)) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02251}02251             ManageCapture(theStep);\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02252}02252         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (processName==\textcolor{stringliteral}{"{}neutronInelastic"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02253}02253             ManageNInelastic(theStep, nNeutrons);\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02254}02254 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02255}02255         ManageNeutronEscape(theStep);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02256}02256 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02258}02258         \textcolor{comment}{//  Energy vs Time histogram}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02259}02259         \textcolor{comment}{//  Fluence Energy spectrum}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02261}02261 \textcolor{comment}{}        \textcolor{comment}{// to do FillHistoTimeEnergyFlux(theStep, PostStatus == fGeomBoundary, nNeutrons);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02262}02262     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02263}02263 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02264}02264 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02265}02265 \textcolor{keywordtype}{void} SteppingAction::ManageNeutronBirth(\textcolor{keyword}{const} G4Step * theStep) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02266}02266     \textcolor{keywordflow}{if}(theStep-\/>GetTrack()-\/>GetCurrentStepNumber() == 1) \{ \textcolor{comment}{// If first step of the neutron track}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02267}02267 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02268}02268         \textcolor{comment}{// PreStep quantities}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02269}02269         G4ThreeVector PrePos   = theStep-\/>GetPreStepPoint()-\/>GetPosition();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02270}02270         \textcolor{comment}{// to do G4double PreGlobalTime = theStep-\/>GetPreStepPoint()-\/>GetGlobalTime()/s;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02271}02271 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02272}02272         fRunAction-\/>GetRun()-\/>m\_scoringNtupleEverythingN-\/>score(theStep, -\/1, fPhysicalVolumeNumber, 0, 0, 0, 0, 0, fNeutronGeneration, 0);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02273}02273         \textcolor{comment}{// FillNtuple1(PrePos.x()/mm, PrePos.y()/mm, PrePos.z()/mm, -\/1, fPhysicalVolumeNumber, 0, 0, 0, 0, 0, theStep-\/>GetTrack()-\/>GetParentID(), 0);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02274}02274 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02275}02275         \textcolor{comment}{// to do FillNdensityVStimeHisto(PreGlobalTime);  // Fill the number of neutrons as a function of time}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02276}02276     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02277}02277 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02278}02278 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02279}02279 \textcolor{keywordtype}{void} SteppingAction::ManageFission(\textcolor{keyword}{const} G4Step* theStep) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02280}02280 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02281}02281     \textcolor{comment}{// Instantiate the analysis manager for the scoring}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02282}02282 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02283}02283     \textcolor{comment}{// Get required quantites from the step}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02284}02284     G4Track* theTrack = theStep-\/>GetTrack();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02285}02285     G4int ID\_track = -\/1;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02286}02286     \textcolor{keywordflow}{if}(theTrack) \{ID\_track = theTrack-\/>GetTrackID();\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02287}02287     G4double StepLength = theStep-\/>GetStepLength()/cm; \textcolor{comment}{// Length of the step in cm}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02288}02288     G4double    energyK = KineticEnergy\_eV(theStep);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02289}02289     G4double       Tot\_Edep = theStep-\/>GetTotalEnergyDeposit()/eV; \textcolor{comment}{// Total Energy Deposit in this step in eV}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02290}02290     G4double PostGlobalTime = theStep-\/>GetPostStepPoint()-\/>GetGlobalTime()/s; \textcolor{comment}{// Time since the event is created}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02291}02291     G4ThreeVector   PostPos = theStep-\/>GetPostStepPoint()-\/>GetPosition(); \textcolor{comment}{// Position of the postStep point}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02292}02292     G4double Threshold\_promtNeutrons = 40*ms; \textcolor{comment}{// WARNING: hard-\/coded value, to discriminate between prompt and delayed neutrons}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02293}02293 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02294}02294     \textcolor{comment}{// Declare a fission at fID\_firstfission to estimate energy released by fission and secondaries}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02295}02295     \textcolor{keywordflow}{if}( !fFromFission ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02296}02296         fFromFission = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02297}02297         fID\_firstfission = ID\_track;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02298}02298         fEperFission = Tot\_Edep;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02299}02299         fNfission\_fromFission = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02300}02300     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02301}02301     ++fNfission\_fromFission;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02302}02302 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02303}02303     \textcolor{comment}{// Count number of fissions}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02304}02304     ++Nfission;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02305}02305     fEventAction-\/>AddFission(1);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02306}02306 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02307}02307     \textcolor{keywordflow}{if} (fNeutronGeneration == 0) \{ \textcolor{comment}{// If it is a source neutron}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02308}02308         fEventAction-\/>AddN0fission(1); \textcolor{comment}{// Increase number of fissions due to source neutrons}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02309}02309         fRunAction-\/>GetRun()-\/>m\_MappingXY\_DeathN0-\/>Fill(PostPos.x(), PostPos.y());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02310}02310         fRunAction-\/>GetRun()-\/>m\_MappingXZ\_DeathN0-\/>Fill(PostPos.x(), PostPos.z());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02311}02311     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02312}02312 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02313}02313     \textcolor{comment}{// Energy of fission}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02314}02314     fRunAction-\/>GetRun()-\/>m\_d2N\_dlogElogTime\_fission-\/>Fill(std::log10(PostGlobalTime), std::log10(Tot\_Edep));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02315}02315 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02316}02316     \textcolor{comment}{// Energy tot for fission}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02317}02317     G4double TotE\_fission = Tot\_Edep;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02318}02318 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02319}02319     \textcolor{comment}{// Number of fission neutrons}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02320}02320     \textcolor{keyword}{const} std::vector<const G4Track*> *secondaries = theStep-\/>GetSecondaryInCurrentStep();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02321}02321     \textcolor{keywordflow}{for}(G4int i=0; i<(G4int)secondaries-\/>size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02322}02322         G4String secondary\_particleName = (*secondaries)[i]-\/>GetDefinition()-\/>GetParticleName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02323}02323         \textcolor{keywordflow}{if} (secondary\_particleName == \textcolor{stringliteral}{"{}neutron"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02324}02324             ++Nnfission;  \textcolor{comment}{// Increase the counter of neutrons coming from fission}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02325}02325 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02326}02326             \textcolor{keywordflow}{if} ((*secondaries)[i]-\/>GetGlobalTime()/s -\/ PostGlobalTime < Threshold\_promtNeutrons) \{ \textcolor{comment}{// prompt neutrons}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02327}02327                 fPromptN = \textcolor{keyword}{true}; \textcolor{comment}{// This is a prompt neutron}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02328}02328                 fRunAction-\/>GetRun()-\/>m\_d2N\_dlogElogTime\_n-\/>Fill(std::log10((*secondaries)[i]-\/>GetGlobalTime()/s), std::log10((*secondaries)[i]-\/>GetKineticEnergy()/eV)); \textcolor{comment}{// Energy and time for fission secondaries}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02329}02329             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02330}02330             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02331}02331                 fPromptN = \textcolor{keyword}{false}; \textcolor{comment}{// This is not a prompt neutron}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02332}02332                 fRunAction-\/>GetRun()-\/>m\_d2N\_dlogElogTime\_FFn-\/>Fill(std::log10((*secondaries)[i]-\/>GetGlobalTime()/s), std::log10((*secondaries)[i]-\/>GetKineticEnergy()/eV)); \textcolor{comment}{// Energy and time for fission secondaries}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02333}02333             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02334}02334         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02335}02335         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (secondary\_particleName == \textcolor{stringliteral}{"{}gamma"{}}) \{ \textcolor{comment}{// Energy and time for fission secondaries}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02336}02336             fRunAction-\/>GetRun()-\/>m\_d2N\_dlogElogTime\_g-\/>Fill(std::log10((*secondaries)[i]-\/>GetGlobalTime()/s), std::log10((*secondaries)[i]-\/>GetKineticEnergy()/eV));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02337}02337         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02338}02338         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (secondary\_particleName == \textcolor{stringliteral}{"{}e-\/"{}}) \{ \textcolor{comment}{// Energy and time for fission secondaries}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02339}02339             fRunAction-\/>GetRun()-\/>m\_d2N\_dlogElogTime\_FFe-\/>Fill(std::log10((*secondaries)[i]-\/>GetGlobalTime()/s), std::log10((*secondaries)[i]-\/>GetKineticEnergy()/eV));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02340}02340         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02341}02341         \textcolor{keywordflow}{else} \{ \textcolor{comment}{// Energy and time for fission secondaries}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02342}02342             fRunAction-\/>GetRun()-\/>m\_d2N\_dlogElogTime\_others-\/>Fill(std::log10((*secondaries)[i]-\/>GetGlobalTime()/s), std::log10((*secondaries)[i]-\/>GetKineticEnergy()/eV));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02343}02343         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02344}02344 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02345}02345         TotE\_fission += (*secondaries)[i]-\/>GetKineticEnergy()/eV;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02346}02346     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02347}02347     fRunAction-\/>GetRun()-\/>m\_d2N\_dlogElogTime\_tot-\/>Fill(std::log10(PostGlobalTime), std::log10(TotE\_fission)); \textcolor{comment}{// Energy and time for fission secondaries}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02348}02348     fEventAction-\/>Setnu(Nnfission/(\textcolor{keywordtype}{double})Nfission);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02349}02349     fEventAction-\/>SetFissionN(Nnfission);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02350}02350 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02351}02351     \textcolor{keyword}{const} G4Isotope* target = GetTargetIsotope(theStep-\/>GetPostStepPoint());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02352}02352     \textcolor{keywordflow}{if} (target-\/>GetName() == \textcolor{stringliteral}{"{}U235"{}}) \{ fEventAction-\/>AddNabsU5(1.);\}  \textcolor{comment}{// WARNING: hard-\/coded value related to the geometry}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02353}02353 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02354}02354     \textcolor{comment}{// Scoring of transmutation information}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02355}02355     \textcolor{keywordflow}{if}( IsSpentFuel(fPhysicalVolumeNumber) ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02356}02356         FillNtuple2(PostPos.x()/mm, PostPos.y()/mm, PostPos.z()/mm, energyK, fPhysicalVolumeNumber, 0, StepLength, fmap\_Region\_volume[fPhysicalVolumeNumber], target-\/>GetN(), target-\/>GetZ());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02357}02357     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02358}02358 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02359}02359     \textcolor{comment}{// If the multiplication is not required}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02360}02360     \textcolor{keywordflow}{if} (TMXOption::IsMultiplicationKilled(p-\/>int\_Option))}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02361}02361         theTrack-\/>SetTrackStatus(fKillTrackAndSecondaries);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02362}02362 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02363}02363     \textcolor{comment}{// Score fission in ntuple}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02364}02364     fRunAction-\/>GetRun()-\/>m\_scoringNtupleEverythingN-\/>score(theStep, 0, fPhysicalVolumeNumber, fPhysicalVolumeNumber, 0, 0, 0, 0, fNeutronGeneration, 0);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02365}02365 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02366}02366 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02367}02367 \textcolor{keywordtype}{void} SteppingAction::ManageCapture(\textcolor{keyword}{const} G4Step* theStep) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02368}02368 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02369}02369     \textcolor{comment}{// Get required quantites from the step}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02370}02370     G4ThreeVector PostPos = theStep-\/>GetPostStepPoint()-\/>GetPosition(); \textcolor{comment}{// Position of the postStep point}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02371}02371     G4double StepLength = theStep-\/>GetStepLength()/cm; \textcolor{comment}{// Length of the step in cm}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02372}02372     G4double    energyK = KineticEnergy\_eV(theStep);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02373}02373 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02374}02374     \textcolor{comment}{// Get the number of neutrons absorbed or captured by U-\/235 and U-\/238 respectively}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02375}02375     \textcolor{keyword}{const} G4Isotope* target = GetTargetIsotope(theStep-\/>GetPostStepPoint());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02376}02376     \textcolor{keywordflow}{if}     (target-\/>GetName() == \textcolor{stringliteral}{"{}U235"{}})  \textcolor{comment}{// WARNING : hard coded value related to the geometry}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02377}02377         fEventAction-\/>AddNabsU5(1.);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02378}02378     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(target-\/>GetName() == \textcolor{stringliteral}{"{}U238"{}})  \textcolor{comment}{// WARNING : hard coded value related to the geometry}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02379}02379         fEventAction-\/>AddNcapU8(1.);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02380}02380 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02381}02381     \textcolor{comment}{// Count neutron absorption}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02382}02382     fEventAction-\/>AddNabsTot(1);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02383}02383 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02384}02384     \textcolor{comment}{// Score death position of source neutrons}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02385}02385     \textcolor{keywordflow}{if} (fNeutronGeneration == 0) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02386}02386         fRunAction-\/>GetRun()-\/>m\_MappingXY\_DeathN0-\/>Fill(PostPos.x(), PostPos.y());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02387}02387         fRunAction-\/>GetRun()-\/>m\_MappingXZ\_DeathN0-\/>Fill(PostPos.x(), PostPos.z());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02388}02388     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02389}02389 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02390}02390     \textcolor{comment}{// If sample to study the transmutation}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02391}02391     \textcolor{keywordflow}{if}( IsSpentFuel(fPhysicalVolumeNumber) ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02392}02392         FillNtuple2(PostPos.x()/mm, PostPos.y()/mm, PostPos.z()/mm, energyK, 0, fPhysicalVolumeNumber, StepLength, fmap\_Region\_volume[fPhysicalVolumeNumber], target-\/>GetN(), target-\/>GetZ());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02393}02393     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02394}02394 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02395}02395     \textcolor{comment}{// Score capture in ntuple}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02396}02396     fRunAction-\/>GetRun()-\/>m\_scoringNtupleEverythingN-\/>score(theStep, 0, fPhysicalVolumeNumber, 0, fPhysicalVolumeNumber, 0, 0, 0, fNeutronGeneration, 0);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02397}02397 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02398}02398 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02399}02399 \textcolor{keywordtype}{void} SteppingAction::ManageNInelastic(\textcolor{keyword}{const} G4Step* theStep, \textcolor{keywordtype}{int}\& nNeutrons) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02400}02400 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02401}02401     \textcolor{comment}{// Get required quantites from the step}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02402}02402     G4ThreeVector PostPos = theStep-\/>GetPostStepPoint()-\/>GetPosition(); \textcolor{comment}{// Position of the postStep point}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02403}02403     G4double StepLength = theStep-\/>GetStepLength()/cm; \textcolor{comment}{// Length of the step in cm}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02404}02404     G4double    energyK = KineticEnergy\_eV(theStep);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02405}02405     G4int InelasticVol = 0, nXnVol = 0, nnPrimeVol = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02406}02406 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02407}02407     \textcolor{comment}{// Get target isotope (nucleus which interacts with neutron)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02408}02408     \textcolor{keyword}{const} G4Isotope* target = GetTargetIsotope(theStep-\/>GetPostStepPoint());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02409}02409     nNeutrons = 0; \textcolor{comment}{// Initialize number of secondary neutrons to 0}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02410}02410 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02411}02411     \textcolor{comment}{// Counter number of secondary neutrons from inelastic}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02412}02412     \textcolor{keyword}{const} std::vector<const G4Track*> *secondaries = theStep-\/>GetSecondaryInCurrentStep();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02413}02413     \textcolor{keywordflow}{for}(G4int i=0; i<(G4int)secondaries-\/>size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02414}02414         \textcolor{keywordflow}{if} ((*secondaries)[i]-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}neutron"{}}) \{ ++nNeutrons; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02415}02415     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02416}02416 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02417}02417     \textcolor{keywordflow}{if}(nNeutrons == 0) \{ \textcolor{comment}{// Neutron is absorbed => usually called inelastic reaction (e.g. (n, alpha) reaction)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02418}02418         InelasticVol = fPhysicalVolumeNumber;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02419}02419 \textcolor{comment}{//         if(IsSpentFuel(fPhysicalVolumeNumber)) \{ InelasticVol += theStep-\/>GetPostStepPoint()-\/>GetPhysicalVolume()-\/>GetCopyNo(); \} // if volume = pSpentFuel -\/> element to be transmuted}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02420}02420 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02421}02421         \textcolor{comment}{// Death position of source neutrons}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02422}02422         \textcolor{keywordflow}{if} (fNeutronGeneration == 0) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02423}02423             fRunAction-\/>GetRun()-\/>m\_MappingXY\_DeathN0-\/>Fill(PostPos.x(), PostPos.y());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02424}02424             fRunAction-\/>GetRun()-\/>m\_MappingXZ\_DeathN0-\/>Fill(PostPos.x(), PostPos.z());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02425}02425         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02426}02426 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02427}02427         \textcolor{comment}{// If sample to study the transmutation}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02428}02428         \textcolor{keywordflow}{if}( IsSpentFuel(fPhysicalVolumeNumber) ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02429}02429             FillNtuple2(PostPos.x()/mm, PostPos.y()/mm, PostPos.z()/mm, energyK, 0, InelasticVol, StepLength, fmap\_Region\_volume[fPhysicalVolumeNumber], target-\/>GetN(), target-\/>GetZ());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02430}02430         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02431}02431     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02432}02432     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(nNeutrons == 1) \{ \textcolor{comment}{// (n, n') reaction}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02433}02433         nnPrimeVol = fPhysicalVolumeNumber;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02434}02434 \textcolor{comment}{//         if(IsSpentFuel(fPhysicalVolumeNumber)) \{ nnPrimeVol += theStep-\/>GetPostStepPoint()-\/>GetPhysicalVolume()-\/>GetCopyNo(); \} // if volume = pSpentFuel -\/> element to be transmuted}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02435}02435     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02436}02436     \textcolor{keywordflow}{else} \{ \textcolor{comment}{// nNeutrons > 1 => (n, Xn) reaction}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02437}02437         nXnVol = fPhysicalVolumeNumber;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02438}02438 \textcolor{comment}{//         if(IsSpentFuel(fPhysicalVolumeNumber)) \{ nXnVol += theStep-\/>GetPostStepPoint()-\/>GetPhysicalVolume()-\/>GetCopyNo(); \} // if volume = pSpentFuel -\/> element to be transmuted}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02439}02439 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02440}02440         \textcolor{comment}{// Death position of source neutrons}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02441}02441         \textcolor{keywordflow}{if} (fNeutronGeneration == 0) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02442}02442             fRunAction-\/>GetRun()-\/>m\_MappingXY\_DeathN0-\/>Fill(PostPos.x(), PostPos.y());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02443}02443             fRunAction-\/>GetRun()-\/>m\_MappingXZ\_DeathN0-\/>Fill(PostPos.x(), PostPos.z());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02444}02444         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02445}02445 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02446}02446         \textcolor{comment}{// If sample to study the transmutation}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02447}02447         \textcolor{keywordflow}{if}( IsSpentFuel(fPhysicalVolumeNumber) ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02448}02448             FillNtuple2(PostPos.x()/mm, PostPos.y()/mm, PostPos.z()/mm, energyK, 0, nXnVol, StepLength, fmap\_Region\_volume[fPhysicalVolumeNumber], target-\/>GetN(), target-\/>GetZ());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02449}02449         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02450}02450     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02451}02451 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02452}02452     \textcolor{comment}{// WARNING: hard-\/coded values to count the absorption/capture in U-\/235 or U-\/238}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02453}02453     \textcolor{keywordflow}{if}(nNeutrons != 1 \&\& target-\/>GetName() == \textcolor{stringliteral}{"{}U235"{}}) \textcolor{comment}{// If absorption in U235}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02454}02454         fEventAction-\/>AddNabsU5(1.);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02455}02455     \textcolor{keywordflow}{if}(nNeutrons == 0 \&\& target-\/>GetName() == \textcolor{stringliteral}{"{}U238"{}}) \textcolor{comment}{// If capture in U235}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02456}02456         fEventAction-\/>AddNcapU8(1.);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02457}02457 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02458}02458     \textcolor{comment}{// Count neutron total absorption}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02459}02459     \textcolor{keywordflow}{if}(nNeutrons == 0)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02460}02460         fEventAction-\/>AddNabsTot(1);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02461}02461 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02462}02462     \textcolor{comment}{// Score inelastic in ntuple}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02463}02463     fRunAction-\/>GetRun()-\/>m\_scoringNtupleEverythingN-\/>score(theStep, 0, fPhysicalVolumeNumber, 0, 0, InelasticVol, nnPrimeVol, nXnVol, fNeutronGeneration, 0);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02464}02464 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02465}02465 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02466}02466 \textcolor{keywordtype}{void} SteppingAction::ManageNeutronEscape(\textcolor{keyword}{const} G4Step* theStep) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02467}02467     \textcolor{keywordflow}{if} (theStep-\/>GetPostStepPoint()-\/>GetStepStatus() == fWorldBoundary}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02468}02468         \&\& theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}neutron"{}})}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02469}02469     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02470}02470         G4ThreeVector PrePos = theStep-\/>GetPreStepPoint()-\/>GetPosition();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02471}02471         fRunAction-\/>GetRun()-\/>m\_scoringNtupleEverythingN-\/>score(theStep, -\/1, fPhysicalVolumeNumber, 0, 0, 0, 0, 0, fNeutronGeneration, -\/1);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02472}02472 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02473}02473         \textcolor{comment}{// Kill the neutron}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02474}02474         theStep-\/>GetTrack()-\/>SetTrackStatus(fStopAndKill);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02475}02475     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02476}02476 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02477}02477 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02478}02478 \textcolor{keyword}{const} G4Isotope* SteppingAction::GetTargetIsotope(G4StepPoint* thePostPoint) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02479}02479     G4VProcess* process = \textcolor{keyword}{const\_cast<}G4VProcess*\textcolor{keyword}{>}(thePostPoint-\/>GetProcessDefinedStep());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02480}02480     G4HadronicProcess* hproc = \textcolor{keyword}{dynamic\_cast<}G4HadronicProcess*\textcolor{keyword}{>}(process);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02481}02481     \textcolor{keyword}{const} G4Isotope* target = NULL;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02482}02482     \textcolor{keywordflow}{if} (hproc) target = hproc-\/>GetTargetIsotope();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02483}02483 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02484}02484     \textcolor{keywordflow}{return} target;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02485}02485 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02486}02486 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02487}02487 \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02488}02488 \textcolor{comment}{void SteppingAction::FillNtuple1(G4double PosX, G4double PosY, G4double PosZ, G4int reasonID, G4int EveryVol, G4int FissionVol, G4int CaptureVol, G4int InelasticVol, G4int nnPrimeVol, G4int nXnVol, G4int pID, G4int OutPhysVol) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02489}02489 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02490}02490 \textcolor{comment}{    auto analysisManager = G4AnalysisManager::Instance();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02491}02491 \textcolor{comment}{    analysisManager-\/>FillNtupleFColumn( 0, 0,PosX);          // ID= 0 PosX en mm}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02492}02492 \textcolor{comment}{    analysisManager-\/>FillNtupleFColumn( 0, 1,PosY);          // ID= 1 PosY en mm}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02493}02493 \textcolor{comment}{    analysisManager-\/>FillNtupleFColumn( 0, 2,PosZ);          // ID= 2 PosZ en mm}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02494}02494 \textcolor{comment}{    analysisManager-\/>FillNtupleIColumn( 0, 3,reasonID);      // ID= 3 ID of the scoring}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02495}02495 \textcolor{comment}{    analysisManager-\/>FillNtupleIColumn( 0, 4,EveryVol);      // ID= 4 Number of neutrons in the volume of interest}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02496}02496 \textcolor{comment}{    analysisManager-\/>FillNtupleIColumn( 0, 5,FissionVol);    // ID= 5 Number of neutrons inducing fission into the volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02497}02497 \textcolor{comment}{    analysisManager-\/>FillNtupleIColumn( 0, 6,CaptureVol);    // ID= 6 Number of neutrons captured         into the volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02498}02498 \textcolor{comment}{    analysisManager-\/>FillNtupleIColumn( 0, 7,InelasticVol);  // ID= 7 Number of neutrons inducing inelastic scattering into the volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02499}02499 \textcolor{comment}{    analysisManager-\/>FillNtupleIColumn( 0, 8,nnPrimeVol);    // ID= 8 Number of neutrons inducing inelastic scattering into the volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02500}02500 \textcolor{comment}{    analysisManager-\/>FillNtupleIColumn( 0, 9,nXnVol);        // ID= 9 Number of neutrons inducing inelastic scattering into the volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02501}02501 \textcolor{comment}{    analysisManager-\/>FillNtupleIColumn( 0,10,pID);           // ID=11 ID of the parent track}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02502}02502 \textcolor{comment}{    analysisManager-\/>FillNtupleIColumn( 0,11,fNeutronGeneration); // ID=10 Neutron generation number}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02503}02503 \textcolor{comment}{    analysisManager-\/>FillNtupleIColumn( 0,12,OutPhysVol);    // ID=12 Number of neutrons going out of the volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02504}02504 \textcolor{comment}{    // analysisManager-\/>FillNtupleDColumn( 0,13,Edep);       // ID=13 Kinetic energy in eV}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02505}02505 \textcolor{comment}{//     analysisManager-\/>FillNtupleIColumn( 0, 7,InPhysVol);     // ID= 7 Number of neutrons entering  in the volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02506}02506 \textcolor{comment}{//     analysisManager-\/>FillNtupleDColumn( 0,14,GlobalTime);    // ID=14 Time since the track is created in ns}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02507}02507 \textcolor{comment}{//     analysisManager-\/>FillNtupleDColumn( 0,15,StepLength);    // ID=15 Neutron step length in cm}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02508}02508 \textcolor{comment}{//     analysisManager-\/>FillNtupleIColumn( 0,16,fNeutronGeneration);     // ID=16 Neutron generation number}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02509}02509 \textcolor{comment}{    analysisManager-\/>AddNtupleRow(0);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02510}02510 \textcolor{comment}{\}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02511}02511 \textcolor{comment}{*/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02512}02512 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02513}02513 \textcolor{keywordtype}{void} SteppingAction::FillNtuple2(G4double PosX, G4double PosY, G4double PosZ, G4double energyK, G4int FissionVol, G4int CaptureVol, G4double StepLength, G4double CubicVolume, G4int A, G4int Z) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02514}02514     fRunAction-\/>GetRun()-\/>m\_scoringNtupleTransmutationInfo-\/>Fill(}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02515}02515         PosX,                   \textcolor{comment}{// PosX en mm}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02516}02516         PosY,                   \textcolor{comment}{// PosY en mm}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02517}02517         PosZ,                   \textcolor{comment}{// PosZ en mm}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02518}02518         energyK,                \textcolor{comment}{// Kinetic energy in eV}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02519}02519         StepLength/CubicVolume, \textcolor{comment}{// Neutron step length in cm}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02520}02520         FissionVol,             \textcolor{comment}{// Number of neutrons inducing fission into the volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02521}02521         CaptureVol,             \textcolor{comment}{// Number of neutrons captured         into the volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02522}02522         fNeutronGeneration,     \textcolor{comment}{// ID=16 Neutron generation number}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02523}02523         A,                      \textcolor{comment}{// Number of neutrons inducing inelastic scattering into the volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02524}02524         Z                       \textcolor{comment}{// Number of neutrons inducing inelastic scattering into the volume}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02525}02525     );}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02526}02526 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02527}02527 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02528}02528 \textcolor{keywordtype}{void} SteppingAction::FillNtupleDepositedPower(\textcolor{keyword}{const} G4Step* theStep) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02529}02529     \textcolor{keywordflow}{if} (theStep \&\& theStep-\/>GetTotalEnergyDeposit()) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02530}02530         G4double N0\_Energy = theStep-\/>GetTotalEnergyDeposit()/eV;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02531}02531         \textcolor{keywordflow}{if} (N0\_Energy > 0.) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02532}02532             \textcolor{comment}{// G4int row = 2;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02533}02533             \textcolor{keywordflow}{if} (theStep-\/>GetPostStepPoint() \&\&}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02534}02534                 theStep-\/>GetPostStepPoint()-\/>GetPhysicalVolume()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02535}02535             ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02536}02536                 G4String thePostPVname = theStep-\/>GetPostStepPoint()-\/>GetPhysicalVolume()-\/>GetName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02537}02537                 G4ThreeVector position = theStep-\/>GetPostStepPoint()-\/>GetPosition();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02538}02538                 fRunAction-\/>GetRun()-\/>m\_scoringNtupleDepositedPower-\/>Fill(}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02539}02539                     position.x()/mm, \textcolor{comment}{// X Position}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02540}02540                     position.y()/mm, \textcolor{comment}{// Y Position}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02541}02541                     position.z()/mm, \textcolor{comment}{// Z Position}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02542}02542                     N0\_Energy,       \textcolor{comment}{// Energy}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02543}02543                     thePostPVname.find(\textcolor{stringliteral}{"{}FuelPellet"{}}) != std::string::npos ? 1 : 0}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02544}02544                 );}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02545}02545             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02546}02546         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02547}02547     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02548}02548 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02549}02549 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02550}02550 \textcolor{keywordtype}{void} SteppingAction::FillNtupleNeutronSource(G4ThreeVector N0\_Pos, G4ThreeVector N0\_Momentum, G4double N0\_Energy) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02551}02551     \textcolor{keywordflow}{if} (N0\_Energy > 0.) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02552}02552         fRunAction-\/>GetRun()-\/>m\_scoringNtupleTMXNeutronSource-\/>Fill(}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02553}02553             N0\_Pos.x()/mm,   \textcolor{comment}{// X Position}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02554}02554             N0\_Pos.y()/mm,   \textcolor{comment}{// Y Position}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02555}02555             N0\_Pos.z()/mm,   \textcolor{comment}{// Z Position}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02556}02556             N0\_Momentum.x(), \textcolor{comment}{// X Momentum}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02557}02557             N0\_Momentum.y(), \textcolor{comment}{// Y Momentum}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02558}02558             N0\_Momentum.z(), \textcolor{comment}{// Z Momentum}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02559}02559             N0\_Energy        \textcolor{comment}{// Energy}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02560}02560         );}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02561}02561     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02562}02562 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02563}02563 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02564}02564 \textcolor{keywordtype}{void} SteppingAction::FillNtupleProton(G4ThreeVector N0\_Pos, G4ThreeVector N0\_Momentum, G4double N0\_Energy) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02565}02565     \textcolor{keywordflow}{if} (N0\_Energy > 0.) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02566}02566         fRunAction-\/>GetRun()-\/>m\_scoringNtupleProton-\/>Fill(}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02567}02567             N0\_Pos.x()/mm,   \textcolor{comment}{// X Position}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02568}02568             N0\_Pos.y()/mm,   \textcolor{comment}{// Y Position}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02569}02569             N0\_Pos.z()/mm,   \textcolor{comment}{// Z Position}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02570}02570             N0\_Momentum.x(), \textcolor{comment}{// X Momentum}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02571}02571             N0\_Momentum.y(), \textcolor{comment}{// Y Momentum}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02572}02572             N0\_Momentum.z(), \textcolor{comment}{// Z Momentum}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02573}02573             N0\_Energy        \textcolor{comment}{// Energy}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02574}02574         );}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02575}02575     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02576}02576 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02577}02577 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02578}02578 \textcolor{keywordtype}{void} SteppingAction::FillNdensityVStimeHisto(\textcolor{keywordtype}{double} time) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02579}02579 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02580}02580     \textcolor{keyword}{auto} analysisManager = G4AnalysisManager::Instance();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02581}02581     f\_tBin = time;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02582}02582     \textcolor{keywordflow}{if}( IsTargetRegion (fPhysicalVolumeNumber)) \{ analysisManager-\/>FillH1(21, log10(time)); \}  \textcolor{comment}{// Target    region}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02583}02583     \textcolor{keywordflow}{if}( IsCoolantRegion(fPhysicalVolumeNumber)) \{ analysisManager-\/>FillH1(22, log10(time)); \}  \textcolor{comment}{// coolant   region}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02584}02584     \textcolor{keywordflow}{if}( IsFuel         (fPhysicalVolumeNumber)) \{ analysisManager-\/>FillH1(23, log10(time)); \}  \textcolor{comment}{// fuel      region}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02585}02585     \textcolor{keywordflow}{if}( IsReflector    (fPhysicalVolumeNumber)) \{ analysisManager-\/>FillH1(24, log10(time)); \}  \textcolor{comment}{// Reflector region}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02586}02586 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02587}02587 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02588}02588 \textcolor{keywordtype}{void} SteppingAction::FillEdepInStepHisto(\textcolor{keyword}{const} G4Step * theStep, \textcolor{keywordtype}{double} \textcolor{comment}{/*dbl\_Ibeam*/}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02589}02589     \textcolor{keywordflow}{if}(!TMXOption::IsMultiplicationKilled(p-\/>int\_Option)) \{  \textcolor{comment}{// If multiplication is not killed}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02590}02590 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02591}02591         \textcolor{comment}{// Total Energy Deposit in this step in eV}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02592}02592         G4double Tot\_Edep = theStep-\/>GetTotalEnergyDeposit()/eV;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02593}02593 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02594}02594         \textcolor{keywordflow}{if}( Tot\_Edep > 0 ) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02595}02595             fEventAction-\/>AddEdep(Tot\_Edep); \textcolor{comment}{// Add energy deposit to this event}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02596}02596 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02597}02597             \textcolor{keywordflow}{if} (fmap\_Region\_volume[fPhysicalVolumeNumber] != 1) \{ \textcolor{comment}{// Energy deposit /cm3 in listed volumes (not in the universe)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02598}02598                 fRunAction-\/>GetRun()-\/>m\_MappingVol\_Edep-\/>Fill(fPhysicalVolumeNumber, Tot\_Edep  /fmap\_Region\_volume[fPhysicalVolumeNumber]);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02599}02599             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02600}02600             fRunAction-\/>GetRun()-\/>m\_MappingEdep-\/>Fill(fPhysicalVolumeNumber, Tot\_Edep ); \textcolor{comment}{// Energy deposit in listed volumes}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02601}02601             fRunAction-\/>GetRun()-\/>m\_MappingEdep\_square-\/>Fill(fPhysicalVolumeNumber, Tot\_Edep*Tot\_Edep ); \textcolor{comment}{// Energy deposit\string^2 in listed volumes}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02602}02602             fRunAction-\/>GetRun()-\/>m\_MappingEdep\_N-\/>Fill(fPhysicalVolumeNumber); \textcolor{comment}{// Number of times the deposited energy is scored}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02603}02603         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02604}02604     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02605}02605 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02606}02606 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02607}02607 \textcolor{keywordtype}{void} SteppingAction::FillBeamProfile(G4Track\& theTrack, \textcolor{keywordtype}{int} stepnumber, G4ThreeVector\& PrePos, G4AnalysisManager\& \textcolor{comment}{/*analysisManager*/}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02608}02608     \textcolor{keywordflow}{if}(theTrack.GetParentID() == 0 \&\& stepnumber==1) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02609}02609         fRunAction-\/>GetRun()-\/>m\_MappingYZ\_pSrc-\/>Fill(PrePos.y()/mm, PrePos.z()/mm, 1); \textcolor{comment}{// Beam profile}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02610}02610     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02611}02611 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02612}02612 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02613}02613 \textcolor{keywordtype}{void} SteppingAction::FillEdepPrimaries(\textcolor{keyword}{const} G4Step* theStep\textcolor{comment}{/*G4ThreeVector\& PostPos, double Tot\_Edep*/}, \textcolor{keywordtype}{double} \textcolor{comment}{/*dbl\_Ibeam*/}, G4AnalysisManager\& \textcolor{comment}{/*analysisManager*/}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02614}02614     G4double Tot\_Edep = theStep-\/>GetTotalEnergyDeposit()/eV; \textcolor{comment}{// Total Energy Deposit in this step in eV}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02615}02615     G4ThreeVector  PrePos = theStep-\/>GetPreStepPoint()-\/>GetPosition();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02616}02616     G4ThreeVector PostPos = theStep-\/>GetPostStepPoint()-\/>GetPosition();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02617}02617     \textcolor{keywordflow}{if}( PostPos.z() > fTargetZdistanceToBottom -\/ fh0 -\/ 126*mm \&\& PostPos.z() < fTargetZdistanceToBottom -\/ fh0 + 126*mm ) \{ \textcolor{comment}{// \&\& Tot\_Edep > 0}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02618}02618         \textcolor{keywordtype}{double} MeshCubicVolume = ((p-\/>maxX-\/p-\/>minX)/p-\/>nbinsX * (p-\/>maxY-\/p-\/>minY)/p-\/>nbinsY)/cm2 * 25.2;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02619}02619         fRunAction-\/>GetRun()-\/>m\_MappingXY\_Ede\_ppSrc-\/>Fill(PostPos.x()/mm, PostPos.y()/mm, Tot\_Edep  /MeshCubicVolume); \textcolor{comment}{// Energy deposit mapping for primary protons}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02620}02620     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02621}02621     \textcolor{comment}{// FillNtupleDepositedPower(theStep); // Already taken into account in line 119}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02622}02622 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02623}02623 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02624}02624 \textcolor{keywordtype}{void} SteppingAction::AccumulateMeanEperFission(\textcolor{keyword}{const} G4Step* theStep) \{ \textcolor{comment}{// To calculate the mean deposited energy per fission}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02625}02625     \textcolor{keywordtype}{int}      ID\_track = theStep-\/>GetTrack()-\/>GetTrackID();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02626}02626     G4double Tot\_Edep = theStep-\/>GetTotalEnergyDeposit()/eV; \textcolor{comment}{// Total Energy Deposit in this step in eV}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02627}02627 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02628}02628     \textcolor{keywordflow}{if}( fID\_firstfission > ID\_track) \{  \textcolor{comment}{// If secondaries of fission n°fID\_firstfission are all simulated}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02629}02629         \textcolor{comment}{// Calculation of the mean energy per fission}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02630}02630         fEventAction-\/>AddEperfission(fEperFission/(G4double)fNfission\_fromFission);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02631}02631 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02632}02632         \textcolor{comment}{// Initialization of variables}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02633}02633         fFromFission = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02634}02634         fID\_firstfission = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02635}02635         fEperFission = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02636}02636         fNfission\_fromFission = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02637}02637     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02638}02638     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (fFromFission) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02639}02639         fEperFission += Tot\_Edep;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02640}02640     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02641}02641 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02642}02642     \textcolor{comment}{// WARNING: not necessary (to be tested)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02643}02643     \textcolor{keywordflow}{if} ( theStep-\/>GetTrack()}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02644}02644       \&\& theStep-\/>GetTrack()-\/>GetParentID() == 0}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02645}02645       \&\& theStep-\/>GetTrack()-\/>GetCurrentStepNumber()==1 ) \{ \textcolor{comment}{// New event -\/> Initialization}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02646}02646         fFromFission = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02647}02647         fID\_firstfission = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02648}02648         fNfission\_fromFission = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02649}02649         fEperFission = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02650}02650     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02651}02651 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02652}02652 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02653}02653 \textcolor{keywordtype}{void} SteppingAction::FillTimeEnergyFissionProducts(\textcolor{keyword}{const} G4Step* theStep) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02654}02654     G4String processName = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02655}02655     \textcolor{keywordflow}{if}(theStep-\/>GetPostStepPoint()-\/>GetProcessDefinedStep()) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02656}02656         processName = theStep-\/>GetPostStepPoint()-\/>GetProcessDefinedStep()-\/>GetProcessName();\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02657}02657 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02658}02658     \textcolor{keywordflow}{if}(processName != \textcolor{stringliteral}{"{}ionIoni"{}} \&\& processName != \textcolor{stringliteral}{"{}ParallelScoringWorld"{}} \&\& processName != \textcolor{stringliteral}{"{}ParallelScoringWorld\_polar"{}} \&\& processName!=\textcolor{stringliteral}{"{}RadioactiveDecayBase"{}} \&\& processName!=\textcolor{stringliteral}{"{}CoupledTransportation"{}} \&\& processName!=\textcolor{stringliteral}{"{}hadElastic"{}} \&\& processName!=\textcolor{stringliteral}{"{}alphaInelastic"{}} \&\& processName!=\textcolor{stringliteral}{"{}msc"{}} \&\& processName!=\textcolor{stringliteral}{"{}hIoni"{}} \&\& processName != \textcolor{stringliteral}{"{}Transportation"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02659}02659         \textcolor{comment}{// std::cout << processName << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02660}02660         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02661}02661     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02662}02662 \textcolor{comment}{//         G4int A = particleType-\/>GetAtomicMass();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02663}02663 \textcolor{comment}{//         G4int Z = particleType-\/>GetAtomicNumber();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02664}02664     \textcolor{keyword}{const} std::vector<const G4Track*> *secondaries = theStep-\/>GetSecondaryInCurrentStep();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02665}02665 \textcolor{comment}{//         bool Presence\_anti\_nu\_e = false;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02666}02666 \textcolor{comment}{//         G4double AntiNuGlobalTime = 0, AntiNuEnergy = 0;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02667}02667 \textcolor{comment}{//         bool Presence\_e = false;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02668}02668 \textcolor{comment}{//         G4double ElectronGlobalTime = 0, ElectronEnergy = 0;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02669}02669     \textcolor{keywordflow}{for}(G4int i=0; i<(G4int)secondaries-\/>size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02670}02670         G4String secondary\_particleName = (*secondaries)[i]-\/>GetDefinition()-\/>GetParticleName();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02671}02671         \textcolor{keywordflow}{if} (secondary\_particleName == \textcolor{stringliteral}{"{}neutron"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02672}02672             fRunAction-\/>GetRun()-\/>m\_d2N\_dlogElogTime\_FFn-\/>Fill(std::log10((*secondaries)[i]-\/>GetGlobalTime()/s), std::log10((*secondaries)[i]-\/>GetKineticEnergy()/eV)); \textcolor{comment}{// Energy and time for FF secondaries}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02673}02673         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02674}02674         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (secondary\_particleName == \textcolor{stringliteral}{"{}gamma"{}} \&\& processName==\textcolor{stringliteral}{"{}RadioactiveDecayBase"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02675}02675             fRunAction-\/>GetRun()-\/>m\_d2N\_dlogElogTime\_FFg-\/>Fill(std::log10((*secondaries)[i]-\/>GetGlobalTime()/s), std::log10((*secondaries)[i]-\/>GetKineticEnergy()/eV)); \textcolor{comment}{// Energy and time for FF secondaries}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02676}02676         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02677}02677         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (secondary\_particleName == \textcolor{stringliteral}{"{}e-\/"{}} \&\& processName==\textcolor{stringliteral}{"{}RadioactiveDecayBase"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02678}02678 \textcolor{comment}{//                 ElectronGlobalTime = std::log10((*secondaries)[i]-\/>GetGlobalTime()/s);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02679}02679 \textcolor{comment}{//                 ElectronEnergy     = std::log10((*secondaries)[i]-\/>GetKineticEnergy()/eV);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02680}02680 \textcolor{comment}{//                 Presence\_e = true;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02681}02681             fRunAction-\/>GetRun()-\/>m\_d2N\_dlogElogTime\_FFe-\/>Fill(std::log10((*secondaries)[i]-\/>GetGlobalTime()/s), std::log10((*secondaries)[i]-\/>GetKineticEnergy()/eV)); \textcolor{comment}{// Energy and time for FF secondaries}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02682}02682         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02683}02683         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (secondary\_particleName == \textcolor{stringliteral}{"{}anti\_nu\_e"{}} \&\& processName==\textcolor{stringliteral}{"{}RadioactiveDecayBase"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02684}02684 \textcolor{comment}{//                 AntiNuGlobalTime = std::log10((*secondaries)[i]-\/>GetGlobalTime()/s);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02685}02685 \textcolor{comment}{//                 AntiNuEnergy     = std::log10((*secondaries)[i]-\/>GetKineticEnergy()/eV);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02686}02686 \textcolor{comment}{//                 Presence\_anti\_nu\_e = true;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02687}02687             fRunAction-\/>GetRun()-\/>m\_d2N\_dlogElogTime\_FFantiNu-\/>Fill(std::log10((*secondaries)[i]-\/>GetGlobalTime()/s), std::log10((*secondaries)[i]-\/>GetKineticEnergy()/eV)); \textcolor{comment}{// Energy and time for FF secondaries}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02688}02688         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02689}02689         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (processName==\textcolor{stringliteral}{"{}RadioactiveDecayBase"{}} \&\& (*secondaries)[i]-\/>GetDefinition()-\/>GetParticleType()!=\textcolor{stringliteral}{"{}nucleus"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02690}02690 \textcolor{comment}{//             std::cout << secondary\_particleName << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02691}02691             fRunAction-\/>GetRun()-\/>m\_d2N\_dlogElogTime\_FFothers-\/>Fill(std::log10((*secondaries)[i]-\/>GetGlobalTime()/s), std::log10((*secondaries)[i]-\/>GetKineticEnergy()/eV)); \textcolor{comment}{// Energy and time for FF secondaries}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02692}02692         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02693}02693     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02694}02694 \textcolor{comment}{//         if(Presence\_e \&\& Presence\_anti\_nu\_e) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02695}02695 \textcolor{comment}{//             analysisManager.FillH2(24, ElectronGlobalTime, ElectronEnergy); // Energy and time for FF secondaries}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02696}02696 \textcolor{comment}{//             analysisManager.FillH2(31, AntiNuGlobalTime, AntiNuEnergy); // Energy and time for FF secondaries}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02697}02697 \textcolor{comment}{//         \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02698}02698 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02699}02699 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02700}02700 \textcolor{keywordtype}{void} SteppingAction::ScorePrimaryProtons(\textcolor{keyword}{const} G4Step* theStep, \textcolor{keywordtype}{double} dbl\_Ibeam) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02701}02701     \textcolor{keywordflow}{if}(IsPrimaryProton(theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName(), theStep-\/>GetTrack()-\/>GetTrackID())) \{ \textcolor{comment}{// primary protons}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02702}02702         \textcolor{keyword}{auto} analysisManager = G4AnalysisManager::Instance();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02703}02703         G4Track* theTrack = theStep-\/>GetTrack();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02704}02704         \textcolor{keyword}{const} G4int stepnumber = theTrack-\/>GetCurrentStepNumber();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02705}02705         \textcolor{comment}{//G4double Tot\_Edep = theStep-\/>GetTotalEnergyDeposit()/eV; // Total Energy Deposit in this step in eV}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02706}02706         G4ThreeVector  PrePos = theStep-\/>GetPreStepPoint()-\/>GetPosition();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02707}02707         \textcolor{comment}{//G4ThreeVector PostPos = theStep-\/>GetPostStepPoint()-\/>GetPosition();*/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02708}02708 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02709}02709         FillEdepPrimaries(theStep\textcolor{comment}{/*PostPos, Tot\_Edep*/}, dbl\_Ibeam, *analysisManager);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02710}02710         FillBeamProfile(*theTrack, stepnumber, PrePos, *analysisManager);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02711}02711     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02712}02712 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02713}02713 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02735}02735 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02736}02736 \textcolor{comment}{// MCNP keff estimators}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02737}02737 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02752}02752 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02753}02753 \textcolor{keywordtype}{void} SteppingAction::GetNeutronHadronicProcesses() \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02754}02754     \textcolor{comment}{// on recupere la particule}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02755}02755     G4ParticleDefinition *particle = G4ParticleTable::GetParticleTable()-\/>FindParticle(\textcolor{stringliteral}{"{}neutron"{}}); \textcolor{comment}{// G4Neutron::Definition();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02756}02756 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02757}02757     \textcolor{comment}{// on recupere le process manager pour la particule}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02758}02758     G4ProcessManager *pManager = particle-\/>GetProcessManager();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02759}02759     \textcolor{comment}{// on recupere la liste des processus}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02760}02760     G4ProcessVector *pList = pManager-\/>GetProcessList();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02761}02761     \textcolor{comment}{// on boucle pour trouver le bon process (je pense qu'il faut les imprimer une fois pour voir)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02762}02762     \textcolor{keyword}{const} G4VProcess *pp = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02763}02763 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02764}02764     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} idx = 0; idx < pList-\/>size(); idx++)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02765}02765     \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02766}02766         pp = (*pList)[idx];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02767}02767         G4int ptype = pp-\/>GetProcessType();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02768}02768         \textcolor{keywordflow}{if}( ptype == 4 ) \{ \textcolor{comment}{// Reaction of a neutron with something else (no surface, parallel world, etc.)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02769}02769             \textcolor{keywordflow}{if}     ((G4String)pp-\/>GetProcessName() == \textcolor{stringliteral}{"{}hadElastic"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02770}02770                 fProcessElas = (G4HadronicProcess *)pp; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02771}02771             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((G4String)pp-\/>GetProcessName() == \textcolor{stringliteral}{"{}neutronInelastic"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02772}02772                 fProcessInel = (G4HadronicProcess *)pp; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02773}02773             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((G4String)pp-\/>GetProcessName() == \textcolor{stringliteral}{"{}nCapture"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02774}02774                 fProcessCap = (G4HadronicProcess *)pp; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02775}02775             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((G4String)pp-\/>GetProcessName() == \textcolor{stringliteral}{"{}nFission"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02776}02776                 fProcessFis = (G4HadronicProcess *)pp; \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02777}02777             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02778}02778                 std::cout << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n !! WARNING !! \(\backslash\)n !! At least one hadronic process has not been taken into account in SteppingAction::GetNeutronHadronicProcesses !!"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02779}02779                 printf(\textcolor{stringliteral}{"{} [\%s,\%d,\%d]"{}}, (\textcolor{keyword}{const} \textcolor{keywordtype}{char} *)pp-\/>GetProcessName(), ptype, pp-\/>GetProcessSubType());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02780}02780                 std::cout << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02781}02781             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02782}02782         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02783}02783     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02784}02784 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02785}02785 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02786}02786 G4double SteppingAction::GetElementElasticCrossSection(\textcolor{keyword}{const} G4Step * theStep, G4Element* elm, G4Material* mat) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02787}02787     \textcolor{comment}{// on recupere une DynamicParticle}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02788}02788     \textcolor{keyword}{const} G4DynamicParticle*    particleDyn = theStep-\/>GetTrack()-\/>GetDynamicParticle();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02789}02789     \textcolor{comment}{// On vérifie l'énergie cinltique non nulle sinon on en défini une autre}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02790}02790     G4Track theTrack = *theStep-\/>GetTrack();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02791}02791     G4StepPoint PreStep = *theStep-\/>GetPreStepPoint();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02792}02792     \textcolor{keywordflow}{if}(particleDyn-\/>GetKineticEnergy() < 1e+6)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02793}02793         particleDyn = \textcolor{keyword}{new} G4DynamicParticle(particleDyn-\/>GetParticleDefinition(), particleDyn-\/>GetMomentumDirection(), KineticEnergy\_eV(theStep)*eV);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02794}02794 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02795}02795     \textcolor{comment}{// on recupere la section efficace}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02796}02796     \textcolor{keywordflow}{return} fProcessElas-\/>GetElementCrossSection(particleDyn, elm, mat)/cm2;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02797}02797 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02798}02798 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02799}02799 G4double SteppingAction::GetElementInelastCrossSection(\textcolor{keyword}{const} G4Step * theStep, G4Element* elm, G4Material* mat) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02800}02800     \textcolor{comment}{// on recupere une DynamicParticle}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02801}02801     \textcolor{keyword}{const} G4DynamicParticle*    particleDyn = theStep-\/>GetTrack()-\/>GetDynamicParticle();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02802}02802     \textcolor{comment}{// On vérifie l'énergie cinltique non nulle sinon on en défini une autre}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02803}02803     G4Track theTrack = *theStep-\/>GetTrack();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02804}02804     G4StepPoint PreStep = *theStep-\/>GetPreStepPoint();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02805}02805     \textcolor{keywordflow}{if}(particleDyn-\/>GetKineticEnergy() < 1e+6)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02806}02806         particleDyn = \textcolor{keyword}{new} G4DynamicParticle(particleDyn-\/>GetParticleDefinition(), particleDyn-\/>GetMomentumDirection(), KineticEnergy\_eV(theStep)*eV);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02807}02807 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02808}02808     \textcolor{comment}{// on recupere la section efficace}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02809}02809     \textcolor{keywordflow}{return} fProcessInel-\/>GetElementCrossSection(particleDyn, elm, mat)/cm2;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02810}02810 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02811}02811 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02812}02812 \textcolor{preprocessor}{\#include "{}G4ParticleHPThermalBoost.hh"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02813}02813 G4double SteppingAction::GetElementInelastChannelCrossSection(\textcolor{keyword}{const} G4Step * theStep, G4Element* elm, G4int jchan) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02814}02814     \textcolor{comment}{// Get DynamicParticle}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02815}02815     \textcolor{keyword}{const} G4DynamicParticle* particleDyn = theStep-\/>GetTrack()-\/>GetDynamicParticle();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02816}02816     \textcolor{comment}{// Get DynParticle pre-\/step}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02817}02817     G4Track* theTrack = theStep-\/>GetTrack();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02818}02818     G4StepPoint PreStep = *theStep-\/>GetPreStepPoint();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02819}02819     \textcolor{keywordflow}{if}(particleDyn-\/>GetKineticEnergy() < 1e+6)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02820}02820         particleDyn = \textcolor{keyword}{new} G4DynamicParticle(particleDyn-\/>GetParticleDefinition(), particleDyn-\/>GetMomentumDirection(), KineticEnergy\_eV(theStep)*eV);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02821}02821     G4ParticleHPInelastic* inthpinelastic = \textcolor{keyword}{dynamic\_cast<}G4ParticleHPInelastic*\textcolor{keyword}{>}(fProcessInel-\/>GetHadronicModel(\textcolor{stringliteral}{"{}NeutronHPInelastic"{}}));}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02822}02822     \textcolor{comment}{// Modified G4 to obtain the channel list -\/-\/ one per element}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02823}02823     \textcolor{keyword}{const} std::vector<G4ParticleHPChannelList*>* chanlist = inthpinelastic-\/>GetChannelList(); \textcolor{comment}{// one List per element}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02824}02824 \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02825}02825 \textcolor{comment}{    if(G4Threading::G4GetThreadId() == 99) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02826}02826 \textcolor{comment}{    for(auto ichan=chanlist-\/>begin(); ichan!=chanlist-\/>end(); ++ichan) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02827}02827 \textcolor{comment}{        // List of channels lists -\/-\/ one per element}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02828}02828 \textcolor{comment}{        G4ParticleHPChannelList* chanl = *ichan;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02829}02829 \textcolor{comment}{        G4int nchans = chanl-\/>GetNumberOfChannels();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02830}02830 \textcolor{comment}{        // Modified G4 to get the channels, one by one}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02831}02831 \textcolor{comment}{        G4ParticleHPChannel **chanvec = chanl-\/>GetChannels();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02832}02832 \textcolor{comment}{        for(G4int i=0;i<nchans;++i) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02833}02833 \textcolor{comment}{           G4ParticleHPChannel *chan = chanvec[i];}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02834}02834 \textcolor{comment}{           if(chan-\/>GetNiso() != 1) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02835}02835 \textcolor{comment}{               std::cout << "{}===================================================== DumpInfo ======================================================="{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02836}02836 \textcolor{comment}{               chan-\/>DumpInfo();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02837}02837 \textcolor{comment}{               std::cout << "{}===================================================== DumpInfo ======================================================="{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02838}02838 \textcolor{comment}{           \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02839}02839 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02840}02840 \textcolor{comment}{    \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02841}02841 \textcolor{comment}{    exit(1);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02842}02842 \textcolor{comment}{    \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02843}02843 \textcolor{comment}{    */}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02844}02844     G4ParticleHPChannelList* elmchanlist = (*chanlist)[elm-\/>GetIndex()]; \textcolor{comment}{// channel list for that element}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02845}02845     G4ParticleHPChannel* channel = (elmchanlist-\/>GetChannels())[jchan];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02846}02846 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02847}02847     G4ParticleHPThermalBoost aThermalE; \textcolor{comment}{// Thermal boost}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02848}02848     G4int nisos = channel-\/>GetNiso();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02849}02849 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02850}02850     G4double xsec = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02851}02851     \textcolor{comment}{// static G4Mutex mutex = G4MUTEX\_INITIALIZER;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02852}02852 \textcolor{comment}{//    G4AutoLock l(\&mutex);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02853}02853     \textcolor{keywordflow}{for}(G4int i=0;i<nisos; i++) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02854}02854         \textcolor{keywordflow}{if}(channel-\/>HasAnyData(i)) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02855}02855             xsec += channel-\/>GetWeightedXsec(aThermalE.GetThermalEnergy(*theTrack,}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02856}02856                             channel-\/>GetN(i), channel-\/>GetZ(i),}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02857}02857                             theTrack-\/>GetMaterial()-\/>GetTemperature()),i);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02858}02858         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02859}02859     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02860}02860  \textcolor{comment}{//   l.unlock();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02861}02861 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02862}02862     \textcolor{keywordflow}{return} xsec;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02863}02863 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02864}02864 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02865}02865 G4double SteppingAction::GetElementCaptureCrossSection(\textcolor{keyword}{const} G4Step * theStep, G4Element* elm, G4Material* mat) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02866}02866     \textcolor{comment}{// on recupere une DynamicParticle}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02867}02867     \textcolor{keyword}{const} G4DynamicParticle*    particleDyn = theStep-\/>GetTrack()-\/>GetDynamicParticle();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02868}02868     \textcolor{comment}{// On vérifie l'énergie cinltique non nulle sinon on en défini une autre}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02869}02869     G4Track theTrack = *theStep-\/>GetTrack();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02870}02870     G4StepPoint PreStep = *theStep-\/>GetPreStepPoint();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02871}02871     \textcolor{keywordflow}{if}(particleDyn-\/>GetKineticEnergy() < 1e+6)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02872}02872         particleDyn = \textcolor{keyword}{new} G4DynamicParticle(particleDyn-\/>GetParticleDefinition(), particleDyn-\/>GetMomentumDirection(), KineticEnergy\_eV(theStep)*eV);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02873}02873 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02874}02874     \textcolor{comment}{// on recupere la section efficace}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02875}02875     \textcolor{keywordflow}{return} fProcessCap-\/>GetElementCrossSection(particleDyn, elm, mat)/cm2;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02876}02876 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02877}02877 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02878}02878 G4double SteppingAction::GetElementFissionCrossSection(\textcolor{keyword}{const} G4Step * theStep, G4Element* elm, G4Material* mat) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02879}02879     \textcolor{comment}{// on recupere une DynamicParticle}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02880}02880     \textcolor{keyword}{const} G4DynamicParticle*    particleDyn = theStep-\/>GetTrack()-\/>GetDynamicParticle();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02881}02881      \textcolor{comment}{// On vérifie l'énergie cinltique non nulle sinon on en défini une autre}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02882}02882     G4Track theTrack = *theStep-\/>GetTrack();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02883}02883     G4StepPoint PreStep = *theStep-\/>GetPreStepPoint();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02884}02884     \textcolor{keywordflow}{if}(particleDyn-\/>GetKineticEnergy() < 1e+6)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02885}02885         particleDyn = \textcolor{keyword}{new} G4DynamicParticle(particleDyn-\/>GetParticleDefinition(), particleDyn-\/>GetMomentumDirection(), KineticEnergy\_eV(theStep)*eV);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02886}02886 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02887}02887 \textcolor{comment}{//     if(mat-\/>GetName() == "{}fuel\_UO2Al"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02888}02888 \textcolor{comment}{//         std::cout << particleDyn-\/>GetKineticEnergy()/MeV << "{} ; "{} << fProcessFis-\/>GetProcessName() << "{} ; "{} << elm-\/>GetName() << "{} ; "{} << fProcessFis-\/>GetElementCrossSection(particleDyn, elm, mat)/cm2 << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02889}02889 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02890}02890     \textcolor{comment}{// on recupere la section efficace}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02891}02891    \textcolor{keywordflow}{return} fProcessFis-\/>GetElementCrossSection(particleDyn, elm, mat)/cm2;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02892}02892 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02893}02893 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02894}02894 G4double SteppingAction::GetMaterialElasticCrossSection(\textcolor{keyword}{const} G4Step * theStep, G4Material* mat)  \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02895}02895     \textcolor{comment}{// on recupere une DynamicParticle}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02896}02896     \textcolor{keyword}{const} G4DynamicParticle*    particleDyn = theStep-\/>GetTrack()-\/>GetDynamicParticle();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02897}02897     \textcolor{comment}{// On vérifie l'énergie cinltique non nulle sinon on en défini une autre}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02898}02898     G4Track theTrack = *theStep-\/>GetTrack();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02899}02899     G4StepPoint PreStep = *theStep-\/>GetPreStepPoint();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02900}02900     \textcolor{keywordflow}{if}(particleDyn-\/>GetKineticEnergy() < 1e+6)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02901}02901         particleDyn = \textcolor{keyword}{new} G4DynamicParticle(particleDyn-\/>GetParticleDefinition(), particleDyn-\/>GetMomentumDirection(), KineticEnergy\_eV(theStep)*eV);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02902}02902 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02903}02903     G4double matCrossSection = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02904}02904     G4int nElements = mat-\/>GetNumberOfElements();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02905}02905     \textcolor{keyword}{const} G4double* nAtomsPerVolume = mat-\/>GetVecNbOfAtomsPerVolume();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02906}02906     G4double TotNbAtomsPerVolume = mat-\/>GetTotNbOfAtomsPerVolume();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02907}02907     \textcolor{keywordflow}{for}(G4int i=0; i<nElements; ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02908}02908         matCrossSection += nAtomsPerVolume[i]/(G4double)TotNbAtomsPerVolume * (fProcessElas-\/>GetCrossSectionDataStore()-\/>GetCrossSection(particleDyn, (*mat-\/>GetElementVector())[i], mat)/cm2);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02909}02909     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02910}02910 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02911}02911     \textcolor{comment}{// on recupere la section efficace}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02912}02912     \textcolor{keywordflow}{return} matCrossSection;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02913}02913 \textcolor{comment}{//     return fProcessElas-\/>GetCrossSectionDataStore()-\/>GetCrossSection(particleDyn, mat/*thePrePV-\/>GetLogicalVolume()-\/>GetMaterial()*/);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02914}02914 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02915}02915 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02916}02916 G4double SteppingAction::GetMaterialInelastCrossSection(\textcolor{keyword}{const} G4Step * theStep, G4Material* mat)  \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02917}02917     \textcolor{comment}{// on recupere une DynamicParticle}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02918}02918     \textcolor{keyword}{const} G4DynamicParticle*    particleDyn = theStep-\/>GetTrack()-\/>GetDynamicParticle();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02919}02919     \textcolor{comment}{// On vérifie l'énergie cinltique non nulle sinon on en défini une autre}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02920}02920     G4Track theTrack = *theStep-\/>GetTrack();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02921}02921     G4StepPoint PreStep = *theStep-\/>GetPreStepPoint();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02922}02922     \textcolor{keywordflow}{if}(particleDyn-\/>GetKineticEnergy() < 1e+6)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02923}02923         particleDyn = \textcolor{keyword}{new} G4DynamicParticle(particleDyn-\/>GetParticleDefinition(), particleDyn-\/>GetMomentumDirection(), KineticEnergy\_eV(theStep)*eV);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02924}02924 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02925}02925     G4double matCrossSection = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02926}02926     G4int nElements = mat-\/>GetNumberOfElements();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02927}02927     \textcolor{keyword}{const} G4double* nAtomsPerVolume = mat-\/>GetVecNbOfAtomsPerVolume();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02928}02928     G4double TotNbAtomsPerVolume = mat-\/>GetTotNbOfAtomsPerVolume();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02929}02929     \textcolor{keywordflow}{for}(G4int i=0; i<nElements; ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02930}02930         matCrossSection += nAtomsPerVolume[i]/(G4double)TotNbAtomsPerVolume * (fProcessInel-\/>GetCrossSectionDataStore()-\/>GetCrossSection(particleDyn, (*mat-\/>GetElementVector())[i], mat)/cm2);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02931}02931     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02932}02932 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02933}02933     \textcolor{comment}{// on recupere la section efficace}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02934}02934     \textcolor{keywordflow}{return} matCrossSection;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02935}02935 \textcolor{comment}{//     return fProcessInel-\/>GetCrossSectionDataStore()-\/>GetCrossSection(particleDyn, mat)/cm2;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02936}02936 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02937}02937 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02938}02938 G4double SteppingAction::GetMaterialCaptureCrossSection(\textcolor{keyword}{const} G4Step * theStep, G4Material* mat)  \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02939}02939     \textcolor{comment}{// on recupere une DynamicParticle}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02940}02940     \textcolor{keyword}{const} G4DynamicParticle*    particleDyn = theStep-\/>GetTrack()-\/>GetDynamicParticle();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02941}02941     \textcolor{comment}{// On vérifie l'énergie cinltique non nulle sinon on en défini une autre}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02942}02942     G4Track theTrack = *theStep-\/>GetTrack();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02943}02943     G4StepPoint PreStep = *theStep-\/>GetPreStepPoint();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02944}02944     \textcolor{keywordflow}{if}(particleDyn-\/>GetKineticEnergy() < 1e+6)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02945}02945         particleDyn = \textcolor{keyword}{new} G4DynamicParticle(particleDyn-\/>GetParticleDefinition(), particleDyn-\/>GetMomentumDirection(), KineticEnergy\_eV(theStep)*eV);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02946}02946 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02947}02947     G4double matCrossSection = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02948}02948     G4int nElements = mat-\/>GetNumberOfElements();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02949}02949     \textcolor{keyword}{const} G4double* nAtomsPerVolume = mat-\/>GetVecNbOfAtomsPerVolume();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02950}02950     G4double TotNbAtomsPerVolume = mat-\/>GetTotNbOfAtomsPerVolume();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02951}02951     \textcolor{keywordflow}{for}(G4int i=0; i<nElements; ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02952}02952         matCrossSection += nAtomsPerVolume[i]/(G4double)TotNbAtomsPerVolume * (fProcessCap-\/>GetCrossSectionDataStore()-\/>GetCrossSection(particleDyn, (*mat-\/>GetElementVector())[i], mat)/cm2);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02953}02953     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02954}02954 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02955}02955     \textcolor{comment}{// on recupere la section efficace}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02956}02956     \textcolor{keywordflow}{return} matCrossSection;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02957}02957 \textcolor{comment}{//     return fProcessCap-\/>GetCrossSectionDataStore()-\/>GetCrossSection(particleDyn, mat)/cm2;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02958}02958 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02959}02959 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02960}02960 G4double SteppingAction::GetMaterialFissionCrossSection(\textcolor{keyword}{const} G4Step * theStep, G4Material* mat)  \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02961}02961     \textcolor{comment}{// on recupere une DynamicParticle}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02962}02962     \textcolor{keyword}{const} G4DynamicParticle*    particleDyn = theStep-\/>GetTrack()-\/>GetDynamicParticle();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02963}02963     \textcolor{comment}{// On vérifie l'énergie cinltique non nulle sinon on en défini une autre}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02964}02964     G4Track theTrack = *theStep-\/>GetTrack();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02965}02965     G4StepPoint PreStep = *theStep-\/>GetPreStepPoint();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02966}02966     \textcolor{keywordflow}{if}(particleDyn-\/>GetKineticEnergy() < 1e+6)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02967}02967         particleDyn = \textcolor{keyword}{new} G4DynamicParticle(particleDyn-\/>GetParticleDefinition(), particleDyn-\/>GetMomentumDirection(), KineticEnergy\_eV(theStep)*eV);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02968}02968 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02969}02969     G4double matCrossSection = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02970}02970     G4int nElements = mat-\/>GetNumberOfElements();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02971}02971     \textcolor{keyword}{const} G4double* nAtomsPerVolume = mat-\/>GetVecNbOfAtomsPerVolume();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02972}02972     G4double TotNbAtomsPerVolume = mat-\/>GetTotNbOfAtomsPerVolume();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02973}02973     \textcolor{keywordflow}{for}(G4int i=0; i<nElements; ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02974}02974         matCrossSection += nAtomsPerVolume[i]/(G4double)TotNbAtomsPerVolume * (fProcessFis-\/>GetCrossSectionDataStore()-\/>GetCrossSection(particleDyn, (*mat-\/>GetElementVector())[i], mat)/cm2);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02975}02975     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02976}02976 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02977}02977 \textcolor{comment}{//     if(mat-\/>GetName() == "{}fuel\_UO2Al"{})}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02978}02978 \textcolor{comment}{//         std::cout << particleDyn-\/>GetKineticEnergy()/MeV << "{} ; "{} << fProcessFis-\/>GetProcessName() << "{} ; "{} << matCrossSection << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02979}02979 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02980}02980     \textcolor{comment}{// on recupere la section efficace}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02981}02981     \textcolor{keywordflow}{return} matCrossSection;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02982}02982 \textcolor{comment}{//     return fProcessFis-\/>GetCrossSectionDataStore()-\/>GetCrossSection(particleDyn, mat)/cm2;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02983}02983 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02984}02984 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02985}02985 \textcolor{keywordtype}{void} SteppingAction::MCNP\_Keff\_estimators\_ori(\textcolor{keyword}{const} G4Step theStep) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02986}02986 \textcolor{comment}{//     std::cout << "{}Beginning of MCNP\_Keff\_estimators"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02987}02987 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02988}02988 \textcolor{comment}{//     const G4VProcess *pp = theStep.GetPostStepPoint()-\/>GetProcessDefinedStep();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02989}02989 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02990}02990 \textcolor{comment}{//     if(pp \&\& theStep.GetTrack()-\/>GetDynamicParticle()-\/>GetKineticEnergy() < 20*MeV}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02991}02991 \textcolor{comment}{//     \&\& pp-\/>GetProcessName() != "{}hadElastic"{} \&\& pp-\/>GetProcessName() != "{}CoupledTransportation"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02992}02992 \textcolor{comment}{//     \&\& pp-\/>GetProcessName() != "{}nFission"{} \&\& pp-\/>GetProcessName() != "{}ParallelScoringWorld"{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02993}02993 \textcolor{comment}{//     \&\& pp-\/>GetProcessName() != "{}nCapture"{} /*\&\& pp-\/>GetProcessSubType() != 121*/) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02994}02994 \textcolor{comment}{//         printf("{} [\%s,\%d,\%d] \(\backslash\)n"{}, (const char *)((G4NeutronInelasticProcess*)pp)-\/>GetProcessName(), ((G4NeutronInelasticProcess*)pp)-\/>GetProcessType(), ((G4NeutronInelasticProcess*)pp)-\/>GetProcessSubType());}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02995}02995 \textcolor{comment}{//         const G4ParticleDefinition* part = theStep.GetTrack()-\/>GetDefinition();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02996}02996 \textcolor{comment}{//         ((G4NeutronInelasticProcess*)pp)-\/>DumpPhysicsTable(*part);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02997}02997 \textcolor{comment}{//         ((G4NeutronInelasticProcess*)pp)-\/>DumpPhysicsTable(*G4Neutron::Definition());}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02998}02998 \textcolor{comment}{// //     if((const char *)pp-\/>GetProcessName() == "{}Hadronic"{} \&\& pp-\/>GetProcessSubType() ==  fHadronInelastic) break; // mais il faut tous les imprimer une fois pour voir!}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l02999}02999 \textcolor{comment}{//     \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03000}03000 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03001}03001     G4double nu = fEventAction-\/>GetNu();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03002}03002 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03003}03003     \textcolor{comment}{// Get the post step point}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03004}03004     G4StepPoint*  thePostPoint = theStep.GetPostStepPoint();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03005}03005 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03006}03006     \textcolor{comment}{// Get the process name}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03007}03007     G4String processName = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03008}03008     \textcolor{keywordflow}{if}(thePostPoint-\/>GetProcessDefinedStep()) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03009}03009         processName = thePostPoint-\/>GetProcessDefinedStep()-\/>GetProcessName();\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03010}03010 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03011}03011     \textcolor{keywordflow}{if}( processName == \textcolor{stringliteral}{"{}hadElastic"{}} || processName == \textcolor{stringliteral}{"{}neutronInelastic"{}} || processName == \textcolor{stringliteral}{"{}nCapture"{}} || processName == \textcolor{stringliteral}{"{}nFission"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03012}03012         G4Material* mat = thePostPoint-\/>GetPhysicalVolume()-\/>GetLogicalVolume()-\/>GetMaterial();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03013}03013         G4double MaterialSigmaF = GetMaterialFissionCrossSection(\&theStep, mat);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03014}03014     \textcolor{keywordflow}{if}(MaterialSigmaF == 0) \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03015}03015         G4double MaterialSigmaTot = GetMaterialElasticCrossSection(\&theStep, mat)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03016}03016                                   + GetMaterialInelastCrossSection(\&theStep, mat)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03017}03017                                   + GetMaterialCaptureCrossSection(\&theStep, mat)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03018}03018                                   + MaterialSigmaF;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03019}03019 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03020}03020         G4double MaterialDensityG4 = mat-\/>GetTotNbOfAtomsPerVolume()*cm3;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03021}03021         G4double MaterialDensity = 0; \textcolor{comment}{// Atomic density}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03022}03022     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<mat-\/>GetNumberOfElements(); i++) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03023}03023 \textcolor{comment}{//             std::cout << (mat-\/>GetDensity()/(g/cm3)) << "{} "{} << mat-\/>GetFractionVector()[i] << "{} "{} << mat-\/>GetElement(i)-\/>GetA()/(g/mole) << "{} "{} << Avogadro << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03024}03024 \textcolor{comment}{//             std::cout << mat-\/>GetTotNbOfAtomsPerVolume() << "{} "{} << mat-\/>GetVecNbOfAtomsPerVolume()[i] << "{} "{} << mat-\/>GetVecNbOfAtomsPerVolume()[i]/mat-\/>GetTotNbOfAtomsPerVolume()*100 << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03025}03025             MaterialDensity += (mat-\/>GetDensity()/(g/cm3)) * mat-\/>GetFractionVector()[i] / (mat-\/>GetElement(i)-\/>GetA()/(g/mole)) * Avogadro;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03026}03026         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03027}03027     G4double diff = 2*std::abs(MaterialDensityG4-\/MaterialDensity)/(MaterialDensityG4+MaterialDensity);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03028}03028     \textcolor{keywordflow}{if}(diff >= 1e-\/7) std::cout << \textcolor{stringliteral}{"{}EEEEEEEEK! "{}} << MaterialDensityG4 << \textcolor{stringliteral}{"{} ours "{}} <<MaterialDensity <<std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03029}03029 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03030}03030 \textcolor{comment}{//         if(MaterialSigmaF >0) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03031}03031 \textcolor{comment}{//             std::cout << mat-\/>GetName() << "{} sigmaf = "{} << MaterialSigmaF << "{} sigmaTot = "{} << MaterialSigmaTot << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03032}03032 \textcolor{comment}{//             std::cout << "{}density = "{} << MaterialDensity << "{} at/cm3 ; fLengthBetweenCollision = "{} << fLengthBetweenCollision << "{} cm ; nu = "{} << nu << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03033}03033 \textcolor{comment}{//             std::cout << MaterialDensity * fLengthBetweenCollision * nu * MaterialSigmaF << "{}\(\backslash\)n"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03034}03034 \textcolor{comment}{//         \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03035}03035 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03036}03036         \textcolor{comment}{// Collision keff}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03037}03037         \textcolor{keywordflow}{if}(MaterialSigmaTot > 0) \{fEventAction-\/>Add\_keff\_collision(nu * MaterialSigmaF / MaterialSigmaTot);\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03038}03038 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03039}03039         \textcolor{comment}{// Track length keff}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03040}03040 \textcolor{comment}{//         std::cout << mat-\/>GetName() << "{} MaterialDensity : "{} << MaterialDensity << "{} fLengthBetweenCollision : "{} << fLengthBetweenCollision << "{} nu "{} << nu << "{} sigmaF : "{} << MaterialSigmaF << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03041}03041         fEventAction-\/>Add\_keff\_trackLength(MaterialDensity * fLengthBetweenCollision * nu * MaterialSigmaF);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03042}03042         fLengthBetweenCollision = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03043}03043     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03044}03044 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03045}03045     \textcolor{keywordflow}{if}( processName == \textcolor{stringliteral}{"{}nFission"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03046}03046         G4Material* mat = thePostPoint-\/>GetPhysicalVolume()-\/>GetLogicalVolume()-\/>GetMaterial();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03047}03047         G4VProcess* process = \textcolor{keyword}{const\_cast<}G4VProcess*\textcolor{keyword}{>}(thePostPoint-\/>GetProcessDefinedStep());}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03048}03048         G4HadronicProcess* hproc = \textcolor{keyword}{dynamic\_cast<}G4HadronicProcess*\textcolor{keyword}{>}(process);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03049}03049         \textcolor{keyword}{const} G4Isotope* target = hproc-\/>GetTargetIsotope();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03050}03050 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03051}03051         \textcolor{keyword}{const} G4ElementTable *ElmTable = G4Element::GetElementTable();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03052}03052         G4Element* elm = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03053}03053         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<ElmTable-\/>size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03054}03054             \textcolor{keywordflow}{if}((*ElmTable)[i]) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03055}03055                 \textcolor{keywordflow}{if}((*ElmTable)[i]-\/>GetZ() == target-\/>GetZ() \&\& (*ElmTable)[i]-\/>GetN() == target-\/>GetN())}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03056}03056                     elm = (*ElmTable)[i];}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03057}03057             \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03058}03058         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03059}03059 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03060}03060         \textcolor{keywordflow}{if}(elm) \{ \textcolor{comment}{// if isotope has been found in the table of elements}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03061}03061             G4double ElementSigmaF = GetElementFissionCrossSection(\&theStep, elm, mat);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03062}03062             G4double ElementSigmaAbs = GetElementInelastCrossSection(\&theStep, elm, mat)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03063}03063                                     + GetElementCaptureCrossSection(\&theStep, elm, mat);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03064}03064             G4double ElementSigmaTot = GetElementElasticCrossSection(\&theStep, elm, mat)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03065}03065                                     + ElementSigmaAbs}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03066}03066                                     + ElementSigmaF;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03067}03067 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03068}03068 \textcolor{comment}{//         if(ElementSigmaF <0) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03069}03069 \textcolor{comment}{//             std::cout << mat-\/>GetName() << "{} "{} << elm-\/>GetName() << "{} sigmaf = "{} << ElementSigmaF << "{} sigmaTot = "{} << ElementSigmaTot << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03070}03070 \textcolor{comment}{//             std::cout << "{} ElementSigmaAbs = "{} << ElementSigmaAbs << "{} ; nu = "{} << nu << "{}\(\backslash\)n"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03071}03071 \textcolor{comment}{//             std::cout << nu*ElementSigmaF / (ElementSigmaAbs + ElementSigmaF) << "{}\(\backslash\)n"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03072}03072 \textcolor{comment}{//         \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03073}03073 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03074}03074             \textcolor{comment}{// Analog absorption keff}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03075}03075             \textcolor{comment}{// When a particle collides, there is a probability that it is absorbed by the nucleus.}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03076}03076             \textcolor{comment}{// In analog absorption, the particle is killed with that probability}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03077}03077             \textcolor{keywordflow}{if}( ElementSigmaAbs + ElementSigmaF ) \{ fEventAction-\/>Add\_keff\_analogAbs(nu*ElementSigmaF / (ElementSigmaAbs + ElementSigmaF));\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03078}03078 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03079}03079             \textcolor{comment}{// Implicit absorption keff (not the case in GEANT4, 23/11/2020)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03080}03080             \textcolor{comment}{// the particle is never killed by absorption;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03081}03081             \textcolor{comment}{// instead, its weight is reduced by the absorption probability at eachcollision.}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03082}03082             \textcolor{keywordflow}{if}( ElementSigmaTot ) \{fEventAction-\/>Add\_keff\_implicitAbs(nu*ElementSigmaF / ElementSigmaTot);\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03083}03083         \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03084}03084     \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03085}03085 \textcolor{comment}{//     std::cout << "{}End of MCNP\_Keff\_estimators"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03086}03086 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03087}03087 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03088}03088 \textcolor{keywordtype}{void} SteppingAction::MCNP\_Keff\_estimators(\textcolor{keyword}{const} G4Step \&theStep) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03089}03089 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03090}03090   \textcolor{comment}{// Get the post step point}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03091}03091   \textcolor{keyword}{const} G4StepPoint* thePostPoint = theStep.GetPostStepPoint();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03092}03092   \textcolor{keyword}{const} G4StepPoint* thePrePoint  = theStep.GetPreStepPoint();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03093}03093 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03094}03094   \textcolor{comment}{// Get the process name}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03095}03095   G4String processName = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03096}03096   \textcolor{keywordflow}{if}(thePostPoint-\/>GetProcessDefinedStep()) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03097}03097       processName = thePostPoint-\/>GetProcessDefinedStep()-\/>GetProcessName();\}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03098}03098 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03099}03099   \textcolor{comment}{// Exclude all particles but neutrons}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03100}03100   \textcolor{keywordflow}{if}(theStep.GetTrack()-\/>GetDynamicParticle()-\/>GetParticleDefinition()-\/>GetParticleName() != \textcolor{stringliteral}{"{}neutron"{}}) \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03101}03101 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03102}03102   \textcolor{comment}{// Get the material}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03103}03103   G4Material* mat = thePostPoint-\/>GetPhysicalVolume()-\/>GetLogicalVolume()-\/>GetMaterial();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03104}03104   G4Material* matp = thePrePoint-\/>GetPhysicalVolume()-\/>GetLogicalVolume()-\/>GetMaterial();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03105}03105 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03106}03106   G4double ken =theStep.GetPreStepPoint()-\/>GetKineticEnergy();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03107}03107 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03108}03108   G4int nElements = mat-\/>GetNumberOfElements();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03109}03109   \textcolor{keyword}{const} G4double* nAtomsPerVolume = mat-\/>GetVecNbOfAtomsPerVolume();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03110}03110 \textcolor{comment}{//    G4double TotNbAtomsPerVolume = mat-\/>GetTotNbOfAtomsPerVolume();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03111}03111 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03112}03112 G4int ich = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03113}03113 GetElementInelastChannelCrossSection(\&theStep, (*mat-\/>GetElementVector())[0], ich);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03114}03114 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03115}03115 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03116}03116   G4double nufissCrossSection = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03117}03117   G4double captureCrossSection = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03118}03118   G4double totalCrossSection = 0;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03119}03119   \textcolor{keyword}{const} G4DynamicParticle *dynp = theStep.GetTrack()-\/>GetDynamicParticle();}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03120}03120   \textcolor{keyword}{const} G4DynamicParticle *pdynp = \textcolor{keyword}{new} G4DynamicParticle(dynp-\/>GetParticleDefinition(),}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03121}03121                              dynp-\/>GetMomentumDirection(),}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03122}03122                              ken);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03123}03123   \textcolor{keywordflow}{for}(G4int i=0; i<nElements; ++i) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03124}03124     G4double fis = fProcessFis-\/>GetCrossSectionDataStore()-\/>GetCrossSection(pdynp, (*mat-\/>GetElementVector())[i], mat);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03125}03125     G4double cap = fProcessCap-\/>GetCrossSectionDataStore()-\/>GetCrossSection(pdynp, (*mat-\/>GetElementVector())[i], mat);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03126}03126     totalCrossSection += nAtomsPerVolume[i]*(}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03127}03127       fProcessElas-\/>GetCrossSectionDataStore()-\/>GetCrossSection(pdynp, (*mat-\/>GetElementVector())[i], mat)+}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03128}03128       fProcessInel-\/>GetCrossSectionDataStore()-\/>GetCrossSection(pdynp, (*mat-\/>GetElementVector())[i], mat)+}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03129}03129       cap+fis);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03130}03130     nufissCrossSection +=  nAtomsPerVolume[i]*fEventAction-\/>GetNu(ken)*fis;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03131}03131     captureCrossSection +=  nAtomsPerVolume[i]*cap;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03132}03132   \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03133}03133 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03134}03134   \textcolor{comment}{// Track length keff}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03135}03135   fEventAction-\/>Add\_keff\_trackLength(theStep.GetStepLength()*nufissCrossSection);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03136}03136   \textcolor{comment}{// Exclude non-\/collision processes and all particles but neutrons}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03137}03137   \textcolor{keywordflow}{if}(processName != \textcolor{stringliteral}{"{}ParallelScoringWorld"{}} \&\& processName != \textcolor{stringliteral}{"{}CoupledTransportation"{}}) \{}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03138}03138     \textcolor{keywordflow}{if}(mat != matp \&\& processName)}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03139}03139       std::cout << \textcolor{stringliteral}{"{}matpre "{}} << matp-\/>GetName() << \textcolor{stringliteral}{"{} matpost "{}} << mat-\/>GetName() << \textcolor{stringliteral}{"{} proc "{}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03140}03140         << processName << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03141}03141 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03142}03142     \textcolor{keywordflow}{if}(processName != \textcolor{stringliteral}{"{}hadElastic"{}} \&\&}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03143}03143        processName != \textcolor{stringliteral}{"{}neutronInelastic"{}} \&\&}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03144}03144        processName != \textcolor{stringliteral}{"{}nCapture"{}} \&\&}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03145}03145        processName != \textcolor{stringliteral}{"{}nFission"{}}) std::cout << \textcolor{stringliteral}{"{} proc "{}} << processName << std::endl;}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03146}03146 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03147}03147   \textcolor{comment}{// Collision keff}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03148}03148     fEventAction-\/>Add\_keff\_collision(nufissCrossSection / totalCrossSection);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03149}03149   \textcolor{comment}{// Analog abs keff}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03150}03150     \textcolor{keywordflow}{if}(processName == \textcolor{stringliteral}{"{}nCapture"{}}) fEventAction-\/>Add\_keff\_analogAbs(nufissCrossSection / captureCrossSection);}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03151}03151   \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03152}03152 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03153}03153     \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03154}03154 \textcolor{comment}{        // Track length keff}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03155}03155 \textcolor{comment}{//         std::cout << mat-\/>GetName() << "{} MaterialDensity : "{} << MaterialDensity << "{} fLengthBetweenCollision : "{} << fLengthBetweenCollision << "{} nu "{} << nu << "{} sigmaF : "{} << MaterialSigmaF << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03156}03156 \textcolor{comment}{        fEventAction-\/>Add\_keff\_trackLength(MaterialDensity * fLengthBetweenCollision * nu * MaterialSigmaF);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03157}03157 \textcolor{comment}{        fLengthBetweenCollision = 0;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03158}03158 \textcolor{comment}{    \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03159}03159 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03160}03160 \textcolor{comment}{    if( processName == "{}nFission"{}) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03161}03161 \textcolor{comment}{        G4Material* mat = thePostPoint-\/>GetPhysicalVolume()-\/>GetLogicalVolume()-\/>GetMaterial();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03162}03162 \textcolor{comment}{        G4VProcess* process = const\_cast<G4VProcess*>(thePostPoint-\/>GetProcessDefinedStep());}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03163}03163 \textcolor{comment}{        G4HadronicProcess* hproc = dynamic\_cast<G4HadronicProcess*>(process);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03164}03164 \textcolor{comment}{        const G4Isotope* target = hproc-\/>GetTargetIsotope();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03165}03165 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03166}03166 \textcolor{comment}{        const G4ElementTable *ElmTable = G4Element::GetElementTable();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03167}03167 \textcolor{comment}{        G4Element* elm = nullptr;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03168}03168 \textcolor{comment}{        for(size\_t i=0; i<ElmTable-\/>size(); ++i) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03169}03169 \textcolor{comment}{            if((*ElmTable)[i]) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03170}03170 \textcolor{comment}{                if((*ElmTable)[i]-\/>GetZ() == target-\/>GetZ() \&\& (*ElmTable)[i]-\/>GetN() == target-\/>GetN())}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03171}03171 \textcolor{comment}{                    elm = (*ElmTable)[i];}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03172}03172 \textcolor{comment}{            \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03173}03173 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03174}03174 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03175}03175 \textcolor{comment}{        if(elm) \{ // if isotope has been found in the table of elements}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03176}03176 \textcolor{comment}{            G4double ElementSigmaF = GetElementFissionCrossSection(\&theStep, elm, mat);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03177}03177 \textcolor{comment}{            G4double ElementSigmaAbs = GetElementInelastCrossSection(\&theStep, elm, mat)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03178}03178 \textcolor{comment}{                                    + GetElementCaptureCrossSection(\&theStep, elm, mat);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03179}03179 \textcolor{comment}{            G4double ElementSigmaTot = GetElementElasticCrossSection(\&theStep, elm, mat)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03180}03180 \textcolor{comment}{                                    + ElementSigmaAbs}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03181}03181 \textcolor{comment}{                                    + ElementSigmaF;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03182}03182 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03183}03183 \textcolor{comment}{//         if(ElementSigmaF <0) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03184}03184 \textcolor{comment}{//             std::cout << mat-\/>GetName() << "{} "{} << elm-\/>GetName() << "{} sigmaf = "{} << ElementSigmaF << "{} sigmaTot = "{} << ElementSigmaTot << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03185}03185 \textcolor{comment}{//             std::cout << "{} ElementSigmaAbs = "{} << ElementSigmaAbs << "{} ; nu = "{} << nu << "{}\(\backslash\)n"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03186}03186 \textcolor{comment}{//             std::cout << nu*ElementSigmaF / (ElementSigmaAbs + ElementSigmaF) << "{}\(\backslash\)n"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03187}03187 \textcolor{comment}{//         \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03188}03188 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03189}03189 \textcolor{comment}{            // Analog absorption keff}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03190}03190 \textcolor{comment}{            // When a particle collides, there is a probability that it is absorbed by the nucleus.}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03191}03191 \textcolor{comment}{            // In analog absorption, the particle is killed with that probability}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03192}03192 \textcolor{comment}{            if( ElementSigmaAbs + ElementSigmaF ) \{ fEventAction-\/>Add\_keff\_analogAbs(nu*ElementSigmaF / (ElementSigmaAbs + ElementSigmaF));\}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03193}03193 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03194}03194 \textcolor{comment}{            // Implicit absorption keff (not the case in GEANT4, 23/11/2020)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03195}03195 \textcolor{comment}{            // the particle is never killed by absorption;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03196}03196 \textcolor{comment}{            // instead, its weight is reduced by the absorption probability at eachcollision.}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03197}03197 \textcolor{comment}{            if( ElementSigmaTot ) \{fEventAction-\/>Add\_keff\_implicitAbs(nu*ElementSigmaF / ElementSigmaTot);\}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03198}03198 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03199}03199 \textcolor{comment}{    \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03200}03200 \textcolor{comment}{//     std::cout << "{}End of MCNP\_Keff\_estimators"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03201}03201 \textcolor{comment}{*/}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03202}03202 \}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03203}03203 }
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03204}03204 \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03205}03205 \textcolor{comment}{\#include <sys/types.h>}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03206}03206 \textcolor{comment}{\#include <sys/stat.h>}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03207}03207 \textcolor{comment}{\#include <fcntl.h>}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03208}03208 \textcolor{comment}{void posplot(const G4Step theStep)}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03209}03209 \textcolor{comment}{\{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03210}03210 \textcolor{comment}{    static FILE* file = fopen("{}fiss.csv"{},"{}w"{});}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03211}03211 \textcolor{comment}{    static int count = 0;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03212}03212 \textcolor{comment}{    static G4Mutex mutex = G4MUTEX\_INITIALIZER;}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03213}03213 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03214}03214 \textcolor{comment}{       // Get the post step point}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03215}03215 \textcolor{comment}{    G4StepPoint*  thePostPoint = theStep.GetPostStepPoint();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03216}03216 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03217}03217 \textcolor{comment}{    // Get the process name}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03218}03218 \textcolor{comment}{    const G4String processName = thePostPoint-\/>GetProcessDefinedStep()-\/>GetProcessName();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03219}03219 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03220}03220 \textcolor{comment}{    if(processName == "{}nFission"{}) \{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03221}03221 \textcolor{comment}{        G4AutoLock l(\&mutex);}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03222}03222 \textcolor{comment}{        fprintf(file,"{}\%d,\%12.7g,\%12.7g,\%12.7g,\%12.7g\(\backslash\)n"{},count++,thePostPoint-\/>GetGlobalTime(),}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03223}03223 \textcolor{comment}{            (thePostPoint-\/>GetPosition()).x(),}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03224}03224 \textcolor{comment}{            (thePostPoint-\/>GetPosition()).y(),}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03225}03225 \textcolor{comment}{            (thePostPoint-\/>GetPosition()).z()}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03226}03226 \textcolor{comment}{            );}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03227}03227 \textcolor{comment}{        l.unlock();}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03228}03228 \textcolor{comment}{    \}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03229}03229 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03230}03230 \textcolor{comment}{\}}}
\DoxyCodeLine{\Hypertarget{_g4-_neutron_transport_2src_2_stepping_action_8cc_source_l03231}03231 \textcolor{comment}{*/}}

\end{DoxyCode}
