\hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source}{}\doxysection{DPA\+\_\+\+ROOT.\+C}
\label{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source}\index{/Users/Transmutex/Simulation/ADS\_SimulationCode/Benchmark-\/4/DPA\_ROOT.C@{/Users/Transmutex/Simulation/ADS\_SimulationCode/Benchmark-\/4/DPA\_ROOT.C}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00001}00001 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00002}00002 \textcolor{comment}{// \(\backslash\)brief Implementation of a DPA Calculator}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00003}00003 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00004}00004 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00006}00006 \textcolor{comment}{}\textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00007}00007 \textcolor{comment}{// DPA}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00008}00008 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00009}00009 \textcolor{comment}{// Thomas Guilbaud, Transmutex, 15/06/2021}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00010}00010 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00012}00012 \textcolor{comment}{}\textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00014}00014 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00015}00015 \textcolor{preprocessor}{\#include <TCanvas.h>}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00016}00016 \textcolor{preprocessor}{\#include <TFile.h>}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00017}00017 \textcolor{preprocessor}{\#include <TH1F.h>}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00018}00018 \textcolor{preprocessor}{\#include <TGraph.h>}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00019}00019 \textcolor{preprocessor}{\#include <TTree.h>}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00020}00020 \textcolor{preprocessor}{\#include <TLegend.h>}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00021}00021 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00022}00022 \textcolor{keywordtype}{double} convertPKAtoDPA(\textcolor{keywordtype}{double} E\_dam) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00023}00023     \textcolor{keyword}{const} \textcolor{keywordtype}{double} E\_d = 40.; \textcolor{comment}{// eV}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00024}00024     \textcolor{keyword}{const} \textcolor{keywordtype}{double} k\_d = 0.8; \textcolor{comment}{// damage efficiency}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00025}00025     \textcolor{keywordflow}{if} (E\_dam <= E\_d) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00026}00026         \textcolor{keywordflow}{return}(0.);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00027}00027     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00028}00028     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (E\_d < E\_dam \&\& E\_dam < 2. * E\_d) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00029}00029         \textcolor{keywordflow}{return}(1.);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00030}00030     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00031}00031     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00032}00032         \textcolor{keywordflow}{return}(k\_d*E\_dam/(2.*E\_d));}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00033}00033     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00034}00034 \}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00035}00035 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00036}00036 \textcolor{keywordtype}{void} canvasSetup(TCanvas* canvas) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00037}00037     canvas-\/>SetLogx();}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00038}00038     canvas-\/>SetLogy();}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00039}00039     canvas-\/>SetGridx();}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00040}00040     canvas-\/>SetGridy();}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00041}00041 \}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00043}00043 \textcolor{keywordtype}{int} DPA\_ROOT(std::string inputFile) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00044}00044     \textcolor{comment}{// Reading name of the ROOT file}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00045}00045     \textcolor{keywordtype}{size\_t} last\_slash = inputFile.rfind(\textcolor{stringliteral}{"{}/"{}});}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00046}00046     \textcolor{keywordflow}{if}(last\_slash == std::string::npos) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00047}00047         last\_slash = 0;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00048}00048     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00049}00049     std::string FileName = inputFile.substr(last\_slash, inputFile.rfind(\textcolor{stringliteral}{"{}.root"{}})-\/last\_slash);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00050}00050     TFile *f\_ROOT = \textcolor{keyword}{new} TFile( (inputFile).c\_str() );}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00051}00051 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00052}00052     \textcolor{keywordtype}{double} N\_A = 6.02214076e23; \textcolor{comment}{// Atoms/mol}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00053}00053     \textcolor{keywordtype}{double} M\_qe = 1.602176634E-\/19; \textcolor{comment}{// C}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00054}00054     \textcolor{keywordtype}{double} pi = 3.14159265359;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00055}00055 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00056}00056     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ Main -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00057}00057     \textcolor{keywordtype}{int} N\_source = 100000;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00058}00058     \textcolor{keywordtype}{double} beamPower  = 4; \textcolor{comment}{// in MW}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00059}00059     \textcolor{keywordtype}{double} beamEnergy = 600.; \textcolor{comment}{// in MeV}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00060}00060     \textcolor{keywordtype}{double} beamSigma = 1.667; \textcolor{comment}{// cm}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00061}00061     \textcolor{keywordtype}{double} thickness\_beamWindow = 0.5; \textcolor{comment}{// cm}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00062}00062     \textcolor{keywordtype}{double} timeOfIrradiation = 24.*3600.; \textcolor{comment}{// s}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00063}00063 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00064}00064     \textcolor{keywordtype}{double} correctionFactor = 1.+ 0.*6264.1/819.7; \textcolor{comment}{// Correction of the volume of the beam window}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00065}00065 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00066}00066     std::string spectraName = \textcolor{stringliteral}{"{}dFlux\_dlogE\_beamWindow"{}};}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00068}00068     \textcolor{keywordtype}{double} rho = 7.87; \textcolor{comment}{// g/cm3}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00069}00069     \textcolor{keywordtype}{double} A = 56.; \textcolor{comment}{// g/mol}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00070}00070 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00071}00071     \textcolor{keywordtype}{double} N\_atomsPerCm3 = rho*N\_A/A;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00072}00072     std::cout << \textcolor{stringliteral}{"{}Atomic density = "{}} << N\_atomsPerCm3 << \textcolor{stringliteral}{"{} atoms/cm3"{}} << \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00073}00073 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00074}00074     \textcolor{keywordtype}{bool} isPlotDisplay = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00075}00075     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ End Main -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00076}00076 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00077}00077     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00078}00078     \textcolor{comment}{// Extract the flux from a TMX Simulation}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00079}00079     \textcolor{keywordtype}{int} int\_nbins = 1000;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00080}00080     \textcolor{keywordtype}{double} dbl\_Emin = 1E-\/5;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00081}00081     \textcolor{keywordtype}{double} dbl\_Emax = 1E9;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00082}00082     \textcolor{keywordtype}{double} Emin\_log = TMath::Log10(dbl\_Emin);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00083}00083     \textcolor{keywordtype}{double} Emax\_log = TMath::Log10(dbl\_Emax);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00084}00084     \textcolor{keywordtype}{double} Ebin\_width = ( Emax\_log -\/ Emin\_log) /(\textcolor{keywordtype}{double}) int\_nbins;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00085}00085     \textcolor{keywordtype}{double} Ebins[int\_nbins + 1];}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00087}00087     Ebins[0] = dbl\_Emin;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00088}00088     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 1; i <= int\_nbins; i++) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00089}00089         Ebins[i] = dbl\_Emin + TMath::Power(10, Emin\_log + i * Ebin\_width);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00090}00090     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00091}00091 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00092}00092     \textcolor{keywordflow}{if} (isPlotDisplay) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00093}00093         TCanvas* canvasFlux = \textcolor{keyword}{new} TCanvas(spectraName.c\_str(), spectraName.c\_str());}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00094}00094         canvasSetup(canvasFlux);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00095}00095     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00096}00096 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00097}00097 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00098}00098     TH1D* histoFluxE\_log = \textcolor{keyword}{new} TH1D;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00099}00099     histoFluxE\_log-\/>SetNameTitle(spectraName.c\_str(), \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00100}00100     histoFluxE\_log-\/>SetBins(int\_nbins, Ebins); \textcolor{comment}{// Logarithmic binning}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00101}00101     TH1D* histoLog = (TH1D*)gDirectory-\/>Get(spectraName.c\_str());}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00102}00102     \textcolor{keywordtype}{double} scaling\_rawData = beamPower/(double)(beamEnergy*M\_qe*N\_source) * correctionFactor;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00103}00103     histoLog-\/>Scale(scaling\_rawData);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00104}00104 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00105}00105     \textcolor{keywordtype}{double} errorFlux = 0.;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00106}00106     \textcolor{keywordtype}{double} integral = histoLog-\/>IntegralAndError(0, (histoLog-\/>GetNbinsX() + 1), errorFlux, \textcolor{stringliteral}{"{}"{}}); \textcolor{comment}{// eV}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00107}00107     \textcolor{keywordtype}{double} relativeError = errorFlux/integral;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00108}00108     std::cout << integral << \textcolor{stringliteral}{"{} "{}} << errorFlux << \textcolor{stringliteral}{"{} "{}} << relativeError << \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00109}00109 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00110}00110     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=1; i < histoLog-\/>GetNbinsX(); i++) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00111}00111         \textcolor{comment}{// d (Phi) / d (ln(E))}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00112}00112         \textcolor{keywordtype}{int} bin\_histoFluxElog = (int) (int\_nbins * (histoLog-\/>GetXaxis()-\/>GetBinCenter(i) -\/ Emin\_log) / (Emax\_log -\/ Emin\_log));}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00113}00113         histoFluxE\_log-\/>SetBinError(bin\_histoFluxElog, TMath::Sqrt( TMath::Power(histoFluxE\_log-\/>GetBinError(i),2) + TMath::Power(histoLog-\/>GetBinError(i) / (std::log(TMath::Power(10, histoLog-\/>GetXaxis()-\/>GetBinLowEdge(i+1)))-\/std::log(TMath::Power(10, histoLog-\/>GetXaxis()-\/>GetBinLowEdge(i)))), 2)));}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00114}00114         histoFluxE\_log-\/>SetBinContent(bin\_histoFluxElog, histoFluxE\_log-\/>GetBinContent(bin\_histoFluxElog) + histoLog-\/>GetBinContent(i) / (std::log(TMath::Power(10, histoLog-\/>GetXaxis()-\/>GetBinLowEdge(i+1)))-\/std::log(TMath::Power(10, histoLog-\/>GetXaxis()-\/>GetBinLowEdge(i)))));}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00115}00115     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00116}00116     histoFluxE\_log-\/>SetLineColorAlpha(1, 1);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00117}00117     histoFluxE\_log-\/>SetLineWidth(2);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00118}00118     histoFluxE\_log-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Neutron Energy [eV]"{}});}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00119}00119     histoFluxE\_log-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}d\{Phi\}/d(ln(E)) [cm\string^\{-\/2\}.s\string^\{-\/1\}]"{}});}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00120}00120     \textcolor{keywordflow}{if} (isPlotDisplay) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00121}00121         histoFluxE\_log-\/>Draw(\textcolor{stringliteral}{"{}HIST e"{}});}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00122}00122     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00123}00123 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00124}00124     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00125}00125     \textcolor{comment}{// Extract the PKA data from a data file}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00126}00126     \textcolor{keywordflow}{if} (isPlotDisplay) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00127}00127         TCanvas* canvasPKA = \textcolor{keyword}{new} TCanvas(\textcolor{stringliteral}{"{}PKA"{}}, \textcolor{stringliteral}{"{}PKA"{}});}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00128}00128         canvasSetup(canvasPKA);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00129}00129     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00130}00130 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00131}00131     TH1D* histoPKA\_log = \textcolor{keyword}{new} TH1D;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00132}00132     histoPKA\_log-\/>SetNameTitle(\textcolor{stringliteral}{"{}PKA"{}}, \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00133}00133     histoPKA\_log-\/>SetBins(int\_nbins, Ebins); \textcolor{comment}{// Logarithmic binning}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00134}00134 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00135}00135     std::string fileName = \textcolor{stringliteral}{"{}../../../../../../Simulation/ADS\_SimulationCode/DPA\_data/26\_56\_Iron\_MT444\_incidentNeutrondata.csv"{}};}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00136}00136     std::string line, energyStr, crossSectionStr, delimiter;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00137}00137     \textcolor{keywordtype}{double} energy, crossSection; \textcolor{comment}{// MeV, barn.eV}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00138}00138     std::ifstream file(fileName);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00139}00139     \textcolor{keywordtype}{int} lineCount = 0;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00140}00140     \textcolor{keywordflow}{while} (std::getline(file, line)) \{ \textcolor{comment}{// Read by line}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00141}00141         std::stringstream input(line);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00142}00142         \textcolor{keywordflow}{if} (lineCount > 0) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00143}00143             input >> energyStr >> delimiter >> crossSectionStr;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00144}00144             energy       = std::stod(energyStr);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00145}00145             crossSection = std::stod(crossSectionStr);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00146}00146             histoPKA\_log-\/>Fill(energy, crossSection);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00147}00147         \}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00148}00148         lineCount++;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00149}00149     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00150}00150 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00151}00151     histoPKA\_log-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Neutron Energy [eV]"{}});}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00152}00152     histoPKA\_log-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}PKA [eV.barn]"{}});}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00153}00153     \textcolor{keywordflow}{if} (isPlotDisplay) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00154}00154         histoPKA\_log-\/>Draw(\textcolor{stringliteral}{"{}HIST e"{}});}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00155}00155     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00156}00156 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00157}00157     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00158}00158     \textcolor{comment}{// Convolution}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00159}00159     \textcolor{keywordflow}{if} (isPlotDisplay) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00160}00160         TCanvas* canvasConvolution = \textcolor{keyword}{new} TCanvas(\textcolor{stringliteral}{"{}Convolution"{}}, \textcolor{stringliteral}{"{}Convolution"{}});}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00161}00161         canvasSetup(canvasConvolution);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00162}00162     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00163}00163 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00164}00164     TH1D* convolution = (TH1D*)histoPKA\_log-\/>Clone(\textcolor{stringliteral}{"{}Convolution"{}});}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00165}00165     convolution-\/>Multiply(histoFluxE\_log);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00166}00166     \textcolor{comment}{/*for (int i = 1; i < convolution-\/>GetNbinsX(); i++) \{}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00167}00167 \textcolor{comment}{        // d (Phi) / d (ln(E))}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00168}00168 \textcolor{comment}{        convolution-\/>SetBinContent(i, convertPKAtoDPA(convolution-\/>GetBinContent(i)));}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00169}00169 \textcolor{comment}{    \}*/}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00170}00170     convolution-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Neutron Energy [eV]"{}});}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00171}00171     convolution-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}PKA [eV.barn.cm\string^\{-\/2\}.s\string^\{-\/1\}]"{}});}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00172}00172     \textcolor{keywordflow}{if} (isPlotDisplay) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00173}00173         convolution-\/>Draw(\textcolor{stringliteral}{"{}HIST e"{}});}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00174}00174     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00175}00175 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00176}00176     \textcolor{keywordtype}{double} errorDPA = 0.;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00177}00177     \textcolor{keywordtype}{double} totalEnergyLost = convolution-\/>IntegralAndError(0, (convolution-\/>GetNbinsX() + 1), errorDPA, \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00178}00178     \textcolor{keywordtype}{double} relativeErrorDPA = errorDPA/totalEnergyLost;}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00179}00179     std::cout << totalEnergyLost << \textcolor{stringliteral}{"{} "{}} << errorDPA << \textcolor{stringliteral}{"{} "{}} << errorDPA/totalEnergyLost << \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00180}00180 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00181}00181     std::cout << \textcolor{stringliteral}{"{}Total Energy Lost = "{}} << totalEnergyLost*1e-\/24 << \textcolor{stringliteral}{"{} eV/s"{}} << \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00182}00182     \textcolor{comment}{// std::cout << "{}Total Energy Lost = "{} << totalEnergyLost*1e-\/24*beamEnergy*M\_qe/beamPower << "{} eV/proton"{} << '\(\backslash\)n';}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00183}00183 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00184}00184     \textcolor{comment}{// double totalPKA = totalEnergyLost * beamEnergy*M\_qe/beamPower; // eV/proton}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00185}00185     \textcolor{comment}{// std::cout << "{}Total PKA = "{} << totalPKA << "{} eV/neutron"{} << '\(\backslash\)n';}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00186}00186 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00187}00187     \textcolor{comment}{// double maxGaussianFactor = 1./(2.*pi*beamSigma*beamSigma*thickness\_beamWindow); // /cm3}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00188}00188     \textcolor{keywordtype}{double} totalDPA = convertPKAtoDPA(totalEnergyLost)*1e-\/24; \textcolor{comment}{// /N\_atomsPerCm3*maxGaussianFactor;}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00189}00189     std::cout << \textcolor{stringliteral}{"{}At the maximum of the Gaussian:"{}}                           << \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00190}00190               << \textcolor{stringliteral}{"{}Total DPA = "{}} << totalDPA                  << \textcolor{stringliteral}{"{} ± "{}} << totalDPA*relativeErrorDPA                  << \textcolor{stringliteral}{"{} DPA/s"{}}     << \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00191}00191               << \textcolor{stringliteral}{"{}          = "{}} << totalDPA*60.              << \textcolor{stringliteral}{"{} ± "{}} << totalDPA*60.*relativeErrorDPA              << \textcolor{stringliteral}{"{} DPA/min"{}}   << \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00192}00192               << \textcolor{stringliteral}{"{}          = "{}} << totalDPA*3600.            << \textcolor{stringliteral}{"{} ± "{}} << totalDPA*3600.*relativeErrorDPA            << \textcolor{stringliteral}{"{} DPA/hour"{}}  << \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00193}00193               << \textcolor{stringliteral}{"{}          = "{}} << totalDPA*24.*3600.        << \textcolor{stringliteral}{"{} ± "{}} << totalDPA*24.*3600.*relativeErrorDPA        << \textcolor{stringliteral}{"{} DPA/day"{}}   << \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00194}00194               << \textcolor{stringliteral}{"{}          = "{}} << totalDPA*30.*24.*3600.    << \textcolor{stringliteral}{"{} ± "{}} << totalDPA*30.*24.*3600.*relativeErrorDPA    << \textcolor{stringliteral}{"{} DPA/month"{}} << \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00195}00195               << \textcolor{stringliteral}{"{}          = "{}} << totalDPA*365.25*24.*3600. << \textcolor{stringliteral}{"{} ± "{}} << totalDPA*365.25*24.*3600.*relativeErrorDPA << \textcolor{stringliteral}{"{} DPA/year"{}}  << \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00196}00196 }
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00197}00197     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*}}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00198}00198     \textcolor{keywordflow}{return}(0);}
\DoxyCodeLine{\Hypertarget{_benchmark-4_2_d_p_a___r_o_o_t_8_c_source_l00199}00199 \}}

\end{DoxyCode}
