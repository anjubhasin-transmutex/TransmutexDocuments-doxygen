\hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source}{}\doxysection{TMXNeutron\+Generation\+Counting.\+cc}
\label{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source}\index{/Users/Transmutex/Simulation/ADS\_SimulationCode/Benchmark-\/3/src/TMXNeutronGenerationCounting.cc@{/Users/Transmutex/Simulation/ADS\_SimulationCode/Benchmark-\/3/src/TMXNeutronGenerationCounting.cc}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00001}00001 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00003}00003 \textcolor{comment}{}\textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00004}00004 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00006}00006 \textcolor{comment}{}\textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00007}00007 \textcolor{comment}{// TMXNeutronGenerationCounting}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00008}00008 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00009}00009 \textcolor{comment}{// Donovan Maire, 10/05/2021, Transmutex all rigths reserved}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00010}00010 \textcolor{comment}{// }}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00012}00012 \textcolor{comment}{}\textcolor{comment}{// }}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00013}00013 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00014}00014 \textcolor{comment}{// Class}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00015}00015 \textcolor{preprocessor}{\#include "{}TMXNeutronGenerationCounting.hh"{}}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00016}00016 \textcolor{preprocessor}{\#include "{}Analysis.hh"{}}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00017}00017 \textcolor{preprocessor}{\#include "{}TMXOption.hh"{}}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00018}00018 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00019}00019 \textcolor{comment}{// GEANT4 libraries}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00020}00020 \textcolor{preprocessor}{\#include "{}G4SystemOfUnits.hh"{}}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00021}00021 \textcolor{preprocessor}{\#include "{}G4PhysicalConstants.hh"{}}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00022}00022 \textcolor{preprocessor}{\#include "{}G4VProcess.hh"{}}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00024}00024 \mbox{\hyperlink{class_t_m_x_neutron_generation_counting_a4fd7f5dfed7ba9a439ff23fcec49cb62}{TMXNeutronGenerationCounting::TMXNeutronGenerationCounting}}(\mbox{\hyperlink{class_event_action}{EventAction}}* eventAction, \mbox{\hyperlink{class_t_m_x_input_parameters}{TMXInputParameters}}* parameters) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00025}00025     Initialize(eventAction, parameters);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00026}00026 \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00027}00027 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00028}00028 TMXNeutronGenerationCounting::\string~TMXNeutronGenerationCounting() \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00029}00029 \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00030}00030 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00031}00031 \textcolor{keywordtype}{void} TMXNeutronGenerationCounting::Initialize(\mbox{\hyperlink{class_event_action}{EventAction}}* eventAction, \mbox{\hyperlink{class_t_m_x_input_parameters}{TMXInputParameters}}* parameters) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00032}00032     fVect\_GenerationAndStatus.clear();}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00033}00033     fIsNotSourceNeutron = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00034}00034     fNeutronGeneration = 0;}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00035}00035     fTotalNeutronNumber=0;}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00036}00036     fEnergyAtBirth=0;}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00037}00037     fPosAtBirth = G4ThreeVector(0,0,0);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00038}00038     fEventAction = eventAction;}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00039}00039     fInputParameters = parameters;}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00040}00040 \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00041}00041 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00042}00042 \textcolor{keywordtype}{void} TMXNeutronGenerationCounting::FillHistoSourceN(\textcolor{keywordtype}{double} energyAtBirth, G4ThreeVector posAtBirth, \textcolor{keywordtype}{double} energyAtCounting, G4ThreeVector posAtCounting, G4ThreeVector dirAtCounting, \textcolor{keywordtype}{int} nbNeutrons) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00043}00043     \textcolor{keyword}{auto} analysisManager = G4AnalysisManager::Instance();}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00044}00044     analysisManager-\/>FillH1(16, log10(energyAtBirth), nbNeutrons);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00045}00045     analysisManager-\/>FillH1(17, log10(energyAtCounting), nbNeutrons);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00046}00046     analysisManager-\/>FillH2(32, posAtCounting.x()/mm, posAtCounting.y()/mm, nbNeutrons);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00047}00047     analysisManager-\/>FillH2(33, posAtCounting.x()/mm, posAtCounting.z()/mm, nbNeutrons);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00048}00048     analysisManager-\/>FillH2(34, posAtBirth.x()/mm, posAtBirth.y()/mm, nbNeutrons);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00049}00049     analysisManager-\/>FillH2(35, posAtBirth.x()/mm, posAtBirth.z()/mm, nbNeutrons);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00050}00050     analysisManager-\/>FillH2(36, dirAtCounting.unit().z(), log10(energyAtCounting), nbNeutrons);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00051}00051     analysisManager-\/>FillH2(37, std::acos(dirAtCounting.unit().z())* 360.0 / twopi, log10(energyAtCounting), nbNeutrons);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00052}00052 \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00053}00053 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00054}00054 \textcolor{keywordtype}{void} TMXNeutronGenerationCounting::ScoreNeutronGeneration(\textcolor{keywordtype}{long} NeutronGeneration, \textcolor{keywordtype}{int} NeutronNumber) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00055}00055     fTotalNeutronNumber += NeutronNumber;}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00056}00056     fEventAction-\/>SetNf(fTotalNeutronNumber);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00057}00057     fEventAction-\/>AddNbNeutronPerGeneration(NeutronGeneration, NeutronNumber);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00058}00058     \textcolor{keyword}{auto} analysisManager = G4AnalysisManager::Instance();}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00059}00059     analysisManager-\/>FillH1(15, NeutronGeneration, NeutronNumber); \textcolor{comment}{// +NeutronNumber neutron(s) from generation NeutronGeneration}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00060}00060 \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00061}00061 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00062}00062 \textcolor{keywordtype}{void} TMXNeutronGenerationCounting::InitializeGenerationFlag(\textcolor{keyword}{const} G4Step * theStep, \textcolor{keywordtype}{bool} isStepInTargetRegion) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00063}00063     \textcolor{keywordflow}{if}(theStep-\/>GetTrack()}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00064}00064     \&\& theStep-\/>GetTrack()-\/>GetDefinition()}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00065}00065     \&\& theStep-\/>GetTrack()-\/>GetCurrentStepNumber() == 1) \{ \textcolor{comment}{// If first step of a track}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00066}00066         }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00067}00067         \textcolor{comment}{// if it is a primary particle generated by the primaryGenerator => generation = 0}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00068}00068         \textcolor{keywordflow}{if}(theStep-\/>GetTrack()-\/>GetParentID() == 0) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00069}00069             fNeutronGeneration = 0;}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00070}00070             fIsNotSourceNeutron = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00071}00071             fVect\_GenerationAndStatus.clear();}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00072}00072         \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00073}00073         }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00074}00074         \textcolor{comment}{// The status and generation is retrieved from fVect\_GenerationAndStatus; last element is deleted after reading}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00075}00075         \textcolor{keywordflow}{if}(fVect\_GenerationAndStatus.size() > 0) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00076}00076             fNeutronGeneration = fVect\_GenerationAndStatus.back().first;}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00077}00077             fIsNotSourceNeutron = fVect\_GenerationAndStatus.back().second;}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00078}00078             fVect\_GenerationAndStatus.pop\_back();}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00079}00079         \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00080}00080         \textcolor{comment}{// If the track is not a primary}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00081}00081         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (theStep-\/>GetTrack()-\/>GetParentID() != 0) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00082}00082             \textcolor{comment}{// The vector is empty only for primaries}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00083}00083             std::cout << \textcolor{stringliteral}{"{}ERROR in reading of fVect\_GenerationAndStatus. The vector size is "{}} << fVect\_GenerationAndStatus.size() << std::endl;}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00084}00084         \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00085}00085         }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00086}00086         \textcolor{comment}{// if it is a source neutron, get energy and position at birth}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00087}00087         \textcolor{keywordflow}{if}(theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}neutron"{}}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00088}00088             \&\& fNeutronGeneration == 0}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00089}00089         ) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00090}00090             fEnergyAtBirth = theStep-\/>GetPreStepPoint()-\/>GetKineticEnergy()/eV;}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00091}00091             fPosAtBirth    = theStep-\/>GetPreStepPoint()-\/>GetPosition();}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00092}00092         \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00093}00093     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00094}00094     }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00095}00095     \textcolor{comment}{// If the conditions of source neutron definition are not fulfilled the default condition fIsNotSourceNeutron=false must be changed to true}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00096}00096     ChangeStatusFlag(theStep, isStepInTargetRegion);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00097}00097 \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00098}00098 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00100}00100 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00101}00101 \textcolor{comment}{// This method is used to change fIsNotSourceNeutron and start the counting of neutron generations}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00102}00102 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00103}00103 \textcolor{keywordtype}{void} TMXNeutronGenerationCounting::ChangeStatusFlag(\textcolor{keyword}{const} G4Step * theStep, \textcolor{keywordtype}{bool} isStepInTargetRegion) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00104}00104     \textcolor{comment}{// If the status is still false}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00105}00105     \textcolor{keywordflow}{if}( !fIsNotSourceNeutron \&\&}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00106}00106             \textcolor{comment}{// and the particle is outside the target (e.g. in the beam window) and the definition of source neutron is not the Energy Amplifier's definition}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00107}00107         ( (!TMXOption::IsSourceNeutronEADefinition(fInputParameters-\/>int\_Option) \&\& !isStepInTargetRegion)}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00108}00108            \textcolor{comment}{// or old definition of source neutrons (Energy Amplifier 1995): with neutron counted as source neutron when E < 20 MeV and the particle is a neutron}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00109}00109         || (TMXOption::IsSourceNeutronEADefinition(fInputParameters-\/>int\_Option) \&\& theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}neutron"{}} \&\& theStep-\/>GetPreStepPoint()-\/>GetKineticEnergy() < 20)}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00110}00110           \textcolor{comment}{// or we have an external source file}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00111}00111         || !fInputParameters-\/>ExtSourcePath.empty()}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00112}00112     )) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00113}00113         fIsNotSourceNeutron = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00114}00114         fNeutronGeneration = 0;    \textcolor{comment}{// When the flag is changed to false, the counting of neutron generation starts (from 0).}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00115}00115         }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00116}00116         \textcolor{comment}{// If the track is neutron}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00117}00117         \textcolor{keywordflow}{if}(theStep-\/>GetTrack()}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00118}00118             \&\& theStep-\/>GetTrack()-\/>GetDefinition()}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00119}00119             \&\& theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}neutron"{}}) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00120}00120         }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00121}00121             \textcolor{comment}{// Score neutron birth for neutron counting}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00122}00122             \textcolor{comment}{// Track quantities}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00123}00123             G4double energyK = theStep-\/>GetPreStepPoint()-\/>GetKineticEnergy()/eV;}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00125}00125             \textcolor{comment}{// PreStep quantities}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00126}00126             G4ThreeVector PrePos   = theStep-\/>GetPreStepPoint()-\/>GetPosition();}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00127}00127             G4ThreeVector PreMom   = theStep-\/>GetPreStepPoint()-\/>GetMomentumDirection();}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00128}00128 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00129}00129             \textcolor{comment}{// Scoring  }}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00130}00130             ScoreNeutronGeneration(0, 1);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00131}00131             FillHistoSourceN(fEnergyAtBirth, fPosAtBirth, energyK, PrePos, PreMom, 1);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00132}00132             FillNtupleNeutronSource(PrePos, PreMom, energyK);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00133}00133         \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00134}00134     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00135}00135 \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00136}00136 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00138}00138 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00139}00139 \textcolor{comment}{// This method is used to count neutron per generations}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00140}00140 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00141}00141 \textcolor{keywordtype}{void} TMXNeutronGenerationCounting::NeutronGenerationCounting(\textcolor{keyword}{const} G4Step* theStep, \textcolor{keyword}{const} G4Track* secondary, }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00142}00142                                                 \textcolor{keywordtype}{int} nNeutrons, \textcolor{keywordtype}{int}\& Nb\_inelastic) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00143}00143     }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00144}00144     G4String processName = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00145}00145     \textcolor{keywordflow}{if}(theStep-\/>GetPostStepPoint()-\/>GetProcessDefinedStep()) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00146}00146         processName = theStep-\/>GetPostStepPoint()-\/>GetProcessDefinedStep()-\/>GetProcessName();\}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00147}00147         }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00148}00148     \textcolor{comment}{// if the status is at true, the conditions of source neutron definition are not fulfilled anymore and the counting can start}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00149}00149     \textcolor{keywordflow}{if}(fIsNotSourceNeutron) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00150}00150 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00151}00151         \textcolor{keywordflow}{if} (processName == \textcolor{stringliteral}{"{}nFission"{}}) \{ \textcolor{comment}{// If particles are generated by fission}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00152}00152             \textcolor{comment}{// The secondary generation is +1}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00153}00153             fVect\_GenerationAndStatus.push\_back( \{fNeutronGeneration+1, fIsNotSourceNeutron\});}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00154}00154             }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00155}00155             \textcolor{comment}{// If the secondary is a neutron, the neutron generation is scored}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00156}00156             \textcolor{keywordflow}{if}(secondary-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}neutron"{}}) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00157}00157                 ScoreNeutronGeneration(fNeutronGeneration+1, 1);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00158}00158             \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00159}00159         \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00160}00160         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(processName == \textcolor{stringliteral}{"{}neutronInelastic"{}}) \{ \textcolor{comment}{// If secondary neutrons are generated by inelastic reaction}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00161}00161             \textcolor{comment}{// Count number of secondary neutrons from inelastic reaction}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00162}00162             \textcolor{keywordflow}{if}(secondary-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}neutron"{}})}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00163}00163                 ++Nb\_inelastic;}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00164}00164             }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00165}00165             \textcolor{comment}{// If (n, n' + whatever except neutrons) reaction or neutron absorption,}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00166}00166             \textcolor{keywordflow}{if}(nNeutrons <= 1)\{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00167}00167                 \textcolor{comment}{// the neutron generation remains the same and it is not scored as a new neutron}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00168}00168                 fVect\_GenerationAndStatus.push\_back( \{fNeutronGeneration, fIsNotSourceNeutron\});}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00169}00169             \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00170}00170             \textcolor{comment}{// If source neutrons definition 1 : (n,Xn) does not change the secondary neutron generation,}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00171}00171             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( TMXOption::IsSrcNeutronDefinitionWithNxN(fInputParameters-\/>int\_Option) \textcolor{comment}{/*|| nNeutrons == 1*/}) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00172}00172                 \textcolor{comment}{// the neutron generation remains the same and it scored as a new neutron}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00173}00173                 fVect\_GenerationAndStatus.push\_back( \{fNeutronGeneration, fIsNotSourceNeutron\});  }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00174}00174                 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00175}00175                 \textcolor{comment}{// If the secondary is a neutron and already 1 secondary neutron has been read, the neutron generation is scored}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00176}00176                 \textcolor{keywordflow}{if}(secondary-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}neutron"{}} \&\& Nb\_inelastic > 1) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00177}00177                     ScoreNeutronGeneration(fNeutronGeneration, 1);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00178}00178                     }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00179}00179                     \textcolor{keywordflow}{if}(fNeutronGeneration == 0) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00180}00180                         FillHistoSourceN(secondary-\/>GetKineticEnergy()/eV,  \textcolor{comment}{// At birth}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00181}00181                                          secondary-\/>GetPosition(),          \textcolor{comment}{// At birth}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00182}00182                                          secondary-\/>GetKineticEnergy()/eV,      \textcolor{comment}{// At counting}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00183}00183                                          secondary-\/>GetPosition(),              \textcolor{comment}{// At counting}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00184}00184                                          secondary-\/>GetMomentumDirection(), 1); \textcolor{comment}{// At counting}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00185}00185                         FillNtupleNeutronSource(secondary-\/>GetPosition(), }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00186}00186                                                 secondary-\/>GetMomentumDirection(), }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00187}00187                                                 secondary-\/>GetKineticEnergy()/eV);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00188}00188                     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00189}00189                 \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00190}00190             \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00191}00191             \textcolor{keywordflow}{else} \{ \textcolor{comment}{// else it is (n, Xn + whatever except neutron) reaction, the secondary neutron generation is +1}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00192}00192                 fVect\_GenerationAndStatus.push\_back( \{fNeutronGeneration+1, fIsNotSourceNeutron\}); }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00193}00193                 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00194}00194                 \textcolor{comment}{// If the secondary is a neutron, the neutron generation is scored}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00195}00195                 \textcolor{keywordflow}{if}(secondary-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}neutron"{}}) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00196}00196                     ScoreNeutronGeneration(fNeutronGeneration+1, 1);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00197}00197                 \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00198}00198             \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00199}00199         \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00200}00200         \textcolor{keywordflow}{else} \{ \textcolor{comment}{// Else the process is not a nfission or neutronInelastic}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00201}00201             }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00202}00202             \textcolor{comment}{// The generation and status is not changed}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00203}00203             fVect\_GenerationAndStatus.push\_back( \{fNeutronGeneration, fIsNotSourceNeutron\} );}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00204}00204             }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00205}00205             \textcolor{comment}{// If the secondary is a neutron and not his mother, the neutron generation is scored}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00206}00206             \textcolor{keywordflow}{if}(theStep-\/>GetTrack()-\/>GetDefinition()-\/>GetParticleName() != \textcolor{stringliteral}{"{}neutron"{}}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00207}00207                 \&\& secondary-\/>GetDefinition()-\/>GetParticleName() == \textcolor{stringliteral}{"{}neutron"{}}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00208}00208             ) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00209}00209                 ScoreNeutronGeneration(fNeutronGeneration, 1);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00210}00210                 \textcolor{keywordflow}{if}(fNeutronGeneration == 0) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00211}00211                     FillHistoSourceN(secondary-\/>GetKineticEnergy()/eV,  \textcolor{comment}{// At birth}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00212}00212                                      secondary-\/>GetPosition(),          \textcolor{comment}{// At birth}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00213}00213                                      secondary-\/>GetKineticEnergy()/eV,      \textcolor{comment}{// At counting}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00214}00214                                      secondary-\/>GetPosition(),              \textcolor{comment}{// At counting}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00215}00215                                      secondary-\/>GetMomentumDirection(), 1); \textcolor{comment}{// At counting}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00216}00216                     FillNtupleNeutronSource(secondary-\/>GetPosition(), }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00217}00217                                             secondary-\/>GetMomentumDirection(), }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00218}00218                                             secondary-\/>GetKineticEnergy()/eV);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00219}00219                 \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00220}00220             \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00221}00221         \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00222}00222     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00223}00223     \textcolor{keywordflow}{else} \{ \textcolor{comment}{// else the status is still at false, the conditions of source neutron definition are still fulfilled}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00224}00224         \textcolor{comment}{// Every secondaries inherits of the status and generation of its mother}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00225}00225         fVect\_GenerationAndStatus.push\_back( \{fNeutronGeneration, fIsNotSourceNeutron\} );}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00226}00226     \}    }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00227}00227 \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00228}00228 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00229}00229 \textcolor{keywordtype}{void} TMXNeutronGenerationCounting::FillNtupleNeutronSource(G4ThreeVector N0\_Pos, G4ThreeVector N0\_Momentum, G4double N0\_Energy) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00230}00230     \textcolor{keywordflow}{if} (N0\_Energy > 0.) \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00231}00231         G4int row = 3;}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00232}00232         \textcolor{keyword}{auto} analysisManager = G4AnalysisManager::Instance();}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00233}00233         analysisManager-\/>FillNtupleFColumn(row, 0, N0\_Pos.x()/mm);         \textcolor{comment}{// ID= 0 X Position}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00234}00234         analysisManager-\/>FillNtupleFColumn(row, 1, N0\_Pos.y()/mm);         \textcolor{comment}{// ID= 1 Y Position}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00235}00235         analysisManager-\/>FillNtupleFColumn(row, 2, N0\_Pos.z()/mm);         \textcolor{comment}{// ID= 2 Z Position}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00236}00236         analysisManager-\/>FillNtupleFColumn(row, 3, N0\_Momentum.x());    \textcolor{comment}{// ID= 3 X Momentum}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00237}00237         analysisManager-\/>FillNtupleFColumn(row, 4, N0\_Momentum.y());    \textcolor{comment}{// ID= 4 Y Momentum}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00238}00238         analysisManager-\/>FillNtupleFColumn(row, 5, N0\_Momentum.z());    \textcolor{comment}{// ID= 5 Z Momentum}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00239}00239         analysisManager-\/>FillNtupleDColumn(row, 6, N0\_Energy);       \textcolor{comment}{// ID= 6   Energy}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00240}00240         analysisManager-\/>AddNtupleRow(row);}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00241}00241     \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00242}00242 \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00243}00243 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00245}00245 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00246}00246 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00247}00247 \textcolor{comment}{//   GETTER}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00248}00248 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00249}00249 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00250}00250 \textcolor{keywordtype}{bool} TMXNeutronGenerationCounting::GetStatus\_SourceNeutron() \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00251}00251     \textcolor{keywordflow}{return} fIsNotSourceNeutron;}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00252}00252 \}}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00253}00253 }
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00254}00254 \textcolor{keywordtype}{long} TMXNeutronGenerationCounting::GetNeutronGeneration() \{}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00255}00255     \textcolor{keywordflow}{return} fNeutronGeneration;}
\DoxyCodeLine{\Hypertarget{_benchmark-3_2src_2_t_m_x_neutron_generation_counting_8cc_source_l00256}00256 \}}

\end{DoxyCode}
