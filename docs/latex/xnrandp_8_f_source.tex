\hypertarget{xnrandp_8_f_source}{}\doxysection{xnrandp.\+F}
\label{xnrandp_8_f_source}\index{/Users/Transmutex/Simulation/ADS\_SimulationCode/xnsect/xnsect/src/xnrandp.F@{/Users/Transmutex/Simulation/ADS\_SimulationCode/xnsect/xnsect/src/xnrandp.F}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00001}00001 \textcolor{comment}{*CMZ :  2.03/06 17/08/96  17.17.38  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00002}00002 \textcolor{comment}{*-\/-\/ Author :    Federico Carminati   21/06/96}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00003}00003 \textcolor{preprocessor}{\#ifdef HPUX}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00004}00004 \textcolor{preprocessor}{}      \textcolor{keyword}{SUBROUTINE }xnrand(RVEC,LENV)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00005}00005 \textcolor{comment}{* Thread-\/private random number generator, if the run}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00006}00006 \textcolor{comment}{* is not parallel, always call the first.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00007}00007       ith=my\_thread()}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00008}00008       \textcolor{keywordflow}{IF}(ith.EQ.0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00009}00009          \textcolor{keyword}{CALL }xnrand1(rvec,lenv)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00010}00010       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(ith.EQ.1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00011}00011          \textcolor{keyword}{CALL }xnrand2(rvec,lenv)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00012}00012       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(ith.EQ.2) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00013}00013          \textcolor{keyword}{CALL }xnrand3(rvec,lenv)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00014}00014       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(ith.EQ.3) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00015}00015          \textcolor{keyword}{CALL }xnrand4(rvec,lenv)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00016}00016       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(ith.EQ.4) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00017}00017          \textcolor{keyword}{CALL }xnrand5(rvec,lenv)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00018}00018       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(ith.EQ.5) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00019}00019          \textcolor{keyword}{CALL }xnrand6(rvec,lenv)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00020}00020       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(ith.EQ.6) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00021}00021          \textcolor{keyword}{CALL }xnrand7(rvec,lenv)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00022}00022       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(ith.EQ.7) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00023}00023          \textcolor{keyword}{CALL }xnrand8(rvec,lenv)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00024}00024 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00025}00025 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00026}00026       \textcolor{keyword}{END}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00027}00027       \textcolor{keyword}{SUBROUTINE }xnrngo(LUX,INSEED)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00028}00028 \textcolor{comment}{* Thread-\/private random number generator, if the run}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00029}00029 \textcolor{comment}{* is not parallel, always call the first.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00030}00030       ith=my\_thread()}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00031}00031       \textcolor{keywordflow}{IF}(ith.EQ.0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00032}00032          \textcolor{keyword}{CALL }xnrngo1(lux,inseed)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00033}00033       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(ith.EQ.1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00034}00034          \textcolor{keyword}{CALL }xnrngo2(lux,inseed)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00035}00035       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(ith.EQ.2) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00036}00036          \textcolor{keyword}{CALL }xnrngo3(lux,inseed)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00037}00037       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(ith.EQ.3) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00038}00038          \textcolor{keyword}{CALL }xnrngo4(lux,inseed)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00039}00039       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(ith.EQ.4) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00040}00040          \textcolor{keyword}{CALL }xnrngo5(lux,inseed)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00041}00041       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(ith.EQ.5) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00042}00042          \textcolor{keyword}{CALL }xnrngo6(lux,inseed)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00043}00043       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(ith.EQ.6) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00044}00044          \textcolor{keyword}{CALL }xnrngo7(lux,inseed)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00045}00045       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(ith.EQ.7) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00046}00046          \textcolor{keyword}{CALL }xnrngo8(lux,inseed)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00047}00047 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00048}00048 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00049}00049       \textcolor{keyword}{END}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00050}00050 \textcolor{comment}{*}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00051}00051       \textcolor{keyword}{SUBROUTINE }xnrand1(RVEC,LENV)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00052}00052 \textcolor{comment}{C      SUBROUTINE RANLUX(RVEC,LENV)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00053}00053 \textcolor{comment}{C         Subtract-\/and-\/borrow random number generator proposed by}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00054}00054 \textcolor{comment}{C         Marsaglia and Zaman, implemented by F. James with the name}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00055}00055 \textcolor{comment}{C         RCARRY in 1991, and later improved by Martin Luescher}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00056}00056 \textcolor{comment}{C         in 1993 to produce "{}Luxury Pseudorandom Numbers"{}.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00057}00057 \textcolor{comment}{C     Fortran 77 coded by F. James, 1993}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00058}00058 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00059}00059 \textcolor{comment}{C   LUXURY LEVELS.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00060}00060 \textcolor{comment}{C   -\/-\/-\/-\/-\/-\/ -\/-\/-\/-\/-\/-\/      The available luxury levels are:}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00061}00061 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00062}00062 \textcolor{comment}{C  level 0  (p=24): equivalent to the original RCARRY of Marsaglia}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00063}00063 \textcolor{comment}{C           and Zaman, very long period, but fails many tests.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00064}00064 \textcolor{comment}{C  level 1  (p=48): considerable improvement in quality over level 0,}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00065}00065 \textcolor{comment}{C           now passes the gap test, but still fails spectral test.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00066}00066 \textcolor{comment}{C  level 2  (p=97): passes all known tests, but theoretically still}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00067}00067 \textcolor{comment}{C           defective.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00068}00068 \textcolor{comment}{C  level 3  (p=223): DEFAULT VALUE.  Any theoretically possible}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00069}00069 \textcolor{comment}{C           correlations have very small chance of being observed.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00070}00070 \textcolor{comment}{C  level 4  (p=389): highest possible luxury, all 24 bits chaotic.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00071}00071 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00072}00072 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00073}00073 \textcolor{comment}{C!!!  Calling sequences for RANLUX:                                  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00074}00074 \textcolor{comment}{C!!!      CALL RANLUX (RVEC, LEN)   returns a vector RVEC of LEN     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00075}00075 \textcolor{comment}{C!!!                   32-\/bit random floating point numbers between  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00076}00076 \textcolor{comment}{C!!!                   zero (not included) and one (also not incl.). ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00077}00077 \textcolor{comment}{C!!!      CALL RLUXGO(LUX,INT) initializes the generator from one    ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00078}00078 \textcolor{comment}{C!!!                   32-\/bit integer INT and sets Luxury Level LUX  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00079}00079 \textcolor{comment}{C!!!                   which is integer between zero and MAXLEV,     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00080}00080 \textcolor{comment}{C!!!                   or if LUX .GT. 24, it sets p=LUX directly     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00081}00081 \textcolor{comment}{C!!!      CALL RLUXIN(IVEC)    restarts the generator from vector    ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00082}00082 \textcolor{comment}{C!!!                   IVEC of 25 32-\/bit integers (see RLUXUT)       ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00083}00083 \textcolor{comment}{C!!!      CALL RLUXUT(IVEC)    outputs the current values of the 25  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00084}00084 \textcolor{comment}{C!!!                 32-\/bit integer seeds, to be used for restarting ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00085}00085 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00086}00086       dimension rvec(lenv)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00087}00087       dimension seeds(24), iseeds(24), isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00088}00088       parameter(maxlev=4, lxdflt=3)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00089}00089       dimension ndskip(0:maxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00090}00090       parameter(twop12=4096.)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00091}00091       parameter(itwo24=2**24, icons=2147483563)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00092}00092       \textcolor{keywordtype}{SAVE} notyet, i24, j24, carry, seeds, twom24, twom12, luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00093}00093       \textcolor{keywordtype}{SAVE} nskip, ndskip, in24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00094}00094       \textcolor{keywordtype}{INTEGER} LUXLEV}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00095}00095       \textcolor{keywordtype}{LOGICAL} NOTYET}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00096}00096       \textcolor{keyword}{DATA} notyet, luxlev, in24 /.true., lxdflt, 0/}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00097}00097       \textcolor{keyword}{DATA} i24,j24,carry/24,10,0./}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00098}00098       \textcolor{keyword}{DATA} ndskip/0,  24,  73, 199, 365 /}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00099}00099 \textcolor{comment}{Corresponds to p=24   48   97  223  389}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00100}00100 \textcolor{comment}{C     time factor 1    2    4    9   16   (in practice, much smaller)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00101}00101 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00102}00102 \textcolor{comment}{C  NOTYET is .TRUE. if no initialization has been performed yet.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00103}00103 \textcolor{comment}{C              Default Initialization by Multiplicative Congruential}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00104}00104       \textcolor{keywordflow}{IF} (notyet) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00105}00105          notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00106}00106          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00107}00107          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default initialisation '}\textcolor{stringliteral}{',I12)'}) jseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00108}00108          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00109}00109          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00110}00110          lp = nskip + 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00111}00111          in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00112}00112          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00113}00113      +           luxlev, lp}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00114}00114          twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00115}00115          \textcolor{keywordflow}{DO} 10 i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00116}00116             twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00117}00117             k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00118}00118             jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00119}00119             \textcolor{keywordflow}{IF} (jseed .LT. 0) jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00120}00120             iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00121}00121    10    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00122}00122          twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00123}00123          \textcolor{keywordflow}{DO} 20 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00124}00124             seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00125}00125    20    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00126}00126          i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00127}00127          j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00128}00128          carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00129}00129          \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00130}00130 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00131}00131 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00132}00132 \textcolor{comment}{C          The Generator proper: "{}Subtract-\/with-\/borrow"{},}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00133}00133 \textcolor{comment}{C          as proposed by Marsaglia and Zaman,}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00134}00134 \textcolor{comment}{C          Florida State University, March, 1989}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00135}00135 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00136}00136       \textcolor{keywordflow}{DO} 40  ivec= 1, lenv}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00137}00137 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00138}00138          uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00139}00139 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00140}00140          \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00141}00141             uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00142}00142             carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00143}00143          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00144}00144             carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00145}00145 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00146}00146          seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00147}00147          i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00148}00148          \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00149}00149          j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00150}00150          \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00151}00151          rvec(ivec) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00152}00152 \textcolor{comment}{C  small numbers (with less than 12 "{}significant"{} bits) are "{}padded"{}.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00153}00153          \textcolor{keywordflow}{IF} (uni .LT. twom12) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00154}00154             rvec(ivec) = rvec(ivec) + twom24*seeds(j24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00155}00155 \textcolor{comment}{C        and zero is forbidden in case someone takes a logarithm}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00156}00156             \textcolor{keywordflow}{IF} (rvec(ivec) .EQ. 0.) rvec(ivec) = twom24*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00157}00157 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00158}00158 \textcolor{comment}{C        Skipping to luxury.  As proposed by Martin Luscher.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00159}00159          in24 = in24 + 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00160}00160          \textcolor{keywordflow}{IF} (in24 .EQ. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00161}00161             in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00162}00162             \textcolor{keywordflow}{DO} 30 isk= 1, nskip}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00163}00163                uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00164}00164 \textcolor{comment}{CCCCCC         The above has been corrected}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00165}00165                \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00166}00166                   uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00167}00167                   carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00168}00168                \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00169}00169                   carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00170}00170 \textcolor{keywordflow}{               ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00171}00171                seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00172}00172                i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00173}00173                \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00174}00174                j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00175}00175                \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00176}00176    30       \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00177}00177 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00178}00178    40 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00179}00179       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00180}00180 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00181}00181 \textcolor{comment}{C           Entry to input and float integer seeds from previous run}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00182}00182 \textcolor{comment}{C      ENTRY RLUXIN(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00183}00183       entry xnrnin1(isdext)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00184}00184       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00185}00185       \textcolor{keywordflow}{DO} 50  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00186}00186    50 twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00187}00187       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00188}00188       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: initialisation with 25 numbers'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00189}00189       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'(5X,5I12)'}) isdext}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00190}00190       \textcolor{keywordflow}{DO} 60  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00191}00191          seeds(i) = real(isdext(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00192}00192    60 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00193}00193       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00194}00194       \textcolor{keywordflow}{IF} (isdext(25) .LT. 0)  carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00195}00195       isd = iabs(isdext(25))}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00196}00196       i24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00197}00197       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00198}00198       j24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00199}00199       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00200}00200       in24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00201}00201       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00202}00202       luxlev = isd}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00203}00203       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00204}00204          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00205}00205          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: level set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00206}00206       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (luxlev .GE. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00207}00207          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00208}00208          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00209}00209       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00210}00210          nskip = ndskip(maxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00211}00211          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: illegal level '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00212}00212          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00213}00213 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00214}00214       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00215}00215 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00216}00216 \textcolor{comment}{C                    Entry to ouput seeds as integers}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00217}00217 \textcolor{comment}{C      ENTRY RLUXUT(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00218}00218       entry xnrnut1(isdext)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00219}00219       \textcolor{keywordflow}{DO} 70  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00220}00220          isdext(i) = int(seeds(i)*twop12*twop12)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00221}00221    70 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00222}00222       isdext(25) = i24 + 100*j24 + 10000*in24 + 1000000*luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00223}00223       \textcolor{keywordflow}{IF} (carry .GT. 0.)  isdext(25) = -\/isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00224}00224       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00225}00225 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00226}00226 \textcolor{comment}{C                    Entry to initialize from one integer}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00227}00227 \textcolor{comment}{C      ENTRY RLUXGO(LUX,INSEED)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00228}00228       entry xnrngo1(lux,inseed)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00229}00229       \textcolor{keywordflow}{IF} (lux .LT. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00230}00230          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00231}00231       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00232}00232          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00233}00233       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LT. 24 .OR. lux .GT. 2000) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00234}00234          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00235}00235          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: illegal level '}\textcolor{stringliteral}{',I2)'}) lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00236}00236       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00237}00237          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00238}00238          \textcolor{keywordflow}{DO} 80  ilx= 0, maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00239}00239             \textcolor{keywordflow}{IF} (lux .EQ. ndskip(ilx)+24) luxlev = ilx}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00240}00240    80    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00241}00241 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00242}00242       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00243}00243          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00244}00244          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00245}00245      +           luxlev, nskip+24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00246}00246       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00247}00247          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00248}00248          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00249}00249 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00250}00250       in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00251}00251       \textcolor{keywordflow}{IF} (inseed .NE. 0)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00252}00252          jseed = inseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00253}00253          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from seed '}\textcolor{stringliteral}{',I12)'})inseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00254}00254       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00255}00255          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00256}00256          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from default seed'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00257}00257 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00258}00258       notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00259}00259       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00260}00260       \textcolor{keywordflow}{DO} 90  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00261}00261          twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00262}00262          k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00263}00263          jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00264}00264          \textcolor{keywordflow}{IF} (jseed .LT. 0)  jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00265}00265          iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00266}00266    90 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00267}00267       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00268}00268       \textcolor{keywordflow}{DO} 100 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00269}00269          seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00270}00270   100 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00271}00271       i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00272}00272       j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00273}00273       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00274}00274       \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00275}00275       \textcolor{keyword}{END}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00276}00276 \textcolor{comment}{*CMZ :  1.00/00 16/02/95  11.37.11  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00277}00277 \textcolor{comment}{*CMZ :  0.03/00 19/01/94  22.39.16  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00278}00278 \textcolor{comment}{*CMZ :  0.01/01 19/01/94  17.08.37  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00279}00279 \textcolor{comment}{*-\/-\/ Author :    Federico Carminati   18/01/94}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00280}00280       \textcolor{keyword}{SUBROUTINE }xnrand2(RVEC,LENV)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00281}00281 \textcolor{comment}{C      SUBROUTINE RANLUX(RVEC,LENV)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00282}00282 \textcolor{comment}{C         Subtract-\/and-\/borrow random number generator proposed by}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00283}00283 \textcolor{comment}{C         Marsaglia and Zaman, implemented by F. James with the name}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00284}00284 \textcolor{comment}{C         RCARRY in 1991, and later improved by Martin Luescher}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00285}00285 \textcolor{comment}{C         in 1993 to produce "{}Luxury Pseudorandom Numbers"{}.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00286}00286 \textcolor{comment}{C     Fortran 77 coded by F. James, 1993}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00287}00287 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00288}00288 \textcolor{comment}{C   LUXURY LEVELS.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00289}00289 \textcolor{comment}{C   -\/-\/-\/-\/-\/-\/ -\/-\/-\/-\/-\/-\/      The available luxury levels are:}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00290}00290 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00291}00291 \textcolor{comment}{C  level 0  (p=24): equivalent to the original RCARRY of Marsaglia}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00292}00292 \textcolor{comment}{C           and Zaman, very long period, but fails many tests.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00293}00293 \textcolor{comment}{C  level 1  (p=48): considerable improvement in quality over level 0,}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00294}00294 \textcolor{comment}{C           now passes the gap test, but still fails spectral test.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00295}00295 \textcolor{comment}{C  level 2  (p=97): passes all known tests, but theoretically still}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00296}00296 \textcolor{comment}{C           defective.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00297}00297 \textcolor{comment}{C  level 3  (p=223): DEFAULT VALUE.  Any theoretically possible}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00298}00298 \textcolor{comment}{C           correlations have very small chance of being observed.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00299}00299 \textcolor{comment}{C  level 4  (p=389): highest possible luxury, all 24 bits chaotic.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00300}00300 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00301}00301 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00302}00302 \textcolor{comment}{C!!!  Calling sequences for RANLUX:                                  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00303}00303 \textcolor{comment}{C!!!      CALL RANLUX (RVEC, LEN)   returns a vector RVEC of LEN     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00304}00304 \textcolor{comment}{C!!!                   32-\/bit random floating point numbers between  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00305}00305 \textcolor{comment}{C!!!                   zero (not included) and one (also not incl.). ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00306}00306 \textcolor{comment}{C!!!      CALL RLUXGO(LUX,INT) initializes the generator from one    ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00307}00307 \textcolor{comment}{C!!!                   32-\/bit integer INT and sets Luxury Level LUX  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00308}00308 \textcolor{comment}{C!!!                   which is integer between zero and MAXLEV,     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00309}00309 \textcolor{comment}{C!!!                   or if LUX .GT. 24, it sets p=LUX directly     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00310}00310 \textcolor{comment}{C!!!      CALL RLUXIN(IVEC)    restarts the generator from vector    ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00311}00311 \textcolor{comment}{C!!!                   IVEC of 25 32-\/bit integers (see RLUXUT)       ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00312}00312 \textcolor{comment}{C!!!      CALL RLUXUT(IVEC)    outputs the current values of the 25  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00313}00313 \textcolor{comment}{C!!!                 32-\/bit integer seeds, to be used for restarting ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00314}00314 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00315}00315       dimension rvec(lenv)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00316}00316       dimension seeds(24), iseeds(24), isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00317}00317       parameter(maxlev=4, lxdflt=3)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00318}00318       dimension ndskip(0:maxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00319}00319       parameter(twop12=4096.)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00320}00320       parameter(itwo24=2**24, icons=2147483563)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00321}00321       \textcolor{keywordtype}{SAVE} notyet, i24, j24, carry, seeds, twom24, twom12, luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00322}00322       \textcolor{keywordtype}{SAVE} nskip, ndskip, in24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00323}00323       \textcolor{keywordtype}{INTEGER} LUXLEV}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00324}00324       \textcolor{keywordtype}{LOGICAL} NOTYET}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00325}00325       \textcolor{keyword}{DATA} notyet, luxlev, in24 /.true., lxdflt, 0/}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00326}00326       \textcolor{keyword}{DATA} i24,j24,carry/24,10,0./}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00327}00327       \textcolor{keyword}{DATA} ndskip/0,  24,  73, 199, 365 /}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00328}00328 \textcolor{comment}{Corresponds to p=24   48   97  223  389}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00329}00329 \textcolor{comment}{C     time factor 1    2    4    9   16   (in practice, much smaller)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00330}00330 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00331}00331 \textcolor{comment}{C  NOTYET is .TRUE. if no initialization has been performed yet.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00332}00332 \textcolor{comment}{C              Default Initialization by Multiplicative Congruential}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00333}00333       \textcolor{keywordflow}{IF} (notyet) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00334}00334          notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00335}00335          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00336}00336          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default initialisation '}\textcolor{stringliteral}{',I12)'}) jseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00337}00337          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00338}00338          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00339}00339          lp = nskip + 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00340}00340          in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00341}00341          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00342}00342      +           luxlev, lp}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00343}00343          twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00344}00344          \textcolor{keywordflow}{DO} 10 i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00345}00345             twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00346}00346             k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00347}00347             jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00348}00348             \textcolor{keywordflow}{IF} (jseed .LT. 0) jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00349}00349             iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00350}00350    10    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00351}00351          twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00352}00352          \textcolor{keywordflow}{DO} 20 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00353}00353             seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00354}00354    20    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00355}00355          i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00356}00356          j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00357}00357          carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00358}00358          \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00359}00359 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00360}00360 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00361}00361 \textcolor{comment}{C          The Generator proper: "{}Subtract-\/with-\/borrow"{},}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00362}00362 \textcolor{comment}{C          as proposed by Marsaglia and Zaman,}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00363}00363 \textcolor{comment}{C          Florida State University, March, 1989}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00364}00364 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00365}00365       \textcolor{keywordflow}{DO} 40  ivec= 1, lenv}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00366}00366 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00367}00367          uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00368}00368 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00369}00369          \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00370}00370             uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00371}00371             carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00372}00372          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00373}00373             carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00374}00374 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00375}00375          seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00376}00376          i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00377}00377          \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00378}00378          j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00379}00379          \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00380}00380          rvec(ivec) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00381}00381 \textcolor{comment}{C  small numbers (with less than 12 "{}significant"{} bits) are "{}padded"{}.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00382}00382          \textcolor{keywordflow}{IF} (uni .LT. twom12) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00383}00383             rvec(ivec) = rvec(ivec) + twom24*seeds(j24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00384}00384 \textcolor{comment}{C        and zero is forbidden in case someone takes a logarithm}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00385}00385             \textcolor{keywordflow}{IF} (rvec(ivec) .EQ. 0.) rvec(ivec) = twom24*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00386}00386 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00387}00387 \textcolor{comment}{C        Skipping to luxury.  As proposed by Martin Luscher.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00388}00388          in24 = in24 + 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00389}00389          \textcolor{keywordflow}{IF} (in24 .EQ. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00390}00390             in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00391}00391             \textcolor{keywordflow}{DO} 30 isk= 1, nskip}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00392}00392                uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00393}00393 \textcolor{comment}{CCCCCC         The above has been corrected}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00394}00394                \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00395}00395                   uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00396}00396                   carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00397}00397                \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00398}00398                   carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00399}00399 \textcolor{keywordflow}{               ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00400}00400                seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00401}00401                i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00402}00402                \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00403}00403                j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00404}00404                \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00405}00405    30       \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00406}00406 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00407}00407    40 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00408}00408       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00409}00409 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00410}00410 \textcolor{comment}{C           Entry to input and float integer seeds from previous run}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00411}00411 \textcolor{comment}{C      ENTRY RLUXIN(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00412}00412       entry xnrnin2(isdext)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00413}00413       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00414}00414       \textcolor{keywordflow}{DO} 50  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00415}00415    50 twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00416}00416       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00417}00417       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: initialisation with 25 numbers'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00418}00418       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'(5X,5I12)'}) isdext}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00419}00419       \textcolor{keywordflow}{DO} 60  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00420}00420          seeds(i) = real(isdext(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00421}00421    60 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00422}00422       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00423}00423       \textcolor{keywordflow}{IF} (isdext(25) .LT. 0)  carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00424}00424       isd = iabs(isdext(25))}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00425}00425       i24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00426}00426       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00427}00427       j24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00428}00428       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00429}00429       in24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00430}00430       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00431}00431       luxlev = isd}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00432}00432       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00433}00433          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00434}00434          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: level set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00435}00435       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (luxlev .GE. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00436}00436          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00437}00437          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00438}00438       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00439}00439          nskip = ndskip(maxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00440}00440          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: illegal level '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00441}00441          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00442}00442 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00443}00443       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00444}00444 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00445}00445 \textcolor{comment}{C                    Entry to ouput seeds as integers}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00446}00446 \textcolor{comment}{C      ENTRY RLUXUT(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00447}00447       entry xnrnut2(isdext)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00448}00448       \textcolor{keywordflow}{DO} 70  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00449}00449          isdext(i) = int(seeds(i)*twop12*twop12)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00450}00450    70 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00451}00451       isdext(25) = i24 + 100*j24 + 10000*in24 + 1000000*luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00452}00452       \textcolor{keywordflow}{IF} (carry .GT. 0.)  isdext(25) = -\/isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00453}00453       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00454}00454 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00455}00455 \textcolor{comment}{C                    Entry to initialize from one integer}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00456}00456 \textcolor{comment}{C      ENTRY RLUXGO(LUX,INSEED)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00457}00457       entry xnrngo2(lux,inseed)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00458}00458       \textcolor{keywordflow}{IF} (lux .LT. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00459}00459          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00460}00460       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00461}00461          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00462}00462       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LT. 24 .OR. lux .GT. 2000) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00463}00463          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00464}00464          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: illegal level '}\textcolor{stringliteral}{',I2)'}) lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00465}00465       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00466}00466          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00467}00467          \textcolor{keywordflow}{DO} 80  ilx= 0, maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00468}00468             \textcolor{keywordflow}{IF} (lux .EQ. ndskip(ilx)+24) luxlev = ilx}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00469}00469    80    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00470}00470 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00471}00471       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00472}00472          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00473}00473          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00474}00474      +           luxlev, nskip+24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00475}00475       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00476}00476          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00477}00477          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00478}00478 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00479}00479       in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00480}00480       \textcolor{keywordflow}{IF} (inseed .NE. 0)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00481}00481          jseed = inseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00482}00482          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from seed '}\textcolor{stringliteral}{',I12)'})inseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00483}00483       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00484}00484          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00485}00485          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from default seed'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00486}00486 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00487}00487       notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00488}00488       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00489}00489       \textcolor{keywordflow}{DO} 90  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00490}00490          twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00491}00491          k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00492}00492          jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00493}00493          \textcolor{keywordflow}{IF} (jseed .LT. 0)  jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00494}00494          iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00495}00495    90 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00496}00496       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00497}00497       \textcolor{keywordflow}{DO} 100 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00498}00498          seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00499}00499   100 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00500}00500       i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00501}00501       j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00502}00502       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00503}00503       \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00504}00504       \textcolor{keyword}{END}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00505}00505 \textcolor{comment}{*CMZ :  1.00/00 16/02/95  11.37.11  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00506}00506 \textcolor{comment}{*CMZ :  0.03/00 19/01/94  22.39.16  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00507}00507 \textcolor{comment}{*CMZ :  0.01/01 19/01/94  17.08.37  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00508}00508 \textcolor{comment}{*-\/-\/ Author :    Federico Carminati   18/01/94}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00509}00509       \textcolor{keyword}{SUBROUTINE }xnrand3(RVEC,LENV)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00510}00510 \textcolor{comment}{C      SUBROUTINE RANLUX(RVEC,LENV)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00511}00511 \textcolor{comment}{C         Subtract-\/and-\/borrow random number generator proposed by}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00512}00512 \textcolor{comment}{C         Marsaglia and Zaman, implemented by F. James with the name}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00513}00513 \textcolor{comment}{C         RCARRY in 1991, and later improved by Martin Luescher}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00514}00514 \textcolor{comment}{C         in 1993 to produce "{}Luxury Pseudorandom Numbers"{}.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00515}00515 \textcolor{comment}{C     Fortran 77 coded by F. James, 1993}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00516}00516 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00517}00517 \textcolor{comment}{C   LUXURY LEVELS.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00518}00518 \textcolor{comment}{C   -\/-\/-\/-\/-\/-\/ -\/-\/-\/-\/-\/-\/      The available luxury levels are:}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00519}00519 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00520}00520 \textcolor{comment}{C  level 0  (p=24): equivalent to the original RCARRY of Marsaglia}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00521}00521 \textcolor{comment}{C           and Zaman, very long period, but fails many tests.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00522}00522 \textcolor{comment}{C  level 1  (p=48): considerable improvement in quality over level 0,}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00523}00523 \textcolor{comment}{C           now passes the gap test, but still fails spectral test.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00524}00524 \textcolor{comment}{C  level 2  (p=97): passes all known tests, but theoretically still}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00525}00525 \textcolor{comment}{C           defective.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00526}00526 \textcolor{comment}{C  level 3  (p=223): DEFAULT VALUE.  Any theoretically possible}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00527}00527 \textcolor{comment}{C           correlations have very small chance of being observed.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00528}00528 \textcolor{comment}{C  level 4  (p=389): highest possible luxury, all 24 bits chaotic.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00529}00529 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00530}00530 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00531}00531 \textcolor{comment}{C!!!  Calling sequences for RANLUX:                                  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00532}00532 \textcolor{comment}{C!!!      CALL RANLUX (RVEC, LEN)   returns a vector RVEC of LEN     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00533}00533 \textcolor{comment}{C!!!                   32-\/bit random floating point numbers between  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00534}00534 \textcolor{comment}{C!!!                   zero (not included) and one (also not incl.). ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00535}00535 \textcolor{comment}{C!!!      CALL RLUXGO(LUX,INT) initializes the generator from one    ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00536}00536 \textcolor{comment}{C!!!                   32-\/bit integer INT and sets Luxury Level LUX  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00537}00537 \textcolor{comment}{C!!!                   which is integer between zero and MAXLEV,     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00538}00538 \textcolor{comment}{C!!!                   or if LUX .GT. 24, it sets p=LUX directly     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00539}00539 \textcolor{comment}{C!!!      CALL RLUXIN(IVEC)    restarts the generator from vector    ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00540}00540 \textcolor{comment}{C!!!                   IVEC of 25 32-\/bit integers (see RLUXUT)       ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00541}00541 \textcolor{comment}{C!!!      CALL RLUXUT(IVEC)    outputs the current values of the 25  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00542}00542 \textcolor{comment}{C!!!                 32-\/bit integer seeds, to be used for restarting ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00543}00543 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00544}00544       dimension rvec(lenv)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00545}00545       dimension seeds(24), iseeds(24), isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00546}00546       parameter(maxlev=4, lxdflt=3)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00547}00547       dimension ndskip(0:maxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00548}00548       parameter(twop12=4096.)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00549}00549       parameter(itwo24=2**24, icons=2147483563)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00550}00550       \textcolor{keywordtype}{SAVE} notyet, i24, j24, carry, seeds, twom24, twom12, luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00551}00551       \textcolor{keywordtype}{SAVE} nskip, ndskip, in24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00552}00552       \textcolor{keywordtype}{INTEGER} LUXLEV}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00553}00553       \textcolor{keywordtype}{LOGICAL} NOTYET}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00554}00554       \textcolor{keyword}{DATA} notyet, luxlev, in24 /.true., lxdflt, 0/}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00555}00555       \textcolor{keyword}{DATA} i24,j24,carry/24,10,0./}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00556}00556       \textcolor{keyword}{DATA} ndskip/0,  24,  73, 199, 365 /}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00557}00557 \textcolor{comment}{Corresponds to p=24   48   97  223  389}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00558}00558 \textcolor{comment}{C     time factor 1    2    4    9   16   (in practice, much smaller)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00559}00559 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00560}00560 \textcolor{comment}{C  NOTYET is .TRUE. if no initialization has been performed yet.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00561}00561 \textcolor{comment}{C              Default Initialization by Multiplicative Congruential}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00562}00562       \textcolor{keywordflow}{IF} (notyet) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00563}00563          notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00564}00564          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00565}00565          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default initialisation '}\textcolor{stringliteral}{',I12)'}) jseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00566}00566          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00567}00567          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00568}00568          lp = nskip + 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00569}00569          in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00570}00570          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00571}00571      +           luxlev, lp}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00572}00572          twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00573}00573          \textcolor{keywordflow}{DO} 10 i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00574}00574             twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00575}00575             k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00576}00576             jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00577}00577             \textcolor{keywordflow}{IF} (jseed .LT. 0) jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00578}00578             iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00579}00579    10    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00580}00580          twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00581}00581          \textcolor{keywordflow}{DO} 20 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00582}00582             seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00583}00583    20    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00584}00584          i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00585}00585          j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00586}00586          carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00587}00587          \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00588}00588 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00589}00589 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00590}00590 \textcolor{comment}{C          The Generator proper: "{}Subtract-\/with-\/borrow"{},}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00591}00591 \textcolor{comment}{C          as proposed by Marsaglia and Zaman,}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00592}00592 \textcolor{comment}{C          Florida State University, March, 1989}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00593}00593 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00594}00594       \textcolor{keywordflow}{DO} 40  ivec= 1, lenv}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00595}00595 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00596}00596          uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00597}00597 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00598}00598          \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00599}00599             uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00600}00600             carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00601}00601          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00602}00602             carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00603}00603 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00604}00604          seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00605}00605          i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00606}00606          \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00607}00607          j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00608}00608          \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00609}00609          rvec(ivec) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00610}00610 \textcolor{comment}{C  small numbers (with less than 12 "{}significant"{} bits) are "{}padded"{}.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00611}00611          \textcolor{keywordflow}{IF} (uni .LT. twom12) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00612}00612             rvec(ivec) = rvec(ivec) + twom24*seeds(j24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00613}00613 \textcolor{comment}{C        and zero is forbidden in case someone takes a logarithm}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00614}00614             \textcolor{keywordflow}{IF} (rvec(ivec) .EQ. 0.) rvec(ivec) = twom24*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00615}00615 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00616}00616 \textcolor{comment}{C        Skipping to luxury.  As proposed by Martin Luscher.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00617}00617          in24 = in24 + 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00618}00618          \textcolor{keywordflow}{IF} (in24 .EQ. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00619}00619             in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00620}00620             \textcolor{keywordflow}{DO} 30 isk= 1, nskip}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00621}00621                uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00622}00622 \textcolor{comment}{CCCCCC         The above has been corrected}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00623}00623                \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00624}00624                   uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00625}00625                   carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00626}00626                \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00627}00627                   carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00628}00628 \textcolor{keywordflow}{               ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00629}00629                seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00630}00630                i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00631}00631                \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00632}00632                j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00633}00633                \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00634}00634    30       \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00635}00635 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00636}00636    40 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00637}00637       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00638}00638 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00639}00639 \textcolor{comment}{C           Entry to input and float integer seeds from previous run}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00640}00640 \textcolor{comment}{C      ENTRY RLUXIN(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00641}00641       entry xnrnin3(isdext)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00642}00642       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00643}00643       \textcolor{keywordflow}{DO} 50  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00644}00644    50 twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00645}00645       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00646}00646       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: initialisation with 25 numbers'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00647}00647       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'(5X,5I12)'}) isdext}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00648}00648       \textcolor{keywordflow}{DO} 60  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00649}00649          seeds(i) = real(isdext(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00650}00650    60 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00651}00651       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00652}00652       \textcolor{keywordflow}{IF} (isdext(25) .LT. 0)  carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00653}00653       isd = iabs(isdext(25))}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00654}00654       i24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00655}00655       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00656}00656       j24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00657}00657       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00658}00658       in24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00659}00659       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00660}00660       luxlev = isd}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00661}00661       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00662}00662          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00663}00663          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: level set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00664}00664       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (luxlev .GE. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00665}00665          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00666}00666          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00667}00667       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00668}00668          nskip = ndskip(maxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00669}00669          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: illegal level '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00670}00670          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00671}00671 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00672}00672       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00673}00673 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00674}00674 \textcolor{comment}{C                    Entry to ouput seeds as integers}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00675}00675 \textcolor{comment}{C      ENTRY RLUXUT(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00676}00676       entry xnrnut3(isdext)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00677}00677       \textcolor{keywordflow}{DO} 70  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00678}00678          isdext(i) = int(seeds(i)*twop12*twop12)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00679}00679    70 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00680}00680       isdext(25) = i24 + 100*j24 + 10000*in24 + 1000000*luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00681}00681       \textcolor{keywordflow}{IF} (carry .GT. 0.)  isdext(25) = -\/isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00682}00682       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00683}00683 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00684}00684 \textcolor{comment}{C                    Entry to initialize from one integer}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00685}00685 \textcolor{comment}{C      ENTRY RLUXGO(LUX,INSEED)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00686}00686       entry xnrngo3(lux,inseed)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00687}00687       \textcolor{keywordflow}{IF} (lux .LT. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00688}00688          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00689}00689       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00690}00690          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00691}00691       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LT. 24 .OR. lux .GT. 2000) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00692}00692          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00693}00693          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: illegal level '}\textcolor{stringliteral}{',I2)'}) lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00694}00694       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00695}00695          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00696}00696          \textcolor{keywordflow}{DO} 80  ilx= 0, maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00697}00697             \textcolor{keywordflow}{IF} (lux .EQ. ndskip(ilx)+24) luxlev = ilx}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00698}00698    80    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00699}00699 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00700}00700       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00701}00701          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00702}00702          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00703}00703      +           luxlev, nskip+24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00704}00704       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00705}00705          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00706}00706          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00707}00707 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00708}00708       in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00709}00709       \textcolor{keywordflow}{IF} (inseed .NE. 0)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00710}00710          jseed = inseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00711}00711          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from seed '}\textcolor{stringliteral}{',I12)'})inseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00712}00712       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00713}00713          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00714}00714          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from default seed'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00715}00715 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00716}00716       notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00717}00717       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00718}00718       \textcolor{keywordflow}{DO} 90  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00719}00719          twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00720}00720          k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00721}00721          jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00722}00722          \textcolor{keywordflow}{IF} (jseed .LT. 0)  jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00723}00723          iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00724}00724    90 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00725}00725       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00726}00726       \textcolor{keywordflow}{DO} 100 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00727}00727          seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00728}00728   100 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00729}00729       i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00730}00730       j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00731}00731       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00732}00732       \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00733}00733       \textcolor{keyword}{END}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00734}00734 \textcolor{comment}{*CMZ :  1.00/00 16/02/95  11.37.11  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00735}00735 \textcolor{comment}{*CMZ :  0.03/00 19/01/94  22.39.16  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00736}00736 \textcolor{comment}{*CMZ :  0.01/01 19/01/94  17.08.37  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00737}00737 \textcolor{comment}{*-\/-\/ Author :    Federico Carminati   18/01/94}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00738}00738       \textcolor{keyword}{SUBROUTINE }xnrand4(RVEC,LENV)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00739}00739 \textcolor{comment}{C      SUBROUTINE RANLUX(RVEC,LENV)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00740}00740 \textcolor{comment}{C         Subtract-\/and-\/borrow random number generator proposed by}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00741}00741 \textcolor{comment}{C         Marsaglia and Zaman, implemented by F. James with the name}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00742}00742 \textcolor{comment}{C         RCARRY in 1991, and later improved by Martin Luescher}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00743}00743 \textcolor{comment}{C         in 1993 to produce "{}Luxury Pseudorandom Numbers"{}.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00744}00744 \textcolor{comment}{C     Fortran 77 coded by F. James, 1993}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00745}00745 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00746}00746 \textcolor{comment}{C   LUXURY LEVELS.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00747}00747 \textcolor{comment}{C   -\/-\/-\/-\/-\/-\/ -\/-\/-\/-\/-\/-\/      The available luxury levels are:}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00748}00748 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00749}00749 \textcolor{comment}{C  level 0  (p=24): equivalent to the original RCARRY of Marsaglia}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00750}00750 \textcolor{comment}{C           and Zaman, very long period, but fails many tests.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00751}00751 \textcolor{comment}{C  level 1  (p=48): considerable improvement in quality over level 0,}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00752}00752 \textcolor{comment}{C           now passes the gap test, but still fails spectral test.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00753}00753 \textcolor{comment}{C  level 2  (p=97): passes all known tests, but theoretically still}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00754}00754 \textcolor{comment}{C           defective.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00755}00755 \textcolor{comment}{C  level 3  (p=223): DEFAULT VALUE.  Any theoretically possible}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00756}00756 \textcolor{comment}{C           correlations have very small chance of being observed.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00757}00757 \textcolor{comment}{C  level 4  (p=389): highest possible luxury, all 24 bits chaotic.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00758}00758 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00759}00759 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00760}00760 \textcolor{comment}{C!!!  Calling sequences for RANLUX:                                  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00761}00761 \textcolor{comment}{C!!!      CALL RANLUX (RVEC, LEN)   returns a vector RVEC of LEN     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00762}00762 \textcolor{comment}{C!!!                   32-\/bit random floating point numbers between  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00763}00763 \textcolor{comment}{C!!!                   zero (not included) and one (also not incl.). ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00764}00764 \textcolor{comment}{C!!!      CALL RLUXGO(LUX,INT) initializes the generator from one    ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00765}00765 \textcolor{comment}{C!!!                   32-\/bit integer INT and sets Luxury Level LUX  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00766}00766 \textcolor{comment}{C!!!                   which is integer between zero and MAXLEV,     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00767}00767 \textcolor{comment}{C!!!                   or if LUX .GT. 24, it sets p=LUX directly     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00768}00768 \textcolor{comment}{C!!!      CALL RLUXIN(IVEC)    restarts the generator from vector    ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00769}00769 \textcolor{comment}{C!!!                   IVEC of 25 32-\/bit integers (see RLUXUT)       ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00770}00770 \textcolor{comment}{C!!!      CALL RLUXUT(IVEC)    outputs the current values of the 25  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00771}00771 \textcolor{comment}{C!!!                 32-\/bit integer seeds, to be used for restarting ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00772}00772 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00773}00773       dimension rvec(lenv)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00774}00774       dimension seeds(24), iseeds(24), isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00775}00775       parameter(maxlev=4, lxdflt=3)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00776}00776       dimension ndskip(0:maxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00777}00777       parameter(twop12=4096.)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00778}00778       parameter(itwo24=2**24, icons=2147483563)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00779}00779       \textcolor{keywordtype}{SAVE} notyet, i24, j24, carry, seeds, twom24, twom12, luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00780}00780       \textcolor{keywordtype}{SAVE} nskip, ndskip, in24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00781}00781       \textcolor{keywordtype}{INTEGER} LUXLEV}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00782}00782       \textcolor{keywordtype}{LOGICAL} NOTYET}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00783}00783       \textcolor{keyword}{DATA} notyet, luxlev, in24 /.true., lxdflt, 0/}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00784}00784       \textcolor{keyword}{DATA} i24,j24,carry/24,10,0./}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00785}00785       \textcolor{keyword}{DATA} ndskip/0,  24,  73, 199, 365 /}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00786}00786 \textcolor{comment}{Corresponds to p=24   48   97  223  389}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00787}00787 \textcolor{comment}{C     time factor 1    2    4    9   16   (in practice, much smaller)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00788}00788 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00789}00789 \textcolor{comment}{C  NOTYET is .TRUE. if no initialization has been performed yet.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00790}00790 \textcolor{comment}{C              Default Initialization by Multiplicative Congruential}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00791}00791       \textcolor{keywordflow}{IF} (notyet) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00792}00792          notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00793}00793          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00794}00794          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default initialisation '}\textcolor{stringliteral}{',I12)'}) jseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00795}00795          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00796}00796          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00797}00797          lp = nskip + 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00798}00798          in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00799}00799          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00800}00800      +           luxlev, lp}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00801}00801          twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00802}00802          \textcolor{keywordflow}{DO} 10 i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00803}00803             twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00804}00804             k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00805}00805             jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00806}00806             \textcolor{keywordflow}{IF} (jseed .LT. 0) jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00807}00807             iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00808}00808    10    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00809}00809          twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00810}00810          \textcolor{keywordflow}{DO} 20 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00811}00811             seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00812}00812    20    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00813}00813          i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00814}00814          j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00815}00815          carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00816}00816          \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00817}00817 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00818}00818 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00819}00819 \textcolor{comment}{C          The Generator proper: "{}Subtract-\/with-\/borrow"{},}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00820}00820 \textcolor{comment}{C          as proposed by Marsaglia and Zaman,}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00821}00821 \textcolor{comment}{C          Florida State University, March, 1989}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00822}00822 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00823}00823       \textcolor{keywordflow}{DO} 40  ivec= 1, lenv}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00824}00824 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00825}00825          uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00826}00826 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00827}00827          \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00828}00828             uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00829}00829             carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00830}00830          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00831}00831             carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00832}00832 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00833}00833          seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00834}00834          i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00835}00835          \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00836}00836          j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00837}00837          \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00838}00838          rvec(ivec) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00839}00839 \textcolor{comment}{C  small numbers (with less than 12 "{}significant"{} bits) are "{}padded"{}.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00840}00840          \textcolor{keywordflow}{IF} (uni .LT. twom12) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00841}00841             rvec(ivec) = rvec(ivec) + twom24*seeds(j24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00842}00842 \textcolor{comment}{C        and zero is forbidden in case someone takes a logarithm}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00843}00843             \textcolor{keywordflow}{IF} (rvec(ivec) .EQ. 0.) rvec(ivec) = twom24*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00844}00844 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00845}00845 \textcolor{comment}{C        Skipping to luxury.  As proposed by Martin Luscher.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00846}00846          in24 = in24 + 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00847}00847          \textcolor{keywordflow}{IF} (in24 .EQ. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00848}00848             in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00849}00849             \textcolor{keywordflow}{DO} 30 isk= 1, nskip}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00850}00850                uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00851}00851 \textcolor{comment}{CCCCCC         The above has been corrected}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00852}00852                \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00853}00853                   uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00854}00854                   carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00855}00855                \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00856}00856                   carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00857}00857 \textcolor{keywordflow}{               ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00858}00858                seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00859}00859                i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00860}00860                \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00861}00861                j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00862}00862                \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00863}00863    30       \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00864}00864 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00865}00865    40 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00866}00866       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00867}00867 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00868}00868 \textcolor{comment}{C           Entry to input and float integer seeds from previous run}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00869}00869 \textcolor{comment}{C      ENTRY RLUXIN(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00870}00870       entry xnrnin4(isdext)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00871}00871       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00872}00872       \textcolor{keywordflow}{DO} 50  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00873}00873    50 twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00874}00874       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00875}00875       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: initialisation with 25 numbers'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00876}00876       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'(5X,5I12)'}) isdext}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00877}00877       \textcolor{keywordflow}{DO} 60  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00878}00878          seeds(i) = real(isdext(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00879}00879    60 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00880}00880       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00881}00881       \textcolor{keywordflow}{IF} (isdext(25) .LT. 0)  carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00882}00882       isd = iabs(isdext(25))}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00883}00883       i24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00884}00884       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00885}00885       j24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00886}00886       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00887}00887       in24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00888}00888       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00889}00889       luxlev = isd}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00890}00890       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00891}00891          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00892}00892          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: level set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00893}00893       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (luxlev .GE. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00894}00894          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00895}00895          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00896}00896       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00897}00897          nskip = ndskip(maxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00898}00898          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: illegal level '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00899}00899          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00900}00900 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00901}00901       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00902}00902 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00903}00903 \textcolor{comment}{C                    Entry to ouput seeds as integers}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00904}00904 \textcolor{comment}{C      ENTRY RLUXUT(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00905}00905       entry xnrnut4(isdext)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00906}00906       \textcolor{keywordflow}{DO} 70  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00907}00907          isdext(i) = int(seeds(i)*twop12*twop12)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00908}00908    70 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00909}00909       isdext(25) = i24 + 100*j24 + 10000*in24 + 1000000*luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00910}00910       \textcolor{keywordflow}{IF} (carry .GT. 0.)  isdext(25) = -\/isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00911}00911       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00912}00912 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00913}00913 \textcolor{comment}{C                    Entry to initialize from one integer}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00914}00914 \textcolor{comment}{C      ENTRY RLUXGO(LUX,INSEED)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00915}00915       entry xnrngo4(lux,inseed)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00916}00916       \textcolor{keywordflow}{IF} (lux .LT. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00917}00917          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00918}00918       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00919}00919          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00920}00920       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LT. 24 .OR. lux .GT. 2000) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00921}00921          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00922}00922          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: illegal level '}\textcolor{stringliteral}{',I2)'}) lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00923}00923       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00924}00924          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00925}00925          \textcolor{keywordflow}{DO} 80  ilx= 0, maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00926}00926             \textcolor{keywordflow}{IF} (lux .EQ. ndskip(ilx)+24) luxlev = ilx}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00927}00927    80    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00928}00928 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00929}00929       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00930}00930          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00931}00931          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00932}00932      +           luxlev, nskip+24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00933}00933       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00934}00934          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00935}00935          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00936}00936 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00937}00937       in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00938}00938       \textcolor{keywordflow}{IF} (inseed .NE. 0)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00939}00939          jseed = inseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00940}00940          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from seed '}\textcolor{stringliteral}{',I12)'})inseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00941}00941       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00942}00942          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00943}00943          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from default seed'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00944}00944 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00945}00945       notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00946}00946       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00947}00947       \textcolor{keywordflow}{DO} 90  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00948}00948          twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00949}00949          k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00950}00950          jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00951}00951          \textcolor{keywordflow}{IF} (jseed .LT. 0)  jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00952}00952          iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00953}00953    90 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00954}00954       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00955}00955       \textcolor{keywordflow}{DO} 100 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00956}00956          seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00957}00957   100 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00958}00958       i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00959}00959       j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00960}00960       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00961}00961       \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00962}00962       \textcolor{keyword}{END}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00963}00963 \textcolor{comment}{*CMZ :  1.00/00 16/02/95  11.37.11  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00964}00964 \textcolor{comment}{*CMZ :  0.03/00 19/01/94  22.39.16  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00965}00965 \textcolor{comment}{*CMZ :  0.01/01 19/01/94  17.08.37  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00966}00966 \textcolor{comment}{*-\/-\/ Author :    Federico Carminati   18/01/94}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00967}00967       \textcolor{keyword}{SUBROUTINE }xnrand5(RVEC,LENV)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00968}00968 \textcolor{comment}{C      SUBROUTINE RANLUX(RVEC,LENV)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00969}00969 \textcolor{comment}{C         Subtract-\/and-\/borrow random number generator proposed by}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00970}00970 \textcolor{comment}{C         Marsaglia and Zaman, implemented by F. James with the name}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00971}00971 \textcolor{comment}{C         RCARRY in 1991, and later improved by Martin Luescher}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00972}00972 \textcolor{comment}{C         in 1993 to produce "{}Luxury Pseudorandom Numbers"{}.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00973}00973 \textcolor{comment}{C     Fortran 77 coded by F. James, 1993}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00974}00974 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00975}00975 \textcolor{comment}{C   LUXURY LEVELS.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00976}00976 \textcolor{comment}{C   -\/-\/-\/-\/-\/-\/ -\/-\/-\/-\/-\/-\/      The available luxury levels are:}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00977}00977 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00978}00978 \textcolor{comment}{C  level 0  (p=24): equivalent to the original RCARRY of Marsaglia}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00979}00979 \textcolor{comment}{C           and Zaman, very long period, but fails many tests.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00980}00980 \textcolor{comment}{C  level 1  (p=48): considerable improvement in quality over level 0,}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00981}00981 \textcolor{comment}{C           now passes the gap test, but still fails spectral test.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00982}00982 \textcolor{comment}{C  level 2  (p=97): passes all known tests, but theoretically still}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00983}00983 \textcolor{comment}{C           defective.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00984}00984 \textcolor{comment}{C  level 3  (p=223): DEFAULT VALUE.  Any theoretically possible}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00985}00985 \textcolor{comment}{C           correlations have very small chance of being observed.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00986}00986 \textcolor{comment}{C  level 4  (p=389): highest possible luxury, all 24 bits chaotic.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00987}00987 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00988}00988 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00989}00989 \textcolor{comment}{C!!!  Calling sequences for RANLUX:                                  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00990}00990 \textcolor{comment}{C!!!      CALL RANLUX (RVEC, LEN)   returns a vector RVEC of LEN     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00991}00991 \textcolor{comment}{C!!!                   32-\/bit random floating point numbers between  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00992}00992 \textcolor{comment}{C!!!                   zero (not included) and one (also not incl.). ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00993}00993 \textcolor{comment}{C!!!      CALL RLUXGO(LUX,INT) initializes the generator from one    ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00994}00994 \textcolor{comment}{C!!!                   32-\/bit integer INT and sets Luxury Level LUX  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00995}00995 \textcolor{comment}{C!!!                   which is integer between zero and MAXLEV,     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00996}00996 \textcolor{comment}{C!!!                   or if LUX .GT. 24, it sets p=LUX directly     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00997}00997 \textcolor{comment}{C!!!      CALL RLUXIN(IVEC)    restarts the generator from vector    ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00998}00998 \textcolor{comment}{C!!!                   IVEC of 25 32-\/bit integers (see RLUXUT)       ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l00999}00999 \textcolor{comment}{C!!!      CALL RLUXUT(IVEC)    outputs the current values of the 25  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01000}01000 \textcolor{comment}{C!!!                 32-\/bit integer seeds, to be used for restarting ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01001}01001 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01002}01002       dimension rvec(lenv)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01003}01003       dimension seeds(24), iseeds(24), isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01004}01004       parameter(maxlev=4, lxdflt=3)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01005}01005       dimension ndskip(0:maxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01006}01006       parameter(twop12=4096.)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01007}01007       parameter(itwo24=2**24, icons=2147483563)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01008}01008       \textcolor{keywordtype}{SAVE} notyet, i24, j24, carry, seeds, twom24, twom12, luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01009}01009       \textcolor{keywordtype}{SAVE} nskip, ndskip, in24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01010}01010       \textcolor{keywordtype}{INTEGER} LUXLEV}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01011}01011       \textcolor{keywordtype}{LOGICAL} NOTYET}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01012}01012       \textcolor{keyword}{DATA} notyet, luxlev, in24 /.true., lxdflt, 0/}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01013}01013       \textcolor{keyword}{DATA} i24,j24,carry/24,10,0./}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01014}01014       \textcolor{keyword}{DATA} ndskip/0,  24,  73, 199, 365 /}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01015}01015 \textcolor{comment}{Corresponds to p=24   48   97  223  389}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01016}01016 \textcolor{comment}{C     time factor 1    2    4    9   16   (in practice, much smaller)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01017}01017 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01018}01018 \textcolor{comment}{C  NOTYET is .TRUE. if no initialization has been performed yet.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01019}01019 \textcolor{comment}{C              Default Initialization by Multiplicative Congruential}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01020}01020       \textcolor{keywordflow}{IF} (notyet) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01021}01021          notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01022}01022          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01023}01023          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default initialisation '}\textcolor{stringliteral}{',I12)'}) jseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01024}01024          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01025}01025          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01026}01026          lp = nskip + 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01027}01027          in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01028}01028          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01029}01029      +           luxlev, lp}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01030}01030          twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01031}01031          \textcolor{keywordflow}{DO} 10 i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01032}01032             twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01033}01033             k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01034}01034             jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01035}01035             \textcolor{keywordflow}{IF} (jseed .LT. 0) jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01036}01036             iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01037}01037    10    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01038}01038          twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01039}01039          \textcolor{keywordflow}{DO} 20 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01040}01040             seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01041}01041    20    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01042}01042          i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01043}01043          j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01044}01044          carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01045}01045          \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01046}01046 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01047}01047 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01048}01048 \textcolor{comment}{C          The Generator proper: "{}Subtract-\/with-\/borrow"{},}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01049}01049 \textcolor{comment}{C          as proposed by Marsaglia and Zaman,}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01050}01050 \textcolor{comment}{C          Florida State University, March, 1989}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01051}01051 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01052}01052       \textcolor{keywordflow}{DO} 40  ivec= 1, lenv}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01053}01053 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01054}01054          uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01055}01055 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01056}01056          \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01057}01057             uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01058}01058             carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01059}01059          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01060}01060             carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01061}01061 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01062}01062          seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01063}01063          i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01064}01064          \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01065}01065          j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01066}01066          \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01067}01067          rvec(ivec) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01068}01068 \textcolor{comment}{C  small numbers (with less than 12 "{}significant"{} bits) are "{}padded"{}.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01069}01069          \textcolor{keywordflow}{IF} (uni .LT. twom12) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01070}01070             rvec(ivec) = rvec(ivec) + twom24*seeds(j24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01071}01071 \textcolor{comment}{C        and zero is forbidden in case someone takes a logarithm}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01072}01072             \textcolor{keywordflow}{IF} (rvec(ivec) .EQ. 0.) rvec(ivec) = twom24*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01073}01073 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01074}01074 \textcolor{comment}{C        Skipping to luxury.  As proposed by Martin Luscher.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01075}01075          in24 = in24 + 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01076}01076          \textcolor{keywordflow}{IF} (in24 .EQ. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01077}01077             in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01078}01078             \textcolor{keywordflow}{DO} 30 isk= 1, nskip}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01079}01079                uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01080}01080 \textcolor{comment}{CCCCCC         The above has been corrected}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01081}01081                \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01082}01082                   uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01083}01083                   carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01084}01084                \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01085}01085                   carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01086}01086 \textcolor{keywordflow}{               ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01087}01087                seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01088}01088                i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01089}01089                \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01090}01090                j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01091}01091                \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01092}01092    30       \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01093}01093 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01094}01094    40 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01095}01095       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01096}01096 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01097}01097 \textcolor{comment}{C           Entry to input and float integer seeds from previous run}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01098}01098 \textcolor{comment}{C      ENTRY RLUXIN(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01099}01099       entry xnrnin5(isdext)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01100}01100       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01101}01101       \textcolor{keywordflow}{DO} 50  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01102}01102    50 twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01103}01103       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01104}01104       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: initialisation with 25 numbers'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01105}01105       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'(5X,5I12)'}) isdext}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01106}01106       \textcolor{keywordflow}{DO} 60  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01107}01107          seeds(i) = real(isdext(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01108}01108    60 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01109}01109       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01110}01110       \textcolor{keywordflow}{IF} (isdext(25) .LT. 0)  carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01111}01111       isd = iabs(isdext(25))}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01112}01112       i24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01113}01113       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01114}01114       j24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01115}01115       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01116}01116       in24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01117}01117       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01118}01118       luxlev = isd}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01119}01119       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01120}01120          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01121}01121          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: level set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01122}01122       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (luxlev .GE. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01123}01123          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01124}01124          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01125}01125       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01126}01126          nskip = ndskip(maxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01127}01127          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: illegal level '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01128}01128          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01129}01129 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01130}01130       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01131}01131 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01132}01132 \textcolor{comment}{C                    Entry to ouput seeds as integers}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01133}01133 \textcolor{comment}{C      ENTRY RLUXUT(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01134}01134       entry xnrnut5(isdext)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01135}01135       \textcolor{keywordflow}{DO} 70  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01136}01136          isdext(i) = int(seeds(i)*twop12*twop12)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01137}01137    70 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01138}01138       isdext(25) = i24 + 100*j24 + 10000*in24 + 1000000*luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01139}01139       \textcolor{keywordflow}{IF} (carry .GT. 0.)  isdext(25) = -\/isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01140}01140       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01141}01141 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01142}01142 \textcolor{comment}{C                    Entry to initialize from one integer}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01143}01143 \textcolor{comment}{C      ENTRY RLUXGO(LUX,INSEED)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01144}01144       entry xnrngo5(lux,inseed)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01145}01145       \textcolor{keywordflow}{IF} (lux .LT. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01146}01146          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01147}01147       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01148}01148          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01149}01149       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LT. 24 .OR. lux .GT. 2000) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01150}01150          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01151}01151          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: illegal level '}\textcolor{stringliteral}{',I2)'}) lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01152}01152       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01153}01153          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01154}01154          \textcolor{keywordflow}{DO} 80  ilx= 0, maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01155}01155             \textcolor{keywordflow}{IF} (lux .EQ. ndskip(ilx)+24) luxlev = ilx}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01156}01156    80    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01157}01157 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01158}01158       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01159}01159          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01160}01160          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01161}01161      +           luxlev, nskip+24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01162}01162       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01163}01163          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01164}01164          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01165}01165 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01166}01166       in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01167}01167       \textcolor{keywordflow}{IF} (inseed .NE. 0)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01168}01168          jseed = inseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01169}01169          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from seed '}\textcolor{stringliteral}{',I12)'})inseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01170}01170       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01171}01171          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01172}01172          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from default seed'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01173}01173 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01174}01174       notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01175}01175       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01176}01176       \textcolor{keywordflow}{DO} 90  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01177}01177          twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01178}01178          k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01179}01179          jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01180}01180          \textcolor{keywordflow}{IF} (jseed .LT. 0)  jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01181}01181          iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01182}01182    90 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01183}01183       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01184}01184       \textcolor{keywordflow}{DO} 100 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01185}01185          seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01186}01186   100 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01187}01187       i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01188}01188       j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01189}01189       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01190}01190       \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01191}01191       \textcolor{keyword}{END}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01192}01192 \textcolor{comment}{*CMZ :  1.00/00 16/02/95  11.37.11  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01193}01193 \textcolor{comment}{*CMZ :  0.03/00 19/01/94  22.39.16  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01194}01194 \textcolor{comment}{*CMZ :  0.01/01 19/01/94  17.08.37  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01195}01195 \textcolor{comment}{*-\/-\/ Author :    Federico Carminati   18/01/94}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01196}01196       \textcolor{keyword}{SUBROUTINE }xnrand6(RVEC,LENV)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01197}01197 \textcolor{comment}{C      SUBROUTINE RANLUX(RVEC,LENV)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01198}01198 \textcolor{comment}{C         Subtract-\/and-\/borrow random number generator proposed by}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01199}01199 \textcolor{comment}{C         Marsaglia and Zaman, implemented by F. James with the name}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01200}01200 \textcolor{comment}{C         RCARRY in 1991, and later improved by Martin Luescher}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01201}01201 \textcolor{comment}{C         in 1993 to produce "{}Luxury Pseudorandom Numbers"{}.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01202}01202 \textcolor{comment}{C     Fortran 77 coded by F. James, 1993}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01203}01203 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01204}01204 \textcolor{comment}{C   LUXURY LEVELS.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01205}01205 \textcolor{comment}{C   -\/-\/-\/-\/-\/-\/ -\/-\/-\/-\/-\/-\/      The available luxury levels are:}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01206}01206 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01207}01207 \textcolor{comment}{C  level 0  (p=24): equivalent to the original RCARRY of Marsaglia}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01208}01208 \textcolor{comment}{C           and Zaman, very long period, but fails many tests.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01209}01209 \textcolor{comment}{C  level 1  (p=48): considerable improvement in quality over level 0,}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01210}01210 \textcolor{comment}{C           now passes the gap test, but still fails spectral test.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01211}01211 \textcolor{comment}{C  level 2  (p=97): passes all known tests, but theoretically still}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01212}01212 \textcolor{comment}{C           defective.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01213}01213 \textcolor{comment}{C  level 3  (p=223): DEFAULT VALUE.  Any theoretically possible}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01214}01214 \textcolor{comment}{C           correlations have very small chance of being observed.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01215}01215 \textcolor{comment}{C  level 4  (p=389): highest possible luxury, all 24 bits chaotic.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01216}01216 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01217}01217 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01218}01218 \textcolor{comment}{C!!!  Calling sequences for RANLUX:                                  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01219}01219 \textcolor{comment}{C!!!      CALL RANLUX (RVEC, LEN)   returns a vector RVEC of LEN     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01220}01220 \textcolor{comment}{C!!!                   32-\/bit random floating point numbers between  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01221}01221 \textcolor{comment}{C!!!                   zero (not included) and one (also not incl.). ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01222}01222 \textcolor{comment}{C!!!      CALL RLUXGO(LUX,INT) initializes the generator from one    ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01223}01223 \textcolor{comment}{C!!!                   32-\/bit integer INT and sets Luxury Level LUX  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01224}01224 \textcolor{comment}{C!!!                   which is integer between zero and MAXLEV,     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01225}01225 \textcolor{comment}{C!!!                   or if LUX .GT. 24, it sets p=LUX directly     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01226}01226 \textcolor{comment}{C!!!      CALL RLUXIN(IVEC)    restarts the generator from vector    ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01227}01227 \textcolor{comment}{C!!!                   IVEC of 25 32-\/bit integers (see RLUXUT)       ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01228}01228 \textcolor{comment}{C!!!      CALL RLUXUT(IVEC)    outputs the current values of the 25  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01229}01229 \textcolor{comment}{C!!!                 32-\/bit integer seeds, to be used for restarting ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01230}01230 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01231}01231       dimension rvec(lenv)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01232}01232       dimension seeds(24), iseeds(24), isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01233}01233       parameter(maxlev=4, lxdflt=3)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01234}01234       dimension ndskip(0:maxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01235}01235       parameter(twop12=4096.)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01236}01236       parameter(itwo24=2**24, icons=2147483563)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01237}01237       \textcolor{keywordtype}{SAVE} notyet, i24, j24, carry, seeds, twom24, twom12, luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01238}01238       \textcolor{keywordtype}{SAVE} nskip, ndskip, in24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01239}01239       \textcolor{keywordtype}{INTEGER} LUXLEV}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01240}01240       \textcolor{keywordtype}{LOGICAL} NOTYET}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01241}01241       \textcolor{keyword}{DATA} notyet, luxlev, in24 /.true., lxdflt, 0/}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01242}01242       \textcolor{keyword}{DATA} i24,j24,carry/24,10,0./}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01243}01243       \textcolor{keyword}{DATA} ndskip/0,  24,  73, 199, 365 /}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01244}01244 \textcolor{comment}{Corresponds to p=24   48   97  223  389}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01245}01245 \textcolor{comment}{C     time factor 1    2    4    9   16   (in practice, much smaller)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01246}01246 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01247}01247 \textcolor{comment}{C  NOTYET is .TRUE. if no initialization has been performed yet.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01248}01248 \textcolor{comment}{C              Default Initialization by Multiplicative Congruential}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01249}01249       \textcolor{keywordflow}{IF} (notyet) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01250}01250          notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01251}01251          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01252}01252          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default initialisation '}\textcolor{stringliteral}{',I12)'}) jseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01253}01253          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01254}01254          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01255}01255          lp = nskip + 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01256}01256          in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01257}01257          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01258}01258      +           luxlev, lp}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01259}01259          twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01260}01260          \textcolor{keywordflow}{DO} 10 i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01261}01261             twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01262}01262             k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01263}01263             jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01264}01264             \textcolor{keywordflow}{IF} (jseed .LT. 0) jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01265}01265             iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01266}01266    10    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01267}01267          twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01268}01268          \textcolor{keywordflow}{DO} 20 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01269}01269             seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01270}01270    20    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01271}01271          i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01272}01272          j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01273}01273          carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01274}01274          \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01275}01275 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01276}01276 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01277}01277 \textcolor{comment}{C          The Generator proper: "{}Subtract-\/with-\/borrow"{},}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01278}01278 \textcolor{comment}{C          as proposed by Marsaglia and Zaman,}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01279}01279 \textcolor{comment}{C          Florida State University, March, 1989}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01280}01280 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01281}01281       \textcolor{keywordflow}{DO} 40  ivec= 1, lenv}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01282}01282 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01283}01283          uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01284}01284 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01285}01285          \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01286}01286             uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01287}01287             carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01288}01288          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01289}01289             carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01290}01290 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01291}01291          seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01292}01292          i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01293}01293          \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01294}01294          j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01295}01295          \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01296}01296          rvec(ivec) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01297}01297 \textcolor{comment}{C  small numbers (with less than 12 "{}significant"{} bits) are "{}padded"{}.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01298}01298          \textcolor{keywordflow}{IF} (uni .LT. twom12) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01299}01299             rvec(ivec) = rvec(ivec) + twom24*seeds(j24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01300}01300 \textcolor{comment}{C        and zero is forbidden in case someone takes a logarithm}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01301}01301             \textcolor{keywordflow}{IF} (rvec(ivec) .EQ. 0.) rvec(ivec) = twom24*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01302}01302 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01303}01303 \textcolor{comment}{C        Skipping to luxury.  As proposed by Martin Luscher.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01304}01304          in24 = in24 + 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01305}01305          \textcolor{keywordflow}{IF} (in24 .EQ. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01306}01306             in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01307}01307             \textcolor{keywordflow}{DO} 30 isk= 1, nskip}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01308}01308                uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01309}01309 \textcolor{comment}{CCCCCC         The above has been corrected}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01310}01310                \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01311}01311                   uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01312}01312                   carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01313}01313                \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01314}01314                   carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01315}01315 \textcolor{keywordflow}{               ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01316}01316                seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01317}01317                i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01318}01318                \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01319}01319                j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01320}01320                \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01321}01321    30       \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01322}01322 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01323}01323    40 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01324}01324       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01325}01325 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01326}01326 \textcolor{comment}{C           Entry to input and float integer seeds from previous run}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01327}01327 \textcolor{comment}{C      ENTRY RLUXIN(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01328}01328       entry xnrnin6(isdext)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01329}01329       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01330}01330       \textcolor{keywordflow}{DO} 50  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01331}01331    50 twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01332}01332       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01333}01333       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: initialisation with 25 numbers'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01334}01334       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'(5X,5I12)'}) isdext}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01335}01335       \textcolor{keywordflow}{DO} 60  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01336}01336          seeds(i) = real(isdext(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01337}01337    60 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01338}01338       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01339}01339       \textcolor{keywordflow}{IF} (isdext(25) .LT. 0)  carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01340}01340       isd = iabs(isdext(25))}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01341}01341       i24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01342}01342       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01343}01343       j24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01344}01344       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01345}01345       in24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01346}01346       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01347}01347       luxlev = isd}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01348}01348       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01349}01349          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01350}01350          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: level set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01351}01351       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (luxlev .GE. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01352}01352          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01353}01353          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01354}01354       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01355}01355          nskip = ndskip(maxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01356}01356          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: illegal level '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01357}01357          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01358}01358 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01359}01359       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01360}01360 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01361}01361 \textcolor{comment}{C                    Entry to ouput seeds as integers}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01362}01362 \textcolor{comment}{C      ENTRY RLUXUT(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01363}01363       entry xnrnut6(isdext)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01364}01364       \textcolor{keywordflow}{DO} 70  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01365}01365          isdext(i) = int(seeds(i)*twop12*twop12)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01366}01366    70 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01367}01367       isdext(25) = i24 + 100*j24 + 10000*in24 + 1000000*luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01368}01368       \textcolor{keywordflow}{IF} (carry .GT. 0.)  isdext(25) = -\/isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01369}01369       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01370}01370 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01371}01371 \textcolor{comment}{C                    Entry to initialize from one integer}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01372}01372 \textcolor{comment}{C      ENTRY RLUXGO(LUX,INSEED)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01373}01373       entry xnrngo6(lux,inseed)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01374}01374       \textcolor{keywordflow}{IF} (lux .LT. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01375}01375          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01376}01376       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01377}01377          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01378}01378       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LT. 24 .OR. lux .GT. 2000) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01379}01379          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01380}01380          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: illegal level '}\textcolor{stringliteral}{',I2)'}) lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01381}01381       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01382}01382          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01383}01383          \textcolor{keywordflow}{DO} 80  ilx= 0, maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01384}01384             \textcolor{keywordflow}{IF} (lux .EQ. ndskip(ilx)+24) luxlev = ilx}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01385}01385    80    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01386}01386 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01387}01387       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01388}01388          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01389}01389          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01390}01390      +           luxlev, nskip+24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01391}01391       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01392}01392          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01393}01393          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01394}01394 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01395}01395       in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01396}01396       \textcolor{keywordflow}{IF} (inseed .NE. 0)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01397}01397          jseed = inseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01398}01398          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from seed '}\textcolor{stringliteral}{',I12)'})inseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01399}01399       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01400}01400          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01401}01401          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from default seed'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01402}01402 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01403}01403       notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01404}01404       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01405}01405       \textcolor{keywordflow}{DO} 90  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01406}01406          twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01407}01407          k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01408}01408          jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01409}01409          \textcolor{keywordflow}{IF} (jseed .LT. 0)  jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01410}01410          iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01411}01411    90 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01412}01412       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01413}01413       \textcolor{keywordflow}{DO} 100 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01414}01414          seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01415}01415   100 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01416}01416       i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01417}01417       j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01418}01418       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01419}01419       \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01420}01420       \textcolor{keyword}{END}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01421}01421 \textcolor{comment}{*CMZ :  1.00/00 16/02/95  11.37.11  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01422}01422 \textcolor{comment}{*CMZ :  0.03/00 19/01/94  22.39.16  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01423}01423 \textcolor{comment}{*CMZ :  0.01/01 19/01/94  17.08.37  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01424}01424 \textcolor{comment}{*-\/-\/ Author :    Federico Carminati   18/01/94}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01425}01425       \textcolor{keyword}{SUBROUTINE }xnrand7(RVEC,LENV)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01426}01426 \textcolor{comment}{C      SUBROUTINE RANLUX(RVEC,LENV)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01427}01427 \textcolor{comment}{C         Subtract-\/and-\/borrow random number generator proposed by}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01428}01428 \textcolor{comment}{C         Marsaglia and Zaman, implemented by F. James with the name}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01429}01429 \textcolor{comment}{C         RCARRY in 1991, and later improved by Martin Luescher}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01430}01430 \textcolor{comment}{C         in 1993 to produce "{}Luxury Pseudorandom Numbers"{}.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01431}01431 \textcolor{comment}{C     Fortran 77 coded by F. James, 1993}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01432}01432 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01433}01433 \textcolor{comment}{C   LUXURY LEVELS.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01434}01434 \textcolor{comment}{C   -\/-\/-\/-\/-\/-\/ -\/-\/-\/-\/-\/-\/      The available luxury levels are:}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01435}01435 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01436}01436 \textcolor{comment}{C  level 0  (p=24): equivalent to the original RCARRY of Marsaglia}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01437}01437 \textcolor{comment}{C           and Zaman, very long period, but fails many tests.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01438}01438 \textcolor{comment}{C  level 1  (p=48): considerable improvement in quality over level 0,}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01439}01439 \textcolor{comment}{C           now passes the gap test, but still fails spectral test.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01440}01440 \textcolor{comment}{C  level 2  (p=97): passes all known tests, but theoretically still}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01441}01441 \textcolor{comment}{C           defective.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01442}01442 \textcolor{comment}{C  level 3  (p=223): DEFAULT VALUE.  Any theoretically possible}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01443}01443 \textcolor{comment}{C           correlations have very small chance of being observed.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01444}01444 \textcolor{comment}{C  level 4  (p=389): highest possible luxury, all 24 bits chaotic.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01445}01445 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01446}01446 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01447}01447 \textcolor{comment}{C!!!  Calling sequences for RANLUX:                                  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01448}01448 \textcolor{comment}{C!!!      CALL RANLUX (RVEC, LEN)   returns a vector RVEC of LEN     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01449}01449 \textcolor{comment}{C!!!                   32-\/bit random floating point numbers between  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01450}01450 \textcolor{comment}{C!!!                   zero (not included) and one (also not incl.). ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01451}01451 \textcolor{comment}{C!!!      CALL RLUXGO(LUX,INT) initializes the generator from one    ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01452}01452 \textcolor{comment}{C!!!                   32-\/bit integer INT and sets Luxury Level LUX  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01453}01453 \textcolor{comment}{C!!!                   which is integer between zero and MAXLEV,     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01454}01454 \textcolor{comment}{C!!!                   or if LUX .GT. 24, it sets p=LUX directly     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01455}01455 \textcolor{comment}{C!!!      CALL RLUXIN(IVEC)    restarts the generator from vector    ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01456}01456 \textcolor{comment}{C!!!                   IVEC of 25 32-\/bit integers (see RLUXUT)       ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01457}01457 \textcolor{comment}{C!!!      CALL RLUXUT(IVEC)    outputs the current values of the 25  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01458}01458 \textcolor{comment}{C!!!                 32-\/bit integer seeds, to be used for restarting ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01459}01459 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01460}01460       dimension rvec(lenv)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01461}01461       dimension seeds(24), iseeds(24), isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01462}01462       parameter(maxlev=4, lxdflt=3)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01463}01463       dimension ndskip(0:maxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01464}01464       parameter(twop12=4096.)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01465}01465       parameter(itwo24=2**24, icons=2147483563)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01466}01466       \textcolor{keywordtype}{SAVE} notyet, i24, j24, carry, seeds, twom24, twom12, luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01467}01467       \textcolor{keywordtype}{SAVE} nskip, ndskip, in24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01468}01468       \textcolor{keywordtype}{INTEGER} LUXLEV}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01469}01469       \textcolor{keywordtype}{LOGICAL} NOTYET}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01470}01470       \textcolor{keyword}{DATA} notyet, luxlev, in24 /.true., lxdflt, 0/}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01471}01471       \textcolor{keyword}{DATA} i24,j24,carry/24,10,0./}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01472}01472       \textcolor{keyword}{DATA} ndskip/0,  24,  73, 199, 365 /}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01473}01473 \textcolor{comment}{Corresponds to p=24   48   97  223  389}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01474}01474 \textcolor{comment}{C     time factor 1    2    4    9   16   (in practice, much smaller)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01475}01475 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01476}01476 \textcolor{comment}{C  NOTYET is .TRUE. if no initialization has been performed yet.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01477}01477 \textcolor{comment}{C              Default Initialization by Multiplicative Congruential}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01478}01478       \textcolor{keywordflow}{IF} (notyet) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01479}01479          notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01480}01480          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01481}01481          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default initialisation '}\textcolor{stringliteral}{',I12)'}) jseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01482}01482          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01483}01483          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01484}01484          lp = nskip + 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01485}01485          in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01486}01486          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01487}01487      +           luxlev, lp}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01488}01488          twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01489}01489          \textcolor{keywordflow}{DO} 10 i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01490}01490             twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01491}01491             k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01492}01492             jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01493}01493             \textcolor{keywordflow}{IF} (jseed .LT. 0) jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01494}01494             iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01495}01495    10    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01496}01496          twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01497}01497          \textcolor{keywordflow}{DO} 20 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01498}01498             seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01499}01499    20    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01500}01500          i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01501}01501          j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01502}01502          carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01503}01503          \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01504}01504 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01505}01505 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01506}01506 \textcolor{comment}{C          The Generator proper: "{}Subtract-\/with-\/borrow"{},}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01507}01507 \textcolor{comment}{C          as proposed by Marsaglia and Zaman,}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01508}01508 \textcolor{comment}{C          Florida State University, March, 1989}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01509}01509 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01510}01510       \textcolor{keywordflow}{DO} 40  ivec= 1, lenv}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01511}01511 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01512}01512          uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01513}01513 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01514}01514          \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01515}01515             uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01516}01516             carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01517}01517          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01518}01518             carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01519}01519 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01520}01520          seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01521}01521          i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01522}01522          \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01523}01523          j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01524}01524          \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01525}01525          rvec(ivec) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01526}01526 \textcolor{comment}{C  small numbers (with less than 12 "{}significant"{} bits) are "{}padded"{}.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01527}01527          \textcolor{keywordflow}{IF} (uni .LT. twom12) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01528}01528             rvec(ivec) = rvec(ivec) + twom24*seeds(j24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01529}01529 \textcolor{comment}{C        and zero is forbidden in case someone takes a logarithm}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01530}01530             \textcolor{keywordflow}{IF} (rvec(ivec) .EQ. 0.) rvec(ivec) = twom24*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01531}01531 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01532}01532 \textcolor{comment}{C        Skipping to luxury.  As proposed by Martin Luscher.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01533}01533          in24 = in24 + 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01534}01534          \textcolor{keywordflow}{IF} (in24 .EQ. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01535}01535             in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01536}01536             \textcolor{keywordflow}{DO} 30 isk= 1, nskip}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01537}01537                uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01538}01538 \textcolor{comment}{CCCCCC         The above has been corrected}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01539}01539                \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01540}01540                   uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01541}01541                   carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01542}01542                \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01543}01543                   carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01544}01544 \textcolor{keywordflow}{               ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01545}01545                seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01546}01546                i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01547}01547                \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01548}01548                j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01549}01549                \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01550}01550    30       \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01551}01551 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01552}01552    40 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01553}01553       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01554}01554 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01555}01555 \textcolor{comment}{C           Entry to input and float integer seeds from previous run}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01556}01556 \textcolor{comment}{C      ENTRY RLUXIN(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01557}01557       entry xnrnin7(isdext)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01558}01558       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01559}01559       \textcolor{keywordflow}{DO} 50  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01560}01560    50 twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01561}01561       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01562}01562       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: initialisation with 25 numbers'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01563}01563       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'(5X,5I12)'}) isdext}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01564}01564       \textcolor{keywordflow}{DO} 60  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01565}01565          seeds(i) = real(isdext(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01566}01566    60 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01567}01567       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01568}01568       \textcolor{keywordflow}{IF} (isdext(25) .LT. 0)  carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01569}01569       isd = iabs(isdext(25))}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01570}01570       i24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01571}01571       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01572}01572       j24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01573}01573       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01574}01574       in24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01575}01575       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01576}01576       luxlev = isd}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01577}01577       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01578}01578          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01579}01579          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: level set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01580}01580       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (luxlev .GE. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01581}01581          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01582}01582          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01583}01583       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01584}01584          nskip = ndskip(maxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01585}01585          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: illegal level '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01586}01586          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01587}01587 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01588}01588       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01589}01589 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01590}01590 \textcolor{comment}{C                    Entry to ouput seeds as integers}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01591}01591 \textcolor{comment}{C      ENTRY RLUXUT(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01592}01592       entry xnrnut7(isdext)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01593}01593       \textcolor{keywordflow}{DO} 70  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01594}01594          isdext(i) = int(seeds(i)*twop12*twop12)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01595}01595    70 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01596}01596       isdext(25) = i24 + 100*j24 + 10000*in24 + 1000000*luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01597}01597       \textcolor{keywordflow}{IF} (carry .GT. 0.)  isdext(25) = -\/isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01598}01598       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01599}01599 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01600}01600 \textcolor{comment}{C                    Entry to initialize from one integer}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01601}01601 \textcolor{comment}{C      ENTRY RLUXGO(LUX,INSEED)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01602}01602       entry xnrngo7(lux,inseed)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01603}01603       \textcolor{keywordflow}{IF} (lux .LT. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01604}01604          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01605}01605       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01606}01606          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01607}01607       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LT. 24 .OR. lux .GT. 2000) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01608}01608          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01609}01609          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: illegal level '}\textcolor{stringliteral}{',I2)'}) lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01610}01610       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01611}01611          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01612}01612          \textcolor{keywordflow}{DO} 80  ilx= 0, maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01613}01613             \textcolor{keywordflow}{IF} (lux .EQ. ndskip(ilx)+24) luxlev = ilx}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01614}01614    80    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01615}01615 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01616}01616       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01617}01617          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01618}01618          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01619}01619      +           luxlev, nskip+24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01620}01620       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01621}01621          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01622}01622          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01623}01623 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01624}01624       in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01625}01625       \textcolor{keywordflow}{IF} (inseed .NE. 0)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01626}01626          jseed = inseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01627}01627          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from seed '}\textcolor{stringliteral}{',I12)'})inseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01628}01628       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01629}01629          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01630}01630          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from default seed'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01631}01631 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01632}01632       notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01633}01633       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01634}01634       \textcolor{keywordflow}{DO} 90  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01635}01635          twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01636}01636          k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01637}01637          jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01638}01638          \textcolor{keywordflow}{IF} (jseed .LT. 0)  jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01639}01639          iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01640}01640    90 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01641}01641       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01642}01642       \textcolor{keywordflow}{DO} 100 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01643}01643          seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01644}01644   100 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01645}01645       i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01646}01646       j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01647}01647       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01648}01648       \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01649}01649       \textcolor{keyword}{END}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01650}01650 \textcolor{comment}{*CMZ :  1.00/00 16/02/95  11.37.11  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01651}01651 \textcolor{comment}{*CMZ :  0.03/00 19/01/94  22.39.16  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01652}01652 \textcolor{comment}{*CMZ :  0.01/01 19/01/94  17.08.37  by  Federico Carminati}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01653}01653 \textcolor{comment}{*-\/-\/ Author :    Federico Carminati   18/01/94}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01654}01654       \textcolor{keyword}{SUBROUTINE }xnrand8(RVEC,LENV)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01655}01655 \textcolor{comment}{C      SUBROUTINE RANLUX(RVEC,LENV)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01656}01656 \textcolor{comment}{C         Subtract-\/and-\/borrow random number generator proposed by}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01657}01657 \textcolor{comment}{C         Marsaglia and Zaman, implemented by F. James with the name}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01658}01658 \textcolor{comment}{C         RCARRY in 1991, and later improved by Martin Luescher}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01659}01659 \textcolor{comment}{C         in 1993 to produce "{}Luxury Pseudorandom Numbers"{}.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01660}01660 \textcolor{comment}{C     Fortran 77 coded by F. James, 1993}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01661}01661 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01662}01662 \textcolor{comment}{C   LUXURY LEVELS.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01663}01663 \textcolor{comment}{C   -\/-\/-\/-\/-\/-\/ -\/-\/-\/-\/-\/-\/      The available luxury levels are:}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01664}01664 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01665}01665 \textcolor{comment}{C  level 0  (p=24): equivalent to the original RCARRY of Marsaglia}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01666}01666 \textcolor{comment}{C           and Zaman, very long period, but fails many tests.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01667}01667 \textcolor{comment}{C  level 1  (p=48): considerable improvement in quality over level 0,}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01668}01668 \textcolor{comment}{C           now passes the gap test, but still fails spectral test.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01669}01669 \textcolor{comment}{C  level 2  (p=97): passes all known tests, but theoretically still}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01670}01670 \textcolor{comment}{C           defective.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01671}01671 \textcolor{comment}{C  level 3  (p=223): DEFAULT VALUE.  Any theoretically possible}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01672}01672 \textcolor{comment}{C           correlations have very small chance of being observed.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01673}01673 \textcolor{comment}{C  level 4  (p=389): highest possible luxury, all 24 bits chaotic.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01674}01674 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01675}01675 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01676}01676 \textcolor{comment}{C!!!  Calling sequences for RANLUX:                                  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01677}01677 \textcolor{comment}{C!!!      CALL RANLUX (RVEC, LEN)   returns a vector RVEC of LEN     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01678}01678 \textcolor{comment}{C!!!                   32-\/bit random floating point numbers between  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01679}01679 \textcolor{comment}{C!!!                   zero (not included) and one (also not incl.). ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01680}01680 \textcolor{comment}{C!!!      CALL RLUXGO(LUX,INT) initializes the generator from one    ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01681}01681 \textcolor{comment}{C!!!                   32-\/bit integer INT and sets Luxury Level LUX  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01682}01682 \textcolor{comment}{C!!!                   which is integer between zero and MAXLEV,     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01683}01683 \textcolor{comment}{C!!!                   or if LUX .GT. 24, it sets p=LUX directly     ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01684}01684 \textcolor{comment}{C!!!      CALL RLUXIN(IVEC)    restarts the generator from vector    ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01685}01685 \textcolor{comment}{C!!!                   IVEC of 25 32-\/bit integers (see RLUXUT)       ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01686}01686 \textcolor{comment}{C!!!      CALL RLUXUT(IVEC)    outputs the current values of the 25  ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01687}01687 \textcolor{comment}{C!!!                 32-\/bit integer seeds, to be used for restarting ++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01688}01688 \textcolor{comment}{C!!! ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01689}01689       dimension rvec(lenv)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01690}01690       dimension seeds(24), iseeds(24), isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01691}01691       parameter(maxlev=4, lxdflt=3)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01692}01692       dimension ndskip(0:maxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01693}01693       parameter(twop12=4096.)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01694}01694       parameter(itwo24=2**24, icons=2147483563)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01695}01695       \textcolor{keywordtype}{SAVE} notyet, i24, j24, carry, seeds, twom24, twom12, luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01696}01696       \textcolor{keywordtype}{SAVE} nskip, ndskip, in24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01697}01697       \textcolor{keywordtype}{INTEGER} LUXLEV}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01698}01698       \textcolor{keywordtype}{LOGICAL} NOTYET}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01699}01699       \textcolor{keyword}{DATA} notyet, luxlev, in24 /.true., lxdflt, 0/}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01700}01700       \textcolor{keyword}{DATA} i24,j24,carry/24,10,0./}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01701}01701       \textcolor{keyword}{DATA} ndskip/0,  24,  73, 199, 365 /}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01702}01702 \textcolor{comment}{Corresponds to p=24   48   97  223  389}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01703}01703 \textcolor{comment}{C     time factor 1    2    4    9   16   (in practice, much smaller)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01704}01704 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01705}01705 \textcolor{comment}{C  NOTYET is .TRUE. if no initialization has been performed yet.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01706}01706 \textcolor{comment}{C              Default Initialization by Multiplicative Congruential}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01707}01707       \textcolor{keywordflow}{IF} (notyet) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01708}01708          notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01709}01709          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01710}01710          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default initialisation '}\textcolor{stringliteral}{',I12)'}) jseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01711}01711          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01712}01712          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01713}01713          lp = nskip + 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01714}01714          in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01715}01715          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01716}01716      +           luxlev, lp}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01717}01717          twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01718}01718          \textcolor{keywordflow}{DO} 10 i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01719}01719             twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01720}01720             k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01721}01721             jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01722}01722             \textcolor{keywordflow}{IF} (jseed .LT. 0) jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01723}01723             iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01724}01724    10    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01725}01725          twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01726}01726          \textcolor{keywordflow}{DO} 20 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01727}01727             seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01728}01728    20    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01729}01729          i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01730}01730          j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01731}01731          carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01732}01732          \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01733}01733 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01734}01734 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01735}01735 \textcolor{comment}{C          The Generator proper: "{}Subtract-\/with-\/borrow"{},}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01736}01736 \textcolor{comment}{C          as proposed by Marsaglia and Zaman,}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01737}01737 \textcolor{comment}{C          Florida State University, March, 1989}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01738}01738 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01739}01739       \textcolor{keywordflow}{DO} 40  ivec= 1, lenv}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01740}01740 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01741}01741          uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01742}01742 \textcolor{comment}{CCCCCC     This has now been corrected for the bug discovered by Luescher  ***}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01743}01743          \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01744}01744             uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01745}01745             carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01746}01746          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01747}01747             carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01748}01748 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01749}01749          seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01750}01750          i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01751}01751          \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01752}01752          j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01753}01753          \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01754}01754          rvec(ivec) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01755}01755 \textcolor{comment}{C  small numbers (with less than 12 "{}significant"{} bits) are "{}padded"{}.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01756}01756          \textcolor{keywordflow}{IF} (uni .LT. twom12) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01757}01757             rvec(ivec) = rvec(ivec) + twom24*seeds(j24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01758}01758 \textcolor{comment}{C        and zero is forbidden in case someone takes a logarithm}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01759}01759             \textcolor{keywordflow}{IF} (rvec(ivec) .EQ. 0.) rvec(ivec) = twom24*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01760}01760 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01761}01761 \textcolor{comment}{C        Skipping to luxury.  As proposed by Martin Luscher.}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01762}01762          in24 = in24 + 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01763}01763          \textcolor{keywordflow}{IF} (in24 .EQ. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01764}01764             in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01765}01765             \textcolor{keywordflow}{DO} 30 isk= 1, nskip}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01766}01766                uni = seeds(j24) -\/ seeds(i24) -\/ carry}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01767}01767 \textcolor{comment}{CCCCCC         The above has been corrected}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01768}01768                \textcolor{keywordflow}{IF} (uni .LT. 0.) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01769}01769                   uni = uni + 1.0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01770}01770                   carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01771}01771                \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01772}01772                   carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01773}01773 \textcolor{keywordflow}{               ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01774}01774                seeds(i24) = uni}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01775}01775                i24 = i24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01776}01776                \textcolor{keywordflow}{IF} (i24 .EQ. 0) i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01777}01777                j24 = j24 -\/ 1}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01778}01778                \textcolor{keywordflow}{IF} (j24 .EQ. 0) j24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01779}01779    30       \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01780}01780 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01781}01781    40 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01782}01782       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01783}01783 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01784}01784 \textcolor{comment}{C           Entry to input and float integer seeds from previous run}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01785}01785 \textcolor{comment}{C      ENTRY RLUXIN(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01786}01786       entry xnrnin8(isdext)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01787}01787       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01788}01788       \textcolor{keywordflow}{DO} 50  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01789}01789    50 twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01790}01790       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01791}01791       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: initialisation with 25 numbers'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01792}01792       \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'(5X,5I12)'}) isdext}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01793}01793       \textcolor{keywordflow}{DO} 60  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01794}01794          seeds(i) = real(isdext(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01795}01795    60 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01796}01796       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01797}01797       \textcolor{keywordflow}{IF} (isdext(25) .LT. 0)  carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01798}01798       isd = iabs(isdext(25))}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01799}01799       i24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01800}01800       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01801}01801       j24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01802}01802       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01803}01803       in24 = mod(isd,100)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01804}01804       isd = isd/100}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01805}01805       luxlev = isd}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01806}01806       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01807}01807          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01808}01808          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: level set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01809}01809       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (luxlev .GE. 24) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01810}01810          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01811}01811          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01812}01812       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01813}01813          nskip = ndskip(maxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01814}01814          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRAND: illegal level '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01815}01815          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01816}01816 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01817}01817       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01818}01818 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01819}01819 \textcolor{comment}{C                    Entry to ouput seeds as integers}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01820}01820 \textcolor{comment}{C      ENTRY RLUXUT(ISDEXT)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01821}01821       entry xnrnut8(isdext)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01822}01822       \textcolor{keywordflow}{DO} 70  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01823}01823          isdext(i) = int(seeds(i)*twop12*twop12)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01824}01824    70 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01825}01825       isdext(25) = i24 + 100*j24 + 10000*in24 + 1000000*luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01826}01826       \textcolor{keywordflow}{IF} (carry .GT. 0.)  isdext(25) = -\/isdext(25)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01827}01827       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01828}01828 \textcolor{comment}{C}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01829}01829 \textcolor{comment}{C                    Entry to initialize from one integer}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01830}01830 \textcolor{comment}{C      ENTRY RLUXGO(LUX,INSEED)}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01831}01831       entry xnrngo8(lux,inseed)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01832}01832       \textcolor{keywordflow}{IF} (lux .LT. 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01833}01833          luxlev = lxdflt}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01834}01834       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LE. maxlev) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01835}01835          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01836}01836       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (lux .LT. 24 .OR. lux .GT. 2000) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01837}01837          luxlev = maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01838}01838          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: illegal level '}\textcolor{stringliteral}{',I2)'}) lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01839}01839       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01840}01840          luxlev = lux}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01841}01841          \textcolor{keywordflow}{DO} 80  ilx= 0, maxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01842}01842             \textcolor{keywordflow}{IF} (lux .EQ. ndskip(ilx)+24) luxlev = ilx}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01843}01843    80    \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01844}01844 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01845}01845       \textcolor{keywordflow}{IF} (luxlev .LE. maxlev)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01846}01846          nskip = ndskip(luxlev)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01847}01847          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: default level '}\textcolor{stringliteral}{',I2,'}\textcolor{stringliteral}{', p '}\textcolor{stringliteral}{',I4)'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01848}01848      +           luxlev, nskip+24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01849}01849       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01850}01850          nskip = luxlev -\/ 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01851}01851          \textcolor{keyword}{WRITE} (6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: p-\/value set to '}\textcolor{stringliteral}{',I2)'}) luxlev}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01852}01852 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01853}01853       in24 = 0}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01854}01854       \textcolor{keywordflow}{IF} (inseed .NE. 0)  \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01855}01855          jseed = inseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01856}01856          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from seed '}\textcolor{stringliteral}{',I12)'})inseed}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01857}01857       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01858}01858          jseed = 314159265}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01859}01859          \textcolor{keyword}{WRITE}(6,\textcolor{stringliteral}{'('}\textcolor{stringliteral}{' *** XNRNGO: initialised from default seed'}\textcolor{stringliteral}{')'})}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01860}01860 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01861}01861       notyet = .false.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01862}01862       twom24 = 1.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01863}01863       \textcolor{keywordflow}{DO} 90  i= 1, 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01864}01864          twom24 = twom24 * 0.5}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01865}01865          k = jseed/53668}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01866}01866          jseed = 40014*(jseed-\/k*53668) -\/k*12211}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01867}01867          \textcolor{keywordflow}{IF} (jseed .LT. 0)  jseed = jseed+icons}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01868}01868          iseeds(i) = mod(jseed,itwo24)}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01869}01869    90 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01870}01870       twom12 = twom24 * 4096.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01871}01871       \textcolor{keywordflow}{DO} 100 i= 1,24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01872}01872          seeds(i) = real(iseeds(i))*twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01873}01873   100 \textcolor{keywordflow}{CONTINUE}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01874}01874       i24 = 24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01875}01875       j24 = 10}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01876}01876       carry = 0.}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01877}01877       \textcolor{keywordflow}{IF} (seeds(24) .LE. seeds(14)) carry = twom24}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01878}01878       \textcolor{keyword}{END}}
\DoxyCodeLine{\Hypertarget{xnrandp_8_f_source_l01879}01879 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
