<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_xnfil8_8_f_source" xml:lang="en-US">
<title>xnfil8.F</title>
<indexterm><primary>/Users/Transmutex/Simulation/ADS_SimulationCode/xnsect/isomers/xnfil8.F</primary></indexterm>
<programlisting linenumbering="unnumbered"><anchor xml:id="_xnfil8_8_f_source_1l00001"/>00001 <emphasis role="comment">*CMZ&#32;:&#32;&#32;2.00/02&#32;05/06/96&#32;&#32;14.47.33&#32;&#32;by&#32;&#32;Federico&#32;Carminati</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00002"/>00002 <emphasis role="comment">*--&#32;Author&#32;:</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00003"/>00003 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">SUBROUTINE&#32;</emphasis>xnfil8
<anchor xml:id="_xnfil8_8_f_source_1l00004"/>00004 <emphasis role="comment">************************************************************************</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00005"/>00005 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00006"/>00006 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;Collect&#32;information&#32;stored&#32;in&#32;file&#32;8&#32;on&#32;isomer&#32;production&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00007"/>00007 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;data&#32;to&#32;be&#32;found&#32;in&#32;file&#32;9&#32;or&#32;10&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00008"/>00008 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00009"/>00009 <emphasis role="comment">************************************************************************</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00010"/>00010 <emphasis role="preprocessor">#include&#32;&quot;xcmxse.inc&quot;</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00011"/>00011 <emphasis role="preprocessor"></emphasis><emphasis role="preprocessor">#include&#32;&quot;xctab1.inc&quot;</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00012"/>00012 <emphasis role="preprocessor"></emphasis><emphasis role="preprocessor">#include&#32;&quot;xcnamf.inc&quot;</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00013"/>00013 <emphasis role="preprocessor"></emphasis><emphasis role="preprocessor">#include&#32;&quot;xcsbnl.inc&quot;</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00014"/>00014 <emphasis role="preprocessor"></emphasis><emphasis role="preprocessor">#include&#32;&quot;xcsend.inc&quot;</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00015"/>00015 <emphasis role="preprocessor"></emphasis>&#32;&#32;&#32;&#32;&#32;&#32;dimension&#32;ida(mxreac),&#32;idz(mxreac)
<anchor xml:id="_xnfil8_8_f_source_1l00016"/>00016 <emphasis role="comment">*&#32;---&gt;&#32;Difference&#32;in&#32;mass&#32;number&#32;after&#32;reaction</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00017"/>00017 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">DATA</emphasis>&#32;ida&#32;/&#32;0,&#32;0,&#32;0,&#32;-1,&#32;0,&#32;1,&#32;41*0,&#32;-2,&#32;-4,&#32;-12,&#32;-5,&#32;-6,&#32;-1,
<anchor xml:id="_xnfil8_8_f_source_1l00018"/>00018 &#32;&#32;&#32;&#32;&#32;+&#32;&#32;&#32;&#32;&#32;&#32;&#32;-8,&#32;-9,&#32;-2,&#32;-3,&#32;-3,&#32;-10,&#32;-11,&#32;-3,&#32;-2,&#32;-3,&#32;0,&#32;-1,&#32;-2,
<anchor xml:id="_xnfil8_8_f_source_1l00019"/>00019 &#32;&#32;&#32;&#32;&#32;+&#32;&#32;&#32;&#32;&#32;&#32;&#32;-2,&#32;-3,&#32;-7,&#32;-11,&#32;-1,&#32;-4,&#32;-10,&#32;-9,&#32;-2,&#32;-3/
<anchor xml:id="_xnfil8_8_f_source_1l00020"/>00020 <emphasis role="comment">*&#32;---&gt;&#32;Difference&#32;in&#32;atomic&#32;number&#32;after&#32;reaction</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00021"/>00021 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">DATA</emphasis>&#32;idz&#32;/&#32;0,&#32;0,&#32;0,&#32;0,&#32;0,&#32;0,&#32;41*0,&#32;0,&#32;-2,&#32;-6,&#32;-2,&#32;-2,&#32;-1,&#32;-4,
<anchor xml:id="_xnfil8_8_f_source_1l00022"/>00022 &#32;&#32;&#32;&#32;&#32;+&#32;-4,&#32;-1,&#32;-1,&#32;-2,&#32;-5,&#32;-5,&#32;0,&#32;-1,&#32;-1,&#32;-1,&#32;-1,&#32;-1,&#32;-2,&#32;-2,&#32;-4,&#32;-6,
<anchor xml:id="_xnfil8_8_f_source_1l00023"/>00023 &#32;&#32;&#32;&#32;&#32;+&#32;-2,&#32;-3,&#32;-5,&#32;-5,&#32;-2,&#32;-2/
<anchor xml:id="_xnfil8_8_f_source_1l00024"/>00024 &#32;&#32;&#32;&#32;&#32;&#32;parameter(itapa=12)
<anchor xml:id="_xnfil8_8_f_source_1l00025"/>00025 <emphasis role="comment">*</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00026"/>00026 <emphasis role="comment">*&#32;----------------------------------------------------------------------</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00027"/>00027 <emphasis role="comment">*</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00028"/>00028 <emphasis role="comment">*&#32;---&gt;&#32;See&#32;if&#32;reaction&#32;is&#32;amongst&#32;the&#32;ones&#32;we&#32;consider</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00029"/>00029 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">DO</emphasis>&#32;10&#32;jr=1,mxreac
<anchor xml:id="_xnfil8_8_f_source_1l00030"/>00030 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(mth.EQ.nbmft(jr))&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00031"/>00031 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;kreac=jr
<anchor xml:id="_xnfil8_8_f_source_1l00032"/>00032 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">GOTO</emphasis>&#32;20
<anchor xml:id="_xnfil8_8_f_source_1l00033"/>00033 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00034"/>00034 &#32;&#32;&#32;10&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00035"/>00035 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">GOTO</emphasis>&#32;999
<anchor xml:id="_xnfil8_8_f_source_1l00036"/>00036 <emphasis role="comment">*&#32;---&gt;&#32;Raction&#32;is&#32;ok</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00037"/>00037 &#32;&#32;&#32;20&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00038"/>00038 <emphasis role="comment">*&#32;---&gt;&#32;Number&#32;of&#32;subsections</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00039"/>00039 &#32;&#32;&#32;&#32;&#32;&#32;ns=n1
<anchor xml:id="_xnfil8_8_f_source_1l00040"/>00040 <emphasis role="comment">*&#32;---&gt;&#32;Kind&#32;of&#32;information&#32;present</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00041"/>00041 &#32;&#32;&#32;&#32;&#32;&#32;no=n2
<anchor xml:id="_xnfil8_8_f_source_1l00042"/>00042 <emphasis role="comment">*&#32;---&gt;&#32;Loop&#32;on&#32;subsections</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00043"/>00043 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">DO</emphasis>&#32;40&#32;js=1,ns
<anchor xml:id="_xnfil8_8_f_source_1l00044"/>00044 <emphasis role="comment">*&#32;---&gt;&#32;Read&#32;subsection&#32;(we&#32;are&#32;really&#32;interested&#32;only&#32;in&#32;the&#32;header)</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00045"/>00045 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(no.EQ.1)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00046"/>00046 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">READ</emphasis>(itapa,10000)&#32;zap,elfs,lmf,lfs,izero,matp
<anchor xml:id="_xnfil8_8_f_source_1l00047"/>00047 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">ELSE</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00048"/>00048 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">CALL&#32;</emphasis>xnlist
<anchor xml:id="_xnfil8_8_f_source_1l00049"/>00049 <emphasis role="comment">*&#32;---&gt;&#32;Product&#32;isomer&#32;code</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00050"/>00050 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;zap=c1
<anchor xml:id="_xnfil8_8_f_source_1l00051"/>00051 <emphasis role="comment">*&#32;---&gt;&#32;Product&#32;isomer&#32;level</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00052"/>00052 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;elfs=c2
<anchor xml:id="_xnfil8_8_f_source_1l00053"/>00053 <emphasis role="comment">*&#32;---&gt;&#32;ENDF-6&#32;file&#32;where&#32;additional&#32;information&#32;is&#32;stored</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00054"/>00054 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;lmf=l1
<anchor xml:id="_xnfil8_8_f_source_1l00055"/>00055 <emphasis role="comment">*&#32;---&gt;&#32;Level&#32;(NOT&#32;ISOMER!)&#32;number</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00056"/>00056 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;lfs=l2
<anchor xml:id="_xnfil8_8_f_source_1l00057"/>00057 <emphasis role="comment">*&#32;---&gt;&#32;ENDF-6&#32;material&#32;code&#32;of&#32;product</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00058"/>00058 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;matp=n2
<anchor xml:id="_xnfil8_8_f_source_1l00059"/>00059 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00060"/>00060 <emphasis role="comment">*&#32;---&gt;&#32;If&#32;additional&#32;information&#32;is&#32;not&#32;about&#32;isomer&#32;production&#32;skip</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00061"/>00061 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(lmf.NE.9.AND.lmf.NE.10)&#32;<emphasis role="keywordflow">GOTO</emphasis>&#32;40
<anchor xml:id="_xnfil8_8_f_source_1l00062"/>00062 <emphasis role="comment">*&#32;---&gt;&#32;This&#32;is&#32;the&#32;isotope&#32;code&#32;of&#32;the&#32;product</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00063"/>00063 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;izap=nint(zap)
<anchor xml:id="_xnfil8_8_f_source_1l00064"/>00064 <emphasis role="comment">*&#32;---&gt;&#32;Here&#32;we&#32;recalculate&#32;the&#32;product&#32;and&#32;we&#32;see&#32;whether&#32;it</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00065"/>00065 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;agrees&#32;with&#32;the&#32;one&#32;read,&#32;just&#32;to&#32;see&#32;if&#32;everything&#32;is&#32;ok</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00066"/>00066 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;izfa=izamat/10000
<anchor xml:id="_xnfil8_8_f_source_1l00067"/>00067 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;iafa=mod(izamat/10,1000)
<anchor xml:id="_xnfil8_8_f_source_1l00068"/>00068 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;isfa=mod(izamat,10)
<anchor xml:id="_xnfil8_8_f_source_1l00069"/>00069 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;izso=izfa+idz(kreac)
<anchor xml:id="_xnfil8_8_f_source_1l00070"/>00070 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;iaso=iafa+ida(kreac)
<anchor xml:id="_xnfil8_8_f_source_1l00071"/>00071 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;izaso=izso*1000+iaso
<anchor xml:id="_xnfil8_8_f_source_1l00072"/>00072 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(izaso.NE.izap)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00073"/>00073 <emphasis role="comment">*&#32;---&gt;&#32;Mismatch&#32;between&#32;product&#32;read&#32;and&#32;found.&#32;May&#32;be&#32;is&#32;not</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00074"/>00074 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;very&#32;serious.&#32;In&#32;an&#32;(n,alpha)&#32;reaction&#32;also&#32;the&#32;alpha</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00075"/>00075 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;can&#32;figure&#32;in&#32;the&#32;product&#32;list.&#32;Just&#32;print&#32;it.</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00076"/>00076 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">WRITE</emphasis>(6,10100)&#32;izamat,chname(kreac),izap,izaso
<anchor xml:id="_xnfil8_8_f_source_1l00077"/>00077 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">GOTO</emphasis>&#32;40
<anchor xml:id="_xnfil8_8_f_source_1l00078"/>00078 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00079"/>00079 <emphasis role="comment">*&#32;---&gt;&#32;Here&#32;there&#32;is&#32;a&#32;problem.&#32;The&#32;LFS&#32;flag&#32;is&#32;not&#32;the&#32;isomer</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00080"/>00080 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;number&#32;but&#32;the&#32;level&#32;number,&#32;and&#32;the&#32;information&#32;linking</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00081"/>00081 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;level&#32;and&#32;isomer&#32;number&#32;is&#32;not&#32;available&#32;in&#32;ENDF.&#32;So&#32;we</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00082"/>00082 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;look&#32;in&#32;the&#32;EET&#32;database&#32;for&#32;the&#32;isomer&#32;with&#32;the&#32;closest</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00083"/>00083 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;value&#32;of&#32;the&#32;energy&#32;level.</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00084"/>00084 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;qmdiff=1e10
<anchor xml:id="_xnfil8_8_f_source_1l00085"/>00085 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ipobnl=0
<anchor xml:id="_xnfil8_8_f_source_1l00086"/>00086 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">DO</emphasis>&#32;30&#32;jb=1,ntobnl
<anchor xml:id="_xnfil8_8_f_source_1l00087"/>00087 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(izabnl(jb)/10.EQ.izap)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00088"/>00088 <emphasis role="comment">*&#32;---&gt;&#32;Product&#32;of&#32;reaction&#32;exists&#32;in&#32;EET&#32;database,&#32;see&#32;now&#32;level</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00089"/>00089 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;qcdiff=elfs-qlvbnl(jb)*1e6
<anchor xml:id="_xnfil8_8_f_source_1l00090"/>00090 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(abs(qcdiff).LT.qmdiff)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00091"/>00091 <emphasis role="comment">*&#32;---&gt;&#32;Go&#32;for&#32;closest&#32;level</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00092"/>00092 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ipobnl=jb
<anchor xml:id="_xnfil8_8_f_source_1l00093"/>00093 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;qmdiff=qcdiff
<anchor xml:id="_xnfil8_8_f_source_1l00094"/>00094 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00095"/>00095 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00096"/>00096 &#32;&#32;&#32;30&#32;&#32;&#32;&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00097"/>00097 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(ipobnl.EQ.0)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00098"/>00098 <emphasis role="comment">*&#32;---&gt;&#32;We&#32;did&#32;not&#32;find&#32;the&#32;isotope&#32;in&#32;EET,&#32;print&#32;message&#32;and&#32;skip</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00099"/>00099 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">WRITE</emphasis>(6,10200)&#32;izap,lfs,elfs
<anchor xml:id="_xnfil8_8_f_source_1l00100"/>00100 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">GOTO</emphasis>&#32;40
<anchor xml:id="_xnfil8_8_f_source_1l00101"/>00101 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">ELSE</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00102"/>00102 <emphasis role="comment">*&#32;---&gt;&#32;Load&#32;one&#32;more&#32;product&#32;in&#32;list,&#32;if&#32;enough&#32;space&#32;is&#32;left</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00103"/>00103 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(ntendf.GE.maxssc)&#32;stop&#32;<emphasis role="stringliteral">&apos;Increase&#32;MAXSSC!&apos;</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00104"/>00104 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ntendf=ntendf+1
<anchor xml:id="_xnfil8_8_f_source_1l00105"/>00105 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;izapl(ntendf)=izabnl(ipobnl)
<anchor xml:id="_xnfil8_8_f_source_1l00106"/>00106 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;elfsl(ntendf)=elfs
<anchor xml:id="_xnfil8_8_f_source_1l00107"/>00107 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;lmfl(ntendf)=lmf
<anchor xml:id="_xnfil8_8_f_source_1l00108"/>00108 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;lfsl(ntendf)=lfs
<anchor xml:id="_xnfil8_8_f_source_1l00109"/>00109 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;mthl(ntendf)=mth
<anchor xml:id="_xnfil8_8_f_source_1l00110"/>00110 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ipbnl(ntendf)=ipobnl
<anchor xml:id="_xnfil8_8_f_source_1l00111"/>00111 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;qmdifl(ntendf)=qmdiff
<anchor xml:id="_xnfil8_8_f_source_1l00112"/>00112 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00113"/>00113 &#32;&#32;&#32;40&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00114"/>00114 <emphasis role="comment">*</emphasis>
<anchor xml:id="_xnfil8_8_f_source_1l00115"/>00115 10000&#32;<emphasis role="keyword">FORMAT</emphasis>(2e11.4,4i11,i4,i2,i3)
<anchor xml:id="_xnfil8_8_f_source_1l00116"/>00116 10100&#32;<emphasis role="keyword">FORMAT</emphasis>(<emphasis role="stringliteral">&apos;&#32;Warning!!!!&#32;Target&#32;&apos;</emphasis>,i6,<emphasis role="stringliteral">&apos;&#32;Reaction&#32;&apos;</emphasis>,a6,
<anchor xml:id="_xnfil8_8_f_source_1l00117"/>00117 &#32;&#32;&#32;&#32;&#32;+&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="stringliteral">&apos;&#32;ENDF&#32;product&#32;&apos;</emphasis>,i5,<emphasis role="stringliteral">&apos;&#32;Our&#32;calculation&#32;&apos;</emphasis>,i5)
<anchor xml:id="_xnfil8_8_f_source_1l00118"/>00118 10200&#32;<emphasis role="keyword">FORMAT</emphasis>(<emphasis role="stringliteral">&apos;&#32;Isomer&#32;&apos;</emphasis>,i6,<emphasis role="stringliteral">&apos;&#32;level&#32;&apos;</emphasis>,i2,<emphasis role="stringliteral">&apos;&#32;level&#32;&apos;</emphasis>,g10.3,
<anchor xml:id="_xnfil8_8_f_source_1l00119"/>00119 &#32;&#32;&#32;&#32;&#32;+<emphasis role="stringliteral">&apos;&#32;not&#32;in&#32;BNL&#32;list,&#32;skipping!&apos;</emphasis>)
<anchor xml:id="_xnfil8_8_f_source_1l00120"/>00120 &#32;&#32;999&#32;<emphasis role="keyword">END</emphasis>
</programlisting></section>
