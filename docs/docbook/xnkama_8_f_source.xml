<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_xnkama_8_f_source" xml:lang="en-US">
<title>xnkama.F</title>
<indexterm><primary>/Users/Transmutex/Simulation/ADS_SimulationCode/xnsect/xnsect/src/xnkama.F</primary></indexterm>
<programlisting linenumbering="unnumbered"><anchor xml:id="_xnkama_8_f_source_1l00001"/>00001 <emphasis role="comment">*CMZ&#32;:&#32;&#32;2.00/02&#32;03/06/96&#32;&#32;13.01.36&#32;&#32;by&#32;&#32;Federico&#32;Carminati</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00002"/>00002 <emphasis role="comment">*--&#32;Author&#32;:&#32;&#32;&#32;&#32;Federico&#32;Carminati&#32;&#32;&#32;03/05/96</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00003"/>00003 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">SUBROUTINE&#32;</emphasis>xnkama(AWR,IZAT,R,EIN,EOU,COST,PROB)
<anchor xml:id="_xnkama_8_f_source_1l00004"/>00004 <emphasis role="comment">************************************************************************</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00005"/>00005 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00006"/>00006 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;Kalbach-Mann&#32;distribution&#32;for&#32;incoming&#32;and&#32;outgoing&#32;neutrons&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00007"/>00007 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;See&#32;SIXPAK&#32;code&#32;for&#32;details&#32;and&#32;a&#32;more&#32;general&#32;version&#32;of&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00008"/>00008 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;this&#32;code.&#32;Notation&#32;is&#32;taken&#32;from&#32;the&#32;ENDF/B-VI&#32;manual&#32;page&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00009"/>00009 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;6.7&#32;with&#32;the&#32;well&#32;known&#32;bug&#32;of&#32;the&#32;factor&#32;0.5&#32;missing&#32;correct.&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00010"/>00010 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;Reaction&#32;is:&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00011"/>00011 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00012"/>00012 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;A&#32;+&#32;a&#32;--&gt;&#32;c&#32;--&gt;&#32;B&#32;+&#32;b&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00013"/>00013 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00014"/>00014 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;and&#32;in&#32;our&#32;case&#32;a=b=neutron.&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00015"/>00015 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00016"/>00016 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;AWR&#32;&#32;&#32;&#32;&#32;&#32;&#32;(input)&#32;Target&#32;mass&#32;in&#32;neutron&#32;units&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00017"/>00017 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;IZAT&#32;&#32;&#32;&#32;&#32;&#32;(input)&#32;10000*Z*10*A+ISO&#32;of&#32;target&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00018"/>00018 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;R&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;(input)&#32;r(E&apos;,E)&#32;factor&#32;of&#32;Kalbach-Mann&#32;distribution&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00019"/>00019 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;EIN&#32;&#32;&#32;&#32;&#32;&#32;&#32;(input)&#32;LAB&#32;incoming&#32;neutron&#32;energy&#32;in&#32;eV&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00020"/>00020 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;EOU&#32;&#32;&#32;&#32;&#32;&#32;&#32;(input)&#32;CM&#32;outgoing&#32;neutron&#32;energy&#32;in&#32;eV&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00021"/>00021 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;COST&#32;&#32;&#32;&#32;&#32;&#32;(input)&#32;CM&#32;cost&#32;theta&#32;of&#32;outgoing&#32;neutron&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00022"/>00022 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;PROB&#32;&#32;&#32;&#32;&#32;&#32;(output)&#32;probability&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00023"/>00023 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00024"/>00024 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;In&#32;case&#32;of&#32;natural&#32;elements&#32;use&#32;the&#32;average&#32;A,&#32;not&#32;very&#32;good&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00025"/>00025 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;indeed&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00026"/>00026 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00027"/>00027 <emphasis role="comment">************************************************************************</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00028"/>00028 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">IMPLICIT&#32;DOUBLE&#32;PRECISION</emphasis>&#32;(a-h,o-z)
<anchor xml:id="_xnkama_8_f_source_1l00029"/>00029 <emphasis role="keywordtype">&#32;&#32;&#32;&#32;&#32;&#32;REAL</emphasis>&#32;AWR,R,EIN,EOU,COST,PROB
<anchor xml:id="_xnkama_8_f_source_1l00030"/>00030 &#32;&#32;&#32;&#32;&#32;&#32;parameter(mxavea=109)
<anchor xml:id="_xnkama_8_f_source_1l00031"/>00031 <emphasis role="comment">*&#32;---&gt;&#32;Average&#32;A&#32;for&#32;natural&#32;elements</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00032"/>00032 &#32;&#32;&#32;&#32;&#32;&#32;dimension&#32;avea(mxavea)
<anchor xml:id="_xnkama_8_f_source_1l00033"/>00033 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">DATA</emphasis>&#32;avea&#32;/
<anchor xml:id="_xnkama_8_f_source_1l00034"/>00034 &#32;&#32;&#32;&#32;&#32;+&#32;&#32;1.0001,&#32;&#32;4.0000,&#32;&#32;6.9250,&#32;&#32;9.0000,&#32;10.8010,&#32;12.0110,&#32;14.0031,
<anchor xml:id="_xnkama_8_f_source_1l00035"/>00035 &#32;&#32;&#32;&#32;&#32;+&#32;16.0044,&#32;19.0000,&#32;20.1937,&#32;23.0000,&#32;24.3202,&#32;27.0000,&#32;28.1087,
<anchor xml:id="_xnkama_8_f_source_1l00036"/>00036 &#32;&#32;&#32;&#32;&#32;+&#32;31.0000,&#32;32.0925,&#32;35.4846,&#32;39.9853,&#32;39.1347,&#32;40.1156,&#32;45.0000,
<anchor xml:id="_xnkama_8_f_source_1l00037"/>00037 &#32;&#32;&#32;&#32;&#32;+&#32;47.9300,&#32;50.9975,&#32;52.0554,&#32;55.0000,&#32;55.9155,&#32;59.0000,&#32;58.7541,
<anchor xml:id="_xnkama_8_f_source_1l00038"/>00038 &#32;&#32;&#32;&#32;&#32;+&#32;63.6166,&#32;65.4690,&#32;69.7980,&#32;72.7100,&#32;75.0000,&#32;79.0700,&#32;79.9862,
<anchor xml:id="_xnkama_8_f_source_1l00039"/>00039 &#32;&#32;&#32;&#32;&#32;+&#32;83.8880,&#32;85.5567,&#32;87.7104,&#32;89.0000,&#32;91.3184,&#32;93.0000,&#32;96.0255,
<anchor xml:id="_xnkama_8_f_source_1l00040"/>00040 &#32;&#32;&#32;&#32;&#32;+&#32;97.5000,101.1646,103.0000,106.5111,107.9632,112.5080,114.9140,
<anchor xml:id="_xnkama_8_f_source_1l00041"/>00041 &#32;&#32;&#32;&#32;&#32;+118.8078,121.8540,127.6811,127.0000,131.3882,133.0000,137.4216,
<anchor xml:id="_xnkama_8_f_source_1l00042"/>00042 &#32;&#32;&#32;&#32;&#32;+138.9991,140.2090,141.0000,144.3312,146.0000,150.4420,152.0440,
<anchor xml:id="_xnkama_8_f_source_1l00043"/>00043 &#32;&#32;&#32;&#32;&#32;+157.3281,159.0000,162.5696,165.0000,167.3237,169.0000,173.0960,
<anchor xml:id="_xnkama_8_f_source_1l00044"/>00044 &#32;&#32;&#32;&#32;&#32;+175.0259,178.5416,180.9783,183.8978,186.2520,190.2806,192.2540,
<anchor xml:id="_xnkama_8_f_source_1l00045"/>00045 &#32;&#32;&#32;&#32;&#32;+195.1158,197.0000,200.6278,204.4095,207.2410,209.0000,208.0000,
<anchor xml:id="_xnkama_8_f_source_1l00046"/>00046 &#32;&#32;&#32;&#32;&#32;+210.0000,222.0000,223.0000,226.0000,227.0000,232.0000,231.0000,
<anchor xml:id="_xnkama_8_f_source_1l00047"/>00047 &#32;&#32;&#32;&#32;&#32;+237.9782,237.0000,244.0000,243.0000,247.0000,247.0000,251.0000,
<anchor xml:id="_xnkama_8_f_source_1l00048"/>00048 &#32;&#32;&#32;&#32;&#32;+252.0000,257.0000,258.0000,259.0000,262.0000,260.0000,263.0000,
<anchor xml:id="_xnkama_8_f_source_1l00049"/>00049 &#32;&#32;&#32;&#32;&#32;+263.0000,262.0000,265.0000,266.0000/
<anchor xml:id="_xnkama_8_f_source_1l00050"/>00050 <emphasis role="comment">*&#32;---&gt;&#32;Kalbach&#32;Mann&#32;parameters</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00051"/>00051 &#32;&#32;&#32;&#32;&#32;&#32;parameter(c1=0.04,c2=1.8d-6,c3=6.7d-7,et1=130,et3=41)
<anchor xml:id="_xnkama_8_f_source_1l00052"/>00052 &#32;&#32;&#32;&#32;&#32;&#32;parameter(one=1,half=one/2,onetrd=one/3,twotrd=2*one/3)
<anchor xml:id="_xnkama_8_f_source_1l00053"/>00053 &#32;&#32;&#32;&#32;&#32;&#32;parameter(fortrd=4*one/3)
<anchor xml:id="_xnkama_8_f_source_1l00054"/>00054 &#32;&#32;&#32;&#32;&#32;&#32;parameter(hlmn=one,hsmn=half)
<anchor xml:id="_xnkama_8_f_source_1l00055"/>00055 <emphasis role="comment">*&#32;---&gt;&#32;Fix&#32;parameters&#32;for&#32;incoming&#32;and&#32;outgoing&#32;neutron</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00056"/>00056 &#32;&#32;&#32;&#32;&#32;&#32;parameter(asa=one,zsa=0,hsa=one,asb=one,zsb=0,hsb=0)
<anchor xml:id="_xnkama_8_f_source_1l00057"/>00057 <emphasis role="comment">*&#32;---&gt;&#32;For&#32;speed&#32;do&#32;not&#32;recalculate&#32;separation&#32;energies&#32;if&#32;the&#32;isomer</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00058"/>00058 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;is&#32;the&#32;same</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00059"/>00059 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">DATA</emphasis>&#32;izold&#32;/&#32;-1&#32;/
<anchor xml:id="_xnkama_8_f_source_1l00060"/>00060 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">SAVE</emphasis>&#32;sa,&#32;sb
<anchor xml:id="_xnkama_8_f_source_1l00061"/>00061 <emphasis role="comment">*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00062"/>00062 <emphasis role="comment">*&#32;----------------------------------------------------------------------</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00063"/>00063 <emphasis role="comment">*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00064"/>00064 <emphasis role="comment">*&#32;---&gt;&#32;If&#32;new&#32;isomer&#32;calculate&#32;separation&#32;energies,&#32;liquid&#32;drop&#32;model</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00065"/>00065 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(izat.NE.izold)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00066"/>00066 <emphasis role="comment">*&#32;---&gt;&#32;Target&#32;(A&#32;Large&#32;A,&#32;Z&#32;Large&#32;A,&#32;H&#32;Large&#32;A)</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00067"/>00067 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ala=mod(izat/10,1000)
<anchor xml:id="_xnkama_8_f_source_1l00068"/>00068 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;zla=izat/10000
<anchor xml:id="_xnkama_8_f_source_1l00069"/>00069 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(ala.LE.0)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00070"/>00070 <emphasis role="comment">*&#32;---&gt;&#32;Natural&#32;element,&#32;find&#32;average&#32;A</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00071"/>00071 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ala=avea(nint(zla))
<anchor xml:id="_xnkama_8_f_source_1l00072"/>00072 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00073"/>00073 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;hla=ala-zla
<anchor xml:id="_xnkama_8_f_source_1l00074"/>00074 <emphasis role="comment">*&#32;---&gt;&#32;Compound&#32;nucleus&#32;(A&#32;Small&#32;C,&#32;Z&#32;Small&#32;C,&#32;H&#32;Small&#32;C)</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00075"/>00075 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;asc=ala+1
<anchor xml:id="_xnkama_8_f_source_1l00076"/>00076 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;zsc=zla
<anchor xml:id="_xnkama_8_f_source_1l00077"/>00077 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;hsc=hla+1
<anchor xml:id="_xnkama_8_f_source_1l00078"/>00078 <emphasis role="comment">*&#32;---&gt;&#32;Pseudo&#32;residual&#32;nucleus&#32;(A&#32;Large&#32;B,&#32;Z&#32;Large&#32;B,&#32;H&#32;Large&#32;B)</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00079"/>00079 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;alb=ala
<anchor xml:id="_xnkama_8_f_source_1l00080"/>00080 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;zlb=zla
<anchor xml:id="_xnkama_8_f_source_1l00081"/>00081 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;hlb=hla
<anchor xml:id="_xnkama_8_f_source_1l00082"/>00082 <emphasis role="comment">*&#32;---&gt;&#32;Calculate&#32;SA&#32;and&#32;SB&#32;parameters&#32;(no&#32;breakup&#32;energy&#32;of&#32;target&#32;or</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00083"/>00083 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;emitted&#32;particle&#32;because&#32;it&#32;is&#32;a&#32;neutron!)</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00084"/>00084 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;sa=15.68*(asc-ala)-28.07*((hsc-zsc)**2/asc-(hla-zla)**2/ala)
<anchor xml:id="_xnkama_8_f_source_1l00085"/>00085 &#32;&#32;&#32;&#32;&#32;+&#32;&#32;&#32;-18.56*(asc**twotrd-ala**twotrd)&#32;+33.22*((hsc-zsc)**2/asc**
<anchor xml:id="_xnkama_8_f_source_1l00086"/>00086 &#32;&#32;&#32;&#32;&#32;+&#32;&#32;&#32;fortrd-(hla-zla)**2/ala**fortrd)&#32;-0.717*(zsc**2/asc**
<anchor xml:id="_xnkama_8_f_source_1l00087"/>00087 &#32;&#32;&#32;&#32;&#32;+&#32;&#32;&#32;onetrd-zla**2/ala**onetrd)&#32;+1.211*(zsc**2/asc-zla**2/ala)
<anchor xml:id="_xnkama_8_f_source_1l00088"/>00088 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;sb=15.68*(asc-alb)-28.07*((hsc-zsc)**2/asc-(hlb-zlb)**2/alb)
<anchor xml:id="_xnkama_8_f_source_1l00089"/>00089 &#32;&#32;&#32;&#32;&#32;+&#32;&#32;&#32;-18.56*(asc**twotrd-alb**twotrd)&#32;+33.22*((hsc-zsc)**2/asc**
<anchor xml:id="_xnkama_8_f_source_1l00090"/>00090 &#32;&#32;&#32;&#32;&#32;+&#32;&#32;&#32;fortrd-(hlb-zlb)**2/alb**fortrd)&#32;-0.717*(zsc**2/asc**
<anchor xml:id="_xnkama_8_f_source_1l00091"/>00091 &#32;&#32;&#32;&#32;&#32;+&#32;&#32;&#32;onetrd-zlb**2/alb**onetrd)&#32;+1.211*(zsc**2/asc-zlb**2/alb)
<anchor xml:id="_xnkama_8_f_source_1l00092"/>00092 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;izold=izat
<anchor xml:id="_xnkama_8_f_source_1l00093"/>00093 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00094"/>00094 <emphasis role="comment">*&#32;---&gt;&#32;Calculate&#32;CM&#32;incoming&#32;energy</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00095"/>00095 &#32;&#32;&#32;&#32;&#32;&#32;ecm=ein*(awr/(1+awr))**2
<anchor xml:id="_xnkama_8_f_source_1l00096"/>00096 &#32;&#32;&#32;&#32;&#32;&#32;epcm=eou
<anchor xml:id="_xnkama_8_f_source_1l00097"/>00097 <emphasis role="comment">*&#32;---&gt;&#32;Calculate&#32;a&#32;parameter&#32;of&#32;Kalbach-Mann</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00098"/>00098 &#32;&#32;&#32;&#32;&#32;&#32;ea=ecm*1d-6+sa
<anchor xml:id="_xnkama_8_f_source_1l00099"/>00099 &#32;&#32;&#32;&#32;&#32;&#32;eb=epcm*1d-6+sb
<anchor xml:id="_xnkama_8_f_source_1l00100"/>00100 <emphasis role="comment">*&#32;---&gt;&#32;Input&#32;energy&#32;dependence</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00101"/>00101 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(ea.LE.et1)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00102"/>00102 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;x1=eb
<anchor xml:id="_xnkama_8_f_source_1l00103"/>00103 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">ELSE</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00104"/>00104 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;x1=et1*eb/ea
<anchor xml:id="_xnkama_8_f_source_1l00105"/>00105 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00106"/>00106 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(ea.LE.et3)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00107"/>00107 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;x3=eb
<anchor xml:id="_xnkama_8_f_source_1l00108"/>00108 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">ELSE</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00109"/>00109 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;x3=et3*eb/ea
<anchor xml:id="_xnkama_8_f_source_1l00110"/>00110 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00111"/>00111 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;A=C1*X1+C2*X1**3+C3*HLMN*HSMN*X3**4</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00112"/>00112 &#32;&#32;&#32;&#32;&#32;&#32;a=x1*(c1+c2*x1**2)+c3*hlmn*hsmn*x3**4
<anchor xml:id="_xnkama_8_f_source_1l00113"/>00113 <emphasis role="comment">*&#32;---&gt;&#32;Compute&#32;probability&#32;with&#32;factor&#32;0.5&#32;for&#32;correct&#32;normalisation</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00114"/>00114 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;PROB=0.5*A/SINH(A)*(COSH(A*COST)+R*SINH(A*COST))</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00115"/>00115 &#32;&#32;&#32;&#32;&#32;&#32;expon=exp(a*cost)
<anchor xml:id="_xnkama_8_f_source_1l00116"/>00116 &#32;&#32;&#32;&#32;&#32;&#32;expa=exp(a)
<anchor xml:id="_xnkama_8_f_source_1l00117"/>00117 &#32;&#32;&#32;&#32;&#32;&#32;prob=0.5*a/(expa-one/expa)*((one+r)*expon+(one-r)/expon)
<anchor xml:id="_xnkama_8_f_source_1l00118"/>00118 <emphasis role="comment">*</emphasis>
<anchor xml:id="_xnkama_8_f_source_1l00119"/>00119 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">END</emphasis>
</programlisting></section>
