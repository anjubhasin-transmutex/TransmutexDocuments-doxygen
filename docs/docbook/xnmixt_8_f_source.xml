<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_xnmixt_8_f_source" xml:lang="en-US">
<title>xnmixt.F</title>
<indexterm><primary>/Users/Transmutex/Simulation/ADS_SimulationCode/xnsect/xnsect/src/xnmixt.F</primary></indexterm>
<programlisting linenumbering="unnumbered"><anchor xml:id="_xnmixt_8_f_source_1l00001"/>00001 <emphasis role="comment">*CMZ&#32;:&#32;&#32;2.00/02&#32;03/06/96&#32;&#32;18.59.20&#32;&#32;by&#32;&#32;Federico&#32;Carminati</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00002"/>00002 <emphasis role="comment">*--&#32;Author&#32;:&#32;&#32;&#32;&#32;Federico&#32;Carminati&#32;&#32;&#32;07/03/94</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00003"/>00003 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">SUBROUTINE&#32;</emphasis>xnmixt(IZAMAT,IZAELE,CONCEN,NELEM,CHREAC,NREAC,AMOLEC)
<anchor xml:id="_xnmixt_8_f_source_1l00004"/>00004 <emphasis role="comment">************************************************************************</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00005"/>00005 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00006"/>00006 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;Calculates&#32;and&#32;stores&#32;cross&#32;section&#32;for&#32;mixture&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00007"/>00007 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00008"/>00008 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;IZAMAT&#32;&#32;&#32;&#32;(input)&#32;mixture&#32;code&#32;(user&#32;defined)&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00009"/>00009 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;IZAELE&#32;&#32;&#32;&#32;(input)&#32;array&#32;of&#32;elements&#32;composing&#32;the&#32;mixture&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00010"/>00010 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;CONCEN&#32;&#32;&#32;&#32;(input)&#32;concentration&#32;of&#32;the&#32;elements&#32;composing&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00011"/>00011 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;the&#32;mixture,&#32;either&#32;by&#32;number&#32;(NELEM&gt;0)&#32;or&#32;by&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00012"/>00012 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;weight&#32;(NELEM&lt;0)&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00013"/>00013 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;NELEM&#32;&#32;&#32;&#32;&#32;(input)&#32;number&#32;of&#32;elements&#32;composing&#32;the&#32;mixture&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00014"/>00014 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;CHREAC&#32;&#32;&#32;&#32;(input&#32;CHARACTER*8)&#32;array&#32;of&#32;reaction&#32;codes&#32;to&#32;be&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00015"/>00015 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;calculated&#32;for&#32;the&#32;mixture&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00016"/>00016 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;NREAC&#32;&#32;&#32;&#32;&#32;(input)&#32;number&#32;of&#32;reactions&#32;to&#32;be&#32;calculated&#32;for&#32;the&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00017"/>00017 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;mixture&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00018"/>00018 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;AMOLEC&#32;&#32;&#32;&#32;(input)&#32;molecolar&#32;weight&#32;in&#32;amu&#32;in&#32;case&#32;proportion&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00019"/>00019 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;by&#32;number&#32;is&#32;given&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00020"/>00020 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00021"/>00021 <emphasis role="comment">************************************************************************</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00022"/>00022 <emphasis role="preprocessor">#include&#32;&quot;xcmxse.inc&quot;</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00023"/>00023 <emphasis role="preprocessor"></emphasis><emphasis role="preprocessor">#include&#32;&quot;xcstor.inc&quot;</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00024"/>00024 <emphasis role="preprocessor"></emphasis><emphasis role="preprocessor">#include&#32;&quot;xcpoin.inc&quot;</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00025"/>00025 <emphasis role="preprocessor"></emphasis><emphasis role="preprocessor">#include&#32;&quot;xcnamf.inc&quot;</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00026"/>00026 <emphasis role="preprocessor"></emphasis>&#32;&#32;&#32;&#32;&#32;&#32;parameter(nspace=100&#32;000,maxele=50,perthi=0.02)
<anchor xml:id="_xnmixt_8_f_source_1l00027"/>00027 &#32;&#32;&#32;&#32;&#32;&#32;dimension&#32;izaele(*),concen(*),hinf(nadinf)
<anchor xml:id="_xnmixt_8_f_source_1l00028"/>00028 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">CHARACTER*8</emphasis>&#32;CHREAC(*)
<anchor xml:id="_xnmixt_8_f_source_1l00029"/>00029 &#32;&#32;&#32;&#32;&#32;&#32;dimension&#32;anum(maxele),pnum(maxele),tmpxsc(nspace)
<anchor xml:id="_xnmixt_8_f_source_1l00030"/>00030 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">CHARACTER*2</emphasis>&#32;CHENAM(MAXELE)
<anchor xml:id="_xnmixt_8_f_source_1l00031"/>00031 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">LOGICAL</emphasis>&#32;LOK,LQVAL
<anchor xml:id="_xnmixt_8_f_source_1l00032"/>00032 <emphasis role="comment">*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00033"/>00033 <emphasis role="comment">*-----------------------------------------------------------------------</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00034"/>00034 <emphasis role="comment">*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00035"/>00035 <emphasis role="comment">*&#32;---&gt;&#32;See&#32;whether&#32;it&#32;is&#32;a&#32;new&#32;material&#32;or&#32;not</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00036"/>00036 &#32;&#32;&#32;&#32;&#32;&#32;imate&#32;=&#32;0
<anchor xml:id="_xnmixt_8_f_source_1l00037"/>00037 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">DO</emphasis>&#32;10&#32;jmate=1,nmate
<anchor xml:id="_xnmixt_8_f_source_1l00038"/>00038 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(izamat.EQ.imtabl(1,jmate))&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00039"/>00039 <emphasis role="comment">*&#32;---&gt;&#32;This&#32;isomer&#32;code&#32;is&#32;alread&#32;in&#32;use</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00040"/>00040 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;imate&#32;=&#32;jmate
<anchor xml:id="_xnmixt_8_f_source_1l00041"/>00041 <emphasis role="comment">*&#32;---&gt;&#32;Drop&#32;everything&#32;and&#32;recover&#32;storage</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00042"/>00042 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">CALL&#32;</emphasis>xndrop(izamat,0)
<anchor xml:id="_xnmixt_8_f_source_1l00043"/>00043 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">GOTO</emphasis>&#32;20
<anchor xml:id="_xnmixt_8_f_source_1l00044"/>00044 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00045"/>00045 &#32;&#32;&#32;10&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00046"/>00046 <emphasis role="comment">*&#32;---&gt;&#32;New&#32;material,&#32;check&#32;if&#32;there&#32;is&#32;space&#32;in&#32;index&#32;table&#32;IMTABL</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00047"/>00047 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(nmate.GE.mxmate)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00048"/>00048 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">WRITE</emphasis>(6,<emphasis role="stringliteral">&apos;(&apos;</emphasis><emphasis role="stringliteral">&apos;&#32;***&#32;XNMIXT&#32;No&#32;more&#32;space&#32;to&#32;store&#32;materials&apos;</emphasis><emphasis role="stringliteral">&apos;)&apos;</emphasis>)
<anchor xml:id="_xnmixt_8_f_source_1l00049"/>00049 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">GOTO</emphasis>&#32;999
<anchor xml:id="_xnmixt_8_f_source_1l00050"/>00050 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00051"/>00051 <emphasis role="comment">*&#32;---&gt;&#32;Add&#32;new&#32;code&#32;for&#32;the&#32;mixture</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00052"/>00052 &#32;&#32;&#32;&#32;&#32;&#32;nmate&#32;=&#32;nmate+1
<anchor xml:id="_xnmixt_8_f_source_1l00053"/>00053 &#32;&#32;&#32;&#32;&#32;&#32;imate&#32;=&#32;nmate
<anchor xml:id="_xnmixt_8_f_source_1l00054"/>00054 &#32;&#32;&#32;&#32;&#32;&#32;imtabl(1,imate)=izamat
<anchor xml:id="_xnmixt_8_f_source_1l00055"/>00055 &#32;&#32;&#32;20&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00056"/>00056 <emphasis role="comment">*&#32;---&gt;&#32;Save&#32;high&#32;water&#32;mark</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00057"/>00057 &#32;&#32;&#32;&#32;&#32;&#32;ihgold&#32;=&#32;ihgwmk
<anchor xml:id="_xnmixt_8_f_source_1l00058"/>00058 &#32;&#32;&#32;&#32;&#32;&#32;nmatol&#32;=&#32;nmate
<anchor xml:id="_xnmixt_8_f_source_1l00059"/>00059 &#32;&#32;&#32;&#32;&#32;&#32;mreac=nreac
<anchor xml:id="_xnmixt_8_f_source_1l00060"/>00060 <emphasis role="comment">*&#32;---&gt;&#32;If&#32;NREAC=0,&#32;all&#32;reaction&#32;handled</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00061"/>00061 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(nreac.EQ.0)&#32;mreac=mxreac
<anchor xml:id="_xnmixt_8_f_source_1l00062"/>00062 <emphasis role="comment">*&#32;---&gt;&#32;Loop&#32;over&#32;all&#32;reactions</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00063"/>00063 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">DO</emphasis>&#32;150&#32;jreac=1,mreac
<anchor xml:id="_xnmixt_8_f_source_1l00064"/>00064 <emphasis role="comment">*&#32;---&gt;&#32;Find&#32;reaction&#32;if&#32;not&#32;all&#32;asked</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00065"/>00065 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(nreac.GT.0)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00066"/>00066 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">DO</emphasis>&#32;30&#32;lreac=1,mxreac
<anchor xml:id="_xnmixt_8_f_source_1l00067"/>00067 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(chreac(jreac).EQ.chname(lreac))&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00068"/>00068 <emphasis role="comment">*&#32;---&gt;&#32;Found&#32;reaction&#32;in&#32;list</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00069"/>00069 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ircode=3000+nbmft(lreac)
<anchor xml:id="_xnmixt_8_f_source_1l00070"/>00070 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;irnumb=lreac
<anchor xml:id="_xnmixt_8_f_source_1l00071"/>00071 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">GOTO</emphasis>&#32;40
<anchor xml:id="_xnmixt_8_f_source_1l00072"/>00072 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00073"/>00073 &#32;&#32;&#32;30&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00074"/>00074 <emphasis role="comment">*&#32;---&gt;&#32;Reaction&#32;not&#32;found&#32;in&#32;list,&#32;stop</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00075"/>00075 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">WRITE</emphasis>(6,<emphasis role="stringliteral">&apos;(&apos;</emphasis><emphasis role="stringliteral">&apos;&#32;***&#32;XNMIXT:&#32;Unknown&#32;reaction&#32;&apos;</emphasis><emphasis role="stringliteral">&apos;,A4)&apos;</emphasis>)&#32;chreac(j
<anchor xml:id="_xnmixt_8_f_source_1l00076"/>00076 &#32;&#32;&#32;&#32;&#32;+&#32;&#32;&#32;&#32;&#32;&#32;reac&#32;)
<anchor xml:id="_xnmixt_8_f_source_1l00077"/>00077 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;stop
<anchor xml:id="_xnmixt_8_f_source_1l00078"/>00078 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">ELSE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00079"/>00079 <emphasis role="comment">*&#32;---&gt;&#32;All&#32;reaction&#32;asked,&#32;just&#32;load&#32;combined&#32;reaction&#32;code...</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00080"/>00080 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ircode&#32;=&#32;3000+nbmft(jreac)
<anchor xml:id="_xnmixt_8_f_source_1l00081"/>00081 <emphasis role="comment">*&#32;---&gt;&#32;...and&#32;pointer&#32;to&#32;the&#32;&quot;column&quot;&#32;of&#32;the&#32;IMTABL&#32;index&#32;table</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00082"/>00082 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;irnumb&#32;=&#32;jreac
<anchor xml:id="_xnmixt_8_f_source_1l00083"/>00083 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00084"/>00084 <emphasis role="comment">*&#32;---&gt;&#32;Here&#32;the&#32;work&#32;starts&#32;for&#32;this&#32;reaction</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00085"/>00085 &#32;&#32;&#32;40&#32;&#32;&#32;&#32;hnorm&#32;=&#32;0.
<anchor xml:id="_xnmixt_8_f_source_1l00086"/>00086 <emphasis role="comment">*&#32;---&gt;&#32;decode&#32;reaction&#32;code</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00087"/>00087 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;mf&#32;=&#32;ircode/1000
<anchor xml:id="_xnmixt_8_f_source_1l00088"/>00088 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;mt&#32;=&#32;mod(ircode,1000)
<anchor xml:id="_xnmixt_8_f_source_1l00089"/>00089 <emphasis role="comment">*&#32;---&gt;&#32;Threshold&#32;reaction?</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00090"/>00090 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;qval&#32;=&#32;0.
<anchor xml:id="_xnmixt_8_f_source_1l00091"/>00091 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;lqval=.false.
<anchor xml:id="_xnmixt_8_f_source_1l00092"/>00092 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(mf.EQ.3.AND.&#32;(mt.EQ.4.OR.(51.LE.mt.AND.mt.LE.91)
<anchor xml:id="_xnmixt_8_f_source_1l00093"/>00093 &#32;&#32;&#32;&#32;&#32;+&#32;&#32;&#32;.OR.mt.EQ.16))&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00094"/>00094 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;lqval=.true.
<anchor xml:id="_xnmixt_8_f_source_1l00095"/>00095 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00096"/>00096 <emphasis role="comment">*&#32;---&gt;&#32;Loop&#32;on&#32;all&#32;materials</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00097"/>00097 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">DO</emphasis>&#32;120&#32;jelem=1,abs(nelem)
<anchor xml:id="_xnmixt_8_f_source_1l00098"/>00098 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;hinteg&#32;=&#32;0.
<anchor xml:id="_xnmixt_8_f_source_1l00099"/>00099 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(jreac.EQ.1)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00100"/>00100 <emphasis role="comment">*&#32;---&gt;&#32;Load&#32;total&#32;cross&#32;section&#32;to&#32;have&#32;A&#32;in&#32;amu</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00101"/>00101 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">CALL&#32;</emphasis>xninfo(izaele(jelem),anum(jelem),chenam(jelem))
<anchor xml:id="_xnmixt_8_f_source_1l00102"/>00102 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;anum(jelem)&#32;=&#32;anum(jelem)/.931141
<anchor xml:id="_xnmixt_8_f_source_1l00103"/>00103 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(nelem.GT.0.)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00104"/>00104 <emphasis role="comment">*&#32;---&gt;&#32;Proportion&#32;by&#32;number</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00105"/>00105 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;pnum(jelem)&#32;=&#32;concen(jelem)*amolec/anum(jelem)
<anchor xml:id="_xnmixt_8_f_source_1l00106"/>00106 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">ELSE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00107"/>00107 <emphasis role="comment">*&#32;---&gt;&#32;Proportion&#32;by&#32;weight</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00108"/>00108 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;pnum(jelem)&#32;=&#32;concen(jelem)
<anchor xml:id="_xnmixt_8_f_source_1l00109"/>00109 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00110"/>00110 <emphasis role="comment">*&#32;---&gt;&#32;Reset&#32;old&#32;HiGh&#32;Water&#32;MarK&#32;and&#32;recuperate&#32;storage</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00111"/>00111 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ihgwmk&#32;=&#32;ihgold
<anchor xml:id="_xnmixt_8_f_source_1l00112"/>00112 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00113"/>00113 <emphasis role="comment">*&#32;---&gt;&#32;Load&#32;the&#32;current</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00114"/>00114 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">CALL&#32;</emphasis>xntabl(izaele(jelem),ircode,ima)
<anchor xml:id="_xnmixt_8_f_source_1l00115"/>00115 <emphasis role="comment">*&#32;---&gt;&#32;Get&#32;start&#32;and&#32;length&#32;of&#32;data&#32;in&#32;memory</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00116"/>00116 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">CALL&#32;</emphasis>xngetm(izaele(jelem),ircode,ista,ilen,hinf)
<anchor xml:id="_xnmixt_8_f_source_1l00117"/>00117 <emphasis role="comment">*&#32;---&gt;&#32;If&#32;this&#32;is&#32;a&#32;cross&#32;section,&#32;number&#32;of&#32;pairs&#32;is&#32;returned</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00118"/>00118 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(mf.EQ.3)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00119"/>00119 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ilen=ilen*2
<anchor xml:id="_xnmixt_8_f_source_1l00120"/>00120 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00121"/>00121 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(ima.NE.0)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00122"/>00122 <emphasis role="comment">*&#32;---&gt;&#32;If&#32;something&#32;has&#32;been&#32;loaded</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00123"/>00123 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(jelem.EQ.1)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00124"/>00124 <emphasis role="comment">*&#32;---&gt;&#32;If&#32;this&#32;is&#32;the&#32;first&#32;element&#32;of&#32;the&#32;mixture</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00125"/>00125 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(ilen.GT.0)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00126"/>00126 <emphasis role="comment">*&#32;---&gt;&#32;If&#32;data&#32;was&#32;present</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00127"/>00127 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(ilen.GT.nspace)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00128"/>00128 <emphasis role="comment">*&#32;---&gt;&#32;Error,&#32;not&#32;enough&#32;work&#32;space&#32;for&#32;cross&#32;section</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00129"/>00129 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">WRITE</emphasis>(6,10000)
<anchor xml:id="_xnmixt_8_f_source_1l00130"/>00130 10000&#32;<emphasis role="keyword">FORMAT</emphasis>(<emphasis role="stringliteral">&apos;&#32;***&#32;XNMIXT:&#32;not&#32;enough&#32;internal&#32;storage&#32;for&#32;elements&apos;</emphasis>)
<anchor xml:id="_xnmixt_8_f_source_1l00131"/>00131 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;stop&#32;<emphasis role="stringliteral">&apos;Increase&#32;NSPACE&apos;</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00132"/>00132 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00133"/>00133 <emphasis role="comment">*&#32;---&gt;&#32;Store&#32;cross&#32;section&#32;and&#32;calculate&#32;integral</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00134"/>00134 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(1)&#32;=&#32;xstore(ista+1)
<anchor xml:id="_xnmixt_8_f_source_1l00135"/>00135 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(2)&#32;=&#32;xstore(ista+2)*pnum(jelem)
<anchor xml:id="_xnmixt_8_f_source_1l00136"/>00136 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">DO</emphasis>&#32;50&#32;j=3,ilen-1,2
<anchor xml:id="_xnmixt_8_f_source_1l00137"/>00137 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(j&#32;)&#32;=&#32;xstore(ista+j)
<anchor xml:id="_xnmixt_8_f_source_1l00138"/>00138 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(j+1)&#32;=&#32;xstore(ista+j+1)*pnum(jelem)
<anchor xml:id="_xnmixt_8_f_source_1l00139"/>00139 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;hinteg&#32;=&#32;hinteg&#32;+&#32;0.5*(tmpxsc(j-1)+tmpxsc(j+1))
<anchor xml:id="_xnmixt_8_f_source_1l00140"/>00140 &#32;&#32;&#32;&#32;&#32;+&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*&#32;(tmpxsc(j)-&#32;tmpxsc(j-2))
<anchor xml:id="_xnmixt_8_f_source_1l00141"/>00141 &#32;&#32;&#32;50&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00142"/>00142 <emphasis role="comment">*&#32;---&gt;&#32;Set&#32;high&#32;water&#32;mark&#32;in&#32;TMPXSC</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00143"/>00143 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ilengt&#32;=&#32;ilen
<anchor xml:id="_xnmixt_8_f_source_1l00144"/>00144 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">ELSE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00145"/>00145 <emphasis role="comment">*&#32;---&gt;&#32;No&#32;cross&#32;section&#32;present&#32;for&#32;this&#32;reaction,&#32;set&#32;it&#32;all&#32;to&#32;0</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00146"/>00146 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ilengt&#32;=&#32;2
<anchor xml:id="_xnmixt_8_f_source_1l00147"/>00147 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(1)&#32;=&#32;1e-5
<anchor xml:id="_xnmixt_8_f_source_1l00148"/>00148 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(2)&#32;=&#32;0
<anchor xml:id="_xnmixt_8_f_source_1l00149"/>00149 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(3)&#32;=&#32;2e7
<anchor xml:id="_xnmixt_8_f_source_1l00150"/>00150 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(4)&#32;=&#32;0
<anchor xml:id="_xnmixt_8_f_source_1l00151"/>00151 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00152"/>00152 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">ELSE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00153"/>00153 <emphasis role="comment">*&#32;---&gt;&#32;Not&#32;the&#32;first&#32;element&#32;for&#32;this&#32;reaction,&#32;this&#32;is&#32;more&#32;complicate</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00154"/>00154 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;because&#32;we&#32;have&#32;to&#32;insert&#32;points</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00155"/>00155 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">DO</emphasis>&#32;80&#32;j=ista+1,ista+ilen-1,2
<anchor xml:id="_xnmixt_8_f_source_1l00156"/>00156 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ene&#32;=&#32;xstore(j)
<anchor xml:id="_xnmixt_8_f_source_1l00157"/>00157 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(j.GT.1)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00158"/>00158 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;hinteg&#32;=&#32;hinteg&#32;+&#32;0.5*(xstore(j-1)+xstore(j+1))
<anchor xml:id="_xnmixt_8_f_source_1l00159"/>00159 &#32;&#32;&#32;&#32;&#32;+&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*&#32;(xstore(j&#32;)-xstore(j-2))
<anchor xml:id="_xnmixt_8_f_source_1l00160"/>00160 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00161"/>00161 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(ene.LT.tmpxsc(1))&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00162"/>00162 <emphasis role="comment">*&#32;---&gt;&#32;Add&#32;a&#32;new&#32;low&#32;point&#32;assume&#32;a&#32;threshold,&#32;set&#32;to&#32;0&#32;its&#32;cross&#32;section</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00163"/>00163 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;and&#32;all&#32;the&#32;others&#32;and&#32;move&#32;everything&#32;by&#32;1&#32;pair</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00164"/>00164 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">DO</emphasis>&#32;60&#32;jj=ilengt,1,-1
<anchor xml:id="_xnmixt_8_f_source_1l00165"/>00165 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(jj+2)&#32;=&#32;tmpxsc(jj)
<anchor xml:id="_xnmixt_8_f_source_1l00166"/>00166 &#32;&#32;&#32;60&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00167"/>00167 <emphasis role="comment">*&#32;---&gt;&#32;New&#32;low&#32;point</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00168"/>00168 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(1)&#32;=&#32;ene
<anchor xml:id="_xnmixt_8_f_source_1l00169"/>00169 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(2)&#32;=&#32;0.
<anchor xml:id="_xnmixt_8_f_source_1l00170"/>00170 <emphasis role="comment">*&#32;---&gt;&#32;New&#32;length</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00171"/>00171 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ilengt=ilengt+2
<anchor xml:id="_xnmixt_8_f_source_1l00172"/>00172 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(ilengt.GT.nspace)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00173"/>00173 <emphasis role="comment">*&#32;---&gt;&#32;Do&#32;we&#32;still&#32;have&#32;enough&#32;space?</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00174"/>00174 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">WRITE</emphasis>(6,10100)
<anchor xml:id="_xnmixt_8_f_source_1l00175"/>00175 10100&#32;<emphasis role="keyword">FORMAT</emphasis>(<emphasis role="stringliteral">&apos;&#32;***&#32;XNMIXT:&#32;not&#32;enough&#32;internal&#32;storage&#32;for&#32;elements&apos;</emphasis>)
<anchor xml:id="_xnmixt_8_f_source_1l00176"/>00176 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;stop&#32;<emphasis role="stringliteral">&apos;Increase&#32;NSPACE&apos;</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00177"/>00177 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00178"/>00178 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">ELSEIF</emphasis>(ene.GT.tmpxsc(ilengt-1))&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00179"/>00179 <emphasis role="comment">*&#32;---&gt;&#32;Add&#32;a&#32;new&#32;high&#32;point&#32;assume&#32;plateau&#32;behaviour&#32;for&#32;the&#32;other</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00180"/>00180 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;cross&#32;sections</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00181"/>00181 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(ilengt+1)&#32;=&#32;ene
<anchor xml:id="_xnmixt_8_f_source_1l00182"/>00182 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(ilengt+2)&#32;=&#32;tmpxsc(ilengt)
<anchor xml:id="_xnmixt_8_f_source_1l00183"/>00183 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ilengt=ilengt+2
<anchor xml:id="_xnmixt_8_f_source_1l00184"/>00184 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(ilengt.GT.nspace)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00185"/>00185 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">WRITE</emphasis>(6,10200)
<anchor xml:id="_xnmixt_8_f_source_1l00186"/>00186 10200&#32;<emphasis role="keyword">FORMAT</emphasis>(<emphasis role="stringliteral">&apos;&#32;***&#32;XNMIXT:&#32;not&#32;enough&#32;internal&#32;storage&#32;for&#32;elements&apos;</emphasis>)
<anchor xml:id="_xnmixt_8_f_source_1l00187"/>00187 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;stop&#32;<emphasis role="stringliteral">&apos;Increase&#32;NSPACE&apos;</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00188"/>00188 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00189"/>00189 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">ELSE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00190"/>00190 <emphasis role="comment">*&#32;---&gt;&#32;Add&#32;point&#32;in&#32;the&#32;middle,&#32;find&#32;where&#32;to&#32;add&#32;it</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00191"/>00191 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">CALL&#32;</emphasis>xnbins(tmpxsc,ilengt/2,2,ene,iret)
<anchor xml:id="_xnmixt_8_f_source_1l00192"/>00192 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;iret1&#32;=&#32;2*iret-1
<anchor xml:id="_xnmixt_8_f_source_1l00193"/>00193 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(tmpxsc(iret1).NE.ene)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00194"/>00194 <emphasis role="comment">*&#32;---&gt;&#32;Point&#32;has&#32;to&#32;be&#32;added&#32;because&#32;not&#32;there,&#32;interpolate&#32;the&#32;old</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00195"/>00195 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;cross&#32;section</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00196"/>00196 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;xrat=(tmpxsc(iret1+2)-ene)/(tmpxsc(iret1+2)-
<anchor xml:id="_xnmixt_8_f_source_1l00197"/>00197 &#32;&#32;&#32;&#32;&#32;+&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(iret1)&#32;)
<anchor xml:id="_xnmixt_8_f_source_1l00198"/>00198 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;sect&#32;=&#32;tmpxsc(iret1+1)*xrat+tmpxsc(iret1+3)*
<anchor xml:id="_xnmixt_8_f_source_1l00199"/>00199 &#32;&#32;&#32;&#32;&#32;+&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;(1-&#32;xrat)
<anchor xml:id="_xnmixt_8_f_source_1l00200"/>00200 <emphasis role="comment">*&#32;---&#32;Add&#32;the&#32;point&#32;shifting&#32;everything&#32;up&#32;by&#32;1&#32;pair</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00201"/>00201 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">DO</emphasis>&#32;70&#32;ll=&#32;ilengt,iret1+2,-1
<anchor xml:id="_xnmixt_8_f_source_1l00202"/>00202 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(ll+2)&#32;=&#32;tmpxsc(ll)
<anchor xml:id="_xnmixt_8_f_source_1l00203"/>00203 &#32;&#32;&#32;70&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00204"/>00204 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(iret1+2)&#32;=&#32;ene
<anchor xml:id="_xnmixt_8_f_source_1l00205"/>00205 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(iret1+3)&#32;=&#32;sect
<anchor xml:id="_xnmixt_8_f_source_1l00206"/>00206 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ilengt=ilengt+2
<anchor xml:id="_xnmixt_8_f_source_1l00207"/>00207 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(ilengt.GT.nspace)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00208"/>00208 <emphasis role="comment">*&#32;---&gt;&#32;Do&#32;we&#32;still&#32;have&#32;space?</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00209"/>00209 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">WRITE</emphasis>(6,10300)
<anchor xml:id="_xnmixt_8_f_source_1l00210"/>00210 10300&#32;<emphasis role="keyword">FORMAT</emphasis>(<emphasis role="stringliteral">&apos;&#32;***&#32;XNMIXT:&#32;not&#32;enough&#32;internal&#32;storage&#32;for&#32;elements&apos;</emphasis>)
<anchor xml:id="_xnmixt_8_f_source_1l00211"/>00211 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;stop&#32;<emphasis role="stringliteral">&apos;Increase&#32;NSPACE&apos;</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00212"/>00212 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00213"/>00213 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00214"/>00214 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00215"/>00215 &#32;&#32;&#32;80&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00216"/>00216 <emphasis role="comment">*&#32;---&gt;&#32;Here&#32;we&#32;do&#32;add&#32;the&#32;new&#32;values</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00217"/>00217 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">DO</emphasis>&#32;90&#32;jp=1,ilengt-1,2
<anchor xml:id="_xnmixt_8_f_source_1l00218"/>00218 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">CALL&#32;</emphasis>xnbint(ista,ilen/2,tmpxsc(jp),sect)
<anchor xml:id="_xnmixt_8_f_source_1l00219"/>00219 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(jp+1)=tmpxsc(jp+1)+sect*pnum(jelem)
<anchor xml:id="_xnmixt_8_f_source_1l00220"/>00220 &#32;&#32;&#32;90&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00221"/>00221 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00222"/>00222 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00223"/>00223 <emphasis role="comment">*&#32;---&gt;&#32;We&#32;calculate&#32;the&#32;total&#32;integral</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00224"/>00224 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;hinteg&#32;=&#32;hinteg*pnum(jelem)
<anchor xml:id="_xnmixt_8_f_source_1l00225"/>00225 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;hnorm=hnorm+hinteg
<anchor xml:id="_xnmixt_8_f_source_1l00226"/>00226 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(lqval)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00227"/>00227 <emphasis role="comment">*&#32;---&gt;&#32;If&#32;this&#32;is&#32;a&#32;threshold&#32;reaction&#32;we&#32;add&#32;the&#32;QVAL&#32;to&#32;the&#32;average</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00228"/>00228 <emphasis role="comment">*&#32;&#32;&#32;&#32;&#32;&#32;QVAL&#32;weighted&#32;by&#32;the&#32;cross&#32;section&#32;integral</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00229"/>00229 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;qval&#32;=&#32;qval+hinf(1)*hinteg
<anchor xml:id="_xnmixt_8_f_source_1l00230"/>00230 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00231"/>00231 <emphasis role="comment">*&#32;---&gt;&#32;Recover&#32;space&#32;and&#32;slot&#32;in&#32;the&#32;index&#32;table</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00232"/>00232 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ihgwmk=ihgold
<anchor xml:id="_xnmixt_8_f_source_1l00233"/>00233 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">DO</emphasis>&#32;110&#32;jma=nmatol+1,nmate
<anchor xml:id="_xnmixt_8_f_source_1l00234"/>00234 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">DO</emphasis>&#32;100&#32;jze=1,nreinf*mxreac+1
<anchor xml:id="_xnmixt_8_f_source_1l00235"/>00235 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;imtabl(jze,jma)=0
<anchor xml:id="_xnmixt_8_f_source_1l00236"/>00236 &#32;&#32;100&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00237"/>00237 &#32;&#32;110&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00238"/>00238 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;nmate&#32;=&#32;nmatol
<anchor xml:id="_xnmixt_8_f_source_1l00239"/>00239 &#32;&#32;120&#32;&#32;&#32;&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00240"/>00240 <emphasis role="comment">*&#32;---&gt;&#32;Thin&#32;cross&#32;section</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00241"/>00241 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ilsave&#32;=&#32;ilengt
<anchor xml:id="_xnmixt_8_f_source_1l00242"/>00242 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ip=3
<anchor xml:id="_xnmixt_8_f_source_1l00243"/>00243 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ie=5
<anchor xml:id="_xnmixt_8_f_source_1l00244"/>00244 &#32;&#32;130&#32;&#32;&#32;&#32;lok=.true.
<anchor xml:id="_xnmixt_8_f_source_1l00245"/>00245 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(tmpxsc(ip).EQ.tmpxsc(ie))&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00246"/>00246 <emphasis role="comment">*&#32;---&gt;&#32;Repeated&#32;energy,&#32;thin</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00247"/>00247 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;lok=.false.
<anchor xml:id="_xnmixt_8_f_source_1l00248"/>00248 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">ELSE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00249"/>00249 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;xrat&#32;=&#32;(tmpxsc(ip)-tmpxsc(ip-2))/&#32;(tmpxsc(ie)-tmpxsc(ip-2))
<anchor xml:id="_xnmixt_8_f_source_1l00250"/>00250 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tsec&#32;=&#32;tmpxsc(ip-1)*xrat+tmpxsc(ie+1)*(1-xrat)
<anchor xml:id="_xnmixt_8_f_source_1l00251"/>00251 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(abs(tsec-tmpxsc(ip+1)).LE.perthi*tmpxsc(ip+1))&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00252"/>00252 <emphasis role="comment">*&#32;---&gt;&#32;Useless&#32;point,&#32;thin</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00253"/>00253 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;lok=.false.
<anchor xml:id="_xnmixt_8_f_source_1l00254"/>00254 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00255"/>00255 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00256"/>00256 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(lok)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00257"/>00257 <emphasis role="comment">*&#32;---&gt;&#32;This&#32;poin&#32;ok,&#32;keep&#32;it</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00258"/>00258 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ip&#32;=&#32;ip+2
<anchor xml:id="_xnmixt_8_f_source_1l00259"/>00259 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00260"/>00260 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(ie.GT.ip)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00261"/>00261 <emphasis role="comment">*&#32;---&gt;&#32;Copy&#32;only&#32;if&#32;data&#32;has&#32;to&#32;be&#32;moved</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00262"/>00262 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(ip)=tmpxsc(ie)
<anchor xml:id="_xnmixt_8_f_source_1l00263"/>00263 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tmpxsc(ip+1)=tmpxsc(ie+1)
<anchor xml:id="_xnmixt_8_f_source_1l00264"/>00264 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00265"/>00265 <emphasis role="comment">*&#32;---&gt;&#32;Take&#32;next&#32;point</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00266"/>00266 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ie=ie+2
<anchor xml:id="_xnmixt_8_f_source_1l00267"/>00267 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(ie.LT.ilengt)&#32;<emphasis role="keywordflow">GOTO</emphasis>&#32;130
<anchor xml:id="_xnmixt_8_f_source_1l00268"/>00268 <emphasis role="comment">*&#32;---&gt;&#32;Thinning&#32;ended,&#32;print&#32;summary</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00269"/>00269 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ilengt&#32;=&#32;ilengt-(ie-ip-2)
<anchor xml:id="_xnmixt_8_f_source_1l00270"/>00270 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">WRITE</emphasis>(6,<emphasis role="stringliteral">&apos;(1X,E11.4,&apos;</emphasis><emphasis role="stringliteral">&apos;&#32;%&#32;thinning&apos;</emphasis><emphasis role="stringliteral">&apos;)&apos;</emphasis>)&#32;100.*ilengt/ilsave
<anchor xml:id="_xnmixt_8_f_source_1l00271"/>00271 <emphasis role="comment">*&#32;---&gt;&#32;Insert&#32;reaction&#32;in&#32;table</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00272"/>00272 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;imtabl(1+nreinf*(irnumb-1)+1,imate)=ihgwmk
<anchor xml:id="_xnmixt_8_f_source_1l00273"/>00273 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(mf.EQ.3)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00274"/>00274 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;imtabl(1+nreinf*(irnumb-1)+2,imate)=ilengt/2
<anchor xml:id="_xnmixt_8_f_source_1l00275"/>00275 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">ELSE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00276"/>00276 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;imtabl(1+nreinf*(irnumb-1)+2,imate)=ilengt
<anchor xml:id="_xnmixt_8_f_source_1l00277"/>00277 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00278"/>00278 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(lqval)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00279"/>00279 <emphasis role="comment">*&#32;---&gt;&#32;Reaction&#32;with&#32;a&#32;Q&#32;value,&#32;calculate&#32;average&#32;one</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00280"/>00280 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">IF</emphasis>(hnorm.GT.0.)&#32;<emphasis role="keywordflow">THEN</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00281"/>00281 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;qval=qval/hnorm
<anchor xml:id="_xnmixt_8_f_source_1l00282"/>00282 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">ELSE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00283"/>00283 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;qval&#32;=&#32;0.
<anchor xml:id="_xnmixt_8_f_source_1l00284"/>00284 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00285"/>00285 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;hmtabl(1+nreinf*(irnumb-1)+2+1,imate)=qval
<anchor xml:id="_xnmixt_8_f_source_1l00286"/>00286 <emphasis role="keywordflow">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ENDIF</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00287"/>00287 <emphasis role="comment">*&#32;---&gt;&#32;Load&#32;reaction&#32;in&#32;memory</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00288"/>00288 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">DO</emphasis>&#32;140&#32;jp=1,ilengt
<anchor xml:id="_xnmixt_8_f_source_1l00289"/>00289 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;xstore(ihgwmk+jp)=tmpxsc(jp)
<anchor xml:id="_xnmixt_8_f_source_1l00290"/>00290 &#32;&#32;140&#32;&#32;&#32;&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00291"/>00291 <emphasis role="comment">*&#32;---&gt;&#32;Reset&#32;high&#32;water&#32;mark</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00292"/>00292 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ihgwmk&#32;=&#32;ihgwmk+ilengt
<anchor xml:id="_xnmixt_8_f_source_1l00293"/>00293 <emphasis role="comment">*&#32;---&gt;&#32;Save&#32;current&#32;high&#32;water&#32;mark</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00294"/>00294 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ihgold&#32;=&#32;ihgwmk
<anchor xml:id="_xnmixt_8_f_source_1l00295"/>00295 &#32;&#32;150&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00296"/>00296 <emphasis role="comment">*&#32;---&gt;&#32;Here&#32;we&#32;print&#32;a&#32;little&#32;table</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00297"/>00297 &#32;&#32;&#32;&#32;&#32;&#32;amo&#32;=&#32;0.
<anchor xml:id="_xnmixt_8_f_source_1l00298"/>00298 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">DO</emphasis>&#32;160&#32;jel=1,abs(nelem)
<anchor xml:id="_xnmixt_8_f_source_1l00299"/>00299 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;amo&#32;=&#32;amo+pnum(jel)*anum(jel)
<anchor xml:id="_xnmixt_8_f_source_1l00300"/>00300 &#32;&#32;160&#32;<emphasis role="keywordflow">CONTINUE</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00301"/>00301 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">WRITE</emphasis>(6,<emphasis role="stringliteral">&apos;(&apos;</emphasis><emphasis role="stringliteral">&apos;&#32;&#32;Element&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;Ratio&apos;</emphasis><emphasis role="stringliteral">&apos;)&apos;</emphasis>)
<anchor xml:id="_xnmixt_8_f_source_1l00302"/>00302 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">WRITE</emphasis>(6,<emphasis role="stringliteral">&apos;(&apos;</emphasis><emphasis role="stringliteral">&apos;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;by&#32;number&#32;&#32;&#32;&#32;&#32;&#32;&#32;by&#32;weight&apos;</emphasis><emphasis role="stringliteral">&apos;)&apos;</emphasis>)
<anchor xml:id="_xnmixt_8_f_source_1l00303"/>00303 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">WRITE</emphasis>(6,<emphasis role="stringliteral">&apos;(4X,A2,7X,E11.4,6X,E11.4)&apos;</emphasis>)
<anchor xml:id="_xnmixt_8_f_source_1l00304"/>00304 &#32;&#32;&#32;&#32;&#32;+&#32;(chenam(ll),pnum(ll),pnum(ll)*anum(ll)/amo,ll=1,abs(nelem))
<anchor xml:id="_xnmixt_8_f_source_1l00305"/>00305 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">WRITE</emphasis>(6,<emphasis role="stringliteral">&apos;(&apos;</emphasis><emphasis role="stringliteral">&apos;&#32;Apparent&#32;molecular&#32;weight&#32;of&#32;mixture&#32;=&#32;&apos;</emphasis><emphasis role="stringliteral">&apos;,E11.4)&apos;</emphasis>)
<anchor xml:id="_xnmixt_8_f_source_1l00306"/>00306 &#32;&#32;&#32;&#32;&#32;+&#32;&#32;&#32;&#32;&#32;amo
<anchor xml:id="_xnmixt_8_f_source_1l00307"/>00307 <emphasis role="comment">*</emphasis>
<anchor xml:id="_xnmixt_8_f_source_1l00308"/>00308 &#32;&#32;999&#32;<emphasis role="keyword">END</emphasis>
</programlisting></section>
