<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="__benchmark-2_2ads__transmutex_8cc_source" xml:lang="en-US">
<title>ads_transmutex.cc</title>
<indexterm><primary>/Users/Transmutex/Simulation/ADS_SimulationCode/Benchmark-2/ads_transmutex.cc</primary></indexterm>
<programlisting linenumbering="unnumbered"><anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00001"/>00001 <emphasis role="comment">//</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00002"/>00002 <emphasis role="comment">//&#32;********************************************************************</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00003"/>00003 <emphasis role="comment">//&#32;*&#32;License&#32;and&#32;Disclaimer&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00004"/>00004 <emphasis role="comment">//&#32;*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00005"/>00005 <emphasis role="comment">//&#32;*&#32;The&#32;&#32;Geant4&#32;software&#32;&#32;is&#32;&#32;copyright&#32;of&#32;the&#32;Copyright&#32;Holders&#32;&#32;of&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00006"/>00006 <emphasis role="comment">//&#32;*&#32;the&#32;Geant4&#32;Collaboration.&#32;&#32;It&#32;is&#32;provided&#32;&#32;under&#32;&#32;the&#32;terms&#32;&#32;and&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00007"/>00007 <emphasis role="comment">//&#32;*&#32;conditions&#32;of&#32;the&#32;Geant4&#32;Software&#32;License,&#32;&#32;included&#32;in&#32;the&#32;file&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00008"/>00008 <emphasis role="comment">//&#32;*&#32;LICENSE&#32;and&#32;available&#32;at&#32;&#32;http://cern.ch/geant4/license&#32;.&#32;&#32;These&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00009"/>00009 <emphasis role="comment">//&#32;*&#32;include&#32;a&#32;list&#32;of&#32;copyright&#32;holders.&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00010"/>00010 <emphasis role="comment">//&#32;*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00011"/>00011 <emphasis role="comment">//&#32;*&#32;Neither&#32;the&#32;authors&#32;of&#32;this&#32;software&#32;system,&#32;nor&#32;their&#32;employing&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00012"/>00012 <emphasis role="comment">//&#32;*&#32;institutes,nor&#32;the&#32;agencies&#32;providing&#32;financial&#32;support&#32;for&#32;this&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00013"/>00013 <emphasis role="comment">//&#32;*&#32;work&#32;&#32;make&#32;&#32;any&#32;representation&#32;or&#32;&#32;warranty,&#32;express&#32;or&#32;implied,&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00014"/>00014 <emphasis role="comment">//&#32;*&#32;regarding&#32;&#32;this&#32;&#32;software&#32;system&#32;or&#32;assume&#32;any&#32;liability&#32;for&#32;its&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00015"/>00015 <emphasis role="comment">//&#32;*&#32;use.&#32;&#32;Please&#32;see&#32;the&#32;license&#32;in&#32;the&#32;file&#32;&#32;LICENSE&#32;&#32;and&#32;URL&#32;above&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00016"/>00016 <emphasis role="comment">//&#32;*&#32;for&#32;the&#32;full&#32;disclaimer&#32;and&#32;the&#32;limitation&#32;of&#32;liability.&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00017"/>00017 <emphasis role="comment">//&#32;*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00018"/>00018 <emphasis role="comment">//&#32;*&#32;This&#32;&#32;code&#32;&#32;implementation&#32;is&#32;the&#32;result&#32;of&#32;&#32;the&#32;&#32;scientific&#32;and&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00019"/>00019 <emphasis role="comment">//&#32;*&#32;technical&#32;work&#32;of&#32;the&#32;GEANT4&#32;collaboration.&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00020"/>00020 <emphasis role="comment">//&#32;*&#32;By&#32;using,&#32;&#32;copying,&#32;&#32;modifying&#32;or&#32;&#32;distributing&#32;the&#32;software&#32;(or&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00021"/>00021 <emphasis role="comment">//&#32;*&#32;any&#32;work&#32;based&#32;&#32;on&#32;the&#32;software)&#32;&#32;you&#32;&#32;agree&#32;&#32;to&#32;acknowledge&#32;its&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00022"/>00022 <emphasis role="comment">//&#32;*&#32;use&#32;&#32;in&#32;&#32;resulting&#32;&#32;scientific&#32;&#32;publications,&#32;&#32;and&#32;indicate&#32;your&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00023"/>00023 <emphasis role="comment">//&#32;*&#32;acceptance&#32;of&#32;all&#32;terms&#32;of&#32;the&#32;Geant4&#32;Software&#32;license.&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00024"/>00024 <emphasis role="comment">//&#32;********************************************************************</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00025"/>00025 <emphasis role="comment">//</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00027"/>00027 <emphasis role="comment"></emphasis><emphasis role="comment">//&#32;&#32;experimental&#32;setup</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00028"/>00028 <emphasis role="comment">//</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00030"/>00030 <emphasis role="comment"></emphasis><emphasis role="comment">//</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00031"/>00031 <emphasis role="comment">//&#32;Main</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00032"/>00032 <emphasis role="comment">//</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00033"/>00033 <emphasis role="comment">//&#32;Donovan&#32;Maire,&#32;Transmutex,&#32;18/10/2019</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00034"/>00034 <emphasis role="comment">//&#32;Copyright&#32;2020&#32;Transmutex&#32;SA&#32;--&#32;all&#32;rights&#32;reserved</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00036"/>00036 <emphasis role="comment"></emphasis><emphasis role="comment">//</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00037"/>00037 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00038"/>00038 <emphasis role="preprocessor">#define&#32;G4VIS_USE&#32;1</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00039"/>00039 <emphasis role="preprocessor">#define&#32;G4UI_USE&#32;1</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00040"/>00040 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00041"/>00041 <emphasis role="comment">//&#32;Class</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00042"/>00042 <emphasis role="preprocessor">#include&#32;&quot;DetectorConstruction.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00043"/>00043 <emphasis role="preprocessor">#include&#32;&quot;PhysicsList.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00044"/>00044 <emphasis role="preprocessor">#include&#32;&quot;PrimaryGeneratorAction.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00045"/>00045 <emphasis role="preprocessor">#include&#32;&quot;ActionInitialization.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00046"/>00046 <emphasis role="preprocessor">#include&#32;&quot;SteppingAction.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00047"/>00047 <emphasis role="preprocessor">#include&#32;&quot;RunAction.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00048"/>00048 <emphasis role="preprocessor">#include&#32;&quot;EventAction.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00049"/>00049 <emphasis role="preprocessor">#include&#32;&quot;StackingAction.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00050"/>00050 <emphasis role="preprocessor">#include&#32;&quot;Randomize.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00051"/>00051 <emphasis role="preprocessor">#include&#32;&quot;ScoringParallelWorld.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00052"/>00052 <emphasis role="preprocessor">#include&#32;&quot;ScoringParallelWorld_polar.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00053"/>00053 <emphasis role="preprocessor">#include&#32;&quot;ScoringParallelWorld_hexagonal.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00054"/>00054 <emphasis role="preprocessor">#include&#32;&quot;Analysis.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00055"/>00055 <emphasis role="preprocessor">#include&#32;&quot;TMXBatemanDecay.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00056"/>00056 <emphasis role="preprocessor">#include&#32;&quot;TMXBurnup.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00057"/>00057 <emphasis role="preprocessor">#include&#32;&quot;TMXExternalSource.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00058"/>00058 <emphasis role="preprocessor">#include&#32;&quot;TMXInputParameters.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00059"/>00059 <emphasis role="preprocessor">#include&#32;&quot;TMXkeff.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00060"/>00060 <emphasis role="preprocessor">#include&#32;&quot;TMXMCCubicVolume.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00061"/>00061 <emphasis role="preprocessor">#include&#32;&quot;TMXMergeThreadsResults.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00062"/>00062 <emphasis role="preprocessor">#include&#32;&quot;TMXOption.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00063"/>00063 <emphasis role="preprocessor">#include&#32;&quot;TMXRandomDistribution3D.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00064"/>00064 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00065"/>00065 <emphasis role="comment">//&#32;GEANT4&#32;libraries</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00066"/>00066 <emphasis role="preprocessor">#include&#32;&quot;G4RunManager.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00067"/>00067 <emphasis role="preprocessor">#include&#32;&quot;G4MTRunManager.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00068"/>00068 <emphasis role="preprocessor">#include&#32;&quot;G4UImanager.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00069"/>00069 <emphasis role="preprocessor">#include&#32;&quot;G4PhysListFactory.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00070"/>00070 <emphasis role="preprocessor">#include&#32;&quot;G4VModularPhysicsList.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00071"/>00071 <emphasis role="preprocessor">#include&#32;&quot;G4NeutronKillerMessenger.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00072"/>00072 <emphasis role="preprocessor">#include&#32;&quot;G4NeutronKiller.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00073"/>00073 <emphasis role="preprocessor">#include&#32;&quot;G4RadioactiveDecayPhysics.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00074"/>00074 <emphasis role="comment">//&#32;#include&#32;&quot;G4RadioactiveDecaymessenger.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00075"/>00075 <emphasis role="preprocessor">#include&#32;&quot;G4VisExecutive.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00076"/>00076 <emphasis role="preprocessor">#include&#32;&quot;G4UIExecutive.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00077"/>00077 <emphasis role="preprocessor">#include&#32;&quot;G4ScoringManager.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00078"/>00078 <emphasis role="preprocessor">#include&#32;&quot;G4SystemOfUnits.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00079"/>00079 <emphasis role="preprocessor">#include&#32;&quot;G4ParallelWorldPhysics.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00080"/>00080 <emphasis role="preprocessor">#include&#32;&quot;G4ParallelWorldScoringProcess.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00081"/>00081 <emphasis role="preprocessor">#include&#32;&quot;G4PhysicalConstants.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00082"/>00082 <emphasis role="preprocessor">#include&#32;&quot;G4RegionStore.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00083"/>00083 <emphasis role="comment">//&#32;#include&#32;&quot;G4NuclearLevelData.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00084"/>00084 <emphasis role="preprocessor">#include&#32;&quot;G4PhysicalVolumeStore.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00085"/>00085 <emphasis role="preprocessor">#include&#32;&quot;G4GeometryManager.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00086"/>00086 <emphasis role="preprocessor">#include&#32;&quot;G4NistManager.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00087"/>00087 <emphasis role="preprocessor">#include&#32;&quot;G4Element.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00088"/>00088 <emphasis role="preprocessor">#include&#32;&quot;G4Material.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00089"/>00089 <emphasis role="preprocessor">#include&#32;&quot;G4PVPlacement.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00090"/>00090 <emphasis role="preprocessor">#include&#32;&quot;G4LogicalVolumeStore.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00091"/>00091 <emphasis role="preprocessor">#include&#32;&quot;G4ThermalNeutrons.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00092"/>00092 <emphasis role="preprocessor">#include&#32;&quot;G4StateManager.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00093"/>00093 <emphasis role="preprocessor">#include&#32;&quot;G4ParticleHPManager.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00094"/>00094 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00095"/>00095 <emphasis role="comment">//&#32;#include&#32;&quot;GammaNuclearPhysics.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00096"/>00096 <emphasis role="preprocessor">#include&#32;&quot;G4EmExtraPhysics.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00097"/>00097 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00098"/>00098 <emphasis role="preprocessor">#include&#32;&quot;G4EmPenelopePhysics.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00099"/>00099 <emphasis role="preprocessor">#include&#32;&quot;G4EmLivermorePhysics.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00100"/>00100 <emphasis role="preprocessor">#include&#32;&quot;G4EmDNAPhysics.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00101"/>00101 <emphasis role="preprocessor">#include&#32;&quot;G4EmStandardPhysics.hh&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00102"/>00102 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00103"/>00103 <emphasis role="comment">//&#32;C++&#32;libraries</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00104"/>00104 <emphasis role="preprocessor">#include&#32;&lt;iostream&gt;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00105"/>00105 <emphasis role="preprocessor">#include&#32;&lt;unistd.h&gt;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00106"/>00106 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00107"/>00107 <emphasis role="keywordtype">int</emphasis>&#32;main(<emphasis role="keywordtype">int</emphasis>&#32;argc,&#32;<emphasis role="keywordtype">char</emphasis>**&#32;argv)
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00108"/>00108 {
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00109"/>00109 &#32;&#32;std::string&#32;fileName;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00110"/>00110 &#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(&#32;argc&#32;==&#32;1&#32;)
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00111"/>00111 &#32;&#32;&#32;&#32;fileName&#32;=&#32;<emphasis role="stringliteral">&quot;./param.csv&quot;</emphasis>;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00112"/>00112 &#32;&#32;<emphasis role="keywordflow">else</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00113"/>00113 &#32;&#32;&#32;&#32;fileName&#32;=&#32;argv[1];
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00114"/>00114 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00115"/>00115 &#32;&#32;<emphasis role="keywordflow">if</emphasis>(access(&#32;fileName.c_str(),&#32;F_OK&#32;)&#32;!=&#32;-1)&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00116"/>00116 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00118"/>00118 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Read&#32;the&#32;input&#32;file</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00119"/>00119 &#32;&#32;&#32;&#32;<emphasis role="comment">//</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00120"/>00120 &#32;&#32;&#32;&#32;<link linkend="_class_t_m_x_input_parameters">TMXInputParameters</link>&#32;p;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00121"/>00121 &#32;&#32;&#32;&#32;p.read(fileName);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00122"/>00122 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00123"/>00123 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(p.Verbose&#32;&gt;=&#32;1)
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00124"/>00124 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;p.verbose();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00125"/>00125 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00127"/>00127 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Detect&#32;interactive&#32;mode&#32;and&#32;define&#32;UI&#32;session</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00128"/>00128 &#32;&#32;&#32;&#32;G4UIExecutive*&#32;ui&#32;=&#32;0;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00129"/>00129 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(&#32;p.boolVisualization&#32;)
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00130"/>00130 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00131"/>00131 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ui&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;G4UIExecutive(argc,&#32;argv);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00132"/>00132 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00134"/>00134 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Choose&#32;the&#32;Random&#32;engine</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00135"/>00135 &#32;&#32;&#32;&#32;CLHEP::HepRandom::setTheEngine(<emphasis role="keyword">new</emphasis>&#32;CLHEP::RanecuEngine());
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00136"/>00136 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00138"/>00138 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Construct&#32;the&#32;default&#32;run&#32;manager</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00139"/>00139 &#32;&#32;&#32;&#32;<emphasis role="comment">//</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00140"/>00140 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00141"/>00141 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;n_Threads&#32;=&#32;1;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00142"/>00142 <emphasis role="preprocessor">&#32;&#32;&#32;&#32;#ifdef&#32;G4MULTITHREADED</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00143"/>00143 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4MTRunManager*&#32;runManager&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;G4MTRunManager;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00144"/>00144 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00145"/>00145 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Number&#32;of&#32;threads&#32;can&#32;be&#32;defined&#32;via&#32;parameter&#32;file</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00146"/>00146 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;n_Threads&#32;=&#32;p.nThreads;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00147"/>00147 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(&#32;n_Threads&#32;&lt;=0&#32;||&#32;n_Threads&#32;&gt;&#32;G4Threading::G4GetNumberOfCores())&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00148"/>00148 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;n_Threads&#32;=&#32;G4Threading::G4GetNumberOfCores();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00149"/>00149 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00150"/>00150 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;SetNumberOfThreads(n_Threads);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00151"/>00151 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00152"/>00152 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(p.Verbose&#32;&gt;=&#32;1)&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00153"/>00153 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4cout&#32;&lt;&lt;&#32;<emphasis role="stringliteral">&quot;=====&#32;mtinrtest&#32;is&#32;started&#32;with&#32;&quot;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00154"/>00154 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;&lt;&#32;&#32;runManager-&gt;GetNumberOfThreads()&#32;&lt;&lt;&#32;<emphasis role="stringliteral">&quot;&#32;threads&#32;=====\n&quot;</emphasis>&#32;&lt;&lt;&#32;G4endl;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00155"/>00155 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00156"/>00156 <emphasis role="preprocessor">&#32;&#32;&#32;&#32;#else</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00157"/>00157 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4RunManager*&#32;runManager&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;G4RunManager;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00158"/>00158 <emphasis role="preprocessor">&#32;&#32;&#32;&#32;#endif</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00159"/>00159 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00160"/>00160 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00161"/>00161 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;To&#32;merge&#32;output&#32;results&#32;from&#32;eventAction</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00162"/>00162 &#32;&#32;&#32;&#32;<link linkend="_class_t_m_x_merge_threads_results">TMXMergeThreadsResults</link>&#32;mergedOutput(n_Threads);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00163"/>00163 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00166"/>00166 &#32;&#32;&#32;&#32;<emphasis role="comment">//</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00167"/>00167 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;&#32;set&#32;mandatory&#32;initialization&#32;classes</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00168"/>00168 &#32;&#32;&#32;&#32;<emphasis role="comment">//</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00171"/>00171 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00174"/>00174 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Definition&#32;of&#32;the&#32;Geometry</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00175"/>00175 &#32;&#32;&#32;&#32;<emphasis role="comment">//</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00176"/>00176 &#32;&#32;&#32;&#32;G4double&#32;AssemblyLength&#32;=&#32;0;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00177"/>00177 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00178"/>00178 &#32;&#32;&#32;&#32;<link linkend="_class_detector_construction">DetectorConstruction</link>*&#32;realWorld&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;<link linkend="_class_detector_construction">DetectorConstruction</link>(p.int_Option,&#32;p,&#32;AssemblyLength);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00179"/>00179 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(p.TypeOfMesh&#32;==&#32;<emphasis role="stringliteral">&quot;cartesian&quot;</emphasis>)&#32;{&#32;<emphasis role="comment">//&#32;Cartesian&#32;Mesh</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00180"/>00180 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_class_scoring_parallel_world">ScoringParallelWorld</link>*&#32;parallelWorld&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;<link linkend="_class_scoring_parallel_world">ScoringParallelWorld</link>(<emphasis role="stringliteral">&quot;ParallelScoringWorld&quot;</emphasis>,&#32;&amp;p);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00181"/>00181 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;realWorld-&gt;RegisterParallelWorld(parallelWorld);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00182"/>00182 &#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00183"/>00183 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(p.TypeOfMesh&#32;==&#32;<emphasis role="stringliteral">&quot;hexagonal&quot;</emphasis>)&#32;{&#32;<emphasis role="comment">//&#32;Hexagonal&#32;Mesh</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00184"/>00184 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_class_scoring_parallel_world__hexagonal">ScoringParallelWorld_hexagonal</link>*&#32;parallelWorld_hexagonal&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;<link linkend="_class_scoring_parallel_world__hexagonal">ScoringParallelWorld_hexagonal</link>(<emphasis role="stringliteral">&quot;ParallelScoringWorld_hexagonal&quot;</emphasis>,&#32;&amp;p);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00185"/>00185 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;realWorld-&gt;RegisterParallelWorld(parallelWorld_hexagonal);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00186"/>00186 &#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00187"/>00187 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(p.TypeOfMesh&#32;==&#32;<emphasis role="stringliteral">&quot;polar&quot;</emphasis>)&#32;{&#32;<emphasis role="comment">//&#32;Polar&#32;Mesh</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00188"/>00188 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_class_scoring_parallel_world__polar">ScoringParallelWorld_polar</link>*&#32;parallelWorld_polar&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;<link linkend="_class_scoring_parallel_world__polar">ScoringParallelWorld_polar</link>(<emphasis role="stringliteral">&quot;ParallelScoringWorld_polar&quot;</emphasis>,&#32;&amp;p);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00189"/>00189 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;realWorld-&gt;RegisterParallelWorld(parallelWorld_polar);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00190"/>00190 &#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00191"/>00191 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00192"/>00192 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Initialize&#32;the&#32;geometry</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00193"/>00193 &#32;&#32;&#32;&#32;runManager-&gt;SetUserInitialization(&#32;realWorld&#32;);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00194"/>00194 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00195"/>00195 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Define&#32;3D&#32;space&#32;distribution&#32;of&#32;neutron&#32;birth&#32;position&#32;to&#32;estimate&#32;the&#32;keff</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00196"/>00196 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;nbinsTheta&#32;=&#32;1,&#32;nbinsZ&#32;=&#32;1,&#32;nbinsR2&#32;=&#32;1;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00197"/>00197 &#32;&#32;&#32;&#32;G4double&#32;R_min=0,&#32;R_max&#32;=&#32;p.Rpos_fuel&#32;+&#32;AssemblyLength,&#32;theta_min=0,&#32;theta_max=0,&#32;Zmin=0,&#32;Zmax=0;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00198"/>00198 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(TMXOption::IsKeffCalculation(p.int_Option))&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00199"/>00199 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;nbinsR2&#32;=&#32;p.keff_nbinsR2;&#32;nbinsTheta&#32;=&#32;p.keff_nbinsTheta;&#32;nbinsZ&#32;=&#32;p.keff_nbinsZ;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00200"/>00200 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(p.Geometry&#32;==&#32;0)&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00201"/>00201 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(p.CoreShape&#32;==&#32;<emphasis role="stringliteral">&quot;Hexagonal&quot;</emphasis>)&#32;{R_max&#32;=&#32;R_max/cos(twopi/12.);}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00202"/>00202 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;theta_min&#32;=&#32;0;&#32;theta_max&#32;=&#32;twopi;&#32;Zmin&#32;=&#32;-250;&#32;Zmax&#32;=&#32;250;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00203"/>00203 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;R_min&#32;=&#32;p.Rpos_fuel*p.Rpos_fuel;&#32;R_max&#32;=&#32;R_max*R_max;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00204"/>00204 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00205"/>00205 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">else</emphasis>&#32;<emphasis role="keywordflow">if</emphasis>(p.Geometry&#32;==&#32;1)&#32;{&#32;<emphasis role="comment">//&#32;Rez&#32;geom&#32;with&#32;cartesian&#32;coordinates</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00206"/>00206 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;R_min&#32;&#32;&#32;&#32;&#32;=&#32;-3*71.5*mm;&#32;R_max&#32;&#32;&#32;&#32;&#32;=&#32;4*71.5*mm;&#32;&#32;<emphasis role="comment">//&#32;X</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00207"/>00207 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;theta_min&#32;=&#32;-3*71.5*mm;&#32;theta_max&#32;=&#32;1*71.5*mm;&#32;&#32;<emphasis role="comment">//&#32;Y</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00208"/>00208 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;Zmin&#32;=&#32;-330*mm;&#32;Zmax&#32;=&#32;330*mm;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00209"/>00209 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00210"/>00210 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">else</emphasis>&#32;<emphasis role="keywordflow">if</emphasis>&#32;(p.Geometry&#32;==&#32;4)&#32;{&#32;<emphasis role="comment">//&#32;SVBR&#32;Reactor</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00211"/>00211 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;nbinsTheta&#32;=&#32;1;&#32;nbinsZ&#32;=&#32;6;&#32;nbinsR2&#32;=&#32;4;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00212"/>00212 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;R_min&#32;&#32;&#32;&#32;&#32;=&#32;0.3*0.3*m*m;&#32;&#32;&#32;&#32;R_max&#32;&#32;&#32;&#32;&#32;=&#32;0.90*0.90*m*m;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00213"/>00213 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;theta_min&#32;=&#32;0.;&#32;&#32;&#32;&#32;&#32;&#32;&#32;theta_max&#32;=&#32;twopi*rad;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00214"/>00214 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;Zmin&#32;&#32;&#32;&#32;&#32;&#32;=&#32;-1.305*m;&#32;&#32;Zmax&#32;&#32;&#32;&#32;&#32;&#32;=&#32;-0.405*m;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00215"/>00215 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00216"/>00216 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">else</emphasis>&#32;<emphasis role="keywordflow">if</emphasis>&#32;(p.Geometry&#32;==&#32;7&#32;||&#32;p.Geometry&#32;==&#32;8)&#32;{&#32;<emphasis role="comment">//&#32;GeomSVBR_AKME&#32;geometry&#32;7</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00217"/>00217 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;nbinsTheta&#32;=&#32;1;&#32;nbinsZ&#32;=&#32;6;&#32;nbinsR2&#32;=&#32;4;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00218"/>00218 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;R_min&#32;&#32;&#32;&#32;&#32;=&#32;0.283*0.283*m*m;&#32;&#32;&#32;&#32;R_max&#32;&#32;&#32;&#32;&#32;=&#32;0.85129*0.85129*m*m;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00219"/>00219 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;theta_min&#32;=&#32;0.;&#32;&#32;&#32;&#32;&#32;&#32;&#32;theta_max&#32;=&#32;twopi*rad;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00220"/>00220 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;Zmin&#32;&#32;&#32;&#32;&#32;&#32;=&#32;-1.52*m;&#32;&#32;Zmax&#32;&#32;&#32;&#32;&#32;&#32;=&#32;-0.243*m;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00221"/>00221 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00222"/>00222 &#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00223"/>00223 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00224"/>00224 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00225"/>00225 &#32;&#32;&#32;&#32;<link linkend="_class_t_m_x_random_distribution3_d">TMXRandomDistribution3D</link>&#32;RadiusAnglesHeight(nbinsR2,&#32;R_min,&#32;R_max,&#32;nbinsTheta,&#32;theta_min,&#32;theta_max,&#32;nbinsZ,&#32;Zmin,&#32;Zmax);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00226"/>00226 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00229"/>00229 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Definition&#32;of&#32;the&#32;Physics&#32;to&#32;use&#32;in&#32;the&#32;simulation</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00230"/>00230 &#32;&#32;&#32;&#32;<emphasis role="comment">//</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00231"/>00231 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00232"/>00232 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;G4NuclearLevelData::GetInstance()-&gt;GetParameters()-&gt;SetLevelDensity(0.125);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00233"/>00233 &#32;&#32;&#32;&#32;G4PhysListFactory&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;factory;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00234"/>00234 &#32;&#32;&#32;&#32;G4VModularPhysicsList*&#32;&#32;&#32;&#32;phys&#32;=&#32;0;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00235"/>00235 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00236"/>00236 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Physics&#32;List&#32;name&#32;defined&#32;via&#32;environment&#32;variable</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00237"/>00237 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(&#32;<emphasis role="stringliteral">&quot;&quot;</emphasis>&#32;==&#32;p.physName&#32;)&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00238"/>00238 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">char</emphasis>*&#32;path&#32;=&#32;getenv(<emphasis role="stringliteral">&quot;PHYSLIST&quot;</emphasis>);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00239"/>00239 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(path)&#32;{&#32;&#32;p.physName&#32;=&#32;G4String(path);}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00240"/>00240 &#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00241"/>00241 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00242"/>00242 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;reference&#32;PhysicsList&#32;via&#32;its&#32;name</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00243"/>00243 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(<emphasis role="stringliteral">&quot;&quot;</emphasis>&#32;!=&#32;p.physName&#32;&amp;&amp;&#32;factory.IsReferencePhysList(&#32;p.physName&#32;)&#32;)
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00244"/>00244 &#32;&#32;&#32;&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00245"/>00245 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;phys&#32;=&#32;factory.GetReferencePhysList(&#32;p.physName&#32;);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00246"/>00246 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;phys-&gt;RegisterPhysics(&#32;<emphasis role="keyword">new</emphasis>&#32;G4ThermalNeutrons(&#32;p.Verbose&#32;));
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00247"/>00247 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;phys-&gt;RemovePhysics(&#32;<emphasis role="stringliteral">&quot;G4RadioactiveDecay&quot;</emphasis>&#32;);&#32;&#32;<emphasis role="comment">//&#32;Removing&#32;radioactive&#32;decay&#32;from&#32;the&#32;physics&#32;list</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00248"/>00248 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(p.isLEND)&#32;phys-&gt;RegisterPhysics(&#32;new&#32;GammaNuclearPhysics(&quot;gamma&quot;));</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00249"/>00249 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00250"/>00250 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(p.TypeOfMesh&#32;==&#32;<emphasis role="stringliteral">&quot;cartesian&quot;</emphasis>)&#32;{phys-&gt;RegisterPhysics(&#32;<emphasis role="keyword">new</emphasis>&#32;G4ParallelWorldPhysics(&#32;<emphasis role="stringliteral">&quot;ParallelScoringWorld&quot;</emphasis>,&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">false</emphasis>)&#32;);}&#32;<emphasis role="comment">//&#32;cartesian&#32;mesh</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00251"/>00251 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(p.TypeOfMesh&#32;==&#32;<emphasis role="stringliteral">&quot;hexagonal&quot;</emphasis>)&#32;{phys-&gt;RegisterPhysics(&#32;<emphasis role="keyword">new</emphasis>&#32;G4ParallelWorldPhysics(&#32;<emphasis role="stringliteral">&quot;ParallelScoringWorld_hexagonal&quot;</emphasis>,&#32;<emphasis role="keyword">false</emphasis>)&#32;);}&#32;<emphasis role="comment">//&#32;hexagonal&#32;mesh</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00252"/>00252 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(p.TypeOfMesh&#32;==&#32;<emphasis role="stringliteral">&quot;polar&quot;</emphasis>)&#32;&#32;&#32;&#32;&#32;{phys-&gt;RegisterPhysics(&#32;<emphasis role="keyword">new</emphasis>&#32;G4ParallelWorldPhysics(&#32;<emphasis role="stringliteral">&quot;ParallelScoringWorld_polar&quot;</emphasis>,&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">false</emphasis>)&#32;);}&#32;<emphasis role="comment">//&#32;polar&#32;&#32;&#32;&#32;&#32;mesh</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00253"/>00253 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00254"/>00254 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Print&#32;cut&#32;values</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00255"/>00255 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;phys-&gt;DumpCutValuesTable();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00256"/>00256 &#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00257"/>00257 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00258"/>00258 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;define&#32;physics</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00259"/>00259 &#32;&#32;&#32;&#32;runManager-&gt;SetUserInitialization(phys);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00260"/>00260 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00261"/>00261 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;High&#32;Precision&#32;environment&#32;variables</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00262"/>00262 &#32;&#32;&#32;&#32;G4ParticleHPManager::GetInstance()-&gt;SetSkipMissingIsotopes(&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">true</emphasis>&#32;);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00263"/>00263 &#32;&#32;&#32;&#32;G4ParticleHPManager::GetInstance()-&gt;SetDoNotAdjustFinalState(&#32;&#32;&#32;<emphasis role="keyword">true</emphasis>&#32;);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00264"/>00264 &#32;&#32;&#32;&#32;G4ParticleHPManager::GetInstance()-&gt;SetUseOnlyPhotoEvaporation(&#32;<emphasis role="keyword">false</emphasis>&#32;);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00265"/>00265 &#32;&#32;&#32;&#32;G4ParticleHPManager::GetInstance()-&gt;SetNeglectDoppler(&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">false</emphasis>&#32;);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00266"/>00266 &#32;&#32;&#32;&#32;G4ParticleHPManager::GetInstance()-&gt;SetProduceFissionFragments(&#32;<emphasis role="keyword">true</emphasis>&#32;);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00267"/>00267 &#32;&#32;&#32;&#32;G4ParticleHPManager::GetInstance()-&gt;SetUseWendtFissionModel(&#32;&#32;&#32;&#32;<emphasis role="keyword">false</emphasis>&#32;);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00268"/>00268 &#32;&#32;&#32;&#32;G4ParticleHPManager::GetInstance()-&gt;SetUseNRESP71Model(&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">false</emphasis>&#32;);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00269"/>00269 &#32;&#32;&#32;&#32;G4ParticleHPManager::GetInstance()-&gt;SetVerboseLevel(2);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00270"/>00270 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00271"/>00271 &#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;std::left&#32;&lt;&lt;&#32;<emphasis role="stringliteral">&quot;\n*********\n&#32;*&#32;G4NEUTRONHP_SKIP_MISSING_ISOTOPES:&#32;&#32;&#32;&#32;&#32;&#32;&quot;</emphasis>&#32;&lt;&lt;&#32;std::setw(6)&#32;&lt;&lt;&#32;G4ParticleHPManager::GetInstance()-&gt;GetSkipMissingIsotopes()&#32;&#32;&#32;&#32;&#32;&lt;&lt;<emphasis role="stringliteral">&quot;\n*********&quot;</emphasis>&#32;&lt;&lt;&#32;std::endl;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00272"/>00272 &#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;std::left&#32;&lt;&lt;&#32;<emphasis role="stringliteral">&quot;\n*********\n&#32;*&#32;G4NEUTRONHP_DO_NOT_ADJUST_FINAL_STATE:&#32;&#32;&quot;</emphasis>&#32;&lt;&lt;&#32;std::setw(6)&#32;&lt;&lt;&#32;G4ParticleHPManager::GetInstance()-&gt;GetDoNotAdjustFinalState()&#32;&#32;&#32;&lt;&lt;<emphasis role="stringliteral">&quot;\n*********&quot;</emphasis>&#32;&lt;&lt;&#32;std::endl;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00273"/>00273 &#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;std::left&#32;&lt;&lt;&#32;<emphasis role="stringliteral">&quot;\n*********\n&#32;*&#32;G4NEUTRONHP_USE_ONLY_PHOTO_EVAPORATION:&#32;&quot;</emphasis>&#32;&lt;&lt;&#32;std::setw(6)&#32;&lt;&lt;&#32;G4ParticleHPManager::GetInstance()-&gt;GetUseOnlyPhotoEvaporation()&#32;&lt;&lt;<emphasis role="stringliteral">&quot;\n*********&quot;</emphasis>&#32;&lt;&lt;&#32;std::endl;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00274"/>00274 &#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;std::left&#32;&lt;&lt;&#32;<emphasis role="stringliteral">&quot;\n*********\n&#32;*&#32;G4NEUTRONHP_NEGLECT_DOPPLER:&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&quot;</emphasis>&#32;&lt;&lt;&#32;std::setw(6)&#32;&lt;&lt;&#32;G4ParticleHPManager::GetInstance()-&gt;GetNeglectDoppler()&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;&lt;<emphasis role="stringliteral">&quot;\n*********&quot;</emphasis>&#32;&lt;&lt;&#32;std::endl;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00275"/>00275 &#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;std::left&#32;&lt;&lt;&#32;<emphasis role="stringliteral">&quot;\n*********\n&#32;*&#32;G4NEUTRONHP_PRODUCE_FISSION_FRAGMENTS:&#32;&#32;&quot;</emphasis>&#32;&lt;&lt;&#32;std::setw(6)&#32;&lt;&lt;&#32;G4ParticleHPManager::GetInstance()-&gt;GetProduceFissionFragments()&#32;&lt;&lt;<emphasis role="stringliteral">&quot;\n*********&quot;</emphasis>&#32;&lt;&lt;&#32;std::endl;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00276"/>00276 &#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;std::left&#32;&lt;&lt;&#32;<emphasis role="stringliteral">&quot;\n*********\n&#32;*&#32;G4NEUTRON_HP_USE_WENDT_FISSION_MODEL:&#32;&#32;&#32;&quot;</emphasis>&#32;&lt;&lt;&#32;std::setw(6)&#32;&lt;&lt;&#32;G4ParticleHPManager::GetInstance()-&gt;GetUseWendtFissionModel()&#32;&#32;&#32;&#32;&lt;&lt;<emphasis role="stringliteral">&quot;\n*********&quot;</emphasis>&#32;&lt;&lt;&#32;std::endl;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00277"/>00277 &#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;std::left&#32;&lt;&lt;&#32;<emphasis role="stringliteral">&quot;\n*********\n&#32;*&#32;G4NEUTRONHP_USE_NRESP71_MODEL:&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&quot;</emphasis>&#32;&lt;&lt;&#32;std::setw(6)&#32;&lt;&lt;&#32;G4ParticleHPManager::GetInstance()-&gt;GetUseNRESP71Model()&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;&lt;<emphasis role="stringliteral">&quot;\n*********\n\n&quot;</emphasis>&#32;&lt;&lt;&#32;std::endl;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00278"/>00278 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00282"/>00282 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Initialization&#32;of&#32;all&#32;other&#32;classes&#32;to&#32;use&#32;in&#32;the&#32;simulation</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00283"/>00283 &#32;&#32;&#32;&#32;<emphasis role="comment">//</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00284"/>00284 &#32;&#32;&#32;&#32;<link linkend="_class_t_m_x_bateman_decay">TMXBatemanDecay</link>&#32;batemanDecay;&#32;<emphasis role="comment">//&#32;This&#32;object&#32;(class)&#32;is&#32;used&#32;to&#32;perform&#32;decay&#32;of&#32;radionuclides&#32;following&#32;Bateman&#32;equations</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00285"/>00285 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00286"/>00286 <emphasis role="preprocessor">&#32;&#32;&#32;&#32;#ifdef&#32;G4MULTITHREADED&#32;</emphasis><emphasis role="comment">//&#32;MT&#32;mode&#32;via&#32;action&#32;initialization</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00287"/>00287 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_class_t_m_x_external_source">TMXExternalSource</link>&#32;sourceExt;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00288"/>00288 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;SetUserInitialization(&#32;<emphasis role="keyword">new</emphasis>&#32;<link linkend="_class_action_initialization">ActionInitialization</link>(RadiusAnglesHeight,&#32;mergedOutput,&#32;batemanDecay,&#32;p,&#32;sourceExt)&#32;);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00289"/>00289 <emphasis role="preprocessor">&#32;&#32;&#32;&#32;#else&#32;&#32;&#32;</emphasis><emphasis role="comment">//&#32;sequential&#32;mode</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00290"/>00290 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;SetUserAction(&#32;<emphasis role="keyword">new</emphasis>&#32;<link linkend="_class_primary_generator_action">PrimaryGeneratorAction</link>(1,&#32;&amp;p,&#32;RadiusAnglesHeight));&#32;&#32;<emphasis role="comment">//&#32;Number&#32;of&#32;primary&#32;proton&#32;per&#32;event&#32;(=1)&#32;at&#32;a&#32;given&#32;energy</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00291"/>00291 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00292"/>00292 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//set&#32;user&#32;action&#32;classes</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00293"/>00293 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_class_run_action">RunAction</link>*&#32;runAction&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;<link linkend="_class_run_action">RunAction</link>&#32;&#32;(p,&#32;&amp;mergedOutput);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00294"/>00294 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;SetUserAction(&#32;runAction&#32;);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00295"/>00295 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_class_event_action">EventAction</link>*&#32;eventAction&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;<link linkend="_class_event_action">EventAction</link>(&amp;p,&#32;RadiusAnglesHeight,&#32;mergedOutput,&#32;batemanDecay);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00296"/>00296 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;SetUserAction(&#32;eventAction&#32;);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00297"/>00297 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;SetUserAction(&#32;<emphasis role="keyword">new</emphasis>&#32;<link linkend="_class_stacking_action">StackingAction</link>()&#32;);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00298"/>00298 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;SetUserAction(&#32;<emphasis role="keyword">new</emphasis>&#32;<link linkend="_class_stepping_action">SteppingAction</link>(eventAction,&#32;runAction,&#32;p));
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00299"/>00299 <emphasis role="preprocessor">&#32;&#32;&#32;&#32;#endif</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00300"/>00300 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00301"/>00301 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00305"/>00305 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Initialization&#32;of&#32;the&#32;User&#32;Interface</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00306"/>00306 &#32;&#32;&#32;&#32;<emphasis role="comment">//</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00307"/>00307 &#32;&#32;&#32;&#32;G4VisManager*&#32;visManager;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00308"/>00308 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(&#32;p.Verbose&#32;==&#32;0)&#32;{&#32;visManager&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;G4VisExecutive(<emphasis role="stringliteral">&quot;Quiet&quot;</emphasis>);&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00309"/>00309 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">else</emphasis>&#32;{&#32;visManager&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;G4VisExecutive();&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00310"/>00310 &#32;&#32;&#32;&#32;visManager-&gt;Initialize();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00311"/>00311 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00316"/>00316 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Manage&#32;batch&#32;mode&#32;or&#32;Graphical&#32;mode</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00317"/>00317 &#32;&#32;&#32;&#32;<emphasis role="comment">//</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00318"/>00318 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Process&#32;macro&#32;or&#32;start&#32;UI&#32;session</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00319"/>00319 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00320"/>00320 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(&#32;!&#32;ui&#32;)&#32;{&#32;<emphasis role="comment">//&#32;batch&#32;mode</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00321"/>00321 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Initialization&#32;of&#32;GEANT4</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00322"/>00322 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;Initialize();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00323"/>00323 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00324"/>00324 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(TMXOption::IsPIMKeffCalculation(p.int_Option))
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00325"/>00325 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00326"/>00326 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_class_t_m_xkeff">TMXkeff</link>&#32;*keff&#32;=&#32;<link linkend="_class_t_m_xkeff_1ae1e9f4676a54a9533cfe95f2d3b38805">TMXkeff::getInstance</link>();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00327"/>00327 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;keff-&gt;<link linkend="_class_t_m_xkeff_1abd9cdf715d4500994915baf9bcfa4431">setNbCycleToDiscard</link>(p.NbDiscardCycle);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00328"/>00328 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;keff-&gt;<link linkend="_class_t_m_xkeff_1a211ef49bda3e8c994126533647add4c7">setNbParticlePerCycle</link>(p.Nparticles);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00329"/>00329 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;keff-&gt;<link linkend="_class_t_m_xkeff_1a2465a20d6f7de66891cdf4e2c8f0fc46">setNbTotCycle</link>(p.Ncycle);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00330"/>00330 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(p.originKeff.size()&#32;&gt;&#32;0)&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00331"/>00331 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;keff-&gt;<link linkend="_class_t_m_xkeff_1aeccad85894181d7944ee7fc82ac5d02d">addOriginPosition</link>(G4ThreeVector(p.originKeff[0],&#32;p.originKeff[1],&#32;p.originKeff[2]));
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00332"/>00332 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00333"/>00333 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00334"/>00334 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(p.TimeOfRun&#32;==&#32;0)
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00335"/>00335 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00336"/>00336 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;keff-&gt;<link linkend="_class_t_m_xkeff_1aa783282f552468837665d0b0bfec6f53">setOutputFileName</link>(p.str_ROOTFileName+<emphasis role="stringliteral">&quot;_keff.txt&quot;</emphasis>);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00337"/>00337 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>(<emphasis role="keywordtype">int</emphasis>&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;keff-&gt;<link linkend="_class_t_m_xkeff_1af14b9d4217f4f1dfd681d65c10d7aa66">getNbTotCycle</link>();&#32;i++)
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00338"/>00338 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00339"/>00339 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&lt;&lt;<emphasis role="stringliteral">&quot;Simulation&#32;of:&#32;&quot;</emphasis>&lt;&lt;keff-&gt;<link linkend="_class_t_m_xkeff_1af95ebf42744dfb2899b0572925928140">getNbNeutronPerCycle</link>()&#32;&lt;&lt;&#32;<emphasis role="stringliteral">&quot;&#32;particles&quot;</emphasis>&lt;&lt;std::endl;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00340"/>00340 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;BeamOn(keff-&gt;<link linkend="_class_t_m_xkeff_1af95ebf42744dfb2899b0572925928140">getNbNeutronPerCycle</link>());
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00341"/>00341 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00342"/>00342 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00343"/>00343 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">else</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00344"/>00344 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00345"/>00345 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;irradiationTimePassed&#32;=&#32;0.;<emphasis role="keywordtype">int</emphasis>&#32;count&#32;=&#32;0;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00346"/>00346 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">while</emphasis>(irradiationTimePassed&#32;&lt;&#32;p.TimeOfRun)
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00347"/>00347 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00348"/>00348 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;count++;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00349"/>00349 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4GeometryManager::GetInstance()-&gt;CloseGeometry();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00350"/>00350 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00351"/>00351 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;keff-&gt;<link linkend="_class_t_m_xkeff_1aa783282f552468837665d0b0bfec6f53">setOutputFileName</link>(p.str_ROOTFileName+<emphasis role="stringliteral">&quot;_keff&quot;</emphasis>+to_string(count)+<emphasis role="stringliteral">&quot;.txt&quot;</emphasis>);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00352"/>00352 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>(<emphasis role="keywordtype">int</emphasis>&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;keff-&gt;<link linkend="_class_t_m_xkeff_1af14b9d4217f4f1dfd681d65c10d7aa66">getNbTotCycle</link>();&#32;i++)
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00353"/>00353 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00354"/>00354 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&lt;&lt;<emphasis role="stringliteral">&quot;Simulation&#32;of:&#32;&quot;</emphasis>&lt;&lt;keff-&gt;<link linkend="_class_t_m_xkeff_1af95ebf42744dfb2899b0572925928140">getNbNeutronPerCycle</link>()&#32;&lt;&lt;&#32;<emphasis role="stringliteral">&quot;&#32;particles&quot;</emphasis>&lt;&lt;std::endl;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00355"/>00355 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;BeamOn(keff-&gt;<link linkend="_class_t_m_xkeff_1af95ebf42744dfb2899b0572925928140">getNbNeutronPerCycle</link>());
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00356"/>00356 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00357"/>00357 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;<link linkend="_class_run_action">RunAction</link>&#32;*runaction&#32;=&#32;<emphasis role="keyword">static_cast&lt;</emphasis><emphasis role="keyword">const&#32;</emphasis><link linkend="_class_run_action">RunAction</link>*<emphasis role="keyword">&gt;</emphasis>&#32;(runManager-&gt;GetUserRunAction());
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00358"/>00358 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;irradiationTimePassed&#32;=&#32;runaction-&gt;m_timePassed;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00359"/>00359 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;keff-&gt;<link linkend="_class_t_m_xkeff_1a9739644a1e8af1ab9cc8ea6feeceb1d4">reinitialize</link>();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00360"/>00360 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;GeometryHasBeenModified();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00361"/>00361 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;PhysicsHasBeenModified();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00362"/>00362 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00363"/>00363 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00364"/>00364 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;0;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00365"/>00365 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00366"/>00366 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">else</emphasis>&#32;<emphasis role="keywordflow">if</emphasis>&#32;(TMXOption::IsMCCubicVolumeCalculation(p.int_Option))&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00367"/>00367 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4Navigator&#32;*navigator&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;G4Navigator();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00368"/>00368 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_class_t_m_x_m_c_cubic_volume">TMXMCCubicVolume</link>&#32;*MCCubicVolume&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;<link linkend="_class_t_m_x_m_c_cubic_volume">TMXMCCubicVolume</link>(&amp;p);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00369"/>00369 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;MCCubicVolume-&gt;setNumberOfPoints(p.Nparticles);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00370"/>00370 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;MCCubicVolume-&gt;setErrorLimit(p.ErrorLimitMCCubicVolume);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00371"/>00371 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;MCCubicVolume-&gt;setNavigator(navigator);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00372"/>00372 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(p.MCCubicVolumeLVname.length()&#32;&gt;&#32;0)&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00373"/>00373 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;MCCubicVolume-&gt;setSlicedLogicalVolume(p.MCCubicVolumeLVname);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00374"/>00374 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;MCCubicVolume-&gt;setSliceBoundariesZ(p.minZ,&#32;p.maxZ,&#32;p.nbinsZ);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00375"/>00375 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00376"/>00376 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;MCCubicVolume-&gt;run();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00377"/>00377 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>(0);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00378"/>00378 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00379"/>00379 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">else</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00380"/>00380 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00381"/>00381 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00382"/>00382 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Simulation&#32;of&#32;multiple&#32;run&#32;with&#32;evolution&#32;of&#32;the&#32;materials</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00383"/>00383 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;Initialize();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00384"/>00384 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;BeamOn(p.Nparticles);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00385"/>00385 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00386"/>00386 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;Initialize();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00387"/>00387 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;irradiationTimePassed&#32;=&#32;0.;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00388"/>00388 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(p.TimeOfRun&#32;==&#32;0)
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00389"/>00389 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00390"/>00390 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4GeometryManager::GetInstance()-&gt;CloseGeometry();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00391"/>00391 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00392"/>00392 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>(<emphasis role="keywordtype">int</emphasis>&#32;i=0;&#32;i&lt;p.Nrun;&#32;i++)
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00393"/>00393 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;BeamOn(p.Nparticles);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00394"/>00394 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00395"/>00395 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">else</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00396"/>00396 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00397"/>00397 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">while</emphasis>(irradiationTimePassed&#32;&lt;&#32;p.TimeOfRun)
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00398"/>00398 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00399"/>00399 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4GeometryManager::GetInstance()-&gt;CloseGeometry();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00400"/>00400 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00401"/>00401 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;BeamOn(p.Nparticles);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00402"/>00402 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">const</emphasis>&#32;<link linkend="_class_run_action">RunAction</link>&#32;*runaction&#32;=&#32;<emphasis role="keyword">static_cast&lt;</emphasis><emphasis role="keyword">const&#32;</emphasis><link linkend="_class_run_action">RunAction</link>*<emphasis role="keyword">&gt;</emphasis>&#32;(runManager-&gt;GetUserRunAction());
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00403"/>00403 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;irradiationTimePassed&#32;=&#32;runaction-&gt;m_timePassed;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00404"/>00404 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00405"/>00405 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;GeometryHasBeenModified();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00406"/>00406 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;PhysicsHasBeenModified();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00407"/>00407 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00408"/>00408 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00409"/>00409 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00410"/>00410 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Merging&#32;results&#32;of&#32;neutronic&#32;calculation&#32;(ksrc,&#32;keff,&#32;G0,&#32;G,&#32;etc.)&#32;in&#32;a&#32;results&#32;file&#32;.txt</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00411"/>00411 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;for(&#32;int&#32;i_step&#32;=&#32;0;&#32;i_step&lt;p.Nrun;&#32;++i_step)&#32;{</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00412"/>00412 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;Start&#32;Merge&#32;&quot;&#32;&lt;&lt;&#32;G4StateManager::GetStateManager()-&gt;GetStateString(G4StateManager::GetStateManager()-&gt;GetCurrentState())&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00413"/>00413 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(n_Threads&#32;&gt;&#32;1)&#32;{//&#32;Merge&#32;threads&#32;results&#32;in&#32;one&#32;file</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00414"/>00414 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;mergedOutput.WriteResults(p.str_ROOTFileName&#32;+&#32;&quot;_&quot;&#32;+&#32;std::to_string(0),&#32;p.int_Option,&#32;i_step);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00415"/>00415 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00416"/>00416 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00417"/>00417 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00418"/>00418 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;Initialize();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00419"/>00419 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;BurnupManager*&#32;burnup&#32;=&#32;BurnupManager::getInstance();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00420"/>00420 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;burnup-&gt;setParameters(p);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00421"/>00421 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;burnup-&gt;start(runManager);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00422"/>00422 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00423"/>00423 <emphasis role="comment">/*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;TMXBurnup&#32;burnup;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00424"/>00424 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;for(int&#32;i_step&#32;=&#32;0;&#32;i_step&lt;p.Nrun;&#32;++i_step)&#32;{</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00425"/>00425 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00426"/>00426 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;Run&#32;&quot;&#32;&lt;&lt;&#32;i_step&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00427"/>00427 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;Initialize();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00428"/>00428 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00429"/>00429 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Run&#32;the&#32;simulation&#32;with&#32;p.Nparticles&#32;events</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00430"/>00430 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Initialization&#32;of&#32;GEANT4</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00431"/>00431 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;intialize&quot;&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00432"/>00432 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;SetUserInitialization(phys);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00433"/>00433 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;Initialize();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00434"/>00434 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;RunInitialization&quot;&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00435"/>00435 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;RunInitialization();&#32;&#32;//&#32;Does&#32;not&#32;work&#32;in&#32;this&#32;context</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00436"/>00436 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;InitializePhysics&quot;&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00437"/>00437 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4GeometryManager::GetInstance()-&gt;OpenGeometry(G4PhysicalVolumeStore::GetInstance()-&gt;GetVolume(&quot;Universe&quot;));</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00438"/>00438 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;InitializePhysics();&#32;&#32;//&#32;Does&#32;not&#32;work&#32;in&#32;this&#32;context</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00439"/>00439 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4GeometryManager::GetInstance()-&gt;CloseGeometry(G4PhysicalVolumeStore::GetInstance()-&gt;GetVolume(&quot;Universe&quot;));</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00440"/>00440 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;Close&#32;geom&#32;&quot;&#32;&lt;&lt;&#32;G4StateManager::GetStateManager()-&gt;GetStateString(G4StateManager::GetStateManager()-&gt;GetCurrentState())&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00441"/>00441 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4GeometryManager::GetInstance()-&gt;CloseGeometry();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00442"/>00442 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;BeamOn&#32;&quot;&#32;&lt;&lt;&#32;G4StateManager::GetStateManager()-&gt;GetStateString(G4StateManager::GetStateManager()-&gt;GetCurrentState())&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00443"/>00443 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;BeamOn(p.Nparticles);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00444"/>00444 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;open&#32;geom&#32;&quot;&#32;&lt;&lt;&#32;G4StateManager::GetStateManager()-&gt;GetStateString(G4StateManager::GetStateManager()-&gt;GetCurrentState())&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00445"/>00445 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4GeometryManager::GetInstance()-&gt;OpenGeometry();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00446"/>00446 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00447"/>00447 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00448"/>00448 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;Start&#32;Burnup&#32;&quot;&#32;&lt;&lt;&#32;G4StateManager::GetStateManager()-&gt;GetStateString(G4StateManager::GetStateManager()-&gt;GetCurrentState())&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00449"/>00449 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if(p.TimeOfRun&#32;&gt;&#32;0)&#32;{</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00450"/>00450 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Set&#32;New&#32;Materials&#32;to&#32;logical&#32;volumes</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00451"/>00451 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4LogicalVolumeStore&#32;*LVStore&#32;=&#32;G4LogicalVolumeStore::GetInstance();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00452"/>00452 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;burnup.ChangeMaterial(p,&#32;LVStore,&#32;batemanDecay,&#32;i_step);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00453"/>00453 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00454"/>00454 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00455"/>00455 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Change&#32;the&#32;geometry&#32;with&#32;new&#32;materials</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00456"/>00456 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;GeometryHasBeenModified&#32;&quot;&#32;&lt;&lt;&#32;G4StateManager::GetStateManager()-&gt;GetStateString(G4StateManager::GetStateManager()-&gt;GetCurrentState())&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00457"/>00457 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;GeometryHasBeenModified();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00458"/>00458 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;PhysicsHasBeenModified&#32;&quot;&#32;&lt;&lt;&#32;G4StateManager::GetStateManager()-&gt;GetStateString(G4StateManager::GetStateManager()-&gt;GetCurrentState())&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00459"/>00459 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;PhysicsHasBeenModified();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00460"/>00460 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;CutOffHasBeenModified&#32;&quot;&#32;&lt;&lt;&#32;G4StateManager::GetStateManager()-&gt;GetStateString(G4StateManager::GetStateManager()-&gt;GetCurrentState())&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00461"/>00461 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;CutOffHasBeenModified();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00462"/>00462 <emphasis role="comment">//&#32;//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;RunInitialization();&#32;&#32;//&#32;Does&#32;not&#32;work&#32;in&#32;this&#32;context</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00463"/>00463 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00464"/>00464 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;InitializePhysics&#32;&quot;&#32;&lt;&lt;&#32;G4StateManager::GetStateManager()-&gt;GetStateString(G4StateManager::GetStateManager()-&gt;GetCurrentState())&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00465"/>00465 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;InitializePhysics();&#32;&#32;//</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00466"/>00466 <emphasis role="comment">*/</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00467"/>00467 <emphasis role="comment">/*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;\n\t****\n\t****\n\t****\n\t****\n\t****\n\t****&quot;&#32;&lt;&lt;&#32;(G4Material::GetNumberOfMaterials())&#32;&lt;&lt;&#32;&quot;\n\t****\n\t****\n\t****\n\t****\n\t****\n\t****&quot;&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00468"/>00468 <emphasis role="comment">//&#32;//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4RunManagerKernel::GetRunManagerKernel()-&gt;UpdateRegion();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00469"/>00469 <emphasis role="comment">//&#32;//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;CheckRegions();&#32;-&gt;&#32;private&#32;of&#32;G4RunManagerKernel,&#32;if&#32;necessary&#32;-&gt;&#32;change&#32;state&#32;flag&#32;in&#32;GetRunManagerKernel()-&gt;UpdateRegion()&#32;to&#32;Idle&#32;to&#32;call&#32;these&#32;methods</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00470"/>00470 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00471"/>00471 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4RegionStore::GetInstance()-&gt;UpdateMaterialList(parallelWorld-&gt;GiveWorld());</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00472"/>00472 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4ProductionCutsTable::GetProductionCutsTable()-&gt;UpdateCoupleTable(parallelWorld-&gt;GiveWorld());</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00473"/>00473 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00474"/>00474 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;\n\t****\n\t****\n\t****\n\t****\n\t****\n\t****&#32;&quot;&#32;&lt;&lt;&#32;(G4Element::GetNumberOfElements())&#32;&lt;&lt;&#32;&quot;&#32;\n\t****\n\t****\n\t****\n\t****\n\t****\n\t****&quot;&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00475"/>00475 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;\n\t****\n\t****\n\t****\n\t****\n\t****\n\t****&#32;&quot;&#32;&lt;&lt;&#32;(G4Isotope::GetNumberOfIsotopes())&#32;&lt;&lt;&#32;&quot;&#32;\n\t****\n\t****\n\t****\n\t****\n\t****\n\t****&quot;&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00476"/>00476 <emphasis role="comment">*/</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00477"/>00477 <emphasis role="comment">/*&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&lt;&lt;&quot;\n&#32;Inside&#32;MAIN&quot;&lt;&lt;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00478"/>00478 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;for&#32;(G4LogicalVolumeStore::iterator&#32;it_LV=LVStore-&gt;begin();&#32;it_LV!=LVStore-&gt;end();&#32;++it_LV)&#32;{&#32;//&#32;Read&#32;the&#32;logical&#32;volume&#32;store</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00479"/>00479 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4LogicalVolume&#32;*LV&#32;=&#32;*it_LV;&#32;//&#32;Define&#32;the&#32;logical&#32;volume</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00480"/>00480 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::string&#32;LVName&#32;=&#32;LV-&gt;GetName();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00481"/>00481 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if(LVName.find(&quot;Scoring&quot;)&#32;==&#32;std::string::npos&#32;)&#32;{&#32;&#32;//&#32;Do&#32;not&#32;consider&#32;the&#32;parallel&#32;Scoring&#32;World&#32;or&#32;the&#32;Scoring&#32;world</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00482"/>00482 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00483"/>00483 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(LVName&#32;==&#32;&quot;lfuelmat23&quot;)</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00484"/>00484 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00485"/>00485 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4Material*&#32;LVMaterial&#32;=&#32;LV-&gt;GetMaterial();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00486"/>00486 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00487"/>00487 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;double&#32;LVMass&#32;=&#32;LV-&gt;GetMass()/g;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00488"/>00488 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;const&#32;G4double*&#32;MassFractionVector&#32;&#32;&#32;&#32;=&#32;LVMaterial-&gt;GetFractionVector();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00489"/>00489 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;for(long&#32;unsigned&#32;int&#32;j=0;&#32;j&#32;&lt;&#32;LVMaterial-&gt;GetNumberOfElements();&#32;++j)&#32;{&#32;&#32;//&#32;Read&#32;every&#32;elements&#32;in&#32;the&#32;material</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00490"/>00490 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00491"/>00491 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;const&#32;G4Element*&#32;Element&#32;=&#32;LVMaterial-&gt;GetElement(j);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00492"/>00492 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4double*&#32;RelativAbundanceVec=&#32;Element-&gt;GetRelativeAbundanceVector();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00493"/>00493 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;for(long&#32;unsigned&#32;int&#32;i=0;&#32;i&#32;&lt;&#32;Element-&gt;GetNumberOfIsotopes();&#32;++i)&#32;{&#32;//&#32;Read&#32;every&#32;isotopes&#32;in&#32;the&#32;element</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00494"/>00494 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00495"/>00495 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;const&#32;G4Isotope*&#32;Isotope&#32;=&#32;Element-&gt;GetIsotope(i);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00496"/>00496 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;int&#32;IZA&#32;=&#32;Isotope-&gt;GetZ()*10000&#32;+&#32;Isotope-&gt;GetN()*10&#32;+&#32;Isotope-&gt;Getm();&#32;&#32;//&#32;IZA&#32;identifier</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00497"/>00497 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;double&#32;MolarMass&#32;=&#32;Isotope-&gt;GetN();&#32;//&#32;Isotope-&gt;GetA()/(g/(mole*amu_c2));</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00498"/>00498 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;long&#32;double&#32;N0&#32;=&#32;MassFractionVector[j]&#32;*&#32;RelativAbundanceVec[i]&#32;*&#32;LVMass&#32;/&#32;MolarMass&#32;*&#32;CLHEP::Avogadro;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00499"/>00499 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00500"/>00500 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&lt;&lt;IZA&lt;&lt;&quot;&#32;&quot;&lt;&lt;&#32;N0&lt;&lt;std::endl;&#32;//&#32;Store&#32;N0&#32;for&#32;post-analysis</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00501"/>00501 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00502"/>00502 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00503"/>00503 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00504"/>00504 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00505"/>00505 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00506"/>00506 <emphasis role="comment">*/</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00507"/>00507 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00508"/>00508 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00509"/>00509 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00510"/>00510 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;burnup.WriteResultsPerRun(p.str_ROOTFileName,&#32;i_step);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00511"/>00511 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00512"/>00512 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00513"/>00513 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00514"/>00514 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00515"/>00515 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if(p.TimeOfRun&#32;&gt;&#32;0)</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00516"/>00516 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00517"/>00517 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4LogicalVolumeStore&#32;*LVStore&#32;=&#32;G4LogicalVolumeStore::GetInstance();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00518"/>00518 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;burnup.ChangeMaterial(p,&#32;LVStore,&#32;batemanDecay,&#32;p.Nrun);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00519"/>00519 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;GeometryHasBeenModified&#32;&quot;&#32;&lt;&lt;&#32;G4StateManager::GetStateManager()-&gt;GetStateString(G4StateManager::GetStateManager()-&gt;GetCurrentState())&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00520"/>00520 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;GeometryHasBeenModified();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00521"/>00521 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::cout&#32;&lt;&lt;&#32;&quot;PhysicsHasBeenModified&#32;&quot;&#32;&lt;&lt;&#32;G4StateManager::GetStateManager()-&gt;GetStateString(G4StateManager::GetStateManager()-&gt;GetCurrentState())&#32;&lt;&lt;&#32;std::endl;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00522"/>00522 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;PhysicsHasBeenModified();</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00523"/>00523 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00524"/>00524 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;burnup.WriteResultsPerRun(p.str_ROOTFileName,&#32;p.Nrun);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00525"/>00525 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00526"/>00526 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if(p.CoolingTime&#32;&gt;&#32;0)</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00527"/>00527 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00528"/>00528 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;burnup.ChangeMaterial(p,&#32;LVStore,&#32;batemanDecay,&#32;p.Nrun+1);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00529"/>00529 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;burnup.WriteResultsPerRun(p.str_ROOTFileName,&#32;p.Nrun+1);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00530"/>00530 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00531"/>00531 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00532"/>00532 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;burnup.WriteDecayedResultsPerRun(p.str_ROOTFileName,&#32;p.Nrun);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00533"/>00533 <emphasis role="comment"></emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00534"/>00534 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Results&#32;file&#32;is&#32;used&#32;to&#32;record&#32;evolution&#32;of&#32;the&#32;composition</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00535"/>00535 <emphasis role="comment">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Write&#32;transmutation&#32;results</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00536"/>00536 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if(p.Nrun&#32;&gt;&#32;1)&#32;{&#32;burnup.WriteResults(p.str_ROOTFileName);}*/</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00537"/>00537 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00538"/>00538 &#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00539"/>00539 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">else</emphasis>&#32;{
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00540"/>00540 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;runManager-&gt;SetNumberOfThreads(1);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00541"/>00541 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00542"/>00542 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//get&#32;the&#32;pointer&#32;to&#32;the&#32;User&#32;Interface&#32;manager</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00543"/>00543 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;G4UImanager*&#32;UImanager&#32;=&#32;G4UImanager::GetUIpointer();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00544"/>00544 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00545"/>00545 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;interactive&#32;mode</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00546"/>00546 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;UImanager-&gt;ApplyCommand(<emphasis role="stringliteral">&quot;/control/execute&#32;init_vis.mac&quot;</emphasis>);
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00547"/>00547 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ui-&gt;SessionStart();
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00548"/>00548 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">delete</emphasis>&#32;ui;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00549"/>00549 &#32;&#32;&#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00550"/>00550 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00551"/>00551 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;delete&#32;runManager;</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00552"/>00552 &#32;&#32;&#32;&#32;<emphasis role="keyword">delete</emphasis>&#32;visManager;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00553"/>00553 &#32;&#32;}
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00554"/>00554 &#32;&#32;<emphasis role="keywordflow">else</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00555"/>00555 &#32;&#32;&#32;&#32;&#32;&#32;std::cerr&#32;&lt;&lt;&#32;<emphasis role="stringliteral">&quot;The&#32;default&#32;input&#32;parameter&#32;file&#32;&quot;</emphasis>&#32;&lt;&lt;&#32;fileName&#32;&lt;&lt;&#32;<emphasis role="stringliteral">&quot;&#32;does&#32;not&#32;exist.\nPlease&#32;specify&#32;explicitly&#32;the&#32;input&#32;file.\nEnd&#32;of&#32;the&#32;execution.&quot;</emphasis>&#32;&lt;&lt;&#32;std::endl;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00556"/>00556 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00557"/>00557 &#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;0;
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00558"/>00558 }
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00559"/>00559 
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00560"/>00560 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;G4Random::SetSeed(0)&#32;to&#32;change&#32;the&#32;seed&#32;if&#32;statistical&#32;variation&#32;calculation&#32;is&#32;needed</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00561"/>00561 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;CLHEP::RanluxEngine&#32;defaultEngine(&#32;1234567,&#32;4&#32;);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00562"/>00562 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;G4Random::setTheEngine(&#32;&amp;defaultEngine&#32;);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00563"/>00563 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;G4int&#32;seed&#32;=&#32;time(&#32;NULL&#32;);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00564"/>00564 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;G4Random::setTheSeed(&#32;seed&#32;);</emphasis>
<anchor xml:id="__benchmark-2_2ads__transmutex_8cc_source_1l00565"/>00565 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Define&#32;a&#32;phase/space&#32;file&#32;for&#32;the&#32;spallation&#32;source&#32;and&#32;not&#32;to&#32;simulate&#32;the&#32;neutron&#32;source&#32;each&#32;time?</emphasis>
</programlisting></section>
